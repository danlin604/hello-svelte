function sA(pi,ih){return ih.forEach(function(_){_&&typeof _!="string"&&!Array.isArray(_)&&Object.keys(_).forEach(function(G){if(G!=="default"&&!(G in pi)){var fe=Object.getOwnPropertyDescriptor(_,G);Object.defineProperty(pi,G,fe.get?fe:{enumerable:!0,get:function(){return _[G]}})}})}),Object.freeze(pi)}var da=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function lA(pi){return pi&&pi.__esModule&&Object.prototype.hasOwnProperty.call(pi,"default")?pi.default:pi}function Du(pi){throw new Error('Could not dynamically require "'+pi+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var nh={exports:{}};(function(pi,ih){(function(_){pi.exports=_()})(function(){return function(){function _(G,fe,u){function A(h,v){if(!fe[h]){if(!G[h]){var d=typeof Du=="function"&&Du;if(!v&&d)return d(h,!0);if(E)return E(h,!0);var m=new Error("Cannot find module '"+h+"'");throw m.code="MODULE_NOT_FOUND",m}var f=fe[h]={exports:{}};G[h][0].call(f.exports,function(b){var g=G[h][1][b];return A(g||b)},f,f.exports,_,G,fe,u)}return fe[h].exports}for(var E=typeof Du=="function"&&Du,w=0;w<u.length;w++)A(u[w]);return A}return _}()({1:[function(_,G,fe){var u=Object.prototype.toString;G.exports=A;function A(E){return E.BYTES_PER_ELEMENT&&u.call(E.buffer)==="[object ArrayBuffer]"||Array.isArray(E)}},{}],2:[function(_,G,fe){G.exports=function(A,E){return typeof A=="number"?A:typeof E=="number"?E:0}},{}],3:[function(_,G,fe){fe.byteLength=m,fe.toByteArray=b,fe.fromByteArray=x;for(var u=[],A=[],E=typeof Uint8Array!="undefined"?Uint8Array:Array,w="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,v=w.length;h<v;++h)u[h]=w[h],A[w.charCodeAt(h)]=h;A["-".charCodeAt(0)]=62,A["_".charCodeAt(0)]=63;function d(L){var M=L.length;if(M%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var R=L.indexOf("=");R===-1&&(R=M);var D=R===M?0:4-R%4;return[R,D]}function m(L){var M=d(L),R=M[0],D=M[1];return(R+D)*3/4-D}function f(L,M,R){return(M+R)*3/4-R}function b(L){for(var M,R=d(L),D=R[0],N=R[1],z=new E(f(L,D,N)),re=0,Y=N>0?D-4:D,te=0;te<Y;te+=4)M=A[L.charCodeAt(te)]<<18|A[L.charCodeAt(te+1)]<<12|A[L.charCodeAt(te+2)]<<6|A[L.charCodeAt(te+3)],z[re++]=M>>16&255,z[re++]=M>>8&255,z[re++]=M&255;return N===2&&(M=A[L.charCodeAt(te)]<<2|A[L.charCodeAt(te+1)]>>4,z[re++]=M&255),N===1&&(M=A[L.charCodeAt(te)]<<10|A[L.charCodeAt(te+1)]<<4|A[L.charCodeAt(te+2)]>>2,z[re++]=M>>8&255,z[re++]=M&255),z}function g(L){return u[L>>18&63]+u[L>>12&63]+u[L>>6&63]+u[L&63]}function y(L,M,R){for(var D,N=[],z=M;z<R;z+=3)D=(L[z]<<16&16711680)+(L[z+1]<<8&65280)+(L[z+2]&255),N.push(g(D));return N.join("")}function x(L){for(var M,R=L.length,D=R%3,N=[],z=16383,re=0,Y=R-D;re<Y;re+=z)N.push(y(L,re,re+z>Y?Y:re+z));return D===1?(M=L[R-1],N.push(u[M>>2]+u[M<<4&63]+"==")):D===2&&(M=(L[R-2]<<8)+L[R-1],N.push(u[M>>10]+u[M>>4&63]+u[M<<2&63]+"=")),N.join("")}},{}],4:[function(_,G,fe){G.exports={createLink:function(u,A){var E=document.head||document.getElementsByTagName("head")[0],w=document.createElement("link");w.href=u,w.rel="stylesheet";for(var h in A)if(!!A.hasOwnProperty(h)){var v=A[h];w.setAttribute("data-"+h,v)}E.appendChild(w)},createStyle:function(u,A){var E=document.head||document.getElementsByTagName("head")[0],w=document.createElement("style");w.type="text/css";for(var h in A)if(!!A.hasOwnProperty(h)){var v=A[h];w.setAttribute("data-"+h,v)}w.sheet?(w.innerHTML=u,w.sheet.cssText=u,E.appendChild(w)):w.styleSheet?(E.appendChild(w),w.styleSheet.cssText=u):(w.appendChild(document.createTextNode(u)),E.appendChild(w))}}},{}],5:[function(_,G,fe){var u=_("buffer").Buffer;G.exports=function(A,E){if(!!u.isBuffer(A)&&!!u.isBuffer(E)){if(typeof A.equals=="function")return A.equals(E);if(A.length!==E.length)return!1;for(var w=0;w<A.length;w++)if(A[w]!==E[w])return!1;return!0}}},{buffer:6}],6:[function(_,G,fe){(function(u,A){var E=_("base64-js"),w=_("ieee754"),h=_("isarray");fe.Buffer=A,fe.SlowBuffer=N,fe.INSPECT_MAX_BYTES=50,A.TYPED_ARRAY_SUPPORT=u.TYPED_ARRAY_SUPPORT!==void 0?u.TYPED_ARRAY_SUPPORT:v(),fe.kMaxLength=d();function v(){try{var $=new Uint8Array(1);return $.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},$.foo()===42&&typeof $.subarray=="function"&&$.subarray(1,1).byteLength===0}catch{return!1}}function d(){return A.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function m($,U){if(d()<U)throw new RangeError("Invalid typed array length");return A.TYPED_ARRAY_SUPPORT?($=new Uint8Array(U),$.__proto__=A.prototype):($===null&&($=new A(U)),$.length=U),$}function A($,U,H){if(!A.TYPED_ARRAY_SUPPORT&&!(this instanceof A))return new A($,U,H);if(typeof $=="number"){if(typeof U=="string")throw new Error("If encoding is specified then the first argument must be a string");return y(this,$)}return f(this,$,U,H)}A.poolSize=8192,A._augment=function($){return $.__proto__=A.prototype,$};function f($,U,H,ce){if(typeof U=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer!="undefined"&&U instanceof ArrayBuffer?M($,U,H,ce):typeof U=="string"?x($,U,H):R($,U)}A.from=function($,U,H){return f(null,$,U,H)},A.TYPED_ARRAY_SUPPORT&&(A.prototype.__proto__=Uint8Array.prototype,A.__proto__=Uint8Array,typeof Symbol!="undefined"&&Symbol.species&&A[Symbol.species]===A&&Object.defineProperty(A,Symbol.species,{value:null,configurable:!0}));function b($){if(typeof $!="number")throw new TypeError('"size" argument must be a number');if($<0)throw new RangeError('"size" argument must not be negative')}function g($,U,H,ce){return b(U),U<=0?m($,U):H!==void 0?typeof ce=="string"?m($,U).fill(H,ce):m($,U).fill(H):m($,U)}A.alloc=function($,U,H){return g(null,$,U,H)};function y($,U){if(b(U),$=m($,U<0?0:D(U)|0),!A.TYPED_ARRAY_SUPPORT)for(var H=0;H<U;++H)$[H]=0;return $}A.allocUnsafe=function($){return y(null,$)},A.allocUnsafeSlow=function($){return y(null,$)};function x($,U,H){if((typeof H!="string"||H==="")&&(H="utf8"),!A.isEncoding(H))throw new TypeError('"encoding" must be a valid string encoding');var ce=z(U,H)|0;$=m($,ce);var Re=$.write(U,H);return Re!==ce&&($=$.slice(0,Re)),$}function L($,U){var H=U.length<0?0:D(U.length)|0;$=m($,H);for(var ce=0;ce<H;ce+=1)$[ce]=U[ce]&255;return $}function M($,U,H,ce){if(U.byteLength,H<0||U.byteLength<H)throw new RangeError("'offset' is out of bounds");if(U.byteLength<H+(ce||0))throw new RangeError("'length' is out of bounds");return H===void 0&&ce===void 0?U=new Uint8Array(U):ce===void 0?U=new Uint8Array(U,H):U=new Uint8Array(U,H,ce),A.TYPED_ARRAY_SUPPORT?($=U,$.__proto__=A.prototype):$=L($,U),$}function R($,U){if(A.isBuffer(U)){var H=D(U.length)|0;return $=m($,H),$.length===0||U.copy($,0,0,H),$}if(U){if(typeof ArrayBuffer!="undefined"&&U.buffer instanceof ArrayBuffer||"length"in U)return typeof U.length!="number"||vt(U.length)?m($,0):L($,U);if(U.type==="Buffer"&&h(U.data))return L($,U.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function D($){if($>=d())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+d().toString(16)+" bytes");return $|0}function N($){return+$!=$&&($=0),A.alloc(+$)}A.isBuffer=function(U){return!!(U!=null&&U._isBuffer)},A.compare=function(U,H){if(!A.isBuffer(U)||!A.isBuffer(H))throw new TypeError("Arguments must be Buffers");if(U===H)return 0;for(var ce=U.length,Re=H.length,qe=0,$e=Math.min(ce,Re);qe<$e;++qe)if(U[qe]!==H[qe]){ce=U[qe],Re=H[qe];break}return ce<Re?-1:Re<ce?1:0},A.isEncoding=function(U){switch(String(U).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},A.concat=function(U,H){if(!h(U))throw new TypeError('"list" argument must be an Array of Buffers');if(U.length===0)return A.alloc(0);var ce;if(H===void 0)for(H=0,ce=0;ce<U.length;++ce)H+=U[ce].length;var Re=A.allocUnsafe(H),qe=0;for(ce=0;ce<U.length;++ce){var $e=U[ce];if(!A.isBuffer($e))throw new TypeError('"list" argument must be an Array of Buffers');$e.copy(Re,qe),qe+=$e.length}return Re};function z($,U){if(A.isBuffer($))return $.length;if(typeof ArrayBuffer!="undefined"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView($)||$ instanceof ArrayBuffer))return $.byteLength;typeof $!="string"&&($=""+$);var H=$.length;if(H===0)return 0;for(var ce=!1;;)switch(U){case"ascii":case"latin1":case"binary":return H;case"utf8":case"utf-8":case void 0:return De($).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return H*2;case"hex":return H>>>1;case"base64":return at($).length;default:if(ce)return De($).length;U=(""+U).toLowerCase(),ce=!0}}A.byteLength=z;function re($,U,H){var ce=!1;if((U===void 0||U<0)&&(U=0),U>this.length||((H===void 0||H>this.length)&&(H=this.length),H<=0)||(H>>>=0,U>>>=0,H<=U))return"";for($||($="utf8");;)switch($){case"hex":return Gt(this,U,H);case"utf8":case"utf-8":return ke(this,U,H);case"ascii":return At(this,U,H);case"latin1":case"binary":return St(this,U,H);case"base64":return We(this,U,H);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return er(this,U,H);default:if(ce)throw new TypeError("Unknown encoding: "+$);$=($+"").toLowerCase(),ce=!0}}A.prototype._isBuffer=!0;function Y($,U,H){var ce=$[U];$[U]=$[H],$[H]=ce}A.prototype.swap16=function(){var U=this.length;if(U%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var H=0;H<U;H+=2)Y(this,H,H+1);return this},A.prototype.swap32=function(){var U=this.length;if(U%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var H=0;H<U;H+=4)Y(this,H,H+3),Y(this,H+1,H+2);return this},A.prototype.swap64=function(){var U=this.length;if(U%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var H=0;H<U;H+=8)Y(this,H,H+7),Y(this,H+1,H+6),Y(this,H+2,H+5),Y(this,H+3,H+4);return this},A.prototype.toString=function(){var U=this.length|0;return U===0?"":arguments.length===0?ke(this,0,U):re.apply(this,arguments)},A.prototype.equals=function(U){if(!A.isBuffer(U))throw new TypeError("Argument must be a Buffer");return this===U?!0:A.compare(this,U)===0},A.prototype.inspect=function(){var U="",H=fe.INSPECT_MAX_BYTES;return this.length>0&&(U=this.toString("hex",0,H).match(/.{2}/g).join(" "),this.length>H&&(U+=" ... ")),"<Buffer "+U+">"},A.prototype.compare=function(U,H,ce,Re,qe){if(!A.isBuffer(U))throw new TypeError("Argument must be a Buffer");if(H===void 0&&(H=0),ce===void 0&&(ce=U?U.length:0),Re===void 0&&(Re=0),qe===void 0&&(qe=this.length),H<0||ce>U.length||Re<0||qe>this.length)throw new RangeError("out of range index");if(Re>=qe&&H>=ce)return 0;if(Re>=qe)return-1;if(H>=ce)return 1;if(H>>>=0,ce>>>=0,Re>>>=0,qe>>>=0,this===U)return 0;for(var $e=qe-Re,Rt=ce-H,Qt=Math.min($e,Rt),Ar=this.slice(Re,qe),Pr=U.slice(H,ce),Vt=0;Vt<Qt;++Vt)if(Ar[Vt]!==Pr[Vt]){$e=Ar[Vt],Rt=Pr[Vt];break}return $e<Rt?-1:Rt<$e?1:0};function te($,U,H,ce,Re){if($.length===0)return-1;if(typeof H=="string"?(ce=H,H=0):H>2147483647?H=2147483647:H<-2147483648&&(H=-2147483648),H=+H,isNaN(H)&&(H=Re?0:$.length-1),H<0&&(H=$.length+H),H>=$.length){if(Re)return-1;H=$.length-1}else if(H<0)if(Re)H=0;else return-1;if(typeof U=="string"&&(U=A.from(U,ce)),A.isBuffer(U))return U.length===0?-1:J($,U,H,ce,Re);if(typeof U=="number")return U=U&255,A.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?Re?Uint8Array.prototype.indexOf.call($,U,H):Uint8Array.prototype.lastIndexOf.call($,U,H):J($,[U],H,ce,Re);throw new TypeError("val must be string, number or Buffer")}function J($,U,H,ce,Re){var qe=1,$e=$.length,Rt=U.length;if(ce!==void 0&&(ce=String(ce).toLowerCase(),ce==="ucs2"||ce==="ucs-2"||ce==="utf16le"||ce==="utf-16le")){if($.length<2||U.length<2)return-1;qe=2,$e/=2,Rt/=2,H/=2}function Qt(ar,hn){return qe===1?ar[hn]:ar.readUInt16BE(hn*qe)}var Ar;if(Re){var Pr=-1;for(Ar=H;Ar<$e;Ar++)if(Qt($,Ar)===Qt(U,Pr===-1?0:Ar-Pr)){if(Pr===-1&&(Pr=Ar),Ar-Pr+1===Rt)return Pr*qe}else Pr!==-1&&(Ar-=Ar-Pr),Pr=-1}else for(H+Rt>$e&&(H=$e-Rt),Ar=H;Ar>=0;Ar--){for(var Vt=!0,jr=0;jr<Rt;jr++)if(Qt($,Ar+jr)!==Qt(U,jr)){Vt=!1;break}if(Vt)return Ar}return-1}A.prototype.includes=function(U,H,ce){return this.indexOf(U,H,ce)!==-1},A.prototype.indexOf=function(U,H,ce){return te(this,U,H,ce,!0)},A.prototype.lastIndexOf=function(U,H,ce){return te(this,U,H,ce,!1)};function le($,U,H,ce){H=Number(H)||0;var Re=$.length-H;ce?(ce=Number(ce),ce>Re&&(ce=Re)):ce=Re;var qe=U.length;if(qe%2!=0)throw new TypeError("Invalid hex string");ce>qe/2&&(ce=qe/2);for(var $e=0;$e<ce;++$e){var Rt=parseInt(U.substr($e*2,2),16);if(isNaN(Rt))return $e;$[H+$e]=Rt}return $e}function j($,U,H,ce){return lt(De(U,$.length-H),$,H,ce)}function ae($,U,H,ce){return lt(Fe(U),$,H,ce)}function Z($,U,H,ce){return ae($,U,H,ce)}function ye($,U,H,ce){return lt(at(U),$,H,ce)}function Ne($,U,H,ce){return lt(Xe(U,$.length-H),$,H,ce)}A.prototype.write=function(U,H,ce,Re){if(H===void 0)Re="utf8",ce=this.length,H=0;else if(ce===void 0&&typeof H=="string")Re=H,ce=this.length,H=0;else if(isFinite(H))H=H|0,isFinite(ce)?(ce=ce|0,Re===void 0&&(Re="utf8")):(Re=ce,ce=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var qe=this.length-H;if((ce===void 0||ce>qe)&&(ce=qe),U.length>0&&(ce<0||H<0)||H>this.length)throw new RangeError("Attempt to write outside buffer bounds");Re||(Re="utf8");for(var $e=!1;;)switch(Re){case"hex":return le(this,U,H,ce);case"utf8":case"utf-8":return j(this,U,H,ce);case"ascii":return ae(this,U,H,ce);case"latin1":case"binary":return Z(this,U,H,ce);case"base64":return ye(this,U,H,ce);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ne(this,U,H,ce);default:if($e)throw new TypeError("Unknown encoding: "+Re);Re=(""+Re).toLowerCase(),$e=!0}},A.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function We($,U,H){return U===0&&H===$.length?E.fromByteArray($):E.fromByteArray($.slice(U,H))}function ke($,U,H){H=Math.min($.length,H);for(var ce=[],Re=U;Re<H;){var qe=$[Re],$e=null,Rt=qe>239?4:qe>223?3:qe>191?2:1;if(Re+Rt<=H){var Qt,Ar,Pr,Vt;switch(Rt){case 1:qe<128&&($e=qe);break;case 2:Qt=$[Re+1],(Qt&192)==128&&(Vt=(qe&31)<<6|Qt&63,Vt>127&&($e=Vt));break;case 3:Qt=$[Re+1],Ar=$[Re+2],(Qt&192)==128&&(Ar&192)==128&&(Vt=(qe&15)<<12|(Qt&63)<<6|Ar&63,Vt>2047&&(Vt<55296||Vt>57343)&&($e=Vt));break;case 4:Qt=$[Re+1],Ar=$[Re+2],Pr=$[Re+3],(Qt&192)==128&&(Ar&192)==128&&(Pr&192)==128&&(Vt=(qe&15)<<18|(Qt&63)<<12|(Ar&63)<<6|Pr&63,Vt>65535&&Vt<1114112&&($e=Vt))}}$e===null?($e=65533,Rt=1):$e>65535&&($e-=65536,ce.push($e>>>10&1023|55296),$e=56320|$e&1023),ce.push($e),Re+=Rt}return rt(ce)}var it=4096;function rt($){var U=$.length;if(U<=it)return String.fromCharCode.apply(String,$);for(var H="",ce=0;ce<U;)H+=String.fromCharCode.apply(String,$.slice(ce,ce+=it));return H}function At($,U,H){var ce="";H=Math.min($.length,H);for(var Re=U;Re<H;++Re)ce+=String.fromCharCode($[Re]&127);return ce}function St($,U,H){var ce="";H=Math.min($.length,H);for(var Re=U;Re<H;++Re)ce+=String.fromCharCode($[Re]);return ce}function Gt($,U,H){var ce=$.length;(!U||U<0)&&(U=0),(!H||H<0||H>ce)&&(H=ce);for(var Re="",qe=U;qe<H;++qe)Re+=Ie($[qe]);return Re}function er($,U,H){for(var ce=$.slice(U,H),Re="",qe=0;qe<ce.length;qe+=2)Re+=String.fromCharCode(ce[qe]+ce[qe+1]*256);return Re}A.prototype.slice=function(U,H){var ce=this.length;U=~~U,H=H===void 0?ce:~~H,U<0?(U+=ce,U<0&&(U=0)):U>ce&&(U=ce),H<0?(H+=ce,H<0&&(H=0)):H>ce&&(H=ce),H<U&&(H=U);var Re;if(A.TYPED_ARRAY_SUPPORT)Re=this.subarray(U,H),Re.__proto__=A.prototype;else{var qe=H-U;Re=new A(qe,void 0);for(var $e=0;$e<qe;++$e)Re[$e]=this[$e+U]}return Re};function zt($,U,H){if($%1!=0||$<0)throw new RangeError("offset is not uint");if($+U>H)throw new RangeError("Trying to access beyond buffer length")}A.prototype.readUIntLE=function(U,H,ce){U=U|0,H=H|0,ce||zt(U,H,this.length);for(var Re=this[U],qe=1,$e=0;++$e<H&&(qe*=256);)Re+=this[U+$e]*qe;return Re},A.prototype.readUIntBE=function(U,H,ce){U=U|0,H=H|0,ce||zt(U,H,this.length);for(var Re=this[U+--H],qe=1;H>0&&(qe*=256);)Re+=this[U+--H]*qe;return Re},A.prototype.readUInt8=function(U,H){return H||zt(U,1,this.length),this[U]},A.prototype.readUInt16LE=function(U,H){return H||zt(U,2,this.length),this[U]|this[U+1]<<8},A.prototype.readUInt16BE=function(U,H){return H||zt(U,2,this.length),this[U]<<8|this[U+1]},A.prototype.readUInt32LE=function(U,H){return H||zt(U,4,this.length),(this[U]|this[U+1]<<8|this[U+2]<<16)+this[U+3]*16777216},A.prototype.readUInt32BE=function(U,H){return H||zt(U,4,this.length),this[U]*16777216+(this[U+1]<<16|this[U+2]<<8|this[U+3])},A.prototype.readIntLE=function(U,H,ce){U=U|0,H=H|0,ce||zt(U,H,this.length);for(var Re=this[U],qe=1,$e=0;++$e<H&&(qe*=256);)Re+=this[U+$e]*qe;return qe*=128,Re>=qe&&(Re-=Math.pow(2,8*H)),Re},A.prototype.readIntBE=function(U,H,ce){U=U|0,H=H|0,ce||zt(U,H,this.length);for(var Re=H,qe=1,$e=this[U+--Re];Re>0&&(qe*=256);)$e+=this[U+--Re]*qe;return qe*=128,$e>=qe&&($e-=Math.pow(2,8*H)),$e},A.prototype.readInt8=function(U,H){return H||zt(U,1,this.length),this[U]&128?(255-this[U]+1)*-1:this[U]},A.prototype.readInt16LE=function(U,H){H||zt(U,2,this.length);var ce=this[U]|this[U+1]<<8;return ce&32768?ce|4294901760:ce},A.prototype.readInt16BE=function(U,H){H||zt(U,2,this.length);var ce=this[U+1]|this[U]<<8;return ce&32768?ce|4294901760:ce},A.prototype.readInt32LE=function(U,H){return H||zt(U,4,this.length),this[U]|this[U+1]<<8|this[U+2]<<16|this[U+3]<<24},A.prototype.readInt32BE=function(U,H){return H||zt(U,4,this.length),this[U]<<24|this[U+1]<<16|this[U+2]<<8|this[U+3]},A.prototype.readFloatLE=function(U,H){return H||zt(U,4,this.length),w.read(this,U,!0,23,4)},A.prototype.readFloatBE=function(U,H){return H||zt(U,4,this.length),w.read(this,U,!1,23,4)},A.prototype.readDoubleLE=function(U,H){return H||zt(U,8,this.length),w.read(this,U,!0,52,8)},A.prototype.readDoubleBE=function(U,H){return H||zt(U,8,this.length),w.read(this,U,!1,52,8)};function wt($,U,H,ce,Re,qe){if(!A.isBuffer($))throw new TypeError('"buffer" argument must be a Buffer instance');if(U>Re||U<qe)throw new RangeError('"value" argument is out of bounds');if(H+ce>$.length)throw new RangeError("Index out of range")}A.prototype.writeUIntLE=function(U,H,ce,Re){if(U=+U,H=H|0,ce=ce|0,!Re){var qe=Math.pow(2,8*ce)-1;wt(this,U,H,ce,qe,0)}var $e=1,Rt=0;for(this[H]=U&255;++Rt<ce&&($e*=256);)this[H+Rt]=U/$e&255;return H+ce},A.prototype.writeUIntBE=function(U,H,ce,Re){if(U=+U,H=H|0,ce=ce|0,!Re){var qe=Math.pow(2,8*ce)-1;wt(this,U,H,ce,qe,0)}var $e=ce-1,Rt=1;for(this[H+$e]=U&255;--$e>=0&&(Rt*=256);)this[H+$e]=U/Rt&255;return H+ce},A.prototype.writeUInt8=function(U,H,ce){return U=+U,H=H|0,ce||wt(this,U,H,1,255,0),A.TYPED_ARRAY_SUPPORT||(U=Math.floor(U)),this[H]=U&255,H+1};function kr($,U,H,ce){U<0&&(U=65535+U+1);for(var Re=0,qe=Math.min($.length-H,2);Re<qe;++Re)$[H+Re]=(U&255<<8*(ce?Re:1-Re))>>>(ce?Re:1-Re)*8}A.prototype.writeUInt16LE=function(U,H,ce){return U=+U,H=H|0,ce||wt(this,U,H,2,65535,0),A.TYPED_ARRAY_SUPPORT?(this[H]=U&255,this[H+1]=U>>>8):kr(this,U,H,!0),H+2},A.prototype.writeUInt16BE=function(U,H,ce){return U=+U,H=H|0,ce||wt(this,U,H,2,65535,0),A.TYPED_ARRAY_SUPPORT?(this[H]=U>>>8,this[H+1]=U&255):kr(this,U,H,!1),H+2};function en($,U,H,ce){U<0&&(U=4294967295+U+1);for(var Re=0,qe=Math.min($.length-H,4);Re<qe;++Re)$[H+Re]=U>>>(ce?Re:3-Re)*8&255}A.prototype.writeUInt32LE=function(U,H,ce){return U=+U,H=H|0,ce||wt(this,U,H,4,4294967295,0),A.TYPED_ARRAY_SUPPORT?(this[H+3]=U>>>24,this[H+2]=U>>>16,this[H+1]=U>>>8,this[H]=U&255):en(this,U,H,!0),H+4},A.prototype.writeUInt32BE=function(U,H,ce){return U=+U,H=H|0,ce||wt(this,U,H,4,4294967295,0),A.TYPED_ARRAY_SUPPORT?(this[H]=U>>>24,this[H+1]=U>>>16,this[H+2]=U>>>8,this[H+3]=U&255):en(this,U,H,!1),H+4},A.prototype.writeIntLE=function(U,H,ce,Re){if(U=+U,H=H|0,!Re){var qe=Math.pow(2,8*ce-1);wt(this,U,H,ce,qe-1,-qe)}var $e=0,Rt=1,Qt=0;for(this[H]=U&255;++$e<ce&&(Rt*=256);)U<0&&Qt===0&&this[H+$e-1]!==0&&(Qt=1),this[H+$e]=(U/Rt>>0)-Qt&255;return H+ce},A.prototype.writeIntBE=function(U,H,ce,Re){if(U=+U,H=H|0,!Re){var qe=Math.pow(2,8*ce-1);wt(this,U,H,ce,qe-1,-qe)}var $e=ce-1,Rt=1,Qt=0;for(this[H+$e]=U&255;--$e>=0&&(Rt*=256);)U<0&&Qt===0&&this[H+$e+1]!==0&&(Qt=1),this[H+$e]=(U/Rt>>0)-Qt&255;return H+ce},A.prototype.writeInt8=function(U,H,ce){return U=+U,H=H|0,ce||wt(this,U,H,1,127,-128),A.TYPED_ARRAY_SUPPORT||(U=Math.floor(U)),U<0&&(U=255+U+1),this[H]=U&255,H+1},A.prototype.writeInt16LE=function(U,H,ce){return U=+U,H=H|0,ce||wt(this,U,H,2,32767,-32768),A.TYPED_ARRAY_SUPPORT?(this[H]=U&255,this[H+1]=U>>>8):kr(this,U,H,!0),H+2},A.prototype.writeInt16BE=function(U,H,ce){return U=+U,H=H|0,ce||wt(this,U,H,2,32767,-32768),A.TYPED_ARRAY_SUPPORT?(this[H]=U>>>8,this[H+1]=U&255):kr(this,U,H,!1),H+2},A.prototype.writeInt32LE=function(U,H,ce){return U=+U,H=H|0,ce||wt(this,U,H,4,2147483647,-2147483648),A.TYPED_ARRAY_SUPPORT?(this[H]=U&255,this[H+1]=U>>>8,this[H+2]=U>>>16,this[H+3]=U>>>24):en(this,U,H,!0),H+4},A.prototype.writeInt32BE=function(U,H,ce){return U=+U,H=H|0,ce||wt(this,U,H,4,2147483647,-2147483648),U<0&&(U=4294967295+U+1),A.TYPED_ARRAY_SUPPORT?(this[H]=U>>>24,this[H+1]=U>>>16,this[H+2]=U>>>8,this[H+3]=U&255):en(this,U,H,!1),H+4};function Nt($,U,H,ce,Re,qe){if(H+ce>$.length)throw new RangeError("Index out of range");if(H<0)throw new RangeError("Index out of range")}function ne($,U,H,ce,Re){return Re||Nt($,U,H,4),w.write($,U,H,ce,23,4),H+4}A.prototype.writeFloatLE=function(U,H,ce){return ne(this,U,H,!0,ce)},A.prototype.writeFloatBE=function(U,H,ce){return ne(this,U,H,!1,ce)};function ie($,U,H,ce,Re){return Re||Nt($,U,H,8),w.write($,U,H,ce,52,8),H+8}A.prototype.writeDoubleLE=function(U,H,ce){return ie(this,U,H,!0,ce)},A.prototype.writeDoubleBE=function(U,H,ce){return ie(this,U,H,!1,ce)},A.prototype.copy=function(U,H,ce,Re){if(ce||(ce=0),!Re&&Re!==0&&(Re=this.length),H>=U.length&&(H=U.length),H||(H=0),Re>0&&Re<ce&&(Re=ce),Re===ce||U.length===0||this.length===0)return 0;if(H<0)throw new RangeError("targetStart out of bounds");if(ce<0||ce>=this.length)throw new RangeError("sourceStart out of bounds");if(Re<0)throw new RangeError("sourceEnd out of bounds");Re>this.length&&(Re=this.length),U.length-H<Re-ce&&(Re=U.length-H+ce);var qe=Re-ce,$e;if(this===U&&ce<H&&H<Re)for($e=qe-1;$e>=0;--$e)U[$e+H]=this[$e+ce];else if(qe<1e3||!A.TYPED_ARRAY_SUPPORT)for($e=0;$e<qe;++$e)U[$e+H]=this[$e+ce];else Uint8Array.prototype.set.call(U,this.subarray(ce,ce+qe),H);return qe},A.prototype.fill=function(U,H,ce,Re){if(typeof U=="string"){if(typeof H=="string"?(Re=H,H=0,ce=this.length):typeof ce=="string"&&(Re=ce,ce=this.length),U.length===1){var qe=U.charCodeAt(0);qe<256&&(U=qe)}if(Re!==void 0&&typeof Re!="string")throw new TypeError("encoding must be a string");if(typeof Re=="string"&&!A.isEncoding(Re))throw new TypeError("Unknown encoding: "+Re)}else typeof U=="number"&&(U=U&255);if(H<0||this.length<H||this.length<ce)throw new RangeError("Out of range index");if(ce<=H)return this;H=H>>>0,ce=ce===void 0?this.length:ce>>>0,U||(U=0);var $e;if(typeof U=="number")for($e=H;$e<ce;++$e)this[$e]=U;else{var Rt=A.isBuffer(U)?U:De(new A(U,Re).toString()),Qt=Rt.length;for($e=0;$e<ce-H;++$e)this[$e+H]=Rt[$e%Qt]}return this};var ge=/[^+\/0-9A-Za-z-_]/g;function ve($){if($=we($).replace(ge,""),$.length<2)return"";for(;$.length%4!=0;)$=$+"=";return $}function we($){return $.trim?$.trim():$.replace(/^\s+|\s+$/g,"")}function Ie($){return $<16?"0"+$.toString(16):$.toString(16)}function De($,U){U=U||1/0;for(var H,ce=$.length,Re=null,qe=[],$e=0;$e<ce;++$e){if(H=$.charCodeAt($e),H>55295&&H<57344){if(!Re){if(H>56319){(U-=3)>-1&&qe.push(239,191,189);continue}else if($e+1===ce){(U-=3)>-1&&qe.push(239,191,189);continue}Re=H;continue}if(H<56320){(U-=3)>-1&&qe.push(239,191,189),Re=H;continue}H=(Re-55296<<10|H-56320)+65536}else Re&&(U-=3)>-1&&qe.push(239,191,189);if(Re=null,H<128){if((U-=1)<0)break;qe.push(H)}else if(H<2048){if((U-=2)<0)break;qe.push(H>>6|192,H&63|128)}else if(H<65536){if((U-=3)<0)break;qe.push(H>>12|224,H>>6&63|128,H&63|128)}else if(H<1114112){if((U-=4)<0)break;qe.push(H>>18|240,H>>12&63|128,H>>6&63|128,H&63|128)}else throw new Error("Invalid code point")}return qe}function Fe($){for(var U=[],H=0;H<$.length;++H)U.push($.charCodeAt(H)&255);return U}function Xe($,U){for(var H,ce,Re,qe=[],$e=0;$e<$.length&&!((U-=2)<0);++$e)H=$.charCodeAt($e),ce=H>>8,Re=H%256,qe.push(Re),qe.push(ce);return qe}function at($){return E.toByteArray(ve($))}function lt($,U,H,ce){for(var Re=0;Re<ce&&!(Re+H>=U.length||Re>=$.length);++Re)U[Re+H]=$[Re];return Re}function vt($){return $!==$}}).call(this,typeof da!="undefined"?da:typeof self!="undefined"?self:typeof window!="undefined"?window:{},_("buffer").Buffer)},{"base64-js":3,buffer:6,ieee754:29,isarray:35}],7:[function(_,G,fe){(function(){if(typeof window!="undefined")try{var u=new window.CustomEvent("test",{cancelable:!0});if(u.preventDefault(),u.defaultPrevented!==!0)throw new Error("Could not prevent default")}catch{var A=function(w,h){var v,d;return h=h||{},h.bubbles=!!h.bubbles,h.cancelable=!!h.cancelable,v=document.createEvent("CustomEvent"),v.initCustomEvent(w,h.bubbles,h.cancelable,h.detail),d=v.preventDefault,v.preventDefault=function(){d.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch{this.defaultPrevented=!0}},v};A.prototype=window.Event.prototype,window.CustomEvent=A}})()},{}],8:[function(_,G,fe){fe=G.exports=_("./debug"),fe.log=E,fe.formatArgs=A,fe.save=w,fe.load=h,fe.useColors=u,fe.storage=typeof chrome!="undefined"&&typeof chrome.storage!="undefined"?chrome.storage.local:v(),fe.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function u(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}fe.formatters.j=function(d){return JSON.stringify(d)};function A(){var d=arguments,m=this.useColors;if(d[0]=(m?"%c":"")+this.namespace+(m?" %c":" ")+d[0]+(m?"%c ":" "),!m)return d;var f="color: "+this.color;d=[d[0],f,"color: inherit"].concat(Array.prototype.slice.call(d,1));var b=0,g=0;return d[0].replace(/%[a-z%]/g,function(y){y!=="%%"&&(b++,y==="%c"&&(g=b))}),d.splice(g,0,f),d}function E(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function w(d){try{d==null?fe.storage.removeItem("debug"):fe.storage.debug=d}catch{}}function h(){var d;try{d=fe.storage.debug}catch{}return d}fe.enable(h());function v(){try{return window.localStorage}catch{}}},{"./debug":9}],9:[function(_,G,fe){fe=G.exports=E,fe.coerce=d,fe.disable=h,fe.enable=w,fe.enabled=v,fe.names=[],fe.skips=[],fe.formatters={};var u=0;function A(){return fe.colors[u++%fe.colors.length]}function E(m){function f(){}f.enabled=!1;function b(){var y=b;y.useColors==null&&(y.useColors=fe.useColors()),y.color==null&&y.useColors&&(y.color=A());var x=Array.prototype.slice.call(arguments);x[0]=fe.coerce(x[0]),typeof x[0]!="string"&&(x=["%o"].concat(x));var L=0;x[0]=x[0].replace(/%([a-z%])/g,function(R,D){if(R==="%%")return R;L++;var N=fe.formatters[D];if(typeof N=="function"){var z=x[L];R=N.call(y,z),x.splice(L,1),L--}return R}),typeof fe.formatArgs=="function"&&(x=fe.formatArgs.apply(y,x));var M=b.log||fe.log||console.log.bind(console);M.apply(y,x)}b.enabled=!0;var g=fe.enabled(m)?b:f;return g.namespace=m,g}function w(m){fe.save(m);for(var f=(m||"").split(/[\s,]+/),b=f.length,g=0;g<b;g++)!f[g]||(m=f[g].replace(/\*/g,".*?"),m[0]==="-"?fe.skips.push(new RegExp("^"+m.substr(1)+"$")):fe.names.push(new RegExp("^"+m+"$")))}function h(){fe.enable("")}function v(m){var f,b;for(f=0,b=fe.skips.length;f<b;f++)if(fe.skips[f].test(m))return!1;for(f=0,b=fe.names.length;f<b;f++)if(fe.names[f].test(m))return!0;return!1}function d(m){return m instanceof Error?m.stack||m.message:m}},{}],10:[function(_,G,fe){var u=_("is-obj"),A=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;function w(d){if(d==null)throw new TypeError("Sources cannot be null or undefined");return Object(d)}function h(d,m,f){var b=m[f];if(b!=null){if(A.call(d,f)&&(d[f]===void 0||d[f]===null))throw new TypeError("Cannot convert undefined or null to object ("+f+")");!A.call(d,f)||!u(b)?d[f]=b:d[f]=v(Object(d[f]),m[f])}}function v(d,m){if(d===m)return d;m=Object(m);for(var f in m)A.call(m,f)&&h(d,m,f);if(Object.getOwnPropertySymbols)for(var b=Object.getOwnPropertySymbols(m),g=0;g<b.length;g++)E.call(m,b[g])&&h(d,m,b[g]);return d}G.exports=function(m){m=w(m);for(var f=1;f<arguments.length;f++)v(m,arguments[f]);return m}},{"is-obj":34}],11:[function(_,G,fe){var u=_("object-keys"),A=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",E=Object.prototype.toString,w=Array.prototype.concat,h=Object.defineProperty,v=function(g){return typeof g=="function"&&E.call(g)==="[object Function]"},d=function(){var g={};try{h(g,"x",{enumerable:!1,value:g});for(var y in g)return!1;return g.x===g}catch{return!1}},m=h&&d(),f=function(g,y,x,L){y in g&&(!v(L)||!L())||(m?h(g,y,{configurable:!0,enumerable:!1,value:x,writable:!0}):g[y]=x)},b=function(g,y){var x=arguments.length>2?arguments[2]:{},L=u(y);A&&(L=w.call(L,Object.getOwnPropertySymbols(y)));for(var M=0;M<L.length;M+=1)f(g,L[M],y[L[M]],x[L[M]])};b.supportsDescriptors=!!m,G.exports=b},{"object-keys":41}],12:[function(_,G,fe){/*! (C) WebReflection Mit Style License */(function(u,A,E,w){function h(ot,nt){for(var yt=0,Jt=ot.length;yt<Jt;yt++)D(ot[yt],nt)}function v(ot){for(var nt=0,yt=ot.length,Jt;nt<yt;nt++)Jt=ot[nt],dn(Jt,rt[m(Jt)])}function d(ot){return function(nt){Xe(nt)&&(D(nt,ot),h(nt.querySelectorAll(At),ot))}}function m(ot){var nt=vt.call(ot,"is"),yt=ot.nodeName.toUpperCase(),Jt=Gt.call(it,nt?Ne+nt.toUpperCase():ye+yt);return nt&&-1<Jt&&!f(yt,nt)?-1:Jt}function f(ot,nt){return-1<At.indexOf(ot+'[is="'+nt+'"]')}function b(ot){var nt=ot.currentTarget,yt=ot.attrChange,Jt=ot.attrName,tr=ot.target;Pr&&(!tr||tr===nt)&&nt.attributeChangedCallback&&Jt!=="style"&&ot.prevValue!==ot.newValue&&nt.attributeChangedCallback(Jt,yt===ot[te]?null:ot.prevValue,yt===ot[le]?null:ot.newValue)}function g(ot){var nt=d(ot);return function(yt){qe.push(nt,yt.target)}}function y(ot){Ar&&(Ar=!1,ot.currentTarget.removeEventListener(ae,y)),h((ot.target||A).querySelectorAll(At),ot.detail===re?re:z),Fe&&M()}function x(ot,nt){var yt=this;$.call(yt,ot,nt),Vt.call(yt,{target:yt})}function L(ot,nt){we(ot,nt),hn?hn.observe(ot,ce):(Qt&&(ot.setAttribute=x,ot[N]=ar(ot),ot.addEventListener(Z,Vt)),ot.addEventListener(j,b)),ot.createdCallback&&Pr&&(ot.created=!0,ot.createdCallback(),ot.created=!1)}function M(){for(var ot,nt=0,yt=at.length;nt<yt;nt++)ot=at[nt],St.contains(ot)||(yt--,at.splice(nt--,1),D(ot,re))}function R(ot){throw new Error("A "+ot+" type is already registered")}function D(ot,nt){var yt,Jt=m(ot);-1<Jt&&(Rn(ot,rt[Jt]),Jt=0,nt===z&&!ot[z]?(ot[re]=!1,ot[z]=!0,Jt=1,Fe&&Gt.call(at,ot)<0&&at.push(ot)):nt===re&&!ot[re]&&(ot[z]=!1,ot[re]=!0,Jt=1),Jt&&(yt=ot[nt+"Callback"])&&yt.call(ot))}if(!(w in A)){var N="__"+w+(Math.random()*1e5>>0),z="attached",re="detached",Y="extends",te="ADDITION",J="MODIFICATION",le="REMOVAL",j="DOMAttrModified",ae="DOMContentLoaded",Z="DOMSubtreeModified",ye="<",Ne="=",We=/^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,ke=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],it=[],rt=[],At="",St=A.documentElement,Gt=it.indexOf||function(ot){for(var nt=this.length;nt--&&this[nt]!==ot;);return nt},er=E.prototype,zt=er.hasOwnProperty,wt=er.isPrototypeOf,kr=E.defineProperty,en=E.getOwnPropertyDescriptor,Nt=E.getOwnPropertyNames,ne=E.getPrototypeOf,ie=E.setPrototypeOf,ge=!!E.__proto__,ve=E.create||function ot(nt){return nt?(ot.prototype=nt,new ot):this},we=ie||(ge?function(ot,nt){return ot.__proto__=nt,ot}:Nt&&en?function(){function ot(nt,yt){for(var Jt,tr=Nt(yt),ur=0,ir=tr.length;ur<ir;ur++)Jt=tr[ur],zt.call(nt,Jt)||kr(nt,Jt,en(yt,Jt))}return function(nt,yt){do ot(nt,yt);while((yt=ne(yt))&&!wt.call(yt,nt));return nt}}():function(ot,nt){for(var yt in nt)ot[yt]=nt[yt];return ot}),Ie=u.MutationObserver||u.WebKitMutationObserver,De=(u.HTMLElement||u.Element||u.Node).prototype,Fe=!wt.call(De,St),Xe=Fe?function(ot){return ot.nodeType===1}:function(ot){return wt.call(De,ot)},at=Fe&&[],lt=De.cloneNode,vt=De.getAttribute,$=De.setAttribute,U=De.removeAttribute,H=A.createElement,ce=Ie&&{attributes:!0,characterData:!0,attributeOldValue:!0},Re=Ie||function(ot){Qt=!1,St.removeEventListener(j,Re)},qe,$e=u.requestAnimationFrame||u.webkitRequestAnimationFrame||u.mozRequestAnimationFrame||u.msRequestAnimationFrame||function(ot){setTimeout(ot,10)},Rt=!1,Qt=!0,Ar=!0,Pr=!0,Vt,jr,ar,hn,Rn,dn;ie||ge?(Rn=function(ot,nt){wt.call(nt,ot)||L(ot,nt)},dn=L):(Rn=function(ot,nt){ot[N]||(ot[N]=E(!0),L(ot,nt))},dn=Rn),Fe?(Qt=!1,function(){var ot=en(De,"addEventListener"),nt=ot.value,yt=function(ur){var ir=new CustomEvent(j,{bubbles:!0});ir.attrName=ur,ir.prevValue=vt.call(this,ur),ir.newValue=null,ir[le]=ir.attrChange=2,U.call(this,ur),this.dispatchEvent(ir)},Jt=function(ur,ir){var xr=this.hasAttribute(ur),Xr=xr&&vt.call(this,ur);e=new CustomEvent(j,{bubbles:!0}),$.call(this,ur,ir),e.attrName=ur,e.prevValue=xr?Xr:null,e.newValue=ir,xr?e[J]=e.attrChange=1:e[te]=e.attrChange=0,this.dispatchEvent(e)},tr=function(ur){var ir=ur.currentTarget,xr=ir[N],Xr=ur.propertyName,Dr;xr.hasOwnProperty(Xr)&&(xr=xr[Xr],Dr=new CustomEvent(j,{bubbles:!0}),Dr.attrName=xr.name,Dr.prevValue=xr.value||null,Dr.newValue=xr.value=ir[Xr]||null,Dr.prevValue==null?Dr[te]=Dr.attrChange=0:Dr[J]=Dr.attrChange=1,ir.dispatchEvent(Dr))};ot.value=function(ur,ir,xr){ur===j&&this.attributeChangedCallback&&this.setAttribute!==Jt&&(this[N]={className:{name:"class",value:this.className}},this.setAttribute=Jt,this.removeAttribute=yt,nt.call(this,"propertychange",tr)),nt.call(this,ur,ir,xr)},kr(De,"addEventListener",ot)}()):Ie||(St.addEventListener(j,Re),St.setAttribute(N,1),St.removeAttribute(N),Qt&&(Vt=function(ot){var nt=this,yt,Jt,tr;if(nt===ot.target){yt=nt[N],nt[N]=Jt=ar(nt);for(tr in Jt){if(!(tr in yt))return jr(0,nt,tr,yt[tr],Jt[tr],te);if(Jt[tr]!==yt[tr])return jr(1,nt,tr,yt[tr],Jt[tr],J)}for(tr in yt)if(!(tr in Jt))return jr(2,nt,tr,yt[tr],Jt[tr],le)}},jr=function(ot,nt,yt,Jt,tr,ur){var ir={attrChange:ot,currentTarget:nt,attrName:yt,prevValue:Jt,newValue:tr};ir[ur]=ot,b(ir)},ar=function(ot){for(var nt,yt,Jt={},tr=ot.attributes,ur=0,ir=tr.length;ur<ir;ur++)nt=tr[ur],yt=nt.name,yt!=="setAttribute"&&(Jt[yt]=nt.value);return Jt})),A[w]=function(ot,nt){if(ir=ot.toUpperCase(),Rt||(Rt=!0,Ie?(hn=function(Xr,Dr){function Nn(Yr,Ur){for(var on=0,vi=Yr.length;on<vi;Ur(Yr[on++]));}return new Ie(function(Yr){for(var Ur,on,vi,qn=0,qr=Yr.length;qn<qr;qn++)Ur=Yr[qn],Ur.type==="childList"?(Nn(Ur.addedNodes,Xr),Nn(Ur.removedNodes,Dr)):(on=Ur.target,Pr&&on.attributeChangedCallback&&Ur.attributeName!=="style"&&(vi=vt.call(on,Ur.attributeName),vi!==Ur.oldValue&&on.attributeChangedCallback(Ur.attributeName,Ur.oldValue,vi)))})}(d(z),d(re)),hn.observe(A,{childList:!0,subtree:!0})):(qe=[],$e(function Xr(){for(;qe.length;)qe.shift().call(null,qe.shift());$e(Xr)}),A.addEventListener("DOMNodeInserted",g(z)),A.addEventListener("DOMNodeRemoved",g(re))),A.addEventListener(ae,y),A.addEventListener("readystatechange",y),A.createElement=function(Xr,Dr){var Nn=H.apply(A,arguments),Yr=""+Xr,Ur=Gt.call(it,(Dr?Ne:ye)+(Dr||Yr).toUpperCase()),on=-1<Ur;return Dr&&(Nn.setAttribute("is",Dr=Dr.toLowerCase()),on&&(on=f(Yr.toUpperCase(),Dr))),Pr=!A.createElement.innerHTMLHelper,on&&dn(Nn,rt[Ur]),Nn},De.cloneNode=function(Xr){var Dr=lt.call(this,!!Xr),Nn=m(Dr);return-1<Nn&&dn(Dr,rt[Nn]),Xr&&v(Dr.querySelectorAll(At)),Dr}),-2<Gt.call(it,Ne+ir)+Gt.call(it,ye+ir)&&R(ot),!We.test(ir)||-1<Gt.call(ke,ir))throw new Error("The type "+ot+" is invalid");var yt=function(){return tr?A.createElement(ur,ir):A.createElement(ur)},Jt=nt||er,tr=zt.call(Jt,Y),ur=tr?nt[Y].toUpperCase():ir,ir,xr;return tr&&-1<Gt.call(it,ye+ur)&&R(ur),xr=it.push((tr?Ne:ye)+ir)-1,At=At.concat(At.length?",":"",tr?ur+'[is="'+ot.toLowerCase()+'"]':ur),yt.prototype=rt[xr]=zt.call(Jt,"prototype")?Jt.prototype:ve(De),h(A.querySelectorAll(At),z),yt}}})(window,document,Object,"registerElement")},{}],13:[function(_,G,fe){G.exports=function(u){switch(u){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],14:[function(_,G,fe){var u,A=Object.getOwnPropertyDescriptor?function(){return Object.getOwnPropertyDescriptor(arguments,"callee").get}():function(){throw new TypeError},E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",w=Object.getPrototypeOf||function(b){return b.__proto__},h=u,v=u,d=u,m=typeof Uint8Array=="undefined"?u:w(Uint8Array),f={"$ %Array%":Array,"$ %ArrayBuffer%":typeof ArrayBuffer=="undefined"?u:ArrayBuffer,"$ %ArrayBufferPrototype%":typeof ArrayBuffer=="undefined"?u:ArrayBuffer.prototype,"$ %ArrayIteratorPrototype%":E?w([][Symbol.iterator]()):u,"$ %ArrayPrototype%":Array.prototype,"$ %ArrayProto_entries%":Array.prototype.entries,"$ %ArrayProto_forEach%":Array.prototype.forEach,"$ %ArrayProto_keys%":Array.prototype.keys,"$ %ArrayProto_values%":Array.prototype.values,"$ %AsyncFromSyncIteratorPrototype%":u,"$ %AsyncFunction%":v,"$ %AsyncFunctionPrototype%":u,"$ %AsyncGenerator%":u,"$ %AsyncGeneratorFunction%":d,"$ %AsyncGeneratorPrototype%":u,"$ %AsyncIteratorPrototype%":u,"$ %Atomics%":typeof Atomics=="undefined"?u:Atomics,"$ %Boolean%":Boolean,"$ %BooleanPrototype%":Boolean.prototype,"$ %DataView%":typeof DataView=="undefined"?u:DataView,"$ %DataViewPrototype%":typeof DataView=="undefined"?u:DataView.prototype,"$ %Date%":Date,"$ %DatePrototype%":Date.prototype,"$ %decodeURI%":decodeURI,"$ %decodeURIComponent%":decodeURIComponent,"$ %encodeURI%":encodeURI,"$ %encodeURIComponent%":encodeURIComponent,"$ %Error%":Error,"$ %ErrorPrototype%":Error.prototype,"$ %eval%":eval,"$ %EvalError%":EvalError,"$ %EvalErrorPrototype%":EvalError.prototype,"$ %Float32Array%":typeof Float32Array=="undefined"?u:Float32Array,"$ %Float32ArrayPrototype%":typeof Float32Array=="undefined"?u:Float32Array.prototype,"$ %Float64Array%":typeof Float64Array=="undefined"?u:Float64Array,"$ %Float64ArrayPrototype%":typeof Float64Array=="undefined"?u:Float64Array.prototype,"$ %Function%":Function,"$ %FunctionPrototype%":Function.prototype,"$ %Generator%":u,"$ %GeneratorFunction%":h,"$ %GeneratorPrototype%":u,"$ %Int8Array%":typeof Int8Array=="undefined"?u:Int8Array,"$ %Int8ArrayPrototype%":typeof Int8Array=="undefined"?u:Int8Array.prototype,"$ %Int16Array%":typeof Int16Array=="undefined"?u:Int16Array,"$ %Int16ArrayPrototype%":typeof Int16Array=="undefined"?u:Int8Array.prototype,"$ %Int32Array%":typeof Int32Array=="undefined"?u:Int32Array,"$ %Int32ArrayPrototype%":typeof Int32Array=="undefined"?u:Int32Array.prototype,"$ %isFinite%":isFinite,"$ %isNaN%":isNaN,"$ %IteratorPrototype%":E?w(w([][Symbol.iterator]())):u,"$ %JSON%":JSON,"$ %JSONParse%":JSON.parse,"$ %Map%":typeof Map=="undefined"?u:Map,"$ %MapIteratorPrototype%":typeof Map=="undefined"||!E?u:w(new Map()[Symbol.iterator]()),"$ %MapPrototype%":typeof Map=="undefined"?u:Map.prototype,"$ %Math%":Math,"$ %Number%":Number,"$ %NumberPrototype%":Number.prototype,"$ %Object%":Object,"$ %ObjectPrototype%":Object.prototype,"$ %ObjProto_toString%":Object.prototype.toString,"$ %ObjProto_valueOf%":Object.prototype.valueOf,"$ %parseFloat%":parseFloat,"$ %parseInt%":parseInt,"$ %Promise%":typeof Promise=="undefined"?u:Promise,"$ %PromisePrototype%":typeof Promise=="undefined"?u:Promise.prototype,"$ %PromiseProto_then%":typeof Promise=="undefined"?u:Promise.prototype.then,"$ %Promise_all%":typeof Promise=="undefined"?u:Promise.all,"$ %Promise_reject%":typeof Promise=="undefined"?u:Promise.reject,"$ %Promise_resolve%":typeof Promise=="undefined"?u:Promise.resolve,"$ %Proxy%":typeof Proxy=="undefined"?u:Proxy,"$ %RangeError%":RangeError,"$ %RangeErrorPrototype%":RangeError.prototype,"$ %ReferenceError%":ReferenceError,"$ %ReferenceErrorPrototype%":ReferenceError.prototype,"$ %Reflect%":typeof Reflect=="undefined"?u:Reflect,"$ %RegExp%":RegExp,"$ %RegExpPrototype%":RegExp.prototype,"$ %Set%":typeof Set=="undefined"?u:Set,"$ %SetIteratorPrototype%":typeof Set=="undefined"||!E?u:w(new Set()[Symbol.iterator]()),"$ %SetPrototype%":typeof Set=="undefined"?u:Set.prototype,"$ %SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?u:SharedArrayBuffer,"$ %SharedArrayBufferPrototype%":typeof SharedArrayBuffer=="undefined"?u:SharedArrayBuffer.prototype,"$ %String%":String,"$ %StringIteratorPrototype%":E?w(""[Symbol.iterator]()):u,"$ %StringPrototype%":String.prototype,"$ %Symbol%":E?Symbol:u,"$ %SymbolPrototype%":E?Symbol.prototype:u,"$ %SyntaxError%":SyntaxError,"$ %SyntaxErrorPrototype%":SyntaxError.prototype,"$ %ThrowTypeError%":A,"$ %TypedArray%":m,"$ %TypedArrayPrototype%":m?m.prototype:u,"$ %TypeError%":TypeError,"$ %TypeErrorPrototype%":TypeError.prototype,"$ %Uint8Array%":typeof Uint8Array=="undefined"?u:Uint8Array,"$ %Uint8ArrayPrototype%":typeof Uint8Array=="undefined"?u:Uint8Array.prototype,"$ %Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?u:Uint8ClampedArray,"$ %Uint8ClampedArrayPrototype%":typeof Uint8ClampedArray=="undefined"?u:Uint8ClampedArray.prototype,"$ %Uint16Array%":typeof Uint16Array=="undefined"?u:Uint16Array,"$ %Uint16ArrayPrototype%":typeof Uint16Array=="undefined"?u:Uint16Array.prototype,"$ %Uint32Array%":typeof Uint32Array=="undefined"?u:Uint32Array,"$ %Uint32ArrayPrototype%":typeof Uint32Array=="undefined"?u:Uint32Array.prototype,"$ %URIError%":URIError,"$ %URIErrorPrototype%":URIError.prototype,"$ %WeakMap%":typeof WeakMap=="undefined"?u:WeakMap,"$ %WeakMapPrototype%":typeof WeakMap=="undefined"?u:WeakMap.prototype,"$ %WeakSet%":typeof WeakSet=="undefined"?u:WeakSet,"$ %WeakSetPrototype%":typeof WeakSet=="undefined"?u:WeakSet.prototype};G.exports=function(g,y){if(arguments.length>1&&typeof y!="boolean")throw new TypeError('"allowMissing" argument must be a boolean');var x="$ "+g;if(!(x in f))throw new SyntaxError("intrinsic "+g+" does not exist!");if(typeof f[x]=="undefined"&&!y)throw new TypeError("intrinsic "+g+" exists, but is not available. Please file an issue!");return f[x]}},{}],15:[function(_,G,fe){var u=_("./GetIntrinsic"),A=u("%Object%"),E=u("%TypeError%"),w=u("%String%"),h=_("./helpers/assertRecord"),v=_("./helpers/isNaN"),d=_("./helpers/isFinite"),m=_("./helpers/sign"),f=_("./helpers/mod"),b=_("is-callable"),g=_("es-to-primitive/es5"),y=_("has"),x={ToPrimitive:g,ToBoolean:function(M){return!!M},ToNumber:function(M){return+M},ToInteger:function(M){var R=this.ToNumber(M);return v(R)?0:R===0||!d(R)?R:m(R)*Math.floor(Math.abs(R))},ToInt32:function(M){return this.ToNumber(M)>>0},ToUint32:function(M){return this.ToNumber(M)>>>0},ToUint16:function(M){var R=this.ToNumber(M);if(v(R)||R===0||!d(R))return 0;var D=m(R)*Math.floor(Math.abs(R));return f(D,65536)},ToString:function(M){return w(M)},ToObject:function(M){return this.CheckObjectCoercible(M),A(M)},CheckObjectCoercible:function(M,R){if(M==null)throw new E(R||"Cannot call method on "+M);return M},IsCallable:b,SameValue:function(M,R){return M===R?M===0?1/M==1/R:!0:v(M)&&v(R)},Type:function(M){if(M===null)return"Null";if(typeof M=="undefined")return"Undefined";if(typeof M=="function"||typeof M=="object")return"Object";if(typeof M=="number")return"Number";if(typeof M=="boolean")return"Boolean";if(typeof M=="string")return"String"},IsPropertyDescriptor:function(M){if(this.Type(M)!=="Object")return!1;var R={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var D in M)if(y(M,D)&&!R[D])return!1;var N=y(M,"[[Value]]"),z=y(M,"[[Get]]")||y(M,"[[Set]]");if(N&&z)throw new E("Property Descriptors may not be both accessor and data descriptors");return!0},IsAccessorDescriptor:function(M){return!(typeof M=="undefined"||(h(this,"Property Descriptor","Desc",M),!y(M,"[[Get]]")&&!y(M,"[[Set]]")))},IsDataDescriptor:function(M){return!(typeof M=="undefined"||(h(this,"Property Descriptor","Desc",M),!y(M,"[[Value]]")&&!y(M,"[[Writable]]")))},IsGenericDescriptor:function(M){return typeof M=="undefined"?!1:(h(this,"Property Descriptor","Desc",M),!this.IsAccessorDescriptor(M)&&!this.IsDataDescriptor(M))},FromPropertyDescriptor:function(M){if(typeof M=="undefined")return M;if(h(this,"Property Descriptor","Desc",M),this.IsDataDescriptor(M))return{value:M["[[Value]]"],writable:!!M["[[Writable]]"],enumerable:!!M["[[Enumerable]]"],configurable:!!M["[[Configurable]]"]};if(this.IsAccessorDescriptor(M))return{get:M["[[Get]]"],set:M["[[Set]]"],enumerable:!!M["[[Enumerable]]"],configurable:!!M["[[Configurable]]"]};throw new E("FromPropertyDescriptor must be called with a fully populated Property Descriptor")},ToPropertyDescriptor:function(M){if(this.Type(M)!=="Object")throw new E("ToPropertyDescriptor requires an object");var R={};if(y(M,"enumerable")&&(R["[[Enumerable]]"]=this.ToBoolean(M.enumerable)),y(M,"configurable")&&(R["[[Configurable]]"]=this.ToBoolean(M.configurable)),y(M,"value")&&(R["[[Value]]"]=M.value),y(M,"writable")&&(R["[[Writable]]"]=this.ToBoolean(M.writable)),y(M,"get")){var D=M.get;if(typeof D!="undefined"&&!this.IsCallable(D))throw new TypeError("getter must be a function");R["[[Get]]"]=D}if(y(M,"set")){var N=M.set;if(typeof N!="undefined"&&!this.IsCallable(N))throw new E("setter must be a function");R["[[Set]]"]=N}if((y(R,"[[Get]]")||y(R,"[[Set]]"))&&(y(R,"[[Value]]")||y(R,"[[Writable]]")))throw new E("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return R}};G.exports=x},{"./GetIntrinsic":14,"./helpers/assertRecord":16,"./helpers/isFinite":17,"./helpers/isNaN":18,"./helpers/mod":19,"./helpers/sign":20,"es-to-primitive/es5":21,has:28,"is-callable":32}],16:[function(_,G,fe){var u=_("../GetIntrinsic"),A=u("%TypeError%"),E=u("%SyntaxError%"),w=_("has"),h={"Property Descriptor":function(d,m){if(d.Type(m)!=="Object")return!1;var f={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var b in m)if(w(m,b)&&!f[b])return!1;var g=w(m,"[[Value]]"),y=w(m,"[[Get]]")||w(m,"[[Set]]");if(g&&y)throw new A("Property Descriptors may not be both accessor and data descriptors");return!0}};G.exports=function(d,m,f,b){var g=h[m];if(typeof g!="function")throw new E("unknown record type: "+m);if(!g(d,b))throw new A(f+" must be a "+m);console.log(g(d,b),b)}},{"../GetIntrinsic":14,has:28}],17:[function(_,G,fe){var u=Number.isNaN||function(A){return A!==A};G.exports=Number.isFinite||function(A){return typeof A=="number"&&!u(A)&&A!==1/0&&A!==-1/0}},{}],18:[function(_,G,fe){G.exports=Number.isNaN||function(A){return A!==A}},{}],19:[function(_,G,fe){G.exports=function(A,E){var w=A%E;return Math.floor(w>=0?w:w+E)}},{}],20:[function(_,G,fe){G.exports=function(A){return A>=0?1:-1}},{}],21:[function(_,G,fe){var u=Object.prototype.toString,A=_("./helpers/isPrimitive"),E=_("is-callable"),w={"[[DefaultValue]]":function(h){var v;if(arguments.length>1?v=arguments[1]:v=u.call(h)==="[object Date]"?String:Number,v===String||v===Number){var d=v===String?["toString","valueOf"]:["valueOf","toString"],m,f;for(f=0;f<d.length;++f)if(E(h[d[f]])&&(m=h[d[f]](),A(m)))return m;throw new TypeError("No default value")}throw new TypeError("invalid [[DefaultValue]] hint supplied")}};G.exports=function(v){return A(v)?v:arguments.length>1?w["[[DefaultValue]]"](v,arguments[1]):w["[[DefaultValue]]"](v)}},{"./helpers/isPrimitive":22,"is-callable":32}],22:[function(_,G,fe){G.exports=function(A){return A===null||typeof A!="function"&&typeof A!="object"}},{}],23:[function(_,G,fe){var u=_("dtype");G.exports=A;function A(E,w,h){if(!E)throw new TypeError("must specify data as first parameter");if(h=+(h||0)|0,Array.isArray(E)&&E[0]&&typeof E[0][0]=="number"){var v=E[0].length,d=E.length*v,m,f,b,g;(!w||typeof w=="string")&&(w=new(u(w||"float32"))(d+h));var y=w.length-h;if(d!==y)throw new Error("source length "+d+" ("+v+"x"+E.length+") does not match destination length "+y);for(m=0,b=h;m<E.length;m++)for(f=0;f<v;f++)w[b++]=E[m][f]===null?NaN:E[m][f]}else if(!w||typeof w=="string"){var x=u(w||"float32");if(Array.isArray(E)||w==="array")for(w=new x(E.length+h),m=0,b=h,g=w.length;b<g;b++,m++)w[b]=E[m]===null?NaN:E[m];else h===0?w=new x(E):(w=new x(E.length+h),w.set(E,h))}else w.set(E,h);return w}},{dtype:13}],24:[function(_,G,fe){var u=_("is-callable"),A=Object.prototype.toString,E=Object.prototype.hasOwnProperty,w=function(f,b,g){for(var y=0,x=f.length;y<x;y++)E.call(f,y)&&(g==null?b(f[y],y,f):b.call(g,f[y],y,f))},h=function(f,b,g){for(var y=0,x=f.length;y<x;y++)g==null?b(f.charAt(y),y,f):b.call(g,f.charAt(y),y,f)},v=function(f,b,g){for(var y in f)E.call(f,y)&&(g==null?b(f[y],y,f):b.call(g,f[y],y,f))},d=function(f,b,g){if(!u(b))throw new TypeError("iterator must be a function");var y;arguments.length>=3&&(y=g),A.call(f)==="[object Array]"?w(f,b,y):typeof f=="string"?h(f,b,y):v(f,b,y)};G.exports=d},{"is-callable":32}],25:[function(_,G,fe){var u="Function.prototype.bind called on incompatible ",A=Array.prototype.slice,E=Object.prototype.toString,w="[object Function]";G.exports=function(v){var d=this;if(typeof d!="function"||E.call(d)!==w)throw new TypeError(u+d);for(var m=A.call(arguments,1),f,b=function(){if(this instanceof f){var M=d.apply(this,m.concat(A.call(arguments)));return Object(M)===M?M:this}else return d.apply(v,m.concat(A.call(arguments)))},g=Math.max(0,d.length-m.length),y=[],x=0;x<g;x++)y.push("$"+x);if(f=Function("binder","return function ("+y.join(",")+"){ return binder.apply(this,arguments); }")(b),d.prototype){var L=function(){};L.prototype=d.prototype,f.prototype=new L,L.prototype=null}return f}},{}],26:[function(_,G,fe){var u=_("./implementation");G.exports=Function.prototype.bind||u},{"./implementation":25}],27:[function(_,G,fe){(function(u){var A;typeof window!="undefined"?A=window:typeof u!="undefined"?A=u:typeof self!="undefined"?A=self:A={},G.exports=A}).call(this,typeof da!="undefined"?da:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],28:[function(_,G,fe){var u=_("function-bind");G.exports=u.call(Function.call,Object.prototype.hasOwnProperty)},{"function-bind":26}],29:[function(_,G,fe){fe.read=function(u,A,E,w,h){var v,d,m=h*8-w-1,f=(1<<m)-1,b=f>>1,g=-7,y=E?h-1:0,x=E?-1:1,L=u[A+y];for(y+=x,v=L&(1<<-g)-1,L>>=-g,g+=m;g>0;v=v*256+u[A+y],y+=x,g-=8);for(d=v&(1<<-g)-1,v>>=-g,g+=w;g>0;d=d*256+u[A+y],y+=x,g-=8);if(v===0)v=1-b;else{if(v===f)return d?NaN:(L?-1:1)*(1/0);d=d+Math.pow(2,w),v=v-b}return(L?-1:1)*d*Math.pow(2,v-w)},fe.write=function(u,A,E,w,h,v){var d,m,f,b=v*8-h-1,g=(1<<b)-1,y=g>>1,x=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,L=w?0:v-1,M=w?1:-1,R=A<0||A===0&&1/A<0?1:0;for(A=Math.abs(A),isNaN(A)||A===1/0?(m=isNaN(A)?1:0,d=g):(d=Math.floor(Math.log(A)/Math.LN2),A*(f=Math.pow(2,-d))<1&&(d--,f*=2),d+y>=1?A+=x/f:A+=x*Math.pow(2,1-y),A*f>=2&&(d++,f/=2),d+y>=g?(m=0,d=g):d+y>=1?(m=(A*f-1)*Math.pow(2,h),d=d+y):(m=A*Math.pow(2,y-1)*Math.pow(2,h),d=0));h>=8;u[E+L]=m&255,L+=M,m/=256,h-=8);for(d=d<<h|m,b+=h;b>0;u[E+L]=d&255,L+=M,d/=256,b-=8);u[E+L-M]|=R*128}},{}],30:[function(_,G,fe){typeof Object.create=="function"?G.exports=function(A,E){E&&(A.super_=E,A.prototype=Object.create(E.prototype,{constructor:{value:A,enumerable:!1,writable:!0,configurable:!0}}))}:G.exports=function(A,E){if(E){A.super_=E;var w=function(){};w.prototype=E.prototype,A.prototype=new w,A.prototype.constructor=A}}},{}],31:[function(_,G,fe){/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */G.exports=function(E){return E!=null&&(u(E)||A(E)||!!E._isBuffer)};function u(E){return!!E.constructor&&typeof E.constructor.isBuffer=="function"&&E.constructor.isBuffer(E)}function A(E){return typeof E.readFloatLE=="function"&&typeof E.slice=="function"&&u(E.slice(0,0))}},{}],32:[function(_,G,fe){var u=Function.prototype.toString,A=/^\s*class\b/,E=function(b){try{var g=u.call(b);return A.test(g)}catch{return!1}},w=function(b){try{return E(b)?!1:(u.call(b),!0)}catch{return!1}},h=Object.prototype.toString,v="[object Function]",d="[object GeneratorFunction]",m=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol";G.exports=function(b){if(!b||typeof b!="function"&&typeof b!="object")return!1;if(typeof b=="function"&&!b.prototype)return!0;if(m)return w(b);if(E(b))return!1;var g=h.call(b);return g===v||g===d}},{}],33:[function(_,G,fe){G.exports=A;var u=Object.prototype.toString;function A(E){var w=u.call(E);return w==="[object Function]"||typeof E=="function"&&w!=="[object RegExp]"||typeof window!="undefined"&&(E===window.setTimeout||E===window.alert||E===window.confirm||E===window.prompt)}},{}],34:[function(_,G,fe){G.exports=function(u){var A=typeof u;return u!==null&&(A==="object"||A==="function")}},{}],35:[function(_,G,fe){var u={}.toString;G.exports=Array.isArray||function(A){return u.call(A)=="[object Array]"}},{}],36:[function(_,G,fe){var u=_("word-wrapper"),A=_("xtend"),E=_("as-number"),w=["x","e","a","o","n","s","r","c","u","m","v","w","z"],h=["m","w"],v=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],d="	".charCodeAt(0),m=" ".charCodeAt(0),f=0,b=1,g=2;G.exports=function(J){return new y(J)};function y(te){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(te)}y.prototype.update=function(te){if(te=A({measure:this._measure},te),this._opt=te,this._opt.tabSize=E(this._opt.tabSize,4),!te.font)throw new Error("must provide a valid bitmap font");var J=this.glyphs,le=te.text||"",j=te.font;this._setupSpaceGlyphs(j);var ae=u.lines(le,te),Z=te.width||0;J.length=0;var ye=ae.reduce(function(zt,wt){return Math.max(zt,wt.width,Z)},0),Ne=0,We=0,ke=E(te.lineHeight,j.common.lineHeight),it=j.common.base,rt=ke-it,At=te.letterSpacing||0,St=ke*ae.length-rt,Gt=re(this._opt.align);We-=St,this._width=ye,this._height=St,this._descender=ke-it,this._baseline=it,this._xHeight=R(j),this._capHeight=N(j),this._lineHeight=ke,this._ascender=ke-rt-this._xHeight;var er=this;ae.forEach(function(zt,wt){for(var kr=zt.start,en=zt.end,Nt=zt.width,ne,ie=kr;ie<en;ie++){var ge=le.charCodeAt(ie),ve=er.getGlyph(j,ge);if(ve){ne&&(Ne+=z(j,ne.id,ve.id));var we=Ne;Gt===b?we+=(ye-Nt)/2:Gt===g&&(we+=ye-Nt),J.push({position:[we,We],data:ve,index:ie,line:wt}),Ne+=ve.xadvance+At,ne=ve}}We+=ke,Ne=0}),this._linesTotal=ae.length},y.prototype._setupSpaceGlyphs=function(te){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,!(!te.chars||te.chars.length===0)){var J=M(te,m)||D(te)||te.chars[0],le=this._opt.tabSize*J.xadvance;this._fallbackSpaceGlyph=J,this._fallbackTabGlyph=A(J,{x:0,y:0,xadvance:le,id:d,xoffset:0,yoffset:0,width:0,height:0})}},y.prototype.getGlyph=function(te,J){var le=M(te,J);return le||(J===d?this._fallbackTabGlyph:J===m?this._fallbackSpaceGlyph:null)},y.prototype.computeMetrics=function(te,J,le,j){var ae=this._opt.letterSpacing||0,Z=this._opt.font,ye=0,Ne=0,We=0,ke,it;if(!Z.chars||Z.chars.length===0)return{start:J,end:J,width:0};le=Math.min(te.length,le);for(var rt=J;rt<le;rt++){var At=te.charCodeAt(rt),ke=this.getGlyph(Z,At);if(ke){ke.xoffset;var St=it?z(Z,it.id,ke.id):0;ye+=St;var Gt=ye+ke.xadvance+ae,er=ye+ke.width;if(er>=j||Gt>=j)break;ye=Gt,Ne=er,it=ke}We++}return it&&(Ne+=it.xoffset),{start:J,end:J+We,width:Ne}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(x);function x(te){Object.defineProperty(y.prototype,te,{get:L(te),configurable:!0})}function L(te){return new Function(["return function "+te+"() {","  return this._"+te,"}"].join(`
`))()}function M(te,J){if(!te.chars||te.chars.length===0)return null;var le=Y(te.chars,J);return le>=0?te.chars[le]:null}function R(te){for(var J=0;J<w.length;J++){var le=w[J].charCodeAt(0),j=Y(te.chars,le);if(j>=0)return te.chars[j].height}return 0}function D(te){for(var J=0;J<h.length;J++){var le=h[J].charCodeAt(0),j=Y(te.chars,le);if(j>=0)return te.chars[j]}return 0}function N(te){for(var J=0;J<v.length;J++){var le=v[J].charCodeAt(0),j=Y(te.chars,le);if(j>=0)return te.chars[j].height}return 0}function z(te,J,le){if(!te.kernings||te.kernings.length===0)return 0;for(var j=te.kernings,ae=0;ae<j.length;ae++){var Z=j[ae];if(Z.first===J&&Z.second===le)return Z.amount}return 0}function re(te){return te==="center"?b:te==="right"?g:f}function Y(te,J,le){le=le||0;for(var j=le;j<te.length;j++)if(te[j].id===J)return j;return-1}},{"as-number":2,"word-wrapper":69,xtend:72}],37:[function(_,G,fe){(function(u){var A=_("xhr"),E=function(){},w=_("parse-bmfont-ascii"),h=_("parse-bmfont-xml"),v=_("parse-bmfont-binary"),d=_("./lib/is-binary"),m=_("xtend"),f=function(){return self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}();G.exports=function(y,x){x=typeof x=="function"?x:E,typeof y=="string"?y={uri:y}:y||(y={});var L=y.binary;L&&(y=g(y)),A(y,function(M,R,D){if(M)return x(M);if(!/^2/.test(R.statusCode))return x(new Error("http status code: "+R.statusCode));if(!D)return x(new Error("no body result"));var N=!1;if(b(D)){var z=new Uint8Array(D);D=new u(z,"binary")}d(D)&&(N=!0,typeof D=="string"&&(D=new u(D,"binary"))),N||(u.isBuffer(D)&&(D=D.toString(y.encoding)),D=D.trim());var re;try{var Y=R.headers["content-type"];N?re=v(D):/json/.test(Y)||D.charAt(0)==="{"?re=JSON.parse(D):/xml/.test(Y)||D.charAt(0)==="<"?re=h(D):re=w(D)}catch(te){x(new Error("error parsing font "+te.message)),x=E}x(null,re)})};function b(y){var x=Object.prototype.toString;return x.call(y)==="[object ArrayBuffer]"}function g(y){if(f)return m(y,{responseType:"arraybuffer"});if(typeof self.XMLHttpRequest=="undefined")throw new Error("your browser does not support XHR loading");var x=new self.XMLHttpRequest;return x.overrideMimeType("text/plain; charset=x-user-defined"),m({xhr:x},y)}}).call(this,_("buffer").Buffer)},{"./lib/is-binary":38,buffer:6,"parse-bmfont-ascii":43,"parse-bmfont-binary":44,"parse-bmfont-xml":45,xhr:70,xtend:72}],38:[function(_,G,fe){(function(u){var A=_("buffer-equal"),E=new u([66,77,70,3]);G.exports=function(w){return typeof w=="string"?w.substring(0,3)==="BMF":w.length>4&&A(w.slice(0,4),E)}}).call(this,_("buffer").Buffer)},{buffer:6,"buffer-equal":5}],39:[function(_,G,fe){var u=Object.getOwnPropertySymbols,A=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;function w(v){if(v==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(v)}function h(){try{if(!Object.assign)return!1;var v=new String("abc");if(v[5]="de",Object.getOwnPropertyNames(v)[0]==="5")return!1;for(var d={},m=0;m<10;m++)d["_"+String.fromCharCode(m)]=m;var f=Object.getOwnPropertyNames(d).map(function(g){return d[g]});if(f.join("")!=="0123456789")return!1;var b={};return"abcdefghijklmnopqrst".split("").forEach(function(g){b[g]=g}),Object.keys(Object.assign({},b)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}G.exports=h()?Object.assign:function(v,d){for(var m,f=w(v),b,g=1;g<arguments.length;g++){m=Object(arguments[g]);for(var y in m)A.call(m,y)&&(f[y]=m[y]);if(u){b=u(m);for(var x=0;x<b.length;x++)E.call(m,b[x])&&(f[b[x]]=m[b[x]])}}return f}},{}],40:[function(_,G,fe){var u;if(!Object.keys){var A=Object.prototype.hasOwnProperty,E=Object.prototype.toString,w=_("./isArguments"),h=Object.prototype.propertyIsEnumerable,v=!h.call({toString:null},"toString"),d=h.call(function(){},"prototype"),m=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],f=function(x){var L=x.constructor;return L&&L.prototype===x},b={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},g=function(){if(typeof window=="undefined")return!1;for(var x in window)try{if(!b["$"+x]&&A.call(window,x)&&window[x]!==null&&typeof window[x]=="object")try{f(window[x])}catch{return!0}}catch{return!0}return!1}(),y=function(x){if(typeof window=="undefined"||!g)return f(x);try{return f(x)}catch{return!1}};u=function(L){var M=L!==null&&typeof L=="object",R=E.call(L)==="[object Function]",D=w(L),N=M&&E.call(L)==="[object String]",z=[];if(!M&&!R&&!D)throw new TypeError("Object.keys called on a non-object");var re=d&&R;if(N&&L.length>0&&!A.call(L,0))for(var Y=0;Y<L.length;++Y)z.push(String(Y));if(D&&L.length>0)for(var te=0;te<L.length;++te)z.push(String(te));else for(var J in L)!(re&&J==="prototype")&&A.call(L,J)&&z.push(String(J));if(v)for(var le=y(L),j=0;j<m.length;++j)!(le&&m[j]==="constructor")&&A.call(L,m[j])&&z.push(m[j]);return z}}G.exports=u},{"./isArguments":42}],41:[function(_,G,fe){var u=Array.prototype.slice,A=_("./isArguments"),E=Object.keys,w=E?function(d){return E(d)}:_("./implementation"),h=Object.keys;w.shim=function(){if(Object.keys){var d=function(){var m=Object.keys(arguments);return m&&m.length===arguments.length}(1,2);d||(Object.keys=function(f){return A(f)?h(u.call(f)):h(f)})}else Object.keys=w;return Object.keys||w},G.exports=w},{"./implementation":40,"./isArguments":42}],42:[function(_,G,fe){var u=Object.prototype.toString;G.exports=function(E){var w=u.call(E),h=w==="[object Arguments]";return h||(h=w!=="[object Array]"&&E!==null&&typeof E=="object"&&typeof E.length=="number"&&E.length>=0&&u.call(E.callee)==="[object Function]"),h}},{}],43:[function(_,G,fe){G.exports=function(h){if(!h)throw new Error("no data provided");h=h.toString().trim();var v={pages:[],chars:[],kernings:[]},d=h.split(/\r\n?|\n/g);if(d.length===0)throw new Error("no data in BMFont file");for(var m=0;m<d.length;m++){var f=u(d[m],m);if(!!f)if(f.key==="page"){if(typeof f.data.id!="number")throw new Error("malformed file at line "+m+" -- needs page id=N");if(typeof f.data.file!="string")throw new Error("malformed file at line "+m+' -- needs page file="path"');v.pages[f.data.id]=f.data.file}else f.key==="chars"||f.key==="kernings"||(f.key==="char"?v.chars.push(f.data):f.key==="kerning"?v.kernings.push(f.data):v[f.key]=f.data)}return v};function u(w,h){if(w=w.replace(/\t+/g," ").trim(),!w)return null;var v=w.indexOf(" ");if(v===-1)throw new Error("no named row at line "+h);var d=w.substring(0,v);w=w.substring(v+1),w=w.replace(/letter=[\'\"]\S+[\'\"]/gi,""),w=w.split("="),w=w.map(function(y){return y.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var m=[],f=0;f<w.length;f++){var b=w[f];f===0?m.push({key:b[0],data:""}):f===w.length-1?m[m.length-1].data=A(b[0]):(m[m.length-1].data=A(b[0]),m.push({key:b[1],data:""}))}var g={key:d,data:{}};return m.forEach(function(y){g.data[y.key]=y.data}),g}function A(w){return!w||w.length===0?"":w.indexOf('"')===0||w.indexOf("'")===0?w.substring(1,w.length-1):w.indexOf(",")!==-1?E(w):parseInt(w,10)}function E(w){return w.split(",").map(function(h){return parseInt(h,10)})}},{}],44:[function(_,G,fe){var u=[66,77,70];G.exports=function(g){if(g.length<6)throw new Error("invalid buffer length for BMFont");var y=u.every(function(D,N){return g.readUInt8(N)===D});if(!y)throw new Error("BMFont missing BMF byte header");var x=3,L=g.readUInt8(x++);if(L>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var M={kernings:[],chars:[]},R=0;R<5;R++)x+=A(M,g,x);return M};function A(b,g,y){if(y>g.length-1)return 0;var x=g.readUInt8(y++),L=g.readInt32LE(y);switch(y+=4,x){case 1:b.info=E(g,y);break;case 2:b.common=w(g,y);break;case 3:b.pages=h(g,y,L);break;case 4:b.chars=v(g,y,L);break;case 5:b.kernings=d(g,y,L);break}return 5+L}function E(b,g){var y={};y.size=b.readInt16LE(g);var x=b.readUInt8(g+2);return y.smooth=x>>7&1,y.unicode=x>>6&1,y.italic=x>>5&1,y.bold=x>>4&1,x>>3&1&&(y.fixedHeight=1),y.charset=b.readUInt8(g+3)||"",y.stretchH=b.readUInt16LE(g+4),y.aa=b.readUInt8(g+6),y.padding=[b.readInt8(g+7),b.readInt8(g+8),b.readInt8(g+9),b.readInt8(g+10)],y.spacing=[b.readInt8(g+11),b.readInt8(g+12)],y.outline=b.readUInt8(g+13),y.face=f(b,g+14),y}function w(b,g){var y={};return y.lineHeight=b.readUInt16LE(g),y.base=b.readUInt16LE(g+2),y.scaleW=b.readUInt16LE(g+4),y.scaleH=b.readUInt16LE(g+6),y.pages=b.readUInt16LE(g+8),b.readUInt8(g+10),y.packed=0,y.alphaChnl=b.readUInt8(g+11),y.redChnl=b.readUInt8(g+12),y.greenChnl=b.readUInt8(g+13),y.blueChnl=b.readUInt8(g+14),y}function h(b,g,y){for(var x=[],L=m(b,g),M=L.length+1,R=y/M,D=0;D<R;D++)x[D]=b.slice(g,g+L.length).toString("utf8"),g+=M;return x}function v(b,g,y){for(var x=[],L=y/20,M=0;M<L;M++){var R={},D=M*20;R.id=b.readUInt32LE(g+0+D),R.x=b.readUInt16LE(g+4+D),R.y=b.readUInt16LE(g+6+D),R.width=b.readUInt16LE(g+8+D),R.height=b.readUInt16LE(g+10+D),R.xoffset=b.readInt16LE(g+12+D),R.yoffset=b.readInt16LE(g+14+D),R.xadvance=b.readInt16LE(g+16+D),R.page=b.readUInt8(g+18+D),R.chnl=b.readUInt8(g+19+D),x[M]=R}return x}function d(b,g,y){for(var x=[],L=y/10,M=0;M<L;M++){var R={},D=M*10;R.first=b.readUInt32LE(g+0+D),R.second=b.readUInt32LE(g+4+D),R.amount=b.readInt16LE(g+8+D),x[M]=R}return x}function m(b,g){for(var y=g;y<b.length&&b[y]!==0;y++);return b.slice(g,y)}function f(b,g){return m(b,g).toString("utf8")}},{}],45:[function(_,G,fe){var u=_("./parse-attribs"),A=_("xml-parse-from-string"),E={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};G.exports=function(m){m=m.toString();var f=A(m),b={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(D){var N=f.getElementsByTagName(D)[0];N&&(b[D]=u(w(N)))});var g=f.getElementsByTagName("pages")[0];if(!g)throw new Error("malformed file -- no <pages> element");for(var y=g.getElementsByTagName("page"),x=0;x<y.length;x++){var L=y[x],M=parseInt(L.getAttribute("id"),10),R=L.getAttribute("file");if(isNaN(M))throw new Error('malformed file -- page "id" attribute is NaN');if(!R)throw new Error('malformed file -- needs page "file" attribute');b.pages[parseInt(M,10)]=R}return["chars","kernings"].forEach(function(D){var N=f.getElementsByTagName(D)[0];if(!!N)for(var z=D.substring(0,D.length-1),re=N.getElementsByTagName(z),Y=0;Y<re.length;Y++){var te=re[Y];b[D].push(u(w(te)))}}),b};function w(d){var m=h(d);return m.reduce(function(f,b){var g=v(b.nodeName);return f[g]=b.nodeValue,f},{})}function h(d){for(var m=[],f=0;f<d.attributes.length;f++)m.push(d.attributes[f]);return m}function v(d){return E[d.toLowerCase()]||d}},{"./parse-attribs":46,"xml-parse-from-string":71}],46:[function(_,G,fe){var u="chasrset";G.exports=function(w){u in w&&(w.charset=w[u],delete w[u]);for(var h in w)h==="face"||h==="charset"||(h==="padding"||h==="spacing"?w[h]=A(w[h]):w[h]=parseInt(w[h],10));return w};function A(E){return E.split(",").map(function(w){return parseInt(w,10)})}},{}],47:[function(_,G,fe){var u=_("string.prototype.trim"),A=_("for-each"),E=function(w){return Object.prototype.toString.call(w)==="[object Array]"};G.exports=function(w){if(!w)return{};var h={};return A(u(w).split(`
`),function(v){var d=v.indexOf(":"),m=u(v.slice(0,d)).toLowerCase(),f=u(v.slice(d+1));typeof h[m]=="undefined"?h[m]=f:E(h[m])?h[m].push(f):h[m]=[h[m],f]}),h}},{"for-each":24,"string.prototype.trim":53}],48:[function(_,G,fe){(function(u){var A=u.performance||{},E=function(){for(var w=["now","webkitNow","msNow","mozNow","oNow"];w.length;){var h=w.shift();if(h in A)return A[h].bind(A)}var v=Date.now||function(){return new Date().getTime()},d=(A.timing||{}).navigationStart||v();return function(){return v()-d}}();E.performanceNow=A.now,E.noConflict=function(){A.now=E.performanceNow},E.conflict=function(){A.now=E},E.conflict(),G.exports=E}).call(this,typeof da!="undefined"?da:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],49:[function(_,G,fe){var u=G.exports={},A,E;function w(){throw new Error("setTimeout has not been defined")}function h(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?A=setTimeout:A=w}catch{A=w}try{typeof clearTimeout=="function"?E=clearTimeout:E=h}catch{E=h}})();function v(R){if(A===setTimeout)return setTimeout(R,0);if((A===w||!A)&&setTimeout)return A=setTimeout,setTimeout(R,0);try{return A(R,0)}catch{try{return A.call(null,R,0)}catch{return A.call(this,R,0)}}}function d(R){if(E===clearTimeout)return clearTimeout(R);if((E===h||!E)&&clearTimeout)return E=clearTimeout,clearTimeout(R);try{return E(R)}catch{try{return E.call(null,R)}catch{return E.call(this,R)}}}var m=[],f=!1,b,g=-1;function y(){!f||!b||(f=!1,b.length?m=b.concat(m):g=-1,m.length&&x())}function x(){if(!f){var R=v(y);f=!0;for(var D=m.length;D;){for(b=m,m=[];++g<D;)b&&b[g].run();g=-1,D=m.length}b=null,f=!1,d(R)}}u.nextTick=function(R){var D=new Array(arguments.length-1);if(arguments.length>1)for(var N=1;N<arguments.length;N++)D[N-1]=arguments[N];m.push(new L(R,D)),m.length===1&&!f&&v(x)};function L(R,D){this.fun=R,this.array=D}L.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={};function M(){}u.on=M,u.addListener=M,u.once=M,u.off=M,u.removeListener=M,u.removeAllListeners=M,u.emit=M,u.prependListener=M,u.prependOnceListener=M,u.listeners=function(R){return[]},u.binding=function(R){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(R){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},{}],50:[function(_,G,fe){(function(u){(function(A){var E=setTimeout,w=typeof u=="function"&&u||function(L){E(L,1)};function h(L,M){return function(){L.apply(M,arguments)}}var v=Array.isArray||function(L){return Object.prototype.toString.call(L)==="[object Array]"};function d(L){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof L!="function")throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],x(L,h(f,this),h(b,this))}function m(L){var M=this;if(this._state===null){this._deferreds.push(L);return}w(function(){var R=M._state?L.onFulfilled:L.onRejected;if(R===null){(M._state?L.resolve:L.reject)(M._value);return}var D;try{D=R(M._value)}catch(N){L.reject(N);return}L.resolve(D)})}function f(L){try{if(L===this)throw new TypeError("A promise cannot be resolved with itself.");if(L&&(typeof L=="object"||typeof L=="function")){var M=L.then;if(typeof M=="function"){x(h(M,L),h(f,this),h(b,this));return}}this._state=!0,this._value=L,g.call(this)}catch(R){b.call(this,R)}}function b(L){this._state=!1,this._value=L,g.call(this)}function g(){for(var L=0,M=this._deferreds.length;L<M;L++)m.call(this,this._deferreds[L]);this._deferreds=null}function y(L,M,R,D){this.onFulfilled=typeof L=="function"?L:null,this.onRejected=typeof M=="function"?M:null,this.resolve=R,this.reject=D}function x(L,M,R){var D=!1;try{L(function(N){D||(D=!0,M(N))},function(N){D||(D=!0,R(N))})}catch(N){if(D)return;D=!0,R(N)}}d.prototype.catch=function(L){return this.then(null,L)},d.prototype.then=function(L,M){var R=this;return new d(function(D,N){m.call(R,new y(L,M,D,N))})},d.all=function(){var L=Array.prototype.slice.call(arguments.length===1&&v(arguments[0])?arguments[0]:arguments);return new d(function(M,R){if(L.length===0)return M([]);var D=L.length;function N(re,Y){try{if(Y&&(typeof Y=="object"||typeof Y=="function")){var te=Y.then;if(typeof te=="function"){te.call(Y,function(J){N(re,J)},R);return}}L[re]=Y,--D==0&&M(L)}catch(J){R(J)}}for(var z=0;z<L.length;z++)N(z,L[z])})},d.resolve=function(L){return L&&typeof L=="object"&&L.constructor===d?L:new d(function(M){M(L)})},d.reject=function(L){return new d(function(M,R){R(L)})},d.race=function(L){return new d(function(M,R){for(var D=0,N=L.length;D<N;D++)L[D].then(M,R)})},d._setImmediateFn=function(M){w=M},typeof G!="undefined"&&G.exports?G.exports=d:A.Promise||(A.Promise=d)})(this)}).call(this,_("timers").setImmediate)},{timers:67}],51:[function(_,G,fe){var u=_("dtype"),A=_("an-array"),E=_("is-buffer"),w=[0,2,3],h=[2,1,3];G.exports=function(d,m){(!d||!(A(d)||E(d)))&&(m=d||{},d=null),typeof m=="number"?m={count:m}:m=m||{};for(var f=typeof m.type=="string"?m.type:"uint16",b=typeof m.count=="number"?m.count:1,g=m.start||0,y=m.clockwise!==!1?w:h,x=y[0],L=y[1],M=y[2],R=b*6,D=d||new(u(f))(R),N=0,z=0;N<R;N+=6,z+=4){var re=N+g;D[re+0]=z+0,D[re+1]=z+1,D[re+2]=z+2,D[re+3]=z+x,D[re+4]=z+L,D[re+5]=z+M}return D}},{"an-array":1,dtype:13,"is-buffer":31}],52:[function(_,G,fe){var u=_("function-bind"),A=_("es-abstract/es5"),E=u.call(Function.call,String.prototype.replace),w=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,h=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;G.exports=function(){var d=A.ToString(A.CheckObjectCoercible(this));return E(E(d,w,""),h,"")}},{"es-abstract/es5":15,"function-bind":26}],53:[function(_,G,fe){var u=_("function-bind"),A=_("define-properties"),E=_("./implementation"),w=_("./polyfill"),h=_("./shim"),v=u.call(Function.call,w());A(v,{getPolyfill:w,implementation:E,shim:h}),G.exports=v},{"./implementation":52,"./polyfill":54,"./shim":55,"define-properties":11,"function-bind":26}],54:[function(_,G,fe){var u=_("./implementation"),A="\u200B";G.exports=function(){return String.prototype.trim&&A.trim()===A?String.prototype.trim:u}},{"./implementation":52}],55:[function(_,G,fe){var u=_("define-properties"),A=_("./polyfill");G.exports=function(){var w=A();return u(String.prototype,{trim:w},{trim:function(){return String.prototype.trim!==w}}),w}},{"./polyfill":54,"define-properties":11}],56:[function(_,G,fe){var u={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},A={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},E=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective"],w={CSS:{},springs:{}};function h(oe,be,Ge){return Math.min(Math.max(oe,be),Ge)}function v(oe,be){return oe.indexOf(be)>-1}function d(oe,be){return oe.apply(null,be)}var m=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i,f=/^rgb/,b=/^hsl/,g={arr:function(oe){return Array.isArray(oe)},obj:function(oe){return v(Object.prototype.toString.call(oe),"Object")},pth:function(oe){return g.obj(oe)&&oe.hasOwnProperty("totalLength")},svg:function(oe){return oe instanceof SVGElement},inp:function(oe){return oe instanceof HTMLInputElement},dom:function(oe){return oe.nodeType||g.svg(oe)},str:function(oe){return typeof oe=="string"},fnc:function(oe){return typeof oe=="function"},und:function(oe){return typeof oe=="undefined"},hex:function(oe){return m.test(oe)},rgb:function(oe){return f.test(oe)},hsl:function(oe){return b.test(oe)},col:function(oe){return g.hex(oe)||g.rgb(oe)||g.hsl(oe)},key:function(oe){return!u.hasOwnProperty(oe)&&!A.hasOwnProperty(oe)&&oe!=="targets"&&oe!=="keyframes"}},y=/\(([^)]+)\)/;function x(oe){var be=y.exec(oe);return be?be[1].split(",").map(function(Ge){return parseFloat(Ge)}):[]}function L(oe,be){var Ge=x(oe),et=h(g.und(Ge[0])?1:Ge[0],.1,100),je=h(g.und(Ge[1])?100:Ge[1],.1,100),ht=h(g.und(Ge[2])?10:Ge[2],.1,100),bt=h(g.und(Ge[3])?0:Ge[3],.1,100),kt=Math.sqrt(je/et),Mt=ht/(2*Math.sqrt(je*et)),ct=Mt<1?kt*Math.sqrt(1-Mt*Mt):0,Wt=1,qt=Mt<1?(Mt*kt+-bt)/ct:-bt+kt;function cr(Or){var br=be?be*Or/1e3:Or;return Mt<1?br=Math.exp(-br*Mt*kt)*(Wt*Math.cos(ct*br)+qt*Math.sin(ct*br)):br=(Wt+qt*br)*Math.exp(-br*kt),Or===0||Or===1?Or:1-br}function fn(){var Or=w.springs[oe];if(Or)return Or;for(var br=1/6,Hr=0,yn=0;;)if(Hr+=br,cr(Hr)===1){if(yn++,yn>=16)break}else yn=0;var Hn=Hr*br*1e3;return w.springs[oe]=Hn,Hn}return be?cr:fn}function M(oe,be){oe===void 0&&(oe=1),be===void 0&&(be=.5);var Ge=h(oe,1,10),et=h(be,.1,2);return function(je){return je===0||je===1?je:-Ge*Math.pow(2,10*(je-1))*Math.sin((je-1-et/(Math.PI*2)*Math.asin(1/Ge))*(Math.PI*2)/et)}}function R(oe){return oe===void 0&&(oe=10),function(be){return Math.round(be*oe)*(1/oe)}}var D=function(){var oe=11,be=1/(oe-1);function Ge(Wt,qt){return 1-3*qt+3*Wt}function et(Wt,qt){return 3*qt-6*Wt}function je(Wt){return 3*Wt}function ht(Wt,qt,cr){return((Ge(qt,cr)*Wt+et(qt,cr))*Wt+je(qt))*Wt}function bt(Wt,qt,cr){return 3*Ge(qt,cr)*Wt*Wt+2*et(qt,cr)*Wt+je(qt)}function kt(Wt,qt,cr,fn,Or){var br,Hr,yn=0;do Hr=qt+(cr-qt)/2,br=ht(Hr,fn,Or)-Wt,br>0?cr=Hr:qt=Hr;while(Math.abs(br)>1e-7&&++yn<10);return Hr}function Mt(Wt,qt,cr,fn){for(var Or=0;Or<4;++Or){var br=bt(qt,cr,fn);if(br===0)return qt;var Hr=ht(qt,cr,fn)-Wt;qt-=Hr/br}return qt}function ct(Wt,qt,cr,fn){if(!(0<=Wt&&Wt<=1&&0<=cr&&cr<=1))return;var Or=new Float32Array(oe);if(Wt!==qt||cr!==fn)for(var br=0;br<oe;++br)Or[br]=ht(br*be,Wt,cr);function Hr(yn){for(var Hn=0,hr=1,Tr=oe-1;hr!==Tr&&Or[hr]<=yn;++hr)Hn+=be;--hr;var Sr=(yn-Or[hr])/(Or[hr+1]-Or[hr]),si=Hn+Sr*be,sn=bt(si,Wt,cr);return sn>=.001?Mt(yn,si,Wt,cr):sn===0?si:kt(yn,Hn,Hn+be,Wt,cr)}return function(yn){return Wt===qt&&cr===fn||yn===0||yn===1?yn:ht(Hr(yn),qt,fn)}}return ct}(),N=function(){var oe=["Quad","Cubic","Quart","Quint","Sine","Expo","Circ","Back","Elastic"],be={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],M],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(bt,kt){return function(Mt){return 1-M(bt,kt)(1-Mt)}}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(bt,kt){return function(Mt){return Mt<.5?M(bt,kt)(Mt*2)/2:1-M(bt,kt)(Mt*-2+2)/2}}]},Ge={linear:[.25,.25,.75,.75]};for(var et in be)for(var je=0,ht=be[et].length;je<ht;je++)Ge["ease"+et+oe[je]]=be[et][je];return Ge}();function z(oe,be){if(g.fnc(oe))return oe;var Ge=oe.split("(")[0],et=N[Ge],je=x(oe);switch(Ge){case"spring":return L(oe,be);case"cubicBezier":return d(D,je);case"steps":return d(R,je);default:return g.fnc(et)?d(et,je):d(D,et)}}function re(oe){try{var be=document.querySelectorAll(oe);return be}catch{return}}var Y=[];function te(oe,be){for(var Ge=Y,et=oe.length,je=arguments.length>=2?arguments[1]:void 0,ht=0;ht<et;ht++)if(ht in oe){var bt=oe[ht];be.call(je,bt,ht,oe)&&Ge.push(bt)}return Y=oe,Y.length=0,Ge}function J(oe,be){be||(be=[]);for(var Ge=0,et=oe.length;Ge<et;Ge++){var je=oe[Ge];Array.isArray(je)?J(je,be):be.push(je)}return be}function le(oe){return g.arr(oe)?oe:(g.str(oe)&&(oe=re(oe)||oe),oe instanceof NodeList||oe instanceof HTMLCollection?[].slice.call(oe):[oe])}function j(oe,be){return oe.some(function(Ge){return Ge===be})}function ae(oe){var be={};for(var Ge in oe)be[Ge]=oe[Ge];return be}function Z(oe,be){var Ge=ae(oe);for(var et in oe)Ge[et]=be.hasOwnProperty(et)?be[et]:oe[et];return Ge}function ye(oe,be){var Ge=ae(oe);for(var et in be)Ge[et]=g.und(oe[et])?be[et]:oe[et];return Ge}var Ne=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g;function We(oe){var be=Ne.exec(oe);return be?"rgba("+be[1]+",1)":oe}var ke=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,it=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;function rt(oe){var be=oe.replace(ke,function(bt,kt,Mt,ct){return kt+kt+Mt+Mt+ct+ct}),Ge=it.exec(be),et=parseInt(Ge[1],16),je=parseInt(Ge[2],16),ht=parseInt(Ge[3],16);return"rgba("+et+","+je+","+ht+",1)"}var At=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g,St=/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g;function Gt(oe){var be=At.exec(oe)||St.exec(oe),Ge=parseInt(be[1],10)/360,et=parseInt(be[2],10)/100,je=parseInt(be[3],10)/100,ht=be[4]||1;function bt(cr,fn,Or){return Or<0&&(Or+=1),Or>1&&(Or-=1),Or<1/6?cr+(fn-cr)*6*Or:Or<1/2?fn:Or<2/3?cr+(fn-cr)*(2/3-Or)*6:cr}var kt,Mt,ct;if(et==0)kt=Mt=ct=je;else{var Wt=je<.5?je*(1+et):je+et-je*et,qt=2*je-Wt;kt=bt(qt,Wt,Ge+1/3),Mt=bt(qt,Wt,Ge),ct=bt(qt,Wt,Ge-1/3)}return"rgba("+kt*255+","+Mt*255+","+ct*255+","+ht+")"}function er(oe){if(g.rgb(oe))return We(oe);if(g.hex(oe))return rt(oe);if(g.hsl(oe))return Gt(oe)}var zt=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/;function wt(oe){var be=zt.exec(oe);if(be)return be[2]}function kr(oe){if(v(oe,"translate")||oe==="perspective")return"px";if(v(oe,"rotate")||v(oe,"skew"))return"deg"}function en(oe,be){return g.fnc(oe)?oe(be.target,be.id,be.total):oe}function Nt(oe,be){return oe.getAttribute(be)}function ne(oe,be,Ge){var et=wt(be);if(j([Ge,"deg","rad","turn"],et))return be;var je=w.CSS[be+Ge];if(!g.und(je))return je;var ht=100,bt=document.createElement(oe.tagName),kt=oe.parentNode&&oe.parentNode!==document?oe.parentNode:document.body;kt.appendChild(bt),bt.style.position="absolute",bt.style.width=ht+Ge;var Mt=ht/bt.offsetWidth;kt.removeChild(bt);var ct=Mt*parseFloat(be);return w.CSS[be+Ge]=ct,ct}function ie(oe,be,Ge){if(be in oe.style){var et=be.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),je=oe.style[be]||getComputedStyle(oe).getPropertyValue(et)||"0";return Ge?ne(oe,je,Ge):je}}function ge(oe,be){if(g.dom(oe)&&!g.inp(oe)&&(Nt(oe,be)||g.svg(oe)&&oe[be]))return"attribute";if(g.dom(oe)&&j(E,be))return"transform";if(g.dom(oe)&&be!=="transform"&&ie(oe,be))return"css";if(oe[be]!=null)return"object"}var ve=/(\w+)\(([^)]*)\)/g;function we(oe){if(!!g.dom(oe)){for(var be=oe.style.transform||"",Ge=new Map,et;et=ve.exec(be);)Ge.set(et[1],et[2]);return Ge}}function Ie(oe,be,Ge,et){var je=v(be,"scale")?1:0+kr(be),ht=we(oe).get(be)||je;return Ge&&(Ge.transforms.list.set(be,ht),Ge.transforms.last=be),et?ne(oe,ht,et):ht}function De(oe,be,Ge,et){switch(ge(oe,be)){case"transform":return Ie(oe,be,et,Ge);case"css":return ie(oe,be,Ge);case"attribute":return Nt(oe,be);default:return oe[be]||0}}var Fe=/^(\*=|\+=|-=)/;function Xe(oe,be){var Ge=Fe.exec(oe);if(!Ge)return oe;var et=wt(oe)||0,je=parseFloat(be),ht=parseFloat(oe.replace(Ge[0],""));switch(Ge[0][0]){case"+":return je+ht+et;case"-":return je-ht+et;case"*":return je*ht+et}}var at=/\s/g;function lt(oe,be){if(g.col(oe))return er(oe);var Ge=wt(oe),et=Ge?oe.substr(0,oe.length-Ge.length):oe;return be&&!at.test(oe)?et+be:et}function vt(oe,be){return Math.sqrt(Math.pow(be.x-oe.x,2)+Math.pow(be.y-oe.y,2))}function $(oe){return Math.PI*2*Nt(oe,"r")}function U(oe){return Nt(oe,"width")*2+Nt(oe,"height")*2}function H(oe){return vt({x:Nt(oe,"x1"),y:Nt(oe,"y1")},{x:Nt(oe,"x2"),y:Nt(oe,"y2")})}function ce(oe){for(var be=oe.points,Ge=0,et,je=0;je<be.numberOfItems;je++){var ht=be.getItem(je);je>0&&(Ge+=vt(et,ht)),et=ht}return Ge}function Re(oe){var be=oe.points;return ce(oe)+vt(be.getItem(be.numberOfItems-1),be.getItem(0))}function qe(oe){if(oe.getTotalLength)return oe.getTotalLength();switch(oe.tagName.toLowerCase()){case"circle":return $(oe);case"rect":return U(oe);case"line":return H(oe);case"polyline":return ce(oe);case"polygon":return Re(oe)}}function $e(oe){var be=qe(oe);return oe.setAttribute("stroke-dasharray",be),be}function Rt(oe){for(var be=oe.parentNode;g.svg(be)&&(be=be.parentNode,!!g.svg(be.parentNode)););return be}function Qt(oe,be){var Ge=be||{},et=Ge.el||Rt(oe),je=et.getBoundingClientRect(),ht=Nt(et,"viewBox"),bt=je.width,kt=je.height,Mt=Ge.viewBox||(ht?ht.split(" "):[0,0,bt,kt]);return{el:et,viewBox:Mt,x:Mt[0]/1,y:Mt[1]/1,w:bt/Mt[2],h:kt/Mt[3]}}function Ar(oe,be){var Ge=g.str(oe)?re(oe)[0]:oe,et=be||100;return function(je){return{property:je,el:Ge,svg:Qt(Ge),totalLength:qe(Ge)*(et/100)}}}function Pr(oe,be){function Ge(kt){kt===void 0&&(kt=0);var Mt=be+kt>=1?be+kt:0;return oe.el.getPointAtLength(Mt)}var et=Qt(oe.el,oe.svg),je=Ge(),ht=Ge(-1),bt=Ge(1);switch(oe.property){case"x":return(je.x-et.x)*et.w;case"y":return(je.y-et.y)*et.h;case"angle":return Math.atan2(bt.y-ht.y,bt.x-ht.x)*180/Math.PI}}var Vt=/-?\d*\.?\d+/g;function jr(oe,be){var Ge=lt(g.pth(oe)?oe.totalLength:oe,be)+"";return{original:Ge,numbers:Ge.match(Vt)?Ge.match(Vt).map(Number):[0],strings:g.str(oe)||be?Ge.split(Vt):[]}}function ar(oe){var be=oe?J(g.arr(oe)?oe.map(le):le(oe)):[];return te(be,function(Ge,et,je){return je.indexOf(Ge)===et})}function hn(oe){var be=ar(oe);return be.map(function(Ge,et){return{target:Ge,id:et,total:be.length,transforms:{list:we(Ge)}}})}var Rn=/^spring/;function dn(oe,be){var Ge=ae(be);if(Rn.test(Ge.easing)&&(Ge.duration=L(Ge.easing)),g.arr(oe)){var et=oe.length,je=et===2&&!g.obj(oe[0]);je?oe={value:oe}:g.fnc(be.duration)||(Ge.duration=be.duration/et)}var ht=g.arr(oe)?oe:[oe];return ht.map(function(bt,kt){var Mt=g.obj(bt)&&!g.pth(bt)?bt:{value:bt};return g.und(Mt.delay)&&(Mt.delay=kt?0:be.delay),g.und(Mt.endDelay)&&(Mt.endDelay=kt===ht.length-1?be.endDelay:0),Mt}).map(function(bt){return ye(bt,Ge)})}function ot(oe){for(var be=te(J(oe.map(function(ht){return Object.keys(ht)})),function(ht){return g.key(ht)}).reduce(function(ht,bt){return ht.indexOf(bt)<0&&ht.push(bt),ht},[]),Ge={},et=function(ht){var bt=be[ht];Ge[bt]=oe.map(function(kt){var Mt={};for(var ct in kt)g.key(ct)?ct==bt&&(Mt.value=kt[ct]):Mt[ct]=kt[ct];return Mt})},je=0;je<be.length;je++)et(je);return Ge}function nt(oe,be){var Ge=[],et=be.keyframes;et&&(be=ye(ot(et),be));for(var je in be)g.key(je)&&Ge.push({name:je,tweens:dn(be[je],oe)});return Ge}function yt(oe,be){var Ge={};for(var et in oe){var je=en(oe[et],be);g.arr(je)&&(je=je.map(function(ht){return en(ht,be)}),je.length===1&&(je=je[0])),Ge[et]=je}return Ge.duration=parseFloat(Ge.duration),Ge.delay=parseFloat(Ge.delay),Ge}function Jt(oe,be){var Ge;return oe.tweens.map(function(et){var je=yt(et,be),ht=je.value,bt=g.arr(ht)?ht[1]:ht,kt=wt(bt),Mt=De(be.target,oe.name,kt,be),ct=Ge?Ge.to.original:Mt,Wt=g.arr(ht)?ht[0]:ct,qt=wt(Wt)||wt(Mt),cr=kt||qt;return g.und(bt)&&(bt=ct),je.from=jr(Wt,cr),je.to=jr(Xe(bt,Wt),cr),je.start=Ge?Ge.end:0,je.end=je.start+je.delay+je.duration+je.endDelay,je.easing=z(je.easing,je.duration),je.isPath=g.pth(ht),je.isColor=g.col(je.from.original),je.isColor&&(je.round=1),Ge=je,je})}var tr={css:function(oe,be,Ge){return oe.style[be]=Ge},attribute:function(oe,be,Ge){return oe.setAttribute(be,Ge)},object:function(oe,be,Ge){return oe[be]=Ge},transform:function(oe,be,Ge,et,je){if(et.list.set(be,Ge),be===et.last||je){var ht="";et.list.forEach(function(bt,kt){ht+=kt+"("+bt+") "}),oe.style.transform=ht}}};function ur(oe,be){for(var Ge=hn(oe),et=0,je=Ge.length;et<je;et++){var ht=Ge[et];for(var bt in be){var kt=en(be[bt],ht),Mt=ht.target,ct=wt(kt),Wt=De(Mt,bt,ct,ht),qt=ct||wt(Wt),cr=Xe(lt(kt,qt),Wt),fn=ge(Mt,bt);tr[fn](Mt,bt,cr,ht.transforms,!0)}}}function ir(oe,be){var Ge=ge(oe.target,be.name);if(Ge){var et=Jt(be,oe),je=et[et.length-1];return{type:Ge,property:be.name,animatable:oe,tweens:et,duration:je.end,delay:et[0].delay,endDelay:je.endDelay}}}function xr(oe,be){return te(J(oe.map(function(Ge){return be.map(function(et){return ir(Ge,et)})})),function(Ge){return!g.und(Ge)})}function Xr(oe,be){var Ge=oe.length,et=function(ht){return ht.timelineOffset?ht.timelineOffset:0},je={};return je.duration=Ge?Math.max.apply(Math,oe.map(function(ht){return et(ht)+ht.duration})):be.duration,je.delay=Ge?Math.min.apply(Math,oe.map(function(ht){return et(ht)+ht.delay})):be.delay,je.endDelay=Ge?je.duration-Math.max.apply(Math,oe.map(function(ht){return et(ht)+ht.duration-ht.endDelay})):be.endDelay,je}var Dr=0;function Nn(oe){var be=Z(u,oe),Ge=Z(A,oe),et=nt(Ge,oe),je=hn(oe.targets),ht=xr(je,et),bt=Xr(ht,Ge),kt=Dr;return Dr++,ye(be,{id:kt,children:[],animatables:je,animations:ht,duration:bt.duration,delay:bt.delay,endDelay:bt.endDelay})}var Yr=[],Ur=[],on,vi=function(){function oe(){on=requestAnimationFrame(be)}function be(Ge){var et=Yr.length;if(et){for(var je=0;je<et;){var ht=Yr[je];if(!ht.paused)ht.tick(Ge);else{var bt=Yr.indexOf(ht);bt>-1&&(Yr.splice(bt,1),et=Yr.length)}je++}oe()}else on=cancelAnimationFrame(on)}return oe}();function qn(){if(document.hidden){for(var oe=0,be=Yr.length;oe<be;oe++)activeInstance[oe].pause();Ur=Yr.slice(0),Yr=[]}else for(var Ge=0,et=Ur.length;Ge<et;Ge++)Ur[Ge].play()}document.addEventListener("visibilitychange",qn);function qr(oe){oe===void 0&&(oe={});var be=0,Ge=0,et=0,je,ht=0,bt=null;function kt(){return window.Promise&&new Promise(function(hr){return bt=hr})}var Mt=kt(),ct=Nn(oe);function Wt(){ct.reversed=!ct.reversed;for(var hr=0,Tr=je.length;hr<Tr;hr++)je[hr].reversed=ct.reversed}function qt(hr){return ct.reversed?ct.duration-hr:hr}function cr(){be=0,Ge=qt(ct.currentTime)*(1/qr.speed)}function fn(hr,Tr){Tr&&Tr.seek(hr-Tr.timelineOffset)}function Or(hr){if(ct.reversePlayback)for(var Sr=ht;Sr--;)fn(hr,je[Sr]);else for(var Tr=0;Tr<ht;Tr++)fn(hr,je[Tr])}function br(hr){for(var Tr=0,Sr=ct.animations,si=Sr.length;Tr<si;){var sn=Sr[Tr],pn=sn.animatable,I=sn.tweens,F=I.length-1,X=I[F];F&&(X=te(I,function(tn){return hr<tn.end})[0]||X);for(var q=h(hr-X.start-X.delay,0,X.duration)/X.duration,he=isNaN(q)?1:X.easing(q),Oe=X.to.strings,Je=X.round,ft=[],dt=X.to.numbers.length,ze=void 0,tt=0;tt<dt;tt++){var mt=void 0,Bt=X.to.numbers[tt],jt=X.from.numbers[tt]||0;X.isPath?mt=Pr(X.value,he*Bt):mt=jt+he*(Bt-jt),Je&&(X.isColor&&tt>2||(mt=Math.round(mt*Je)/Je)),ft.push(mt)}var Zt=Oe.length;if(!Zt)ze=ft[0];else{ze=Oe[0];for(var Er=0;Er<Zt;Er++){Oe[Er];var fr=Oe[Er+1],or=ft[Er];isNaN(or)||(fr?ze+=or+fr:ze+=or+" ")}}tr[sn.type](pn.target,sn.property,ze,pn.transforms),sn.currentValue=ze,Tr++}}function Hr(hr){ct[hr]&&!ct.passThrough&&ct[hr](ct)}function yn(){ct.remaining&&ct.remaining!==!0&&ct.remaining--}function Hn(hr){var Tr=ct.duration,Sr=ct.delay,si=Tr-ct.endDelay,sn=qt(hr);ct.progress=h(sn/Tr*100,0,100),ct.reversePlayback=sn<ct.currentTime,je&&Or(sn),!ct.began&&ct.currentTime>0&&(ct.began=!0,Hr("begin"),Hr("loopBegin")),sn<=Sr&&ct.currentTime!==0&&br(0),(sn>=si&&ct.currentTime!==Tr||!Tr)&&br(Tr),sn>Sr&&sn<si?(ct.changeBegan||(ct.changeBegan=!0,ct.changeCompleted=!1,Hr("changeBegin")),Hr("change"),br(sn)):ct.changeBegan&&(ct.changeCompleted=!0,ct.changeBegan=!1,Hr("changeComplete")),ct.currentTime=h(sn,0,Tr),ct.began&&Hr("update"),hr>=Tr&&(Ge=0,yn(),ct.remaining?(be=et,Hr("loopComplete"),Hr("loopBegin"),ct.direction==="alternate"&&Wt()):(ct.paused=!0,ct.completed||(ct.completed=!0,Hr("loopComplete"),Hr("complete"),"Promise"in window&&(bt(),Mt=kt()))))}return ct.reset=function(){var hr=ct.direction;ct.passThrough=!1,ct.currentTime=0,ct.progress=0,ct.paused=!0,ct.began=!1,ct.changeBegan=!1,ct.completed=!1,ct.changeCompleted=!1,ct.reversePlayback=!1,ct.reversed=hr==="reverse",ct.remaining=ct.loop,je=ct.children,ht=je.length;for(var Tr=ht;Tr--;)ct.children[Tr].reset();(ct.reversed&&ct.loop!==!0||hr==="alternate"&&ct.loop===1)&&ct.remaining++,br(0)},ct.set=function(hr,Tr){return ur(hr,Tr),ct},ct.tick=function(hr){et=hr,be||(be=et),Hn((et+(Ge-be))*qr.speed)},ct.seek=function(hr){Hn(qt(hr))},ct.pause=function(){ct.paused=!0,cr()},ct.play=function(){!ct.paused||(ct.paused=!1,Yr.push(ct),cr(),on||vi())},ct.reverse=function(){Wt(),cr()},ct.restart=function(){ct.reset(),ct.play()},ct.finished=Mt,ct.reset(),ct.autoplay&&ct.play(),ct}function Li(oe,be){for(var Ge=be.length;Ge--;)j(oe,be[Ge].animatable.target)&&be.splice(Ge,1)}function Wn(oe){for(var be=ar(oe),Ge=Yr.length;Ge--;){var et=Yr[Ge],je=et.animations,ht=et.children;Li(be,je);for(var bt=ht.length;bt--;){var kt=ht[bt],Mt=kt.animations;Li(be,Mt),!Mt.length&&!kt.children.length&&ht.splice(bt,1)}!je.length&&!ht.length&&et.pause()}}function Ri(oe,be){be===void 0&&(be={});var Ge=be.direction||"normal",et=be.easing?z(be.easing):null,je=be.grid,ht=be.axis,bt=be.from||0,kt=bt==="first",Mt=bt==="center",ct=bt==="last",Wt=g.arr(oe),qt=parseFloat(Wt?oe[0]:oe),cr=Wt?parseFloat(oe[1]):0,fn=wt(Wt?oe[1]:oe)||0,Or=be.start||0+(Wt?qt:0),br=[],Hr=0;return function(yn,Hn,hr){if(kt&&(bt=0),Mt&&(bt=(hr-1)/2),ct&&(bt=hr-1),!br.length){for(var Tr=0;Tr<hr;Tr++){if(!je)br.push(Math.abs(bt-Tr));else{var Sr=Mt?(je[0]-1)/2:bt%je[0],si=Mt?(je[1]-1)/2:Math.floor(bt/je[0]),sn=Tr%je[0],pn=Math.floor(Tr/je[0]),I=Sr-sn,F=si-pn,X=Math.sqrt(I*I+F*F);ht==="x"&&(X=-I),ht==="y"&&(X=-F),br.push(X)}Hr=Math.max.apply(Math,br)}et&&(br=br.map(function(he){return et(he/Hr)*Hr})),Ge==="reverse"&&(br=br.map(function(he){return ht?he<0?he*-1:-he:Math.abs(Hr-he)}))}var q=Wt?(cr-qt)/Hr:qt;return Or+q*(Math.round(br[Hn]*100)/100)+fn}}function jn(oe){oe===void 0&&(oe={});var be=qr(oe);return be.duration=0,be.add=function(Ge,et){var je=Yr.indexOf(be),ht=be.children;je>-1&&Yr.splice(je,1);function bt(cr){cr.passThrough=!0}for(var kt=0;kt<ht.length;kt++)bt(ht[kt]);var Mt=ye(Ge,Z(A,oe));Mt.targets=Mt.targets||oe.targets;var ct=be.duration;Mt.autoplay=!1,Mt.direction=be.direction,Mt.timelineOffset=g.und(et)?ct:Xe(et,ct),bt(be),be.seek(Mt.timelineOffset);var Wt=qr(Mt);bt(Wt),ht.push(Wt);var qt=Xr(ht,oe);return be.delay=qt.delay,be.endDelay=qt.endDelay,be.duration=qt.duration,be.seek(0),be.reset(),be.autoplay&&be.play(),be},be}qr.version="3.0.0",qr.speed=1,qr.running=Yr,qr.remove=Wn,qr.get=De,qr.set=ur,qr.convertPx=ne,qr.path=Ar,qr.setDashoffset=$e,qr.stagger=Ri,qr.timeline=jn,qr.easing=z,qr.penner=N,qr.random=function(oe,be){return Math.floor(Math.random()*(be-oe+1))+oe},G.exports=qr},{}],57:[function(_,G,fe){(function(u,A){typeof fe=="object"&&typeof G!="undefined"?A(fe):(u=typeof globalThis!="undefined"?globalThis:u||self,A(u.THREE={}))})(this,function(u){Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),Number.isInteger===void 0&&(Number.isInteger=function(a){return typeof a=="number"&&isFinite(a)&&Math.floor(a)===a}),Math.sign===void 0&&(Math.sign=function(a){return a<0?-1:a>0?1:+a}),"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),Object.assign===void 0&&(Object.assign=function(a){if(a==null)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(a),i=1;i<arguments.length;i++){var r=arguments[i];if(r!=null)for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t});var A=function(a){var t=Object.prototype,i=t.hasOwnProperty,r,n=typeof Symbol=="function"?Symbol:{},o=n.iterator||"@@iterator",s=n.asyncIterator||"@@asyncIterator",l=n.toStringTag||"@@toStringTag";function c(Te,me,Ue){return Object.defineProperty(Te,me,{value:Ue,enumerable:!0,configurable:!0,writable:!0}),Te[me]}try{c({},"")}catch{c=function(Ue,He,Ye){return Ue[He]=Ye}}function p(Te,me,Ue,He){var Ye=me&&me.prototype instanceof W?me:W,Qe=Object.create(Ye.prototype),pt=new Ae(He||[]);return Qe._invoke=xe(Te,Ue,pt),Qe}a.wrap=p;function C(Te,me,Ue){try{return{type:"normal",arg:Te.call(me,Ue)}}catch(He){return{type:"throw",arg:He}}}var S="suspendedStart",T="suspendedYield",O="executing",P="completed",k={};function W(){}function V(){}function B(){}var ee={};ee[o]=function(){return this};var ue=Object.getPrototypeOf,K=ue&&ue(ue(Be([])));K&&K!==t&&i.call(K,o)&&(ee=K);var Q=B.prototype=W.prototype=Object.create(ee);V.prototype=Q.constructor=B,B.constructor=V,V.displayName=c(B,l,"GeneratorFunction");function se(Te){["next","throw","return"].forEach(function(me){c(Te,me,function(Ue){return this._invoke(me,Ue)})})}a.isGeneratorFunction=function(Te){var me=typeof Te=="function"&&Te.constructor;return me?me===V||(me.displayName||me.name)==="GeneratorFunction":!1},a.mark=function(Te){return Object.setPrototypeOf?Object.setPrototypeOf(Te,B):(Te.__proto__=B,c(Te,l,"GeneratorFunction")),Te.prototype=Object.create(Q),Te},a.awrap=function(Te){return{__await:Te}};function Me(Te,me){function Ue(Qe,pt,Et,Ut){var Ze=C(Te[Qe],Te,pt);if(Ze.type==="throw")Ut(Ze.arg);else{var $t=Ze.arg,Dt=$t.value;return Dt&&typeof Dt=="object"&&i.call(Dt,"__await")?me.resolve(Dt.__await).then(function(rr){Ue("next",rr,Et,Ut)},function(rr){Ue("throw",rr,Et,Ut)}):me.resolve(Dt).then(function(rr){$t.value=rr,Et($t)},function(rr){return Ue("throw",rr,Et,Ut)})}}var He;function Ye(Qe,pt){function Et(){return new me(function(Ut,Ze){Ue(Qe,pt,Ut,Ze)})}return He=He?He.then(Et,Et):Et()}this._invoke=Ye}se(Me.prototype),Me.prototype[s]=function(){return this},a.AsyncIterator=Me,a.async=function(Te,me,Ue,He,Ye){Ye===void 0&&(Ye=Promise);var Qe=new Me(p(Te,me,Ue,He),Ye);return a.isGeneratorFunction(me)?Qe:Qe.next().then(function(pt){return pt.done?pt.value:Qe.next()})};function xe(Te,me,Ue){var He=S;return function(Qe,pt){if(He===O)throw new Error("Generator is already running");if(He===P){if(Qe==="throw")throw pt;return Se()}for(Ue.method=Qe,Ue.arg=pt;;){var Et=Ue.delegate;if(Et){var Ut=_e(Et,Ue);if(Ut){if(Ut===k)continue;return Ut}}if(Ue.method==="next")Ue.sent=Ue._sent=Ue.arg;else if(Ue.method==="throw"){if(He===S)throw He=P,Ue.arg;Ue.dispatchException(Ue.arg)}else Ue.method==="return"&&Ue.abrupt("return",Ue.arg);He=O;var Ze=C(Te,me,Ue);if(Ze.type==="normal"){if(He=Ue.done?P:T,Ze.arg===k)continue;return{value:Ze.arg,done:Ue.done}}else Ze.type==="throw"&&(He=P,Ue.method="throw",Ue.arg=Ze.arg)}}}function _e(Te,me){var Ue=Te.iterator[me.method];if(Ue===r){if(me.delegate=null,me.method==="throw"){if(Te.iterator.return&&(me.method="return",me.arg=r,_e(Te,me),me.method==="throw"))return k;me.method="throw",me.arg=new TypeError("The iterator does not provide a 'throw' method")}return k}var He=C(Ue,Te.iterator,me.arg);if(He.type==="throw")return me.method="throw",me.arg=He.arg,me.delegate=null,k;var Ye=He.arg;if(!Ye)return me.method="throw",me.arg=new TypeError("iterator result is not an object"),me.delegate=null,k;if(Ye.done)me[Te.resultName]=Ye.value,me.next=Te.nextLoc,me.method!=="return"&&(me.method="next",me.arg=r);else return Ye;return me.delegate=null,k}se(Q),c(Q,l,"Generator"),Q[o]=function(){return this},Q.toString=function(){return"[object Generator]"};function Pe(Te){var me={tryLoc:Te[0]};1 in Te&&(me.catchLoc=Te[1]),2 in Te&&(me.finallyLoc=Te[2],me.afterLoc=Te[3]),this.tryEntries.push(me)}function Ce(Te){var me=Te.completion||{};me.type="normal",delete me.arg,Te.completion=me}function Ae(Te){this.tryEntries=[{tryLoc:"root"}],Te.forEach(Pe,this),this.reset(!0)}a.keys=function(Te){var me=[];for(var Ue in Te)me.push(Ue);return me.reverse(),function He(){for(;me.length;){var Ye=me.pop();if(Ye in Te)return He.value=Ye,He.done=!1,He}return He.done=!0,He}};function Be(Te){if(Te){var me=Te[o];if(me)return me.call(Te);if(typeof Te.next=="function")return Te;if(!isNaN(Te.length)){var Ue=-1,He=function Ye(){for(;++Ue<Te.length;)if(i.call(Te,Ue))return Ye.value=Te[Ue],Ye.done=!1,Ye;return Ye.value=r,Ye.done=!0,Ye};return He.next=He}}return{next:Se}}a.values=Be;function Se(){return{value:r,done:!0}}return Ae.prototype={constructor:Ae,reset:function(me){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(Ce),!me)for(var Ue in this)Ue.charAt(0)==="t"&&i.call(this,Ue)&&!isNaN(+Ue.slice(1))&&(this[Ue]=r)},stop:function(){this.done=!0;var me=this.tryEntries[0],Ue=me.completion;if(Ue.type==="throw")throw Ue.arg;return this.rval},dispatchException:function(me){if(this.done)throw me;var Ue=this;function He(Ze,$t){return pt.type="throw",pt.arg=me,Ue.next=Ze,$t&&(Ue.method="next",Ue.arg=r),!!$t}for(var Ye=this.tryEntries.length-1;Ye>=0;--Ye){var Qe=this.tryEntries[Ye],pt=Qe.completion;if(Qe.tryLoc==="root")return He("end");if(Qe.tryLoc<=this.prev){var Et=i.call(Qe,"catchLoc"),Ut=i.call(Qe,"finallyLoc");if(Et&&Ut){if(this.prev<Qe.catchLoc)return He(Qe.catchLoc,!0);if(this.prev<Qe.finallyLoc)return He(Qe.finallyLoc)}else if(Et){if(this.prev<Qe.catchLoc)return He(Qe.catchLoc,!0)}else if(Ut){if(this.prev<Qe.finallyLoc)return He(Qe.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(me,Ue){for(var He=this.tryEntries.length-1;He>=0;--He){var Ye=this.tryEntries[He];if(Ye.tryLoc<=this.prev&&i.call(Ye,"finallyLoc")&&this.prev<Ye.finallyLoc){var Qe=Ye;break}}Qe&&(me==="break"||me==="continue")&&Qe.tryLoc<=Ue&&Ue<=Qe.finallyLoc&&(Qe=null);var pt=Qe?Qe.completion:{};return pt.type=me,pt.arg=Ue,Qe?(this.method="next",this.next=Qe.finallyLoc,k):this.complete(pt)},complete:function(me,Ue){if(me.type==="throw")throw me.arg;return me.type==="break"||me.type==="continue"?this.next=me.arg:me.type==="return"?(this.rval=this.arg=me.arg,this.method="return",this.next="end"):me.type==="normal"&&Ue&&(this.next=Ue),k},finish:function(me){for(var Ue=this.tryEntries.length-1;Ue>=0;--Ue){var He=this.tryEntries[Ue];if(He.finallyLoc===me)return this.complete(He.completion,He.afterLoc),Ce(He),k}},catch:function(me){for(var Ue=this.tryEntries.length-1;Ue>=0;--Ue){var He=this.tryEntries[Ue];if(He.tryLoc===me){var Ye=He.completion;if(Ye.type==="throw"){var Qe=Ye.arg;Ce(He)}return Qe}}throw new Error("illegal catch attempt")},delegateYield:function(me,Ue,He){return this.delegate={iterator:Be(me),resultName:Ue,nextLoc:He},this.method==="next"&&(this.arg=r),k}},a}(typeof G=="object"?G.exports:{});try{regeneratorRuntime=A}catch{Function("r","regeneratorRuntime = r")(A)}var E="125",w={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},h={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},v=0,d=1,m=2,f=3,b=0,g=1,y=2,x=3,L=0,M=1,R=2,D=1,N=2,z=0,re=1,Y=2,te=3,J=4,le=5,j=100,ae=101,Z=102,ye=103,Ne=104,We=200,ke=201,it=202,rt=203,At=204,St=205,Gt=206,er=207,zt=208,wt=209,kr=210,en=0,Nt=1,ne=2,ie=3,ge=4,ve=5,we=6,Ie=7,De=0,Fe=1,Xe=2,at=0,lt=1,vt=2,$=3,U=4,H=5,ce=300,Re=301,qe=302,$e=303,Rt=304,Qt=306,Ar=307,Pr=1e3,Vt=1001,jr=1002,ar=1003,hn=1004,Rn=1004,dn=1005,ot=1005,nt=1006,yt=1007,Jt=1007,tr=1008,ur=1008,ir=1009,xr=1010,Xr=1011,Dr=1012,Nn=1013,Yr=1014,Ur=1015,on=1016,vi=1017,qn=1018,qr=1019,Li=1020,Wn=1021,Ri=1022,jn=1023,oe=1024,be=1025,Ge=jn,et=1026,je=1027,ht=1028,bt=1029,kt=1030,Mt=1031,ct=1032,Wt=1033,qt=33776,cr=33777,fn=33778,Or=33779,br=35840,Hr=35841,yn=35842,Hn=35843,hr=36196,Tr=37492,Sr=37496,si=37808,sn=37809,pn=37810,I=37811,F=37812,X=37813,q=37814,he=37815,Oe=37816,Je=37817,ft=37818,dt=37819,ze=37820,tt=37821,mt=36492,Bt=37840,jt=37841,Zt=37842,Er=37843,fr=37844,or=37845,tn=37846,Mn=37847,Pn=37848,An=37849,Un=37850,Jn=37851,Zn=37852,Kn=37853,$n=2200,Bi=2201,La=2202,Fi=2300,Ni=2301,Ki=2302,mi=2400,gi=2401,ki=2402,$i=2500,fa=2501,Ra=0,to=1,Dn=2,li=3e3,hs=3001,al=3007,ol=3002,ah=3003,Ou=3004,Iu=3005,Bu=3006,oh=3200,sh=3201,ro=0,lh=1,wf=0,sl=7680,xf=7681,Mf=7682,Tf=7683,Sf=34055,_f=34056,Cf=5386,Lf=512,Rf=513,Pf=514,Df=515,Of=516,If=517,Bf=518,uh=519,ds=35044,no=35048,Ff=35040,Nf=35045,kf=35049,Uf=35041,Hf=35046,Gf=35050,Vf=35042,zf="100",Fu="300 es";function ch(a,t,i,r,n,o,s){try{var l=a[o](s),c=l.value}catch(p){i(p);return}l.done?t(c):Promise.resolve(c).then(r,n)}function Wf(a){return function(){var t=this,i=arguments;return new Promise(function(r,n){var o=a.apply(t,i);function s(c){ch(o,r,n,s,l,"next",c)}function l(c){ch(o,r,n,s,l,"throw",c)}s(void 0)})}}function hh(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function ll(a,t,i){return t&&hh(a.prototype,t),i&&hh(a,i),a}function Mr(a,t){a.prototype=Object.create(t.prototype),a.prototype.constructor=a,a.__proto__=t}function Ui(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function jf(a,t){if(!!a){if(typeof a=="string")return dh(a,t);var i=Object.prototype.toString.call(a).slice(8,-1);if(i==="Object"&&a.constructor&&(i=a.constructor.name),i==="Map"||i==="Set")return Array.from(a);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return dh(a,t)}}function dh(a,t){(t==null||t>a.length)&&(t=a.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=a[i];return r}function Xf(a,t){var i;if(typeof Symbol=="undefined"||a[Symbol.iterator]==null){if(Array.isArray(a)||(i=jf(a))||t&&a&&typeof a.length=="number"){i&&(a=i);var r=0;return function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}return i=a[Symbol.iterator](),i.next.bind(i)}function ea(){}Object.assign(ea.prototype,{addEventListener:function(t,i){this._listeners===void 0&&(this._listeners={});var r=this._listeners;r[t]===void 0&&(r[t]=[]),r[t].indexOf(i)===-1&&r[t].push(i)},hasEventListener:function(t,i){if(this._listeners===void 0)return!1;var r=this._listeners;return r[t]!==void 0&&r[t].indexOf(i)!==-1},removeEventListener:function(t,i){if(this._listeners!==void 0){var r=this._listeners,n=r[t];if(n!==void 0){var o=n.indexOf(i);o!==-1&&n.splice(o,1)}}},dispatchEvent:function(t){if(this._listeners!==void 0){var i=this._listeners,r=i[t.type];if(r!==void 0){t.target=this;for(var n=r.slice(0),o=0,s=n.length;o<s;o++)n[o].call(this,t)}}}});for(var Xn=[],fs=0;fs<256;fs++)Xn[fs]=(fs<16?"0":"")+fs.toString(16);var ul=1234567,dr={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=Math.random()*4294967295|0,i=Math.random()*4294967295|0,r=Math.random()*4294967295|0,n=Math.random()*4294967295|0,o=Xn[t&255]+Xn[t>>8&255]+Xn[t>>16&255]+Xn[t>>24&255]+"-"+Xn[i&255]+Xn[i>>8&255]+"-"+Xn[i>>16&15|64]+Xn[i>>24&255]+"-"+Xn[r&63|128]+Xn[r>>8&255]+"-"+Xn[r>>16&255]+Xn[r>>24&255]+Xn[n&255]+Xn[n>>8&255]+Xn[n>>16&255]+Xn[n>>24&255];return o.toUpperCase()},clamp:function(t,i,r){return Math.max(i,Math.min(r,t))},euclideanModulo:function(t,i){return(t%i+i)%i},mapLinear:function(t,i,r,n,o){return n+(t-i)*(o-n)/(r-i)},lerp:function(t,i,r){return(1-r)*t+r*i},damp:function(t,i,r,n){return dr.lerp(t,i,1-Math.exp(-r*n))},pingpong:function(t,i){return i===void 0&&(i=1),i-Math.abs(dr.euclideanModulo(t,i*2)-i)},smoothstep:function(t,i,r){return t<=i?0:t>=r?1:(t=(t-i)/(r-i),t*t*(3-2*t))},smootherstep:function(t,i,r){return t<=i?0:t>=r?1:(t=(t-i)/(r-i),t*t*t*(t*(t*6-15)+10))},randInt:function(t,i){return t+Math.floor(Math.random()*(i-t+1))},randFloat:function(t,i){return t+Math.random()*(i-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return t!==void 0&&(ul=t%2147483647),ul=ul*16807%2147483647,(ul-1)/2147483646},degToRad:function(t){return t*dr.DEG2RAD},radToDeg:function(t){return t*dr.RAD2DEG},isPowerOfTwo:function(t){return(t&t-1)==0&&t!==0},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,i,r,n,o){var s=Math.cos,l=Math.sin,c=s(r/2),p=l(r/2),C=s((i+n)/2),S=l((i+n)/2),T=s((i-n)/2),O=l((i-n)/2),P=s((n-i)/2),k=l((n-i)/2);switch(o){case"XYX":t.set(c*S,p*T,p*O,c*C);break;case"YZY":t.set(p*O,c*S,p*T,c*C);break;case"ZXZ":t.set(p*T,p*O,c*S,c*C);break;case"XZX":t.set(c*S,p*k,p*P,c*C);break;case"YXY":t.set(p*P,c*S,p*k,c*C);break;case"ZYZ":t.set(p*k,p*P,c*S,c*C);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+o)}}},gt=function(){function a(i,r){i===void 0&&(i=0),r===void 0&&(r=0),Object.defineProperty(this,"isVector2",{value:!0}),this.x=i,this.y=r}var t=a.prototype;return t.set=function(r,n){return this.x=r,this.y=n,this},t.setScalar=function(r){return this.x=r,this.y=r,this},t.setX=function(r){return this.x=r,this},t.setY=function(r){return this.y=r,this},t.setComponent=function(r,n){switch(r){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+r)}return this},t.getComponent=function(r){switch(r){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+r)}},t.clone=function(){return new this.constructor(this.x,this.y)},t.copy=function(r){return this.x=r.x,this.y=r.y,this},t.add=function(r,n){return n!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(r,n)):(this.x+=r.x,this.y+=r.y,this)},t.addScalar=function(r){return this.x+=r,this.y+=r,this},t.addVectors=function(r,n){return this.x=r.x+n.x,this.y=r.y+n.y,this},t.addScaledVector=function(r,n){return this.x+=r.x*n,this.y+=r.y*n,this},t.sub=function(r,n){return n!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(r,n)):(this.x-=r.x,this.y-=r.y,this)},t.subScalar=function(r){return this.x-=r,this.y-=r,this},t.subVectors=function(r,n){return this.x=r.x-n.x,this.y=r.y-n.y,this},t.multiply=function(r){return this.x*=r.x,this.y*=r.y,this},t.multiplyScalar=function(r){return this.x*=r,this.y*=r,this},t.divide=function(r){return this.x/=r.x,this.y/=r.y,this},t.divideScalar=function(r){return this.multiplyScalar(1/r)},t.applyMatrix3=function(r){var n=this.x,o=this.y,s=r.elements;return this.x=s[0]*n+s[3]*o+s[6],this.y=s[1]*n+s[4]*o+s[7],this},t.min=function(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this},t.max=function(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this},t.clamp=function(r,n){return this.x=Math.max(r.x,Math.min(n.x,this.x)),this.y=Math.max(r.y,Math.min(n.y,this.y)),this},t.clampScalar=function(r,n){return this.x=Math.max(r,Math.min(n,this.x)),this.y=Math.max(r,Math.min(n,this.y)),this},t.clampLength=function(r,n){var o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(r,Math.min(n,o)))},t.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},t.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},t.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},t.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},t.negate=function(){return this.x=-this.x,this.y=-this.y,this},t.dot=function(r){return this.x*r.x+this.y*r.y},t.cross=function(r){return this.x*r.y-this.y*r.x},t.lengthSq=function(){return this.x*this.x+this.y*this.y},t.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},t.normalize=function(){return this.divideScalar(this.length()||1)},t.angle=function(){var r=Math.atan2(-this.y,-this.x)+Math.PI;return r},t.distanceTo=function(r){return Math.sqrt(this.distanceToSquared(r))},t.distanceToSquared=function(r){var n=this.x-r.x,o=this.y-r.y;return n*n+o*o},t.manhattanDistanceTo=function(r){return Math.abs(this.x-r.x)+Math.abs(this.y-r.y)},t.setLength=function(r){return this.normalize().multiplyScalar(r)},t.lerp=function(r,n){return this.x+=(r.x-this.x)*n,this.y+=(r.y-this.y)*n,this},t.lerpVectors=function(r,n,o){return this.x=r.x+(n.x-r.x)*o,this.y=r.y+(n.y-r.y)*o,this},t.equals=function(r){return r.x===this.x&&r.y===this.y},t.fromArray=function(r,n){return n===void 0&&(n=0),this.x=r[n],this.y=r[n+1],this},t.toArray=function(r,n){return r===void 0&&(r=[]),n===void 0&&(n=0),r[n]=this.x,r[n+1]=this.y,r},t.fromBufferAttribute=function(r,n,o){return o!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=r.getX(n),this.y=r.getY(n),this},t.rotateAround=function(r,n){var o=Math.cos(n),s=Math.sin(n),l=this.x-r.x,c=this.y-r.y;return this.x=l*o-c*s+r.x,this.y=l*s+c*o+r.y,this},t.random=function(){return this.x=Math.random(),this.y=Math.random(),this},ll(a,[{key:"width",get:function(){return this.x},set:function(r){this.x=r}},{key:"height",get:function(){return this.y},set:function(r){this.y=r}}]),a}(),yi=function(){function a(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}var t=a.prototype;return t.set=function(r,n,o,s,l,c,p,C,S){var T=this.elements;return T[0]=r,T[1]=s,T[2]=p,T[3]=n,T[4]=l,T[5]=C,T[6]=o,T[7]=c,T[8]=S,this},t.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this},t.clone=function(){return new this.constructor().fromArray(this.elements)},t.copy=function(r){var n=this.elements,o=r.elements;return n[0]=o[0],n[1]=o[1],n[2]=o[2],n[3]=o[3],n[4]=o[4],n[5]=o[5],n[6]=o[6],n[7]=o[7],n[8]=o[8],this},t.extractBasis=function(r,n,o){return r.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),o.setFromMatrix3Column(this,2),this},t.setFromMatrix4=function(r){var n=r.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this},t.multiply=function(r){return this.multiplyMatrices(this,r)},t.premultiply=function(r){return this.multiplyMatrices(r,this)},t.multiplyMatrices=function(r,n){var o=r.elements,s=n.elements,l=this.elements,c=o[0],p=o[3],C=o[6],S=o[1],T=o[4],O=o[7],P=o[2],k=o[5],W=o[8],V=s[0],B=s[3],ee=s[6],ue=s[1],K=s[4],Q=s[7],se=s[2],Me=s[5],xe=s[8];return l[0]=c*V+p*ue+C*se,l[3]=c*B+p*K+C*Me,l[6]=c*ee+p*Q+C*xe,l[1]=S*V+T*ue+O*se,l[4]=S*B+T*K+O*Me,l[7]=S*ee+T*Q+O*xe,l[2]=P*V+k*ue+W*se,l[5]=P*B+k*K+W*Me,l[8]=P*ee+k*Q+W*xe,this},t.multiplyScalar=function(r){var n=this.elements;return n[0]*=r,n[3]*=r,n[6]*=r,n[1]*=r,n[4]*=r,n[7]*=r,n[2]*=r,n[5]*=r,n[8]*=r,this},t.determinant=function(){var r=this.elements,n=r[0],o=r[1],s=r[2],l=r[3],c=r[4],p=r[5],C=r[6],S=r[7],T=r[8];return n*c*T-n*p*S-o*l*T+o*p*C+s*l*S-s*c*C},t.invert=function(){var r=this.elements,n=r[0],o=r[1],s=r[2],l=r[3],c=r[4],p=r[5],C=r[6],S=r[7],T=r[8],O=T*c-p*S,P=p*C-T*l,k=S*l-c*C,W=n*O+o*P+s*k;if(W===0)return this.set(0,0,0,0,0,0,0,0,0);var V=1/W;return r[0]=O*V,r[1]=(s*S-T*o)*V,r[2]=(p*o-s*c)*V,r[3]=P*V,r[4]=(T*n-s*C)*V,r[5]=(s*l-p*n)*V,r[6]=k*V,r[7]=(o*C-S*n)*V,r[8]=(c*n-o*l)*V,this},t.transpose=function(){var r,n=this.elements;return r=n[1],n[1]=n[3],n[3]=r,r=n[2],n[2]=n[6],n[6]=r,r=n[5],n[5]=n[7],n[7]=r,this},t.getNormalMatrix=function(r){return this.setFromMatrix4(r).copy(this).invert().transpose()},t.transposeIntoArray=function(r){var n=this.elements;return r[0]=n[0],r[1]=n[3],r[2]=n[6],r[3]=n[1],r[4]=n[4],r[5]=n[7],r[6]=n[2],r[7]=n[5],r[8]=n[8],this},t.setUvTransform=function(r,n,o,s,l,c,p){var C=Math.cos(l),S=Math.sin(l);return this.set(o*C,o*S,-o*(C*c+S*p)+c+r,-s*S,s*C,-s*(-S*c+C*p)+p+n,0,0,1),this},t.scale=function(r,n){var o=this.elements;return o[0]*=r,o[3]*=r,o[6]*=r,o[1]*=n,o[4]*=n,o[7]*=n,this},t.rotate=function(r){var n=Math.cos(r),o=Math.sin(r),s=this.elements,l=s[0],c=s[3],p=s[6],C=s[1],S=s[4],T=s[7];return s[0]=n*l+o*C,s[3]=n*c+o*S,s[6]=n*p+o*T,s[1]=-o*l+n*C,s[4]=-o*c+n*S,s[7]=-o*p+n*T,this},t.translate=function(r,n){var o=this.elements;return o[0]+=r*o[2],o[3]+=r*o[5],o[6]+=r*o[8],o[1]+=n*o[2],o[4]+=n*o[5],o[7]+=n*o[8],this},t.equals=function(r){for(var n=this.elements,o=r.elements,s=0;s<9;s++)if(n[s]!==o[s])return!1;return!0},t.fromArray=function(r,n){n===void 0&&(n=0);for(var o=0;o<9;o++)this.elements[o]=r[o+n];return this},t.toArray=function(r,n){r===void 0&&(r=[]),n===void 0&&(n=0);var o=this.elements;return r[n]=o[0],r[n+1]=o[1],r[n+2]=o[2],r[n+3]=o[3],r[n+4]=o[4],r[n+5]=o[5],r[n+6]=o[6],r[n+7]=o[7],r[n+8]=o[8],r},a}(),Lo,io={getDataURL:function(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement=="undefined")return t.src;var i;if(t instanceof HTMLCanvasElement)i=t;else{Lo===void 0&&(Lo=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Lo.width=t.width,Lo.height=t.height;var r=Lo.getContext("2d");t instanceof ImageData?r.putImageData(t,0,0):r.drawImage(t,0,0,t.width,t.height),i=Lo}return i.width>2048||i.height>2048?i.toDataURL("image/jpeg",.6):i.toDataURL("image/png")}},Yf=0;function ln(a,t,i,r,n,o,s,l,c,p){a===void 0&&(a=ln.DEFAULT_IMAGE),t===void 0&&(t=ln.DEFAULT_MAPPING),i===void 0&&(i=Vt),r===void 0&&(r=Vt),n===void 0&&(n=nt),o===void 0&&(o=tr),s===void 0&&(s=jn),l===void 0&&(l=ir),c===void 0&&(c=1),p===void 0&&(p=li),Object.defineProperty(this,"id",{value:Yf++}),this.uuid=dr.generateUUID(),this.name="",this.image=a,this.mipmaps=[],this.mapping=t,this.wrapS=i,this.wrapT=r,this.magFilter=n,this.minFilter=o,this.anisotropy=c,this.format=s,this.internalFormat=null,this.type=l,this.offset=new gt(0,0),this.repeat=new gt(1,1),this.center=new gt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new yi,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=p,this.version=0,this.onUpdate=null}ln.DEFAULT_IMAGE=void 0,ln.DEFAULT_MAPPING=ce,ln.prototype=Object.assign(Object.create(ea.prototype),{constructor:ln,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var i=t===void 0||typeof t=="string";if(!i&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];var r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){var n=this.image;if(n.uuid===void 0&&(n.uuid=dr.generateUUID()),!i&&t.images[n.uuid]===void 0){var o;if(Array.isArray(n)){o=[];for(var s=0,l=n.length;s<l;s++)n[s].isDataTexture?o.push(Nu(n[s].image)):o.push(Nu(n[s]))}else o=Nu(n);t.images[n.uuid]={uuid:n.uuid,url:o}}r.image=n.uuid}return i||(t.textures[this.uuid]=r),r},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping!==ce)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Pr:t.x=t.x-Math.floor(t.x);break;case Vt:t.x=t.x<0?0:1;break;case jr:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case Pr:t.y=t.y-Math.floor(t.y);break;case Vt:t.y=t.y<0?0:1;break;case jr:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(ln.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}});function Nu(a){return typeof HTMLImageElement!="undefined"&&a instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&a instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&a instanceof ImageBitmap?io.getDataURL(a):a.data?{data:Array.prototype.slice.call(a.data),width:a.width,height:a.height,type:a.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var rn=function(){function a(i,r,n,o){i===void 0&&(i=0),r===void 0&&(r=0),n===void 0&&(n=0),o===void 0&&(o=1),Object.defineProperty(this,"isVector4",{value:!0}),this.x=i,this.y=r,this.z=n,this.w=o}var t=a.prototype;return t.set=function(r,n,o,s){return this.x=r,this.y=n,this.z=o,this.w=s,this},t.setScalar=function(r){return this.x=r,this.y=r,this.z=r,this.w=r,this},t.setX=function(r){return this.x=r,this},t.setY=function(r){return this.y=r,this},t.setZ=function(r){return this.z=r,this},t.setW=function(r){return this.w=r,this},t.setComponent=function(r,n){switch(r){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+r)}return this},t.getComponent=function(r){switch(r){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+r)}},t.clone=function(){return new this.constructor(this.x,this.y,this.z,this.w)},t.copy=function(r){return this.x=r.x,this.y=r.y,this.z=r.z,this.w=r.w!==void 0?r.w:1,this},t.add=function(r,n){return n!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(r,n)):(this.x+=r.x,this.y+=r.y,this.z+=r.z,this.w+=r.w,this)},t.addScalar=function(r){return this.x+=r,this.y+=r,this.z+=r,this.w+=r,this},t.addVectors=function(r,n){return this.x=r.x+n.x,this.y=r.y+n.y,this.z=r.z+n.z,this.w=r.w+n.w,this},t.addScaledVector=function(r,n){return this.x+=r.x*n,this.y+=r.y*n,this.z+=r.z*n,this.w+=r.w*n,this},t.sub=function(r,n){return n!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(r,n)):(this.x-=r.x,this.y-=r.y,this.z-=r.z,this.w-=r.w,this)},t.subScalar=function(r){return this.x-=r,this.y-=r,this.z-=r,this.w-=r,this},t.subVectors=function(r,n){return this.x=r.x-n.x,this.y=r.y-n.y,this.z=r.z-n.z,this.w=r.w-n.w,this},t.multiply=function(r){return this.x*=r.x,this.y*=r.y,this.z*=r.z,this.w*=r.w,this},t.multiplyScalar=function(r){return this.x*=r,this.y*=r,this.z*=r,this.w*=r,this},t.applyMatrix4=function(r){var n=this.x,o=this.y,s=this.z,l=this.w,c=r.elements;return this.x=c[0]*n+c[4]*o+c[8]*s+c[12]*l,this.y=c[1]*n+c[5]*o+c[9]*s+c[13]*l,this.z=c[2]*n+c[6]*o+c[10]*s+c[14]*l,this.w=c[3]*n+c[7]*o+c[11]*s+c[15]*l,this},t.divideScalar=function(r){return this.multiplyScalar(1/r)},t.setAxisAngleFromQuaternion=function(r){this.w=2*Math.acos(r.w);var n=Math.sqrt(1-r.w*r.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=r.x/n,this.y=r.y/n,this.z=r.z/n),this},t.setAxisAngleFromRotationMatrix=function(r){var n,o,s,l,c=.01,p=.1,C=r.elements,S=C[0],T=C[4],O=C[8],P=C[1],k=C[5],W=C[9],V=C[2],B=C[6],ee=C[10];if(Math.abs(T-P)<c&&Math.abs(O-V)<c&&Math.abs(W-B)<c){if(Math.abs(T+P)<p&&Math.abs(O+V)<p&&Math.abs(W+B)<p&&Math.abs(S+k+ee-3)<p)return this.set(1,0,0,0),this;n=Math.PI;var ue=(S+1)/2,K=(k+1)/2,Q=(ee+1)/2,se=(T+P)/4,Me=(O+V)/4,xe=(W+B)/4;return ue>K&&ue>Q?ue<c?(o=0,s=.707106781,l=.707106781):(o=Math.sqrt(ue),s=se/o,l=Me/o):K>Q?K<c?(o=.707106781,s=0,l=.707106781):(s=Math.sqrt(K),o=se/s,l=xe/s):Q<c?(o=.707106781,s=.707106781,l=0):(l=Math.sqrt(Q),o=Me/l,s=xe/l),this.set(o,s,l,n),this}var _e=Math.sqrt((B-W)*(B-W)+(O-V)*(O-V)+(P-T)*(P-T));return Math.abs(_e)<.001&&(_e=1),this.x=(B-W)/_e,this.y=(O-V)/_e,this.z=(P-T)/_e,this.w=Math.acos((S+k+ee-1)/2),this},t.min=function(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this.z=Math.min(this.z,r.z),this.w=Math.min(this.w,r.w),this},t.max=function(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this.z=Math.max(this.z,r.z),this.w=Math.max(this.w,r.w),this},t.clamp=function(r,n){return this.x=Math.max(r.x,Math.min(n.x,this.x)),this.y=Math.max(r.y,Math.min(n.y,this.y)),this.z=Math.max(r.z,Math.min(n.z,this.z)),this.w=Math.max(r.w,Math.min(n.w,this.w)),this},t.clampScalar=function(r,n){return this.x=Math.max(r,Math.min(n,this.x)),this.y=Math.max(r,Math.min(n,this.y)),this.z=Math.max(r,Math.min(n,this.z)),this.w=Math.max(r,Math.min(n,this.w)),this},t.clampLength=function(r,n){var o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(r,Math.min(n,o)))},t.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},t.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},t.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},t.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},t.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},t.dot=function(r){return this.x*r.x+this.y*r.y+this.z*r.z+this.w*r.w},t.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},t.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},t.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},t.normalize=function(){return this.divideScalar(this.length()||1)},t.setLength=function(r){return this.normalize().multiplyScalar(r)},t.lerp=function(r,n){return this.x+=(r.x-this.x)*n,this.y+=(r.y-this.y)*n,this.z+=(r.z-this.z)*n,this.w+=(r.w-this.w)*n,this},t.lerpVectors=function(r,n,o){return this.x=r.x+(n.x-r.x)*o,this.y=r.y+(n.y-r.y)*o,this.z=r.z+(n.z-r.z)*o,this.w=r.w+(n.w-r.w)*o,this},t.equals=function(r){return r.x===this.x&&r.y===this.y&&r.z===this.z&&r.w===this.w},t.fromArray=function(r,n){return n===void 0&&(n=0),this.x=r[n],this.y=r[n+1],this.z=r[n+2],this.w=r[n+3],this},t.toArray=function(r,n){return r===void 0&&(r=[]),n===void 0&&(n=0),r[n]=this.x,r[n+1]=this.y,r[n+2]=this.z,r[n+3]=this.w,r},t.fromBufferAttribute=function(r,n,o){return o!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=r.getX(n),this.y=r.getY(n),this.z=r.getZ(n),this.w=r.getW(n),this},t.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this},ll(a,[{key:"width",get:function(){return this.z},set:function(r){this.z=r}},{key:"height",get:function(){return this.w},set:function(r){this.w=r}}]),a}(),Pa=function(a){Mr(t,a);function t(r,n,o){var s;return s=a.call(this)||this,Object.defineProperty(Ui(s),"isWebGLRenderTarget",{value:!0}),s.width=r,s.height=n,s.scissor=new rn(0,0,r,n),s.scissorTest=!1,s.viewport=new rn(0,0,r,n),o=o||{},s.texture=new ln(void 0,o.mapping,o.wrapS,o.wrapT,o.magFilter,o.minFilter,o.format,o.type,o.anisotropy,o.encoding),s.texture.image={},s.texture.image.width=r,s.texture.image.height=n,s.texture.generateMipmaps=o.generateMipmaps!==void 0?o.generateMipmaps:!1,s.texture.minFilter=o.minFilter!==void 0?o.minFilter:nt,s.depthBuffer=o.depthBuffer!==void 0?o.depthBuffer:!0,s.stencilBuffer=o.stencilBuffer!==void 0?o.stencilBuffer:!1,s.depthTexture=o.depthTexture!==void 0?o.depthTexture:null,s}var i=t.prototype;return i.setSize=function(n,o){(this.width!==n||this.height!==o)&&(this.width=n,this.height=o,this.texture.image.width=n,this.texture.image.height=o,this.dispose()),this.viewport.set(0,0,n,o),this.scissor.set(0,0,n,o)},i.clone=function(){return new this.constructor().copy(this)},i.copy=function(n){return this.width=n.width,this.height=n.height,this.viewport.copy(n.viewport),this.texture=n.texture.clone(),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.depthTexture=n.depthTexture,this},i.dispose=function(){this.dispatchEvent({type:"dispose"})},t}(ea),Qf=function(a){Mr(t,a);function t(r,n,o){var s;return s=a.call(this,r,n,o)||this,Object.defineProperty(Ui(s),"isWebGLMultisampleRenderTarget",{value:!0}),s.samples=4,s}var i=t.prototype;return i.copy=function(n){return a.prototype.copy.call(this,n),this.samples=n.samples,this},t}(Pa),Yn=function(){function a(i,r,n,o){i===void 0&&(i=0),r===void 0&&(r=0),n===void 0&&(n=0),o===void 0&&(o=1),Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=i,this._y=r,this._z=n,this._w=o}a.slerp=function(r,n,o,s){return o.copy(r).slerp(n,s)},a.slerpFlat=function(r,n,o,s,l,c,p){var C=o[s+0],S=o[s+1],T=o[s+2],O=o[s+3],P=l[c+0],k=l[c+1],W=l[c+2],V=l[c+3];if(O!==V||C!==P||S!==k||T!==W){var B=1-p,ee=C*P+S*k+T*W+O*V,ue=ee>=0?1:-1,K=1-ee*ee;if(K>Number.EPSILON){var Q=Math.sqrt(K),se=Math.atan2(Q,ee*ue);B=Math.sin(B*se)/Q,p=Math.sin(p*se)/Q}var Me=p*ue;if(C=C*B+P*Me,S=S*B+k*Me,T=T*B+W*Me,O=O*B+V*Me,B===1-p){var xe=1/Math.sqrt(C*C+S*S+T*T+O*O);C*=xe,S*=xe,T*=xe,O*=xe}}r[n]=C,r[n+1]=S,r[n+2]=T,r[n+3]=O},a.multiplyQuaternionsFlat=function(r,n,o,s,l,c){var p=o[s],C=o[s+1],S=o[s+2],T=o[s+3],O=l[c],P=l[c+1],k=l[c+2],W=l[c+3];return r[n]=p*W+T*O+C*k-S*P,r[n+1]=C*W+T*P+S*O-p*k,r[n+2]=S*W+T*k+p*P-C*O,r[n+3]=T*W-p*O-C*P-S*k,r};var t=a.prototype;return t.set=function(r,n,o,s){return this._x=r,this._y=n,this._z=o,this._w=s,this._onChangeCallback(),this},t.clone=function(){return new this.constructor(this._x,this._y,this._z,this._w)},t.copy=function(r){return this._x=r.x,this._y=r.y,this._z=r.z,this._w=r.w,this._onChangeCallback(),this},t.setFromEuler=function(r,n){if(!(r&&r.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var o=r._x,s=r._y,l=r._z,c=r._order,p=Math.cos,C=Math.sin,S=p(o/2),T=p(s/2),O=p(l/2),P=C(o/2),k=C(s/2),W=C(l/2);switch(c){case"XYZ":this._x=P*T*O+S*k*W,this._y=S*k*O-P*T*W,this._z=S*T*W+P*k*O,this._w=S*T*O-P*k*W;break;case"YXZ":this._x=P*T*O+S*k*W,this._y=S*k*O-P*T*W,this._z=S*T*W-P*k*O,this._w=S*T*O+P*k*W;break;case"ZXY":this._x=P*T*O-S*k*W,this._y=S*k*O+P*T*W,this._z=S*T*W+P*k*O,this._w=S*T*O-P*k*W;break;case"ZYX":this._x=P*T*O-S*k*W,this._y=S*k*O+P*T*W,this._z=S*T*W-P*k*O,this._w=S*T*O+P*k*W;break;case"YZX":this._x=P*T*O+S*k*W,this._y=S*k*O+P*T*W,this._z=S*T*W-P*k*O,this._w=S*T*O-P*k*W;break;case"XZY":this._x=P*T*O-S*k*W,this._y=S*k*O-P*T*W,this._z=S*T*W+P*k*O,this._w=S*T*O+P*k*W;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+c)}return n!==!1&&this._onChangeCallback(),this},t.setFromAxisAngle=function(r,n){var o=n/2,s=Math.sin(o);return this._x=r.x*s,this._y=r.y*s,this._z=r.z*s,this._w=Math.cos(o),this._onChangeCallback(),this},t.setFromRotationMatrix=function(r){var n=r.elements,o=n[0],s=n[4],l=n[8],c=n[1],p=n[5],C=n[9],S=n[2],T=n[6],O=n[10],P=o+p+O;if(P>0){var k=.5/Math.sqrt(P+1);this._w=.25/k,this._x=(T-C)*k,this._y=(l-S)*k,this._z=(c-s)*k}else if(o>p&&o>O){var W=2*Math.sqrt(1+o-p-O);this._w=(T-C)/W,this._x=.25*W,this._y=(s+c)/W,this._z=(l+S)/W}else if(p>O){var V=2*Math.sqrt(1+p-o-O);this._w=(l-S)/V,this._x=(s+c)/V,this._y=.25*V,this._z=(C+T)/V}else{var B=2*Math.sqrt(1+O-o-p);this._w=(c-s)/B,this._x=(l+S)/B,this._y=(C+T)/B,this._z=.25*B}return this._onChangeCallback(),this},t.setFromUnitVectors=function(r,n){var o=1e-6,s=r.dot(n)+1;return s<o?(s=0,Math.abs(r.x)>Math.abs(r.z)?(this._x=-r.y,this._y=r.x,this._z=0,this._w=s):(this._x=0,this._y=-r.z,this._z=r.y,this._w=s)):(this._x=r.y*n.z-r.z*n.y,this._y=r.z*n.x-r.x*n.z,this._z=r.x*n.y-r.y*n.x,this._w=s),this.normalize()},t.angleTo=function(r){return 2*Math.acos(Math.abs(dr.clamp(this.dot(r),-1,1)))},t.rotateTowards=function(r,n){var o=this.angleTo(r);if(o===0)return this;var s=Math.min(1,n/o);return this.slerp(r,s),this},t.identity=function(){return this.set(0,0,0,1)},t.invert=function(){return this.conjugate()},t.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},t.dot=function(r){return this._x*r._x+this._y*r._y+this._z*r._z+this._w*r._w},t.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},t.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},t.normalize=function(){var r=this.length();return r===0?(this._x=0,this._y=0,this._z=0,this._w=1):(r=1/r,this._x=this._x*r,this._y=this._y*r,this._z=this._z*r,this._w=this._w*r),this._onChangeCallback(),this},t.multiply=function(r,n){return n!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(r,n)):this.multiplyQuaternions(this,r)},t.premultiply=function(r){return this.multiplyQuaternions(r,this)},t.multiplyQuaternions=function(r,n){var o=r._x,s=r._y,l=r._z,c=r._w,p=n._x,C=n._y,S=n._z,T=n._w;return this._x=o*T+c*p+s*S-l*C,this._y=s*T+c*C+l*p-o*S,this._z=l*T+c*S+o*C-s*p,this._w=c*T-o*p-s*C-l*S,this._onChangeCallback(),this},t.slerp=function(r,n){if(n===0)return this;if(n===1)return this.copy(r);var o=this._x,s=this._y,l=this._z,c=this._w,p=c*r._w+o*r._x+s*r._y+l*r._z;if(p<0?(this._w=-r._w,this._x=-r._x,this._y=-r._y,this._z=-r._z,p=-p):this.copy(r),p>=1)return this._w=c,this._x=o,this._y=s,this._z=l,this;var C=1-p*p;if(C<=Number.EPSILON){var S=1-n;return this._w=S*c+n*this._w,this._x=S*o+n*this._x,this._y=S*s+n*this._y,this._z=S*l+n*this._z,this.normalize(),this._onChangeCallback(),this}var T=Math.sqrt(C),O=Math.atan2(T,p),P=Math.sin((1-n)*O)/T,k=Math.sin(n*O)/T;return this._w=c*P+this._w*k,this._x=o*P+this._x*k,this._y=s*P+this._y*k,this._z=l*P+this._z*k,this._onChangeCallback(),this},t.equals=function(r){return r._x===this._x&&r._y===this._y&&r._z===this._z&&r._w===this._w},t.fromArray=function(r,n){return n===void 0&&(n=0),this._x=r[n],this._y=r[n+1],this._z=r[n+2],this._w=r[n+3],this._onChangeCallback(),this},t.toArray=function(r,n){return r===void 0&&(r=[]),n===void 0&&(n=0),r[n]=this._x,r[n+1]=this._y,r[n+2]=this._z,r[n+3]=this._w,r},t.fromBufferAttribute=function(r,n){return this._x=r.getX(n),this._y=r.getY(n),this._z=r.getZ(n),this._w=r.getW(n),this},t._onChange=function(r){return this._onChangeCallback=r,this},t._onChangeCallback=function(){},ll(a,[{key:"x",get:function(){return this._x},set:function(r){this._x=r,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(r){this._y=r,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(r){this._z=r,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(r){this._w=r,this._onChangeCallback()}}]),a}(),de=function(){function a(i,r,n){i===void 0&&(i=0),r===void 0&&(r=0),n===void 0&&(n=0),Object.defineProperty(this,"isVector3",{value:!0}),this.x=i,this.y=r,this.z=n}var t=a.prototype;return t.set=function(r,n,o){return o===void 0&&(o=this.z),this.x=r,this.y=n,this.z=o,this},t.setScalar=function(r){return this.x=r,this.y=r,this.z=r,this},t.setX=function(r){return this.x=r,this},t.setY=function(r){return this.y=r,this},t.setZ=function(r){return this.z=r,this},t.setComponent=function(r,n){switch(r){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+r)}return this},t.getComponent=function(r){switch(r){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+r)}},t.clone=function(){return new this.constructor(this.x,this.y,this.z)},t.copy=function(r){return this.x=r.x,this.y=r.y,this.z=r.z,this},t.add=function(r,n){return n!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(r,n)):(this.x+=r.x,this.y+=r.y,this.z+=r.z,this)},t.addScalar=function(r){return this.x+=r,this.y+=r,this.z+=r,this},t.addVectors=function(r,n){return this.x=r.x+n.x,this.y=r.y+n.y,this.z=r.z+n.z,this},t.addScaledVector=function(r,n){return this.x+=r.x*n,this.y+=r.y*n,this.z+=r.z*n,this},t.sub=function(r,n){return n!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(r,n)):(this.x-=r.x,this.y-=r.y,this.z-=r.z,this)},t.subScalar=function(r){return this.x-=r,this.y-=r,this.z-=r,this},t.subVectors=function(r,n){return this.x=r.x-n.x,this.y=r.y-n.y,this.z=r.z-n.z,this},t.multiply=function(r,n){return n!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(r,n)):(this.x*=r.x,this.y*=r.y,this.z*=r.z,this)},t.multiplyScalar=function(r){return this.x*=r,this.y*=r,this.z*=r,this},t.multiplyVectors=function(r,n){return this.x=r.x*n.x,this.y=r.y*n.y,this.z=r.z*n.z,this},t.applyEuler=function(r){return r&&r.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(fh.setFromEuler(r))},t.applyAxisAngle=function(r,n){return this.applyQuaternion(fh.setFromAxisAngle(r,n))},t.applyMatrix3=function(r){var n=this.x,o=this.y,s=this.z,l=r.elements;return this.x=l[0]*n+l[3]*o+l[6]*s,this.y=l[1]*n+l[4]*o+l[7]*s,this.z=l[2]*n+l[5]*o+l[8]*s,this},t.applyNormalMatrix=function(r){return this.applyMatrix3(r).normalize()},t.applyMatrix4=function(r){var n=this.x,o=this.y,s=this.z,l=r.elements,c=1/(l[3]*n+l[7]*o+l[11]*s+l[15]);return this.x=(l[0]*n+l[4]*o+l[8]*s+l[12])*c,this.y=(l[1]*n+l[5]*o+l[9]*s+l[13])*c,this.z=(l[2]*n+l[6]*o+l[10]*s+l[14])*c,this},t.applyQuaternion=function(r){var n=this.x,o=this.y,s=this.z,l=r.x,c=r.y,p=r.z,C=r.w,S=C*n+c*s-p*o,T=C*o+p*n-l*s,O=C*s+l*o-c*n,P=-l*n-c*o-p*s;return this.x=S*C+P*-l+T*-p-O*-c,this.y=T*C+P*-c+O*-l-S*-p,this.z=O*C+P*-p+S*-c-T*-l,this},t.project=function(r){return this.applyMatrix4(r.matrixWorldInverse).applyMatrix4(r.projectionMatrix)},t.unproject=function(r){return this.applyMatrix4(r.projectionMatrixInverse).applyMatrix4(r.matrixWorld)},t.transformDirection=function(r){var n=this.x,o=this.y,s=this.z,l=r.elements;return this.x=l[0]*n+l[4]*o+l[8]*s,this.y=l[1]*n+l[5]*o+l[9]*s,this.z=l[2]*n+l[6]*o+l[10]*s,this.normalize()},t.divide=function(r){return this.x/=r.x,this.y/=r.y,this.z/=r.z,this},t.divideScalar=function(r){return this.multiplyScalar(1/r)},t.min=function(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this.z=Math.min(this.z,r.z),this},t.max=function(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this.z=Math.max(this.z,r.z),this},t.clamp=function(r,n){return this.x=Math.max(r.x,Math.min(n.x,this.x)),this.y=Math.max(r.y,Math.min(n.y,this.y)),this.z=Math.max(r.z,Math.min(n.z,this.z)),this},t.clampScalar=function(r,n){return this.x=Math.max(r,Math.min(n,this.x)),this.y=Math.max(r,Math.min(n,this.y)),this.z=Math.max(r,Math.min(n,this.z)),this},t.clampLength=function(r,n){var o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(r,Math.min(n,o)))},t.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},t.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},t.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},t.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},t.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},t.dot=function(r){return this.x*r.x+this.y*r.y+this.z*r.z},t.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},t.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},t.normalize=function(){return this.divideScalar(this.length()||1)},t.setLength=function(r){return this.normalize().multiplyScalar(r)},t.lerp=function(r,n){return this.x+=(r.x-this.x)*n,this.y+=(r.y-this.y)*n,this.z+=(r.z-this.z)*n,this},t.lerpVectors=function(r,n,o){return this.x=r.x+(n.x-r.x)*o,this.y=r.y+(n.y-r.y)*o,this.z=r.z+(n.z-r.z)*o,this},t.cross=function(r,n){return n!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(r,n)):this.crossVectors(this,r)},t.crossVectors=function(r,n){var o=r.x,s=r.y,l=r.z,c=n.x,p=n.y,C=n.z;return this.x=s*C-l*p,this.y=l*c-o*C,this.z=o*p-s*c,this},t.projectOnVector=function(r){var n=r.lengthSq();if(n===0)return this.set(0,0,0);var o=r.dot(this)/n;return this.copy(r).multiplyScalar(o)},t.projectOnPlane=function(r){return ku.copy(this).projectOnVector(r),this.sub(ku)},t.reflect=function(r){return this.sub(ku.copy(r).multiplyScalar(2*this.dot(r)))},t.angleTo=function(r){var n=Math.sqrt(this.lengthSq()*r.lengthSq());if(n===0)return Math.PI/2;var o=this.dot(r)/n;return Math.acos(dr.clamp(o,-1,1))},t.distanceTo=function(r){return Math.sqrt(this.distanceToSquared(r))},t.distanceToSquared=function(r){var n=this.x-r.x,o=this.y-r.y,s=this.z-r.z;return n*n+o*o+s*s},t.manhattanDistanceTo=function(r){return Math.abs(this.x-r.x)+Math.abs(this.y-r.y)+Math.abs(this.z-r.z)},t.setFromSpherical=function(r){return this.setFromSphericalCoords(r.radius,r.phi,r.theta)},t.setFromSphericalCoords=function(r,n,o){var s=Math.sin(n)*r;return this.x=s*Math.sin(o),this.y=Math.cos(n)*r,this.z=s*Math.cos(o),this},t.setFromCylindrical=function(r){return this.setFromCylindricalCoords(r.radius,r.theta,r.y)},t.setFromCylindricalCoords=function(r,n,o){return this.x=r*Math.sin(n),this.y=o,this.z=r*Math.cos(n),this},t.setFromMatrixPosition=function(r){var n=r.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this},t.setFromMatrixScale=function(r){var n=this.setFromMatrixColumn(r,0).length(),o=this.setFromMatrixColumn(r,1).length(),s=this.setFromMatrixColumn(r,2).length();return this.x=n,this.y=o,this.z=s,this},t.setFromMatrixColumn=function(r,n){return this.fromArray(r.elements,n*4)},t.setFromMatrix3Column=function(r,n){return this.fromArray(r.elements,n*3)},t.equals=function(r){return r.x===this.x&&r.y===this.y&&r.z===this.z},t.fromArray=function(r,n){return n===void 0&&(n=0),this.x=r[n],this.y=r[n+1],this.z=r[n+2],this},t.toArray=function(r,n){return r===void 0&&(r=[]),n===void 0&&(n=0),r[n]=this.x,r[n+1]=this.y,r[n+2]=this.z,r},t.fromBufferAttribute=function(r,n,o){return o!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=r.getX(n),this.y=r.getY(n),this.z=r.getZ(n),this},t.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this},a}(),ku=new de,fh=new Yn,pa=function(){function a(i,r){Object.defineProperty(this,"isBox3",{value:!0}),this.min=i!==void 0?i:new de(1/0,1/0,1/0),this.max=r!==void 0?r:new de(-1/0,-1/0,-1/0)}var t=a.prototype;return t.set=function(r,n){return this.min.copy(r),this.max.copy(n),this},t.setFromArray=function(r){for(var n=1/0,o=1/0,s=1/0,l=-1/0,c=-1/0,p=-1/0,C=0,S=r.length;C<S;C+=3){var T=r[C],O=r[C+1],P=r[C+2];T<n&&(n=T),O<o&&(o=O),P<s&&(s=P),T>l&&(l=T),O>c&&(c=O),P>p&&(p=P)}return this.min.set(n,o,s),this.max.set(l,c,p),this},t.setFromBufferAttribute=function(r){for(var n=1/0,o=1/0,s=1/0,l=-1/0,c=-1/0,p=-1/0,C=0,S=r.count;C<S;C++){var T=r.getX(C),O=r.getY(C),P=r.getZ(C);T<n&&(n=T),O<o&&(o=O),P<s&&(s=P),T>l&&(l=T),O>c&&(c=O),P>p&&(p=P)}return this.min.set(n,o,s),this.max.set(l,c,p),this},t.setFromPoints=function(r){this.makeEmpty();for(var n=0,o=r.length;n<o;n++)this.expandByPoint(r[n]);return this},t.setFromCenterAndSize=function(r,n){var o=ps.copy(n).multiplyScalar(.5);return this.min.copy(r).sub(o),this.max.copy(r).add(o),this},t.setFromObject=function(r){return this.makeEmpty(),this.expandByObject(r)},t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){return this.min.copy(r.min),this.max.copy(r.max),this},t.makeEmpty=function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},t.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},t.getCenter=function(r){return r===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),r=new de),this.isEmpty()?r.set(0,0,0):r.addVectors(this.min,this.max).multiplyScalar(.5)},t.getSize=function(r){return r===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),r=new de),this.isEmpty()?r.set(0,0,0):r.subVectors(this.max,this.min)},t.expandByPoint=function(r){return this.min.min(r),this.max.max(r),this},t.expandByVector=function(r){return this.min.sub(r),this.max.add(r),this},t.expandByScalar=function(r){return this.min.addScalar(-r),this.max.addScalar(r),this},t.expandByObject=function(r){r.updateWorldMatrix(!1,!1);var n=r.geometry;n!==void 0&&(n.boundingBox===null&&n.computeBoundingBox(),Hu.copy(n.boundingBox),Hu.applyMatrix4(r.matrixWorld),this.union(Hu));for(var o=r.children,s=0,l=o.length;s<l;s++)this.expandByObject(o[s]);return this},t.containsPoint=function(r){return!(r.x<this.min.x||r.x>this.max.x||r.y<this.min.y||r.y>this.max.y||r.z<this.min.z||r.z>this.max.z)},t.containsBox=function(r){return this.min.x<=r.min.x&&r.max.x<=this.max.x&&this.min.y<=r.min.y&&r.max.y<=this.max.y&&this.min.z<=r.min.z&&r.max.z<=this.max.z},t.getParameter=function(r,n){return n===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),n=new de),n.set((r.x-this.min.x)/(this.max.x-this.min.x),(r.y-this.min.y)/(this.max.y-this.min.y),(r.z-this.min.z)/(this.max.z-this.min.z))},t.intersectsBox=function(r){return!(r.max.x<this.min.x||r.min.x>this.max.x||r.max.y<this.min.y||r.min.y>this.max.y||r.max.z<this.min.z||r.min.z>this.max.z)},t.intersectsSphere=function(r){return this.clampPoint(r.center,ps),ps.distanceToSquared(r.center)<=r.radius*r.radius},t.intersectsPlane=function(r){var n,o;return r.normal.x>0?(n=r.normal.x*this.min.x,o=r.normal.x*this.max.x):(n=r.normal.x*this.max.x,o=r.normal.x*this.min.x),r.normal.y>0?(n+=r.normal.y*this.min.y,o+=r.normal.y*this.max.y):(n+=r.normal.y*this.max.y,o+=r.normal.y*this.min.y),r.normal.z>0?(n+=r.normal.z*this.min.z,o+=r.normal.z*this.max.z):(n+=r.normal.z*this.max.z,o+=r.normal.z*this.min.z),n<=-r.constant&&o>=-r.constant},t.intersectsTriangle=function(r){if(this.isEmpty())return!1;this.getCenter(vs),cl.subVectors(this.max,vs),Ro.subVectors(r.a,vs),Po.subVectors(r.b,vs),Do.subVectors(r.c,vs),Da.subVectors(Po,Ro),Oa.subVectors(Do,Po),ao.subVectors(Ro,Do);var n=[0,-Da.z,Da.y,0,-Oa.z,Oa.y,0,-ao.z,ao.y,Da.z,0,-Da.x,Oa.z,0,-Oa.x,ao.z,0,-ao.x,-Da.y,Da.x,0,-Oa.y,Oa.x,0,-ao.y,ao.x,0];return!Uu(n,Ro,Po,Do,cl)||(n=[1,0,0,0,1,0,0,0,1],!Uu(n,Ro,Po,Do,cl))?!1:(hl.crossVectors(Da,Oa),n=[hl.x,hl.y,hl.z],Uu(n,Ro,Po,Do,cl))},t.clampPoint=function(r,n){return n===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),n=new de),n.copy(r).clamp(this.min,this.max)},t.distanceToPoint=function(r){var n=ps.copy(r).clamp(this.min,this.max);return n.sub(r).length()},t.getBoundingSphere=function(r){return r===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(r.center),r.radius=this.getSize(ps).length()*.5,r},t.intersect=function(r){return this.min.max(r.min),this.max.min(r.max),this.isEmpty()&&this.makeEmpty(),this},t.union=function(r){return this.min.min(r.min),this.max.max(r.max),this},t.applyMatrix4=function(r){return this.isEmpty()?this:(va[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(r),va[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(r),va[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(r),va[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(r),va[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(r),va[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(r),va[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(r),va[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(r),this.setFromPoints(va),this)},t.translate=function(r){return this.min.add(r),this.max.add(r),this},t.equals=function(r){return r.min.equals(this.min)&&r.max.equals(this.max)},a}();function Uu(a,t,i,r,n){for(var o=0,s=a.length-3;o<=s;o+=3){oo.fromArray(a,o);var l=n.x*Math.abs(oo.x)+n.y*Math.abs(oo.y)+n.z*Math.abs(oo.z),c=t.dot(oo),p=i.dot(oo),C=r.dot(oo);if(Math.max(-Math.max(c,p,C),Math.min(c,p,C))>l)return!1}return!0}var va=[new de,new de,new de,new de,new de,new de,new de,new de],ps=new de,Hu=new pa,Ro=new de,Po=new de,Do=new de,Da=new de,Oa=new de,ao=new de,vs=new de,cl=new de,hl=new de,oo=new de,qf=new pa,Ia=function(){function a(i,r){this.center=i!==void 0?i:new de,this.radius=r!==void 0?r:-1}var t=a.prototype;return t.set=function(r,n){return this.center.copy(r),this.radius=n,this},t.setFromPoints=function(r,n){var o=this.center;n!==void 0?o.copy(n):qf.setFromPoints(r).getCenter(o);for(var s=0,l=0,c=r.length;l<c;l++)s=Math.max(s,o.distanceToSquared(r[l]));return this.radius=Math.sqrt(s),this},t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){return this.center.copy(r.center),this.radius=r.radius,this},t.isEmpty=function(){return this.radius<0},t.makeEmpty=function(){return this.center.set(0,0,0),this.radius=-1,this},t.containsPoint=function(r){return r.distanceToSquared(this.center)<=this.radius*this.radius},t.distanceToPoint=function(r){return r.distanceTo(this.center)-this.radius},t.intersectsSphere=function(r){var n=this.radius+r.radius;return r.center.distanceToSquared(this.center)<=n*n},t.intersectsBox=function(r){return r.intersectsSphere(this)},t.intersectsPlane=function(r){return Math.abs(r.distanceToPoint(this.center))<=this.radius},t.clampPoint=function(r,n){var o=this.center.distanceToSquared(r);return n===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),n=new de),n.copy(r),o>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},t.getBoundingBox=function(r){return r===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),r=new pa),this.isEmpty()?(r.makeEmpty(),r):(r.set(this.center,this.center),r.expandByScalar(this.radius),r)},t.applyMatrix4=function(r){return this.center.applyMatrix4(r),this.radius=this.radius*r.getMaxScaleOnAxis(),this},t.translate=function(r){return this.center.add(r),this},t.equals=function(r){return r.center.equals(this.center)&&r.radius===this.radius},a}(),ma=new de,Gu=new de,dl=new de,Ba=new de,Vu=new de,fl=new de,zu=new de,Oo=function(){function a(i,r){this.origin=i!==void 0?i:new de,this.direction=r!==void 0?r:new de(0,0,-1)}var t=a.prototype;return t.set=function(r,n){return this.origin.copy(r),this.direction.copy(n),this},t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){return this.origin.copy(r.origin),this.direction.copy(r.direction),this},t.at=function(r,n){return n===void 0&&(console.warn("THREE.Ray: .at() target is now required"),n=new de),n.copy(this.direction).multiplyScalar(r).add(this.origin)},t.lookAt=function(r){return this.direction.copy(r).sub(this.origin).normalize(),this},t.recast=function(r){return this.origin.copy(this.at(r,ma)),this},t.closestPointToPoint=function(r,n){n===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),n=new de),n.subVectors(r,this.origin);var o=n.dot(this.direction);return o<0?n.copy(this.origin):n.copy(this.direction).multiplyScalar(o).add(this.origin)},t.distanceToPoint=function(r){return Math.sqrt(this.distanceSqToPoint(r))},t.distanceSqToPoint=function(r){var n=ma.subVectors(r,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(r):(ma.copy(this.direction).multiplyScalar(n).add(this.origin),ma.distanceToSquared(r))},t.distanceSqToSegment=function(r,n,o,s){Gu.copy(r).add(n).multiplyScalar(.5),dl.copy(n).sub(r).normalize(),Ba.copy(this.origin).sub(Gu);var l=r.distanceTo(n)*.5,c=-this.direction.dot(dl),p=Ba.dot(this.direction),C=-Ba.dot(dl),S=Ba.lengthSq(),T=Math.abs(1-c*c),O,P,k,W;if(T>0)if(O=c*C-p,P=c*p-C,W=l*T,O>=0)if(P>=-W)if(P<=W){var V=1/T;O*=V,P*=V,k=O*(O+c*P+2*p)+P*(c*O+P+2*C)+S}else P=l,O=Math.max(0,-(c*P+p)),k=-O*O+P*(P+2*C)+S;else P=-l,O=Math.max(0,-(c*P+p)),k=-O*O+P*(P+2*C)+S;else P<=-W?(O=Math.max(0,-(-c*l+p)),P=O>0?-l:Math.min(Math.max(-l,-C),l),k=-O*O+P*(P+2*C)+S):P<=W?(O=0,P=Math.min(Math.max(-l,-C),l),k=P*(P+2*C)+S):(O=Math.max(0,-(c*l+p)),P=O>0?l:Math.min(Math.max(-l,-C),l),k=-O*O+P*(P+2*C)+S);else P=c>0?-l:l,O=Math.max(0,-(c*P+p)),k=-O*O+P*(P+2*C)+S;return o&&o.copy(this.direction).multiplyScalar(O).add(this.origin),s&&s.copy(dl).multiplyScalar(P).add(Gu),k},t.intersectSphere=function(r,n){ma.subVectors(r.center,this.origin);var o=ma.dot(this.direction),s=ma.dot(ma)-o*o,l=r.radius*r.radius;if(s>l)return null;var c=Math.sqrt(l-s),p=o-c,C=o+c;return p<0&&C<0?null:p<0?this.at(C,n):this.at(p,n)},t.intersectsSphere=function(r){return this.distanceSqToPoint(r.center)<=r.radius*r.radius},t.distanceToPlane=function(r){var n=r.normal.dot(this.direction);if(n===0)return r.distanceToPoint(this.origin)===0?0:null;var o=-(this.origin.dot(r.normal)+r.constant)/n;return o>=0?o:null},t.intersectPlane=function(r,n){var o=this.distanceToPlane(r);return o===null?null:this.at(o,n)},t.intersectsPlane=function(r){var n=r.distanceToPoint(this.origin);if(n===0)return!0;var o=r.normal.dot(this.direction);return o*n<0},t.intersectBox=function(r,n){var o,s,l,c,p,C,S=1/this.direction.x,T=1/this.direction.y,O=1/this.direction.z,P=this.origin;return S>=0?(o=(r.min.x-P.x)*S,s=(r.max.x-P.x)*S):(o=(r.max.x-P.x)*S,s=(r.min.x-P.x)*S),T>=0?(l=(r.min.y-P.y)*T,c=(r.max.y-P.y)*T):(l=(r.max.y-P.y)*T,c=(r.min.y-P.y)*T),o>c||l>s||((l>o||o!==o)&&(o=l),(c<s||s!==s)&&(s=c),O>=0?(p=(r.min.z-P.z)*O,C=(r.max.z-P.z)*O):(p=(r.max.z-P.z)*O,C=(r.min.z-P.z)*O),o>C||p>s)||((p>o||o!==o)&&(o=p),(C<s||s!==s)&&(s=C),s<0)?null:this.at(o>=0?o:s,n)},t.intersectsBox=function(r){return this.intersectBox(r,ma)!==null},t.intersectTriangle=function(r,n,o,s,l){Vu.subVectors(n,r),fl.subVectors(o,r),zu.crossVectors(Vu,fl);var c=this.direction.dot(zu),p;if(c>0){if(s)return null;p=1}else if(c<0)p=-1,c=-c;else return null;Ba.subVectors(this.origin,r);var C=p*this.direction.dot(fl.crossVectors(Ba,fl));if(C<0)return null;var S=p*this.direction.dot(Vu.cross(Ba));if(S<0||C+S>c)return null;var T=-p*Ba.dot(zu);return T<0?null:this.at(T/c,l)},t.applyMatrix4=function(r){return this.origin.applyMatrix4(r),this.direction.transformDirection(r),this},t.equals=function(r){return r.origin.equals(this.origin)&&r.direction.equals(this.direction)},a}(),Lr=function(){function a(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}var t=a.prototype;return t.set=function(r,n,o,s,l,c,p,C,S,T,O,P,k,W,V,B){var ee=this.elements;return ee[0]=r,ee[4]=n,ee[8]=o,ee[12]=s,ee[1]=l,ee[5]=c,ee[9]=p,ee[13]=C,ee[2]=S,ee[6]=T,ee[10]=O,ee[14]=P,ee[3]=k,ee[7]=W,ee[11]=V,ee[15]=B,this},t.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},t.clone=function(){return new a().fromArray(this.elements)},t.copy=function(r){var n=this.elements,o=r.elements;return n[0]=o[0],n[1]=o[1],n[2]=o[2],n[3]=o[3],n[4]=o[4],n[5]=o[5],n[6]=o[6],n[7]=o[7],n[8]=o[8],n[9]=o[9],n[10]=o[10],n[11]=o[11],n[12]=o[12],n[13]=o[13],n[14]=o[14],n[15]=o[15],this},t.copyPosition=function(r){var n=this.elements,o=r.elements;return n[12]=o[12],n[13]=o[13],n[14]=o[14],this},t.setFromMatrix3=function(r){var n=r.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this},t.extractBasis=function(r,n,o){return r.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),o.setFromMatrixColumn(this,2),this},t.makeBasis=function(r,n,o){return this.set(r.x,n.x,o.x,0,r.y,n.y,o.y,0,r.z,n.z,o.z,0,0,0,0,1),this},t.extractRotation=function(r){var n=this.elements,o=r.elements,s=1/Io.setFromMatrixColumn(r,0).length(),l=1/Io.setFromMatrixColumn(r,1).length(),c=1/Io.setFromMatrixColumn(r,2).length();return n[0]=o[0]*s,n[1]=o[1]*s,n[2]=o[2]*s,n[3]=0,n[4]=o[4]*l,n[5]=o[5]*l,n[6]=o[6]*l,n[7]=0,n[8]=o[8]*c,n[9]=o[9]*c,n[10]=o[10]*c,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this},t.makeRotationFromEuler=function(r){r&&r.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var n=this.elements,o=r.x,s=r.y,l=r.z,c=Math.cos(o),p=Math.sin(o),C=Math.cos(s),S=Math.sin(s),T=Math.cos(l),O=Math.sin(l);if(r.order==="XYZ"){var P=c*T,k=c*O,W=p*T,V=p*O;n[0]=C*T,n[4]=-C*O,n[8]=S,n[1]=k+W*S,n[5]=P-V*S,n[9]=-p*C,n[2]=V-P*S,n[6]=W+k*S,n[10]=c*C}else if(r.order==="YXZ"){var B=C*T,ee=C*O,ue=S*T,K=S*O;n[0]=B+K*p,n[4]=ue*p-ee,n[8]=c*S,n[1]=c*O,n[5]=c*T,n[9]=-p,n[2]=ee*p-ue,n[6]=K+B*p,n[10]=c*C}else if(r.order==="ZXY"){var Q=C*T,se=C*O,Me=S*T,xe=S*O;n[0]=Q-xe*p,n[4]=-c*O,n[8]=Me+se*p,n[1]=se+Me*p,n[5]=c*T,n[9]=xe-Q*p,n[2]=-c*S,n[6]=p,n[10]=c*C}else if(r.order==="ZYX"){var _e=c*T,Pe=c*O,Ce=p*T,Ae=p*O;n[0]=C*T,n[4]=Ce*S-Pe,n[8]=_e*S+Ae,n[1]=C*O,n[5]=Ae*S+_e,n[9]=Pe*S-Ce,n[2]=-S,n[6]=p*C,n[10]=c*C}else if(r.order==="YZX"){var Be=c*C,Se=c*S,Te=p*C,me=p*S;n[0]=C*T,n[4]=me-Be*O,n[8]=Te*O+Se,n[1]=O,n[5]=c*T,n[9]=-p*T,n[2]=-S*T,n[6]=Se*O+Te,n[10]=Be-me*O}else if(r.order==="XZY"){var Ue=c*C,He=c*S,Ye=p*C,Qe=p*S;n[0]=C*T,n[4]=-O,n[8]=S*T,n[1]=Ue*O+Qe,n[5]=c*T,n[9]=He*O-Ye,n[2]=Ye*O-He,n[6]=p*T,n[10]=Qe*O+Ue}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this},t.makeRotationFromQuaternion=function(r){return this.compose(Jf,r,Zf)},t.lookAt=function(r,n,o){var s=this.elements;return Ai.subVectors(r,n),Ai.lengthSq()===0&&(Ai.z=1),Ai.normalize(),Fa.crossVectors(o,Ai),Fa.lengthSq()===0&&(Math.abs(o.z)===1?Ai.x+=1e-4:Ai.z+=1e-4,Ai.normalize(),Fa.crossVectors(o,Ai)),Fa.normalize(),pl.crossVectors(Ai,Fa),s[0]=Fa.x,s[4]=pl.x,s[8]=Ai.x,s[1]=Fa.y,s[5]=pl.y,s[9]=Ai.y,s[2]=Fa.z,s[6]=pl.z,s[10]=Ai.z,this},t.multiply=function(r,n){return n!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(r,n)):this.multiplyMatrices(this,r)},t.premultiply=function(r){return this.multiplyMatrices(r,this)},t.multiplyMatrices=function(r,n){var o=r.elements,s=n.elements,l=this.elements,c=o[0],p=o[4],C=o[8],S=o[12],T=o[1],O=o[5],P=o[9],k=o[13],W=o[2],V=o[6],B=o[10],ee=o[14],ue=o[3],K=o[7],Q=o[11],se=o[15],Me=s[0],xe=s[4],_e=s[8],Pe=s[12],Ce=s[1],Ae=s[5],Be=s[9],Se=s[13],Te=s[2],me=s[6],Ue=s[10],He=s[14],Ye=s[3],Qe=s[7],pt=s[11],Et=s[15];return l[0]=c*Me+p*Ce+C*Te+S*Ye,l[4]=c*xe+p*Ae+C*me+S*Qe,l[8]=c*_e+p*Be+C*Ue+S*pt,l[12]=c*Pe+p*Se+C*He+S*Et,l[1]=T*Me+O*Ce+P*Te+k*Ye,l[5]=T*xe+O*Ae+P*me+k*Qe,l[9]=T*_e+O*Be+P*Ue+k*pt,l[13]=T*Pe+O*Se+P*He+k*Et,l[2]=W*Me+V*Ce+B*Te+ee*Ye,l[6]=W*xe+V*Ae+B*me+ee*Qe,l[10]=W*_e+V*Be+B*Ue+ee*pt,l[14]=W*Pe+V*Se+B*He+ee*Et,l[3]=ue*Me+K*Ce+Q*Te+se*Ye,l[7]=ue*xe+K*Ae+Q*me+se*Qe,l[11]=ue*_e+K*Be+Q*Ue+se*pt,l[15]=ue*Pe+K*Se+Q*He+se*Et,this},t.multiplyScalar=function(r){var n=this.elements;return n[0]*=r,n[4]*=r,n[8]*=r,n[12]*=r,n[1]*=r,n[5]*=r,n[9]*=r,n[13]*=r,n[2]*=r,n[6]*=r,n[10]*=r,n[14]*=r,n[3]*=r,n[7]*=r,n[11]*=r,n[15]*=r,this},t.determinant=function(){var r=this.elements,n=r[0],o=r[4],s=r[8],l=r[12],c=r[1],p=r[5],C=r[9],S=r[13],T=r[2],O=r[6],P=r[10],k=r[14],W=r[3],V=r[7],B=r[11],ee=r[15];return W*(+l*C*O-s*S*O-l*p*P+o*S*P+s*p*k-o*C*k)+V*(+n*C*k-n*S*P+l*c*P-s*c*k+s*S*T-l*C*T)+B*(+n*S*O-n*p*k-l*c*O+o*c*k+l*p*T-o*S*T)+ee*(-s*p*T-n*C*O+n*p*P+s*c*O-o*c*P+o*C*T)},t.transpose=function(){var r=this.elements,n;return n=r[1],r[1]=r[4],r[4]=n,n=r[2],r[2]=r[8],r[8]=n,n=r[6],r[6]=r[9],r[9]=n,n=r[3],r[3]=r[12],r[12]=n,n=r[7],r[7]=r[13],r[13]=n,n=r[11],r[11]=r[14],r[14]=n,this},t.setPosition=function(r,n,o){var s=this.elements;return r.isVector3?(s[12]=r.x,s[13]=r.y,s[14]=r.z):(s[12]=r,s[13]=n,s[14]=o),this},t.invert=function(){var r=this.elements,n=r[0],o=r[1],s=r[2],l=r[3],c=r[4],p=r[5],C=r[6],S=r[7],T=r[8],O=r[9],P=r[10],k=r[11],W=r[12],V=r[13],B=r[14],ee=r[15],ue=O*B*S-V*P*S+V*C*k-p*B*k-O*C*ee+p*P*ee,K=W*P*S-T*B*S-W*C*k+c*B*k+T*C*ee-c*P*ee,Q=T*V*S-W*O*S+W*p*k-c*V*k-T*p*ee+c*O*ee,se=W*O*C-T*V*C-W*p*P+c*V*P+T*p*B-c*O*B,Me=n*ue+o*K+s*Q+l*se;if(Me===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var xe=1/Me;return r[0]=ue*xe,r[1]=(V*P*l-O*B*l-V*s*k+o*B*k+O*s*ee-o*P*ee)*xe,r[2]=(p*B*l-V*C*l+V*s*S-o*B*S-p*s*ee+o*C*ee)*xe,r[3]=(O*C*l-p*P*l-O*s*S+o*P*S+p*s*k-o*C*k)*xe,r[4]=K*xe,r[5]=(T*B*l-W*P*l+W*s*k-n*B*k-T*s*ee+n*P*ee)*xe,r[6]=(W*C*l-c*B*l-W*s*S+n*B*S+c*s*ee-n*C*ee)*xe,r[7]=(c*P*l-T*C*l+T*s*S-n*P*S-c*s*k+n*C*k)*xe,r[8]=Q*xe,r[9]=(W*O*l-T*V*l-W*o*k+n*V*k+T*o*ee-n*O*ee)*xe,r[10]=(c*V*l-W*p*l+W*o*S-n*V*S-c*o*ee+n*p*ee)*xe,r[11]=(T*p*l-c*O*l-T*o*S+n*O*S+c*o*k-n*p*k)*xe,r[12]=se*xe,r[13]=(T*V*s-W*O*s+W*o*P-n*V*P-T*o*B+n*O*B)*xe,r[14]=(W*p*s-c*V*s-W*o*C+n*V*C+c*o*B-n*p*B)*xe,r[15]=(c*O*s-T*p*s+T*o*C-n*O*C-c*o*P+n*p*P)*xe,this},t.scale=function(r){var n=this.elements,o=r.x,s=r.y,l=r.z;return n[0]*=o,n[4]*=s,n[8]*=l,n[1]*=o,n[5]*=s,n[9]*=l,n[2]*=o,n[6]*=s,n[10]*=l,n[3]*=o,n[7]*=s,n[11]*=l,this},t.getMaxScaleOnAxis=function(){var r=this.elements,n=r[0]*r[0]+r[1]*r[1]+r[2]*r[2],o=r[4]*r[4]+r[5]*r[5]+r[6]*r[6],s=r[8]*r[8]+r[9]*r[9]+r[10]*r[10];return Math.sqrt(Math.max(n,o,s))},t.makeTranslation=function(r,n,o){return this.set(1,0,0,r,0,1,0,n,0,0,1,o,0,0,0,1),this},t.makeRotationX=function(r){var n=Math.cos(r),o=Math.sin(r);return this.set(1,0,0,0,0,n,-o,0,0,o,n,0,0,0,0,1),this},t.makeRotationY=function(r){var n=Math.cos(r),o=Math.sin(r);return this.set(n,0,o,0,0,1,0,0,-o,0,n,0,0,0,0,1),this},t.makeRotationZ=function(r){var n=Math.cos(r),o=Math.sin(r);return this.set(n,-o,0,0,o,n,0,0,0,0,1,0,0,0,0,1),this},t.makeRotationAxis=function(r,n){var o=Math.cos(n),s=Math.sin(n),l=1-o,c=r.x,p=r.y,C=r.z,S=l*c,T=l*p;return this.set(S*c+o,S*p-s*C,S*C+s*p,0,S*p+s*C,T*p+o,T*C-s*c,0,S*C-s*p,T*C+s*c,l*C*C+o,0,0,0,0,1),this},t.makeScale=function(r,n,o){return this.set(r,0,0,0,0,n,0,0,0,0,o,0,0,0,0,1),this},t.makeShear=function(r,n,o){return this.set(1,n,o,0,r,1,o,0,r,n,1,0,0,0,0,1),this},t.compose=function(r,n,o){var s=this.elements,l=n._x,c=n._y,p=n._z,C=n._w,S=l+l,T=c+c,O=p+p,P=l*S,k=l*T,W=l*O,V=c*T,B=c*O,ee=p*O,ue=C*S,K=C*T,Q=C*O,se=o.x,Me=o.y,xe=o.z;return s[0]=(1-(V+ee))*se,s[1]=(k+Q)*se,s[2]=(W-K)*se,s[3]=0,s[4]=(k-Q)*Me,s[5]=(1-(P+ee))*Me,s[6]=(B+ue)*Me,s[7]=0,s[8]=(W+K)*xe,s[9]=(B-ue)*xe,s[10]=(1-(P+V))*xe,s[11]=0,s[12]=r.x,s[13]=r.y,s[14]=r.z,s[15]=1,this},t.decompose=function(r,n,o){var s=this.elements,l=Io.set(s[0],s[1],s[2]).length(),c=Io.set(s[4],s[5],s[6]).length(),p=Io.set(s[8],s[9],s[10]).length(),C=this.determinant();C<0&&(l=-l),r.x=s[12],r.y=s[13],r.z=s[14],Hi.copy(this);var S=1/l,T=1/c,O=1/p;return Hi.elements[0]*=S,Hi.elements[1]*=S,Hi.elements[2]*=S,Hi.elements[4]*=T,Hi.elements[5]*=T,Hi.elements[6]*=T,Hi.elements[8]*=O,Hi.elements[9]*=O,Hi.elements[10]*=O,n.setFromRotationMatrix(Hi),o.x=l,o.y=c,o.z=p,this},t.makePerspective=function(r,n,o,s,l,c){c===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var p=this.elements,C=2*l/(n-r),S=2*l/(o-s),T=(n+r)/(n-r),O=(o+s)/(o-s),P=-(c+l)/(c-l),k=-2*c*l/(c-l);return p[0]=C,p[4]=0,p[8]=T,p[12]=0,p[1]=0,p[5]=S,p[9]=O,p[13]=0,p[2]=0,p[6]=0,p[10]=P,p[14]=k,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this},t.makeOrthographic=function(r,n,o,s,l,c){var p=this.elements,C=1/(n-r),S=1/(o-s),T=1/(c-l),O=(n+r)*C,P=(o+s)*S,k=(c+l)*T;return p[0]=2*C,p[4]=0,p[8]=0,p[12]=-O,p[1]=0,p[5]=2*S,p[9]=0,p[13]=-P,p[2]=0,p[6]=0,p[10]=-2*T,p[14]=-k,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this},t.equals=function(r){for(var n=this.elements,o=r.elements,s=0;s<16;s++)if(n[s]!==o[s])return!1;return!0},t.fromArray=function(r,n){n===void 0&&(n=0);for(var o=0;o<16;o++)this.elements[o]=r[o+n];return this},t.toArray=function(r,n){r===void 0&&(r=[]),n===void 0&&(n=0);var o=this.elements;return r[n]=o[0],r[n+1]=o[1],r[n+2]=o[2],r[n+3]=o[3],r[n+4]=o[4],r[n+5]=o[5],r[n+6]=o[6],r[n+7]=o[7],r[n+8]=o[8],r[n+9]=o[9],r[n+10]=o[10],r[n+11]=o[11],r[n+12]=o[12],r[n+13]=o[13],r[n+14]=o[14],r[n+15]=o[15],r},a}(),Io=new de,Hi=new Lr,Jf=new de(0,0,0),Zf=new de(1,1,1),Fa=new de,pl=new de,Ai=new de,vl=function(){function a(i,r,n,o){i===void 0&&(i=0),r===void 0&&(r=0),n===void 0&&(n=0),o===void 0&&(o=a.DefaultOrder),Object.defineProperty(this,"isEuler",{value:!0}),this._x=i,this._y=r,this._z=n,this._order=o}var t=a.prototype;return t.set=function(r,n,o,s){return this._x=r,this._y=n,this._z=o,this._order=s||this._order,this._onChangeCallback(),this},t.clone=function(){return new this.constructor(this._x,this._y,this._z,this._order)},t.copy=function(r){return this._x=r._x,this._y=r._y,this._z=r._z,this._order=r._order,this._onChangeCallback(),this},t.setFromRotationMatrix=function(r,n,o){var s=dr.clamp,l=r.elements,c=l[0],p=l[4],C=l[8],S=l[1],T=l[5],O=l[9],P=l[2],k=l[6],W=l[10];switch(n=n||this._order,n){case"XYZ":this._y=Math.asin(s(C,-1,1)),Math.abs(C)<.9999999?(this._x=Math.atan2(-O,W),this._z=Math.atan2(-p,c)):(this._x=Math.atan2(k,T),this._z=0);break;case"YXZ":this._x=Math.asin(-s(O,-1,1)),Math.abs(O)<.9999999?(this._y=Math.atan2(C,W),this._z=Math.atan2(S,T)):(this._y=Math.atan2(-P,c),this._z=0);break;case"ZXY":this._x=Math.asin(s(k,-1,1)),Math.abs(k)<.9999999?(this._y=Math.atan2(-P,W),this._z=Math.atan2(-p,T)):(this._y=0,this._z=Math.atan2(S,c));break;case"ZYX":this._y=Math.asin(-s(P,-1,1)),Math.abs(P)<.9999999?(this._x=Math.atan2(k,W),this._z=Math.atan2(S,c)):(this._x=0,this._z=Math.atan2(-p,T));break;case"YZX":this._z=Math.asin(s(S,-1,1)),Math.abs(S)<.9999999?(this._x=Math.atan2(-O,T),this._y=Math.atan2(-P,c)):(this._x=0,this._y=Math.atan2(C,W));break;case"XZY":this._z=Math.asin(-s(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(k,T),this._y=Math.atan2(C,c)):(this._x=Math.atan2(-O,W),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,o!==!1&&this._onChangeCallback(),this},t.setFromQuaternion=function(r,n,o){return ph.makeRotationFromQuaternion(r),this.setFromRotationMatrix(ph,n,o)},t.setFromVector3=function(r,n){return this.set(r.x,r.y,r.z,n||this._order)},t.reorder=function(r){return vh.setFromEuler(this),this.setFromQuaternion(vh,r)},t.equals=function(r){return r._x===this._x&&r._y===this._y&&r._z===this._z&&r._order===this._order},t.fromArray=function(r){return this._x=r[0],this._y=r[1],this._z=r[2],r[3]!==void 0&&(this._order=r[3]),this._onChangeCallback(),this},t.toArray=function(r,n){return r===void 0&&(r=[]),n===void 0&&(n=0),r[n]=this._x,r[n+1]=this._y,r[n+2]=this._z,r[n+3]=this._order,r},t.toVector3=function(r){return r?r.set(this._x,this._y,this._z):new de(this._x,this._y,this._z)},t._onChange=function(r){return this._onChangeCallback=r,this},t._onChangeCallback=function(){},ll(a,[{key:"x",get:function(){return this._x},set:function(r){this._x=r,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(r){this._y=r,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(r){this._z=r,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(r){this._order=r,this._onChangeCallback()}}]),a}();vl.DefaultOrder="XYZ",vl.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var ph=new Lr,vh=new Yn,Wu=function(){function a(){this.mask=1|0}var t=a.prototype;return t.set=function(r){this.mask=1<<r|0},t.enable=function(r){this.mask|=1<<r|0},t.enableAll=function(){this.mask=4294967295|0},t.toggle=function(r){this.mask^=1<<r|0},t.disable=function(r){this.mask&=~(1<<r|0)},t.disableAll=function(){this.mask=0},t.test=function(r){return(this.mask&r.mask)!=0},a}(),Kf=0,mh=new de,Bo=new Yn,ga=new Lr,ml=new de,ms=new de,$f=new de,ep=new Yn,gh=new de(1,0,0),yh=new de(0,1,0),Ah=new de(0,0,1),tp={type:"added"},bh={type:"removed"};function Xt(){Object.defineProperty(this,"id",{value:Kf++}),this.uuid=dr.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Xt.DefaultUp.clone();var a=new de,t=new vl,i=new Yn,r=new de(1,1,1);function n(){i.setFromEuler(t,!1)}function o(){t.setFromQuaternion(i,void 0,!1)}t._onChange(n),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:a},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Lr},normalMatrix:{value:new yi}}),this.matrix=new Lr,this.matrixWorld=new Lr,this.matrixAutoUpdate=Xt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Wu,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}Xt.DefaultUp=new de(0,1,0),Xt.DefaultMatrixAutoUpdate=!0,Xt.prototype=Object.assign(Object.create(ea.prototype),{constructor:Xt,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,i){this.quaternion.setFromAxisAngle(t,i)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,i){return Bo.setFromAxisAngle(t,i),this.quaternion.multiply(Bo),this},rotateOnWorldAxis:function(t,i){return Bo.setFromAxisAngle(t,i),this.quaternion.premultiply(Bo),this},rotateX:function(t){return this.rotateOnAxis(gh,t)},rotateY:function(t){return this.rotateOnAxis(yh,t)},rotateZ:function(t){return this.rotateOnAxis(Ah,t)},translateOnAxis:function(t,i){return mh.copy(t).applyQuaternion(this.quaternion),this.position.add(mh.multiplyScalar(i)),this},translateX:function(t){return this.translateOnAxis(gh,t)},translateY:function(t){return this.translateOnAxis(yh,t)},translateZ:function(t){return this.translateOnAxis(Ah,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(ga.copy(this.matrixWorld).invert())},lookAt:function(t,i,r){t.isVector3?ml.copy(t):ml.set(t,i,r);var n=this.parent;this.updateWorldMatrix(!0,!1),ms.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ga.lookAt(ms,ml,this.up):ga.lookAt(ml,ms,this.up),this.quaternion.setFromRotationMatrix(ga),n&&(ga.extractRotation(n.matrixWorld),Bo.setFromRotationMatrix(ga),this.quaternion.premultiply(Bo.invert()))},add:function(t){if(arguments.length>1){for(var i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(tp)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}var r=this.children.indexOf(t);return r!==-1&&(t.parent=null,this.children.splice(r,1),t.dispatchEvent(bh)),this},clear:function(){for(var t=0;t<this.children.length;t++){var i=this.children[t];i.parent=null,i.dispatchEvent(bh)}return this.children.length=0,this},attach:function(t){return this.updateWorldMatrix(!0,!1),ga.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),ga.multiply(t.parent.matrixWorld)),t.applyMatrix4(ga),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,i){if(this[t]===i)return this;for(var r=0,n=this.children.length;r<n;r++){var o=this.children[r],s=o.getObjectByProperty(t,i);if(s!==void 0)return s}},getWorldPosition:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new de),this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new Yn),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ms,t,$f),t},getWorldScale:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new de),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ms,ep,t),t},getWorldDirection:function(t){t===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new de),this.updateWorldMatrix(!0,!1);var i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var i=this.children,r=0,n=i.length;r<n;r++)i[r].traverse(t)},traverseVisible:function(t){if(this.visible!==!1){t(this);for(var i=this.children,r=0,n=i.length;r<n;r++)i[r].traverseVisible(t)}},traverseAncestors:function(t){var i=this.parent;i!==null&&(t(i),i.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var i=this.children,r=0,n=i.length;r<n;r++)i[r].updateMatrixWorld(t)},updateWorldMatrix:function(t,i){var r=this.parent;if(t===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0)for(var n=this.children,o=0,s=n.length;o<s;o++)n[o].updateWorldMatrix(!1,!0)},toJSON:function(t){var i=t===void 0||typeof t=="string",r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON());function o(xe,_e){return xe[_e.uuid]===void 0&&(xe[_e.uuid]=_e.toJSON(t)),_e.uuid}if(this.isMesh||this.isLine||this.isPoints){n.geometry=o(t.geometries,this.geometry);var s=this.geometry.parameters;if(s!==void 0&&s.shapes!==void 0){var l=s.shapes;if(Array.isArray(l))for(var c=0,p=l.length;c<p;c++){var C=l[c];o(t.shapes,C)}else o(t.shapes,l)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(t.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){for(var S=[],T=0,O=this.material.length;T<O;T++)S.push(o(t.materials,this.material[T]));n.material=S}else n.material=o(t.materials,this.material);if(this.children.length>0){n.children=[];for(var P=0;P<this.children.length;P++)n.children.push(this.children[P].toJSON(t).object)}if(this.animations.length>0){n.animations=[];for(var k=0;k<this.animations.length;k++){var W=this.animations[k];n.animations.push(o(t.animations,W))}}if(i){var V=Me(t.geometries),B=Me(t.materials),ee=Me(t.textures),ue=Me(t.images),K=Me(t.shapes),Q=Me(t.skeletons),se=Me(t.animations);V.length>0&&(r.geometries=V),B.length>0&&(r.materials=B),ee.length>0&&(r.textures=ee),ue.length>0&&(r.images=ue),K.length>0&&(r.shapes=K),Q.length>0&&(r.skeletons=Q),se.length>0&&(r.animations=se)}return r.object=n,r;function Me(xe){var _e=[];for(var Pe in xe){var Ce=xe[Pe];delete Ce.metadata,_e.push(Ce)}return _e}},clone:function(t){return new this.constructor().copy(this,t)},copy:function(t,i){if(i===void 0&&(i=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),i===!0)for(var r=0;r<t.children.length;r++){var n=t.children[r];this.add(n.clone())}return this}});var ju=new de,rp=new de,np=new yi,ta=function(){function a(i,r){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=i!==void 0?i:new de(1,0,0),this.constant=r!==void 0?r:0}var t=a.prototype;return t.set=function(r,n){return this.normal.copy(r),this.constant=n,this},t.setComponents=function(r,n,o,s){return this.normal.set(r,n,o),this.constant=s,this},t.setFromNormalAndCoplanarPoint=function(r,n){return this.normal.copy(r),this.constant=-n.dot(this.normal),this},t.setFromCoplanarPoints=function(r,n,o){var s=ju.subVectors(o,n).cross(rp.subVectors(r,n)).normalize();return this.setFromNormalAndCoplanarPoint(s,r),this},t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){return this.normal.copy(r.normal),this.constant=r.constant,this},t.normalize=function(){var r=1/this.normal.length();return this.normal.multiplyScalar(r),this.constant*=r,this},t.negate=function(){return this.constant*=-1,this.normal.negate(),this},t.distanceToPoint=function(r){return this.normal.dot(r)+this.constant},t.distanceToSphere=function(r){return this.distanceToPoint(r.center)-r.radius},t.projectPoint=function(r,n){return n===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),n=new de),n.copy(this.normal).multiplyScalar(-this.distanceToPoint(r)).add(r)},t.intersectLine=function(r,n){n===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),n=new de);var o=r.delta(ju),s=this.normal.dot(o);if(s===0)return this.distanceToPoint(r.start)===0?n.copy(r.start):void 0;var l=-(r.start.dot(this.normal)+this.constant)/s;if(!(l<0||l>1))return n.copy(o).multiplyScalar(l).add(r.start)},t.intersectsLine=function(r){var n=this.distanceToPoint(r.start),o=this.distanceToPoint(r.end);return n<0&&o>0||o<0&&n>0},t.intersectsBox=function(r){return r.intersectsPlane(this)},t.intersectsSphere=function(r){return r.intersectsPlane(this)},t.coplanarPoint=function(r){return r===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),r=new de),r.copy(this.normal).multiplyScalar(-this.constant)},t.applyMatrix4=function(r,n){var o=n||np.getNormalMatrix(r),s=this.coplanarPoint(ju).applyMatrix4(r),l=this.normal.applyMatrix3(o).normalize();return this.constant=-s.dot(l),this},t.translate=function(r){return this.constant-=r.dot(this.normal),this},t.equals=function(r){return r.normal.equals(this.normal)&&r.constant===this.constant},a}(),Gi=new de,ya=new de,Xu=new de,Aa=new de,Fo=new de,No=new de,Eh=new de,Yu=new de,Qu=new de,qu=new de,ra=function(){function a(i,r,n){this.a=i!==void 0?i:new de,this.b=r!==void 0?r:new de,this.c=n!==void 0?n:new de}a.getNormal=function(r,n,o,s){s===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),s=new de),s.subVectors(o,n),Gi.subVectors(r,n),s.cross(Gi);var l=s.lengthSq();return l>0?s.multiplyScalar(1/Math.sqrt(l)):s.set(0,0,0)},a.getBarycoord=function(r,n,o,s,l){Gi.subVectors(s,n),ya.subVectors(o,n),Xu.subVectors(r,n);var c=Gi.dot(Gi),p=Gi.dot(ya),C=Gi.dot(Xu),S=ya.dot(ya),T=ya.dot(Xu),O=c*S-p*p;if(l===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),l=new de),O===0)return l.set(-2,-1,-1);var P=1/O,k=(S*C-p*T)*P,W=(c*T-p*C)*P;return l.set(1-k-W,W,k)},a.containsPoint=function(r,n,o,s){return this.getBarycoord(r,n,o,s,Aa),Aa.x>=0&&Aa.y>=0&&Aa.x+Aa.y<=1},a.getUV=function(r,n,o,s,l,c,p,C){return this.getBarycoord(r,n,o,s,Aa),C.set(0,0),C.addScaledVector(l,Aa.x),C.addScaledVector(c,Aa.y),C.addScaledVector(p,Aa.z),C},a.isFrontFacing=function(r,n,o,s){return Gi.subVectors(o,n),ya.subVectors(r,n),Gi.cross(ya).dot(s)<0};var t=a.prototype;return t.set=function(r,n,o){return this.a.copy(r),this.b.copy(n),this.c.copy(o),this},t.setFromPointsAndIndices=function(r,n,o,s){return this.a.copy(r[n]),this.b.copy(r[o]),this.c.copy(r[s]),this},t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){return this.a.copy(r.a),this.b.copy(r.b),this.c.copy(r.c),this},t.getArea=function(){return Gi.subVectors(this.c,this.b),ya.subVectors(this.a,this.b),Gi.cross(ya).length()*.5},t.getMidpoint=function(r){return r===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),r=new de),r.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},t.getNormal=function(r){return a.getNormal(this.a,this.b,this.c,r)},t.getPlane=function(r){return r===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),r=new ta),r.setFromCoplanarPoints(this.a,this.b,this.c)},t.getBarycoord=function(r,n){return a.getBarycoord(r,this.a,this.b,this.c,n)},t.getUV=function(r,n,o,s,l){return a.getUV(r,this.a,this.b,this.c,n,o,s,l)},t.containsPoint=function(r){return a.containsPoint(r,this.a,this.b,this.c)},t.isFrontFacing=function(r){return a.isFrontFacing(this.a,this.b,this.c,r)},t.intersectsBox=function(r){return r.intersectsTriangle(this)},t.closestPointToPoint=function(r,n){n===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),n=new de);var o=this.a,s=this.b,l=this.c,c,p;Fo.subVectors(s,o),No.subVectors(l,o),Yu.subVectors(r,o);var C=Fo.dot(Yu),S=No.dot(Yu);if(C<=0&&S<=0)return n.copy(o);Qu.subVectors(r,s);var T=Fo.dot(Qu),O=No.dot(Qu);if(T>=0&&O<=T)return n.copy(s);var P=C*O-T*S;if(P<=0&&C>=0&&T<=0)return c=C/(C-T),n.copy(o).addScaledVector(Fo,c);qu.subVectors(r,l);var k=Fo.dot(qu),W=No.dot(qu);if(W>=0&&k<=W)return n.copy(l);var V=k*S-C*W;if(V<=0&&S>=0&&W<=0)return p=S/(S-W),n.copy(o).addScaledVector(No,p);var B=T*W-k*O;if(B<=0&&O-T>=0&&k-W>=0)return Eh.subVectors(l,s),p=(O-T)/(O-T+(k-W)),n.copy(s).addScaledVector(Eh,p);var ee=1/(B+V+P);return c=V*ee,p=P*ee,n.copy(o).addScaledVector(Fo,c).addScaledVector(No,p)},t.equals=function(r){return r.a.equals(this.a)&&r.b.equals(this.b)&&r.c.equals(this.c)},a}(),wh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Vi={h:0,s:0,l:0},gl={h:0,s:0,l:0};function Ju(a,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?a+(t-a)*6*i:i<1/2?t:i<2/3?a+(t-a)*6*(2/3-i):a}function Zu(a){return a<.04045?a*.0773993808:Math.pow(a*.9478672986+.0521327014,2.4)}function Ku(a){return a<.0031308?a*12.92:1.055*Math.pow(a,.41666)-.055}var Pt=function(){function a(i,r,n){return Object.defineProperty(this,"isColor",{value:!0}),r===void 0&&n===void 0?this.set(i):this.setRGB(i,r,n)}var t=a.prototype;return t.set=function(r){return r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r),this},t.setScalar=function(r){return this.r=r,this.g=r,this.b=r,this},t.setHex=function(r){return r=Math.floor(r),this.r=(r>>16&255)/255,this.g=(r>>8&255)/255,this.b=(r&255)/255,this},t.setRGB=function(r,n,o){return this.r=r,this.g=n,this.b=o,this},t.setHSL=function(r,n,o){if(r=dr.euclideanModulo(r,1),n=dr.clamp(n,0,1),o=dr.clamp(o,0,1),n===0)this.r=this.g=this.b=o;else{var s=o<=.5?o*(1+n):o+n-o*n,l=2*o-s;this.r=Ju(l,s,r+1/3),this.g=Ju(l,s,r),this.b=Ju(l,s,r-1/3)}return this},t.setStyle=function(r){function n(P){P!==void 0&&parseFloat(P)<1&&console.warn("THREE.Color: Alpha component of "+r+" will be ignored.")}var o;if(o=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(r)){var s,l=o[1],c=o[2];switch(l){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,n(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,n(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c)){var p=parseFloat(s[1])/360,C=parseInt(s[2],10)/100,S=parseInt(s[3],10)/100;return n(s[4]),this.setHSL(p,C,S)}break}}else if(o=/^\#([A-Fa-f\d]+)$/.exec(r)){var T=o[1],O=T.length;if(O===3)return this.r=parseInt(T.charAt(0)+T.charAt(0),16)/255,this.g=parseInt(T.charAt(1)+T.charAt(1),16)/255,this.b=parseInt(T.charAt(2)+T.charAt(2),16)/255,this;if(O===6)return this.r=parseInt(T.charAt(0)+T.charAt(1),16)/255,this.g=parseInt(T.charAt(2)+T.charAt(3),16)/255,this.b=parseInt(T.charAt(4)+T.charAt(5),16)/255,this}return r&&r.length>0?this.setColorName(r):this},t.setColorName=function(r){var n=wh[r];return n!==void 0?this.setHex(n):console.warn("THREE.Color: Unknown color "+r),this},t.clone=function(){return new this.constructor(this.r,this.g,this.b)},t.copy=function(r){return this.r=r.r,this.g=r.g,this.b=r.b,this},t.copyGammaToLinear=function(r,n){return n===void 0&&(n=2),this.r=Math.pow(r.r,n),this.g=Math.pow(r.g,n),this.b=Math.pow(r.b,n),this},t.copyLinearToGamma=function(r,n){n===void 0&&(n=2);var o=n>0?1/n:1;return this.r=Math.pow(r.r,o),this.g=Math.pow(r.g,o),this.b=Math.pow(r.b,o),this},t.convertGammaToLinear=function(r){return this.copyGammaToLinear(this,r),this},t.convertLinearToGamma=function(r){return this.copyLinearToGamma(this,r),this},t.copySRGBToLinear=function(r){return this.r=Zu(r.r),this.g=Zu(r.g),this.b=Zu(r.b),this},t.copyLinearToSRGB=function(r){return this.r=Ku(r.r),this.g=Ku(r.g),this.b=Ku(r.b),this},t.convertSRGBToLinear=function(){return this.copySRGBToLinear(this),this},t.convertLinearToSRGB=function(){return this.copyLinearToSRGB(this),this},t.getHex=function(){return this.r*255<<16^this.g*255<<8^this.b*255<<0},t.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)},t.getHSL=function(r){r===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),r={h:0,s:0,l:0});var n=this.r,o=this.g,s=this.b,l=Math.max(n,o,s),c=Math.min(n,o,s),p,C,S=(c+l)/2;if(c===l)p=0,C=0;else{var T=l-c;switch(C=S<=.5?T/(l+c):T/(2-l-c),l){case n:p=(o-s)/T+(o<s?6:0);break;case o:p=(s-n)/T+2;break;case s:p=(n-o)/T+4;break}p/=6}return r.h=p,r.s=C,r.l=S,r},t.getStyle=function(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"},t.offsetHSL=function(r,n,o){return this.getHSL(Vi),Vi.h+=r,Vi.s+=n,Vi.l+=o,this.setHSL(Vi.h,Vi.s,Vi.l),this},t.add=function(r){return this.r+=r.r,this.g+=r.g,this.b+=r.b,this},t.addColors=function(r,n){return this.r=r.r+n.r,this.g=r.g+n.g,this.b=r.b+n.b,this},t.addScalar=function(r){return this.r+=r,this.g+=r,this.b+=r,this},t.sub=function(r){return this.r=Math.max(0,this.r-r.r),this.g=Math.max(0,this.g-r.g),this.b=Math.max(0,this.b-r.b),this},t.multiply=function(r){return this.r*=r.r,this.g*=r.g,this.b*=r.b,this},t.multiplyScalar=function(r){return this.r*=r,this.g*=r,this.b*=r,this},t.lerp=function(r,n){return this.r+=(r.r-this.r)*n,this.g+=(r.g-this.g)*n,this.b+=(r.b-this.b)*n,this},t.lerpColors=function(r,n,o){return this.r=r.r+(n.r-r.r)*o,this.g=r.g+(n.g-r.g)*o,this.b=r.b+(n.b-r.b)*o,this},t.lerpHSL=function(r,n){this.getHSL(Vi),r.getHSL(gl);var o=dr.lerp(Vi.h,gl.h,n),s=dr.lerp(Vi.s,gl.s,n),l=dr.lerp(Vi.l,gl.l,n);return this.setHSL(o,s,l),this},t.equals=function(r){return r.r===this.r&&r.g===this.g&&r.b===this.b},t.fromArray=function(r,n){return n===void 0&&(n=0),this.r=r[n],this.g=r[n+1],this.b=r[n+2],this},t.toArray=function(r,n){return r===void 0&&(r=[]),n===void 0&&(n=0),r[n]=this.r,r[n+1]=this.g,r[n+2]=this.b,r},t.fromBufferAttribute=function(r,n){return this.r=r.getX(n),this.g=r.getY(n),this.b=r.getZ(n),r.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this},t.toJSON=function(){return this.getHex()},a}();Pt.NAMES=wh,Pt.prototype.r=1,Pt.prototype.g=1,Pt.prototype.b=1;var $u=function(){function a(i,r,n,o,s,l){l===void 0&&(l=0),this.a=i,this.b=r,this.c=n,this.normal=o&&o.isVector3?o:new de,this.vertexNormals=Array.isArray(o)?o:[],this.color=s&&s.isColor?s:new Pt,this.vertexColors=Array.isArray(s)?s:[],this.materialIndex=l}var t=a.prototype;return t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){this.a=r.a,this.b=r.b,this.c=r.c,this.normal.copy(r.normal),this.color.copy(r.color),this.materialIndex=r.materialIndex;for(var n=0,o=r.vertexNormals.length;n<o;n++)this.vertexNormals[n]=r.vertexNormals[n].clone();for(var s=0,l=r.vertexColors.length;s<l;s++)this.vertexColors[s]=r.vertexColors[s].clone();return this},a}(),ip=0;function sr(){Object.defineProperty(this,"id",{value:ip++}),this.uuid=dr.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=re,this.side=L,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=At,this.blendDst=St,this.blendEquation=j,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ie,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=uh,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=sl,this.stencilZFail=sl,this.stencilZPass=sl,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}sr.prototype=Object.assign(Object.create(ea.prototype),{constructor:sr,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(t){if(t!==void 0)for(var i in t){var r=t[i];if(r===void 0){console.warn("THREE.Material: '"+i+"' parameter is undefined.");continue}if(i==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===D;continue}var n=this[i];if(n===void 0){console.warn("THREE."+this.type+": '"+i+"' is not a property of this material.");continue}n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[i]=r}},toJSON:function(t){var i=t===void 0||typeof t=="string";i&&(t={textures:{},images:{}});var r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(r.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(t).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,r.reflectivity=this.reflectivity,r.refractionRatio=this.refractionRatio,this.combine!==void 0&&(r.combine=this.combine),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),this.size!==void 0&&(r.size=this.size),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==re&&(r.blending=this.blending),this.flatShading===!0&&(r.flatShading=this.flatShading),this.side!==L&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(r.morphTargets=!0),this.morphNormals===!0&&(r.morphNormals=!0),this.skinning===!0&&(r.skinning=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData);function n(l){var c=[];for(var p in l){var C=l[p];delete C.metadata,c.push(C)}return c}if(i){var o=n(t.textures),s=n(t.images);o.length>0&&(r.textures=o),s.length>0&&(r.images=s)}return r},clone:function(){return new this.constructor().copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var i=t.clippingPlanes,r=null;if(i!==null){var n=i.length;r=new Array(n);for(var o=0;o!==n;++o)r[o]=i[o].clone()}return this.clippingPlanes=r,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(sr.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}});function bi(a){sr.call(this),this.type="MeshBasicMaterial",this.color=new Pt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=De,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(a)}bi.prototype=Object.create(sr.prototype),bi.prototype.constructor=bi,bi.prototype.isMeshBasicMaterial=!0,bi.prototype.copy=function(a){return sr.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this};var vn=new de,yl=new gt;function lr(a,t,i){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=a,this.itemSize=t,this.count=a!==void 0?a.length/t:0,this.normalized=i===!0,this.usage=ds,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(lr.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}}),Object.assign(lr.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,i,r){t*=this.itemSize,r*=i.itemSize;for(var n=0,o=this.itemSize;n<o;n++)this.array[t+n]=i.array[r+n];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var i=this.array,r=0,n=0,o=t.length;n<o;n++){var s=t[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),s=new Pt),i[r++]=s.r,i[r++]=s.g,i[r++]=s.b}return this},copyVector2sArray:function(t){for(var i=this.array,r=0,n=0,o=t.length;n<o;n++){var s=t[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),s=new gt),i[r++]=s.x,i[r++]=s.y}return this},copyVector3sArray:function(t){for(var i=this.array,r=0,n=0,o=t.length;n<o;n++){var s=t[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),s=new de),i[r++]=s.x,i[r++]=s.y,i[r++]=s.z}return this},copyVector4sArray:function(t){for(var i=this.array,r=0,n=0,o=t.length;n<o;n++){var s=t[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),s=new rn),i[r++]=s.x,i[r++]=s.y,i[r++]=s.z,i[r++]=s.w}return this},applyMatrix3:function(t){if(this.itemSize===2)for(var i=0,r=this.count;i<r;i++)yl.fromBufferAttribute(this,i),yl.applyMatrix3(t),this.setXY(i,yl.x,yl.y);else if(this.itemSize===3)for(var n=0,o=this.count;n<o;n++)vn.fromBufferAttribute(this,n),vn.applyMatrix3(t),this.setXYZ(n,vn.x,vn.y,vn.z);return this},applyMatrix4:function(t){for(var i=0,r=this.count;i<r;i++)vn.x=this.getX(i),vn.y=this.getY(i),vn.z=this.getZ(i),vn.applyMatrix4(t),this.setXYZ(i,vn.x,vn.y,vn.z);return this},applyNormalMatrix:function(t){for(var i=0,r=this.count;i<r;i++)vn.x=this.getX(i),vn.y=this.getY(i),vn.z=this.getZ(i),vn.applyNormalMatrix(t),this.setXYZ(i,vn.x,vn.y,vn.z);return this},transformDirection:function(t){for(var i=0,r=this.count;i<r;i++)vn.x=this.getX(i),vn.y=this.getY(i),vn.z=this.getZ(i),vn.transformDirection(t),this.setXYZ(i,vn.x,vn.y,vn.z);return this},set:function(t,i){return i===void 0&&(i=0),this.array.set(t,i),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,i){return this.array[t*this.itemSize]=i,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,i){return this.array[t*this.itemSize+1]=i,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,i){return this.array[t*this.itemSize+2]=i,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,i){return this.array[t*this.itemSize+3]=i,this},setXY:function(t,i,r){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=r,this},setXYZ:function(t,i,r,n){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=r,this.array[t+2]=n,this},setXYZW:function(t,i,r,n,o){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=r,this.array[t+2]=n,this.array[t+3]=o,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}});function gs(a,t,i){lr.call(this,new Int8Array(a),t,i)}gs.prototype=Object.create(lr.prototype),gs.prototype.constructor=gs;function ys(a,t,i){lr.call(this,new Uint8Array(a),t,i)}ys.prototype=Object.create(lr.prototype),ys.prototype.constructor=ys;function As(a,t,i){lr.call(this,new Uint8ClampedArray(a),t,i)}As.prototype=Object.create(lr.prototype),As.prototype.constructor=As;function bs(a,t,i){lr.call(this,new Int16Array(a),t,i)}bs.prototype=Object.create(lr.prototype),bs.prototype.constructor=bs;function so(a,t,i){lr.call(this,new Uint16Array(a),t,i)}so.prototype=Object.create(lr.prototype),so.prototype.constructor=so;function Es(a,t,i){lr.call(this,new Int32Array(a),t,i)}Es.prototype=Object.create(lr.prototype),Es.prototype.constructor=Es;function lo(a,t,i){lr.call(this,new Uint32Array(a),t,i)}lo.prototype=Object.create(lr.prototype),lo.prototype.constructor=lo;function ws(a,t,i){lr.call(this,new Uint16Array(a),t,i)}ws.prototype=Object.create(lr.prototype),ws.prototype.constructor=ws,ws.prototype.isFloat16BufferAttribute=!0;function It(a,t,i){lr.call(this,new Float32Array(a),t,i)}It.prototype=Object.create(lr.prototype),It.prototype.constructor=It;function xs(a,t,i){lr.call(this,new Float64Array(a),t,i)}xs.prototype=Object.create(lr.prototype),xs.prototype.constructor=xs;function xh(a){if(a.length===0)return-1/0;for(var t=a[0],i=1,r=a.length;i<r;++i)a[i]>t&&(t=a[i]);return t}var ap={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray!="undefined"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Ms(a,t){return new ap[a](t)}var op=0,na=new Lr,ec=new Xt,ko=new de,Ei=new pa,Ts=new pa,Gn=new de;function Kt(){Object.defineProperty(this,"id",{value:op++}),this.uuid=dr.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Kt.prototype=Object.assign(Object.create(ea.prototype),{constructor:Kt,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){return Array.isArray(t)?this.index=new(xh(t)>65535?lo:so)(t,1):this.index=t,this},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,i){return this.attributes[t]=i,this},deleteAttribute:function(t){return delete this.attributes[t],this},hasAttribute:function(t){return this.attributes[t]!==void 0},addGroup:function(t,i,r){r===void 0&&(r=0),this.groups.push({start:t,count:i,materialIndex:r})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,i){this.drawRange.start=t,this.drawRange.count=i},applyMatrix4:function(t){var i=this.attributes.position;i!==void 0&&(i.applyMatrix4(t),i.needsUpdate=!0);var r=this.attributes.normal;if(r!==void 0){var n=new yi().getNormalMatrix(t);r.applyNormalMatrix(n),r.needsUpdate=!0}var o=this.attributes.tangent;return o!==void 0&&(o.transformDirection(t),o.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(t){return na.makeRotationX(t),this.applyMatrix4(na),this},rotateY:function(t){return na.makeRotationY(t),this.applyMatrix4(na),this},rotateZ:function(t){return na.makeRotationZ(t),this.applyMatrix4(na),this},translate:function(t,i,r){return na.makeTranslation(t,i,r),this.applyMatrix4(na),this},scale:function(t,i,r){return na.makeScale(t,i,r),this.applyMatrix4(na),this},lookAt:function(t){return ec.lookAt(t),ec.updateMatrix(),this.applyMatrix4(ec.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(ko).negate(),this.translate(ko.x,ko.y,ko.z),this},setFromPoints:function(t){for(var i=[],r=0,n=t.length;r<n;r++){var o=t[r];i.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new It(i,3)),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new pa);var t=this.attributes.position,i=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new de(-1/0,-1/0,-1/0),new de(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),i)for(var r=0,n=i.length;r<n;r++){var o=i[r];Ei.setFromBufferAttribute(o),this.morphTargetsRelative?(Gn.addVectors(this.boundingBox.min,Ei.min),this.boundingBox.expandByPoint(Gn),Gn.addVectors(this.boundingBox.max,Ei.max),this.boundingBox.expandByPoint(Gn)):(this.boundingBox.expandByPoint(Ei.min),this.boundingBox.expandByPoint(Ei.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new Ia);var t=this.attributes.position,i=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new de,1/0);return}if(t){var r=this.boundingSphere.center;if(Ei.setFromBufferAttribute(t),i)for(var n=0,o=i.length;n<o;n++){var s=i[n];Ts.setFromBufferAttribute(s),this.morphTargetsRelative?(Gn.addVectors(Ei.min,Ts.min),Ei.expandByPoint(Gn),Gn.addVectors(Ei.max,Ts.max),Ei.expandByPoint(Gn)):(Ei.expandByPoint(Ts.min),Ei.expandByPoint(Ts.max))}Ei.getCenter(r);for(var l=0,c=0,p=t.count;c<p;c++)Gn.fromBufferAttribute(t,c),l=Math.max(l,r.distanceToSquared(Gn));if(i)for(var C=0,S=i.length;C<S;C++)for(var T=i[C],O=this.morphTargetsRelative,P=0,k=T.count;P<k;P++)Gn.fromBufferAttribute(T,P),O&&(ko.fromBufferAttribute(t,P),Gn.add(ko)),l=Math.max(l,r.distanceToSquared(Gn));this.boundingSphere.radius=Math.sqrt(l),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){var t=this.index,i=this.attributes;if(t===null||i.position===void 0||i.normal===void 0||i.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}var r=t.array,n=i.position.array,o=i.normal.array,s=i.uv.array,l=n.length/3;i.tangent===void 0&&this.setAttribute("tangent",new lr(new Float32Array(4*l),4));for(var c=i.tangent.array,p=[],C=[],S=0;S<l;S++)p[S]=new de,C[S]=new de;var T=new de,O=new de,P=new de,k=new gt,W=new gt,V=new gt,B=new de,ee=new de;function ue(Ze,$t,Dt){T.fromArray(n,Ze*3),O.fromArray(n,$t*3),P.fromArray(n,Dt*3),k.fromArray(s,Ze*2),W.fromArray(s,$t*2),V.fromArray(s,Dt*2),O.sub(T),P.sub(T),W.sub(k),V.sub(k);var rr=1/(W.x*V.y-V.x*W.y);!isFinite(rr)||(B.copy(O).multiplyScalar(V.y).addScaledVector(P,-W.y).multiplyScalar(rr),ee.copy(P).multiplyScalar(W.x).addScaledVector(O,-V.x).multiplyScalar(rr),p[Ze].add(B),p[$t].add(B),p[Dt].add(B),C[Ze].add(ee),C[$t].add(ee),C[Dt].add(ee))}var K=this.groups;K.length===0&&(K=[{start:0,count:r.length}]);for(var Q=0,se=K.length;Q<se;++Q)for(var Me=K[Q],xe=Me.start,_e=Me.count,Pe=xe,Ce=xe+_e;Pe<Ce;Pe+=3)ue(r[Pe+0],r[Pe+1],r[Pe+2]);var Ae=new de,Be=new de,Se=new de,Te=new de;function me(Ze){Se.fromArray(o,Ze*3),Te.copy(Se);var $t=p[Ze];Ae.copy($t),Ae.sub(Se.multiplyScalar(Se.dot($t))).normalize(),Be.crossVectors(Te,$t);var Dt=Be.dot(C[Ze]),rr=Dt<0?-1:1;c[Ze*4]=Ae.x,c[Ze*4+1]=Ae.y,c[Ze*4+2]=Ae.z,c[Ze*4+3]=rr}for(var Ue=0,He=K.length;Ue<He;++Ue)for(var Ye=K[Ue],Qe=Ye.start,pt=Ye.count,Et=Qe,Ut=Qe+pt;Et<Ut;Et+=3)me(r[Et+0]),me(r[Et+1]),me(r[Et+2])},computeVertexNormals:function(){var t=this.index,i=this.getAttribute("position");if(i!==void 0){var r=this.getAttribute("normal");if(r===void 0)r=new lr(new Float32Array(i.count*3),3),this.setAttribute("normal",r);else for(var n=0,o=r.count;n<o;n++)r.setXYZ(n,0,0,0);var s=new de,l=new de,c=new de,p=new de,C=new de,S=new de,T=new de,O=new de;if(t)for(var P=0,k=t.count;P<k;P+=3){var W=t.getX(P+0),V=t.getX(P+1),B=t.getX(P+2);s.fromBufferAttribute(i,W),l.fromBufferAttribute(i,V),c.fromBufferAttribute(i,B),T.subVectors(c,l),O.subVectors(s,l),T.cross(O),p.fromBufferAttribute(r,W),C.fromBufferAttribute(r,V),S.fromBufferAttribute(r,B),p.add(T),C.add(T),S.add(T),r.setXYZ(W,p.x,p.y,p.z),r.setXYZ(V,C.x,C.y,C.z),r.setXYZ(B,S.x,S.y,S.z)}else for(var ee=0,ue=i.count;ee<ue;ee+=3)s.fromBufferAttribute(i,ee+0),l.fromBufferAttribute(i,ee+1),c.fromBufferAttribute(i,ee+2),T.subVectors(c,l),O.subVectors(s,l),T.cross(O),r.setXYZ(ee+0,T.x,T.y,T.z),r.setXYZ(ee+1,T.x,T.y,T.z),r.setXYZ(ee+2,T.x,T.y,T.z);this.normalizeNormals(),r.needsUpdate=!0}},merge:function(t,i){if(!(t&&t.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);return}i===void 0&&(i=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var r=this.attributes;for(var n in r)if(t.attributes[n]!==void 0)for(var o=r[n],s=o.array,l=t.attributes[n],c=l.array,p=l.itemSize*i,C=Math.min(c.length,s.length-p),S=0,T=p;S<C;S++,T++)s[T]=c[S];return this},normalizeNormals:function(){for(var t=this.attributes.normal,i=0,r=t.count;i<r;i++)Gn.fromBufferAttribute(t,i),Gn.normalize(),t.setXYZ(i,Gn.x,Gn.y,Gn.z)},toNonIndexed:function(){function t(ue,K){for(var Q=ue.array,se=ue.itemSize,Me=ue.normalized,xe=new Q.constructor(K.length*se),_e=0,Pe=0,Ce=0,Ae=K.length;Ce<Ae;Ce++){_e=K[Ce]*se;for(var Be=0;Be<se;Be++)xe[Pe++]=Q[_e++]}return new lr(xe,se,Me)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var i=new Kt,r=this.index.array,n=this.attributes;for(var o in n){var s=n[o],l=t(s,r);i.setAttribute(o,l)}var c=this.morphAttributes;for(var p in c){for(var C=[],S=c[p],T=0,O=S.length;T<O;T++){var P=S[T],k=t(P,r);C.push(k)}i.morphAttributes[p]=C}i.morphTargetsRelative=this.morphTargetsRelative;for(var W=this.groups,V=0,B=W.length;V<B;V++){var ee=W[V];i.addGroup(ee.start,ee.count,ee.materialIndex)}return i},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){var i=this.parameters;for(var r in i)i[r]!==void 0&&(t[r]=i[r]);return t}t.data={attributes:{}};var n=this.index;n!==null&&(t.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});var o=this.attributes;for(var s in o){var l=o[s],c=l.toJSON(t.data);l.name!==""&&(c.name=l.name),t.data.attributes[s]=c}var p={},C=!1;for(var S in this.morphAttributes){for(var T=this.morphAttributes[S],O=[],P=0,k=T.length;P<k;P++){var W=T[P],V=W.toJSON(t.data);W.name!==""&&(V.name=W.name),O.push(V)}O.length>0&&(p[S]=O,C=!0)}C&&(t.data.morphAttributes=p,t.data.morphTargetsRelative=this.morphTargetsRelative);var B=this.groups;B.length>0&&(t.data.groups=JSON.parse(JSON.stringify(B)));var ee=this.boundingSphere;return ee!==null&&(t.data.boundingSphere={center:ee.center.toArray(),radius:ee.radius}),t},clone:function(){return new Kt().copy(this)},copy:function(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var i={};this.name=t.name;var r=t.index;r!==null&&this.setIndex(r.clone(i));var n=t.attributes;for(var o in n){var s=n[o];this.setAttribute(o,s.clone(i))}var l=t.morphAttributes;for(var c in l){for(var p=[],C=l[c],S=0,T=C.length;S<T;S++)p.push(C[S].clone(i));this.morphAttributes[c]=p}this.morphTargetsRelative=t.morphTargetsRelative;for(var O=t.groups,P=0,k=O.length;P<k;P++){var W=O[P];this.addGroup(W.start,W.count,W.materialIndex)}var V=t.boundingBox;V!==null&&(this.boundingBox=V.clone());var B=t.boundingSphere;return B!==null&&(this.boundingSphere=B.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Mh=new Lr,Uo=new Oo,tc=new Ia,Na=new de,ka=new de,Ua=new de,rc=new de,nc=new de,ic=new de,Al=new de,bl=new de,El=new de,wl=new gt,xl=new gt,Ml=new gt,ac=new de,Tl=new de;function mn(a,t){a===void 0&&(a=new Kt),t===void 0&&(t=new bi),Xt.call(this),this.type="Mesh",this.geometry=a,this.material=t,this.updateMorphTargets()}mn.prototype=Object.assign(Object.create(Xt.prototype),{constructor:mn,isMesh:!0,copy:function(t){return Xt.prototype.copy.call(this,t),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){var i=t.morphAttributes,r=Object.keys(i);if(r.length>0){var n=i[r[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var o=0,s=n.length;o<s;o++){var l=n[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}else{var c=t.morphTargets;c!==void 0&&c.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,i){var r=this.geometry,n=this.material,o=this.matrixWorld;if(n!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),tc.copy(r.boundingSphere),tc.applyMatrix4(o),t.ray.intersectsSphere(tc)!==!1&&(Mh.copy(o).invert(),Uo.copy(t.ray).applyMatrix4(Mh),!(r.boundingBox!==null&&Uo.intersectsBox(r.boundingBox)===!1)))){var s;if(r.isBufferGeometry){var l=r.index,c=r.attributes.position,p=r.morphAttributes.position,C=r.morphTargetsRelative,S=r.attributes.uv,T=r.attributes.uv2,O=r.groups,P=r.drawRange;if(l!==null)if(Array.isArray(n))for(var k=0,W=O.length;k<W;k++)for(var V=O[k],B=n[V.materialIndex],ee=Math.max(V.start,P.start),ue=Math.min(V.start+V.count,P.start+P.count),K=ee,Q=ue;K<Q;K+=3){var se=l.getX(K),Me=l.getX(K+1),xe=l.getX(K+2);s=Sl(this,B,t,Uo,c,p,C,S,T,se,Me,xe),s&&(s.faceIndex=Math.floor(K/3),s.face.materialIndex=V.materialIndex,i.push(s))}else for(var _e=Math.max(0,P.start),Pe=Math.min(l.count,P.start+P.count),Ce=_e,Ae=Pe;Ce<Ae;Ce+=3){var Be=l.getX(Ce),Se=l.getX(Ce+1),Te=l.getX(Ce+2);s=Sl(this,n,t,Uo,c,p,C,S,T,Be,Se,Te),s&&(s.faceIndex=Math.floor(Ce/3),i.push(s))}else if(c!==void 0)if(Array.isArray(n))for(var me=0,Ue=O.length;me<Ue;me++)for(var He=O[me],Ye=n[He.materialIndex],Qe=Math.max(He.start,P.start),pt=Math.min(He.start+He.count,P.start+P.count),Et=Qe,Ut=pt;Et<Ut;Et+=3){var Ze=Et,$t=Et+1,Dt=Et+2;s=Sl(this,Ye,t,Uo,c,p,C,S,T,Ze,$t,Dt),s&&(s.faceIndex=Math.floor(Et/3),s.face.materialIndex=He.materialIndex,i.push(s))}else for(var rr=Math.max(0,P.start),vr=Math.min(c.count,P.start+P.count),_r=rr,gr=vr;_r<gr;_r+=3){var un=_r,Gr=_r+1,nn=_r+2;s=Sl(this,n,t,Uo,c,p,C,S,T,un,Gr,nn),s&&(s.faceIndex=Math.floor(_r/3),i.push(s))}}else r.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}});function sp(a,t,i,r,n,o,s,l){var c;if(t.side===M?c=r.intersectTriangle(s,o,n,!0,l):c=r.intersectTriangle(n,o,s,t.side!==R,l),c===null)return null;Tl.copy(l),Tl.applyMatrix4(a.matrixWorld);var p=i.ray.origin.distanceTo(Tl);return p<i.near||p>i.far?null:{distance:p,point:Tl.clone(),object:a}}function Sl(a,t,i,r,n,o,s,l,c,p,C,S){Na.fromBufferAttribute(n,p),ka.fromBufferAttribute(n,C),Ua.fromBufferAttribute(n,S);var T=a.morphTargetInfluences;if(t.morphTargets&&o&&T){Al.set(0,0,0),bl.set(0,0,0),El.set(0,0,0);for(var O=0,P=o.length;O<P;O++){var k=T[O],W=o[O];k!==0&&(rc.fromBufferAttribute(W,p),nc.fromBufferAttribute(W,C),ic.fromBufferAttribute(W,S),s?(Al.addScaledVector(rc,k),bl.addScaledVector(nc,k),El.addScaledVector(ic,k)):(Al.addScaledVector(rc.sub(Na),k),bl.addScaledVector(nc.sub(ka),k),El.addScaledVector(ic.sub(Ua),k)))}Na.add(Al),ka.add(bl),Ua.add(El)}a.isSkinnedMesh&&(a.boneTransform(p,Na),a.boneTransform(C,ka),a.boneTransform(S,Ua));var V=sp(a,t,i,r,Na,ka,Ua,ac);if(V){l&&(wl.fromBufferAttribute(l,p),xl.fromBufferAttribute(l,C),Ml.fromBufferAttribute(l,S),V.uv=ra.getUV(ac,Na,ka,Ua,wl,xl,Ml,new gt)),c&&(wl.fromBufferAttribute(c,p),xl.fromBufferAttribute(c,C),Ml.fromBufferAttribute(c,S),V.uv2=ra.getUV(ac,Na,ka,Ua,wl,xl,Ml,new gt));var B=new $u(p,C,S);ra.getNormal(Na,ka,Ua,B.normal),V.face=B}return V}var uo=function(a){Mr(t,a);function t(i,r,n,o,s,l){var c;i===void 0&&(i=1),r===void 0&&(r=1),n===void 0&&(n=1),o===void 0&&(o=1),s===void 0&&(s=1),l===void 0&&(l=1),c=a.call(this)||this,c.type="BoxGeometry",c.parameters={width:i,height:r,depth:n,widthSegments:o,heightSegments:s,depthSegments:l};var p=Ui(c);o=Math.floor(o),s=Math.floor(s),l=Math.floor(l);var C=[],S=[],T=[],O=[],P=0,k=0;W("z","y","x",-1,-1,n,r,i,l,s,0),W("z","y","x",1,-1,n,r,-i,l,s,1),W("x","z","y",1,1,i,n,r,o,l,2),W("x","z","y",1,-1,i,n,-r,o,l,3),W("x","y","z",1,-1,i,r,n,o,s,4),W("x","y","z",-1,-1,i,r,-n,o,s,5),c.setIndex(C),c.setAttribute("position",new It(S,3)),c.setAttribute("normal",new It(T,3)),c.setAttribute("uv",new It(O,2));function W(V,B,ee,ue,K,Q,se,Me,xe,_e,Pe){for(var Ce=Q/xe,Ae=se/_e,Be=Q/2,Se=se/2,Te=Me/2,me=xe+1,Ue=_e+1,He=0,Ye=0,Qe=new de,pt=0;pt<Ue;pt++)for(var Et=pt*Ae-Se,Ut=0;Ut<me;Ut++){var Ze=Ut*Ce-Be;Qe[V]=Ze*ue,Qe[B]=Et*K,Qe[ee]=Te,S.push(Qe.x,Qe.y,Qe.z),Qe[V]=0,Qe[B]=0,Qe[ee]=Me>0?1:-1,T.push(Qe.x,Qe.y,Qe.z),O.push(Ut/xe),O.push(1-pt/_e),He+=1}for(var $t=0;$t<_e;$t++)for(var Dt=0;Dt<xe;Dt++){var rr=P+Dt+me*$t,vr=P+Dt+me*($t+1),_r=P+(Dt+1)+me*($t+1),gr=P+(Dt+1)+me*$t;C.push(rr,vr,gr),C.push(vr,_r,gr),Ye+=6}p.addGroup(k,Ye,Pe),k+=Ye,P+=He}return c}return t}(Kt);function Ho(a){var t={};for(var i in a){t[i]={};for(var r in a[i]){var n=a[i][r];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture)?t[i][r]=n.clone():Array.isArray(n)?t[i][r]=n.slice():t[i][r]=n}}return t}function ei(a){for(var t={},i=0;i<a.length;i++){var r=Ho(a[i]);for(var n in r)t[n]=r[n]}return t}var Th={clone:Ho,merge:ei},lp=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,up=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;function ui(a){sr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=lp,this.fragmentShader=up,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,a!==void 0&&(a.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(a))}ui.prototype=Object.create(sr.prototype),ui.prototype.constructor=ui,ui.prototype.isShaderMaterial=!0,ui.prototype.copy=function(a){return sr.prototype.copy.call(this,a),this.fragmentShader=a.fragmentShader,this.vertexShader=a.vertexShader,this.uniforms=Ho(a.uniforms),this.defines=Object.assign({},a.defines),this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.lights=a.lights,this.clipping=a.clipping,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this.extensions=Object.assign({},a.extensions),this.glslVersion=a.glslVersion,this},ui.prototype.toJSON=function(a){var t=sr.prototype.toJSON.call(this,a);t.glslVersion=this.glslVersion,t.uniforms={};for(var i in this.uniforms){var r=this.uniforms[i],n=r.value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(a).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var o={};for(var s in this.extensions)this.extensions[s]===!0&&(o[s]=!0);return Object.keys(o).length>0&&(t.extensions=o),t};function ia(){Xt.call(this),this.type="Camera",this.matrixWorldInverse=new Lr,this.projectionMatrix=new Lr,this.projectionMatrixInverse=new Lr}ia.prototype=Object.assign(Object.create(Xt.prototype),{constructor:ia,isCamera:!0,copy:function(t,i){return Xt.prototype.copy.call(this,t,i),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){t===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new de),this.updateWorldMatrix(!0,!1);var i=this.matrixWorld.elements;return t.set(-i[8],-i[9],-i[10]).normalize()},updateMatrixWorld:function(t){Xt.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(t,i){Xt.prototype.updateWorldMatrix.call(this,t,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return new this.constructor().copy(this)}});function _n(a,t,i,r){a===void 0&&(a=50),t===void 0&&(t=1),i===void 0&&(i=.1),r===void 0&&(r=2e3),ia.call(this),this.type="PerspectiveCamera",this.fov=a,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}_n.prototype=Object.assign(Object.create(ia.prototype),{constructor:_n,isPerspectiveCamera:!0,copy:function(t,i){return ia.prototype.copy.call(this,t,i),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var i=.5*this.getFilmHeight()/t;this.fov=dr.RAD2DEG*2*Math.atan(i),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(dr.DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/t},getEffectiveFOV:function(){return dr.RAD2DEG*2*Math.atan(Math.tan(dr.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,i,r,n,o,s){this.aspect=t/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=i,this.view.offsetX=r,this.view.offsetY=n,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,i=t*Math.tan(dr.DEG2RAD*.5*this.fov)/this.zoom,r=2*i,n=this.aspect*r,o=-.5*n,s=this.view;if(this.view!==null&&this.view.enabled){var l=s.fullWidth,c=s.fullHeight;o+=s.offsetX*n/l,i-=s.offsetY*r/c,n*=s.width/l,r*=s.height/c}var p=this.filmOffset;p!==0&&(o+=t*p/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+n,i,i-r,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(t){var i=Xt.prototype.toJSON.call(this,t);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}});var Go=90,Vo=1;function co(a,t,i){if(Xt.call(this),this.type="CubeCamera",i.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=i;var r=new _n(Go,Vo,a,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new de(1,0,0)),this.add(r);var n=new _n(Go,Vo,a,t);n.layers=this.layers,n.up.set(0,-1,0),n.lookAt(new de(-1,0,0)),this.add(n);var o=new _n(Go,Vo,a,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new de(0,1,0)),this.add(o);var s=new _n(Go,Vo,a,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(new de(0,-1,0)),this.add(s);var l=new _n(Go,Vo,a,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new de(0,0,1)),this.add(l);var c=new _n(Go,Vo,a,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new de(0,0,-1)),this.add(c),this.update=function(p,C){this.parent===null&&this.updateMatrixWorld();var S=p.xr.enabled,T=p.getRenderTarget();p.xr.enabled=!1;var O=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,p.setRenderTarget(i,0),p.render(C,r),p.setRenderTarget(i,1),p.render(C,n),p.setRenderTarget(i,2),p.render(C,o),p.setRenderTarget(i,3),p.render(C,s),p.setRenderTarget(i,4),p.render(C,l),i.texture.generateMipmaps=O,p.setRenderTarget(i,5),p.render(C,c),p.setRenderTarget(T),p.xr.enabled=S}}co.prototype=Object.create(Xt.prototype),co.prototype.constructor=co;function aa(a,t,i,r,n,o,s,l,c,p){a=a!==void 0?a:[],t=t!==void 0?t:Re,s=s!==void 0?s:Ri,ln.call(this,a,t,i,r,n,o,s,l,c,p),this.flipY=!1,this._needsFlipEnvMap=!0}aa.prototype=Object.create(ln.prototype),aa.prototype.constructor=aa,aa.prototype.isCubeTexture=!0,Object.defineProperty(aa.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});var oc=function(a){Mr(t,a);function t(r,n,o){var s;return Number.isInteger(n)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),n=o),s=a.call(this,r,r,n)||this,Object.defineProperty(Ui(s),"isWebGLCubeRenderTarget",{value:!0}),n=n||{},s.texture=new aa(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),s.texture._needsFlipEnvMap=!1,s}var i=t.prototype;return i.fromEquirectangularTexture=function(n,o){this.texture.type=o.type,this.texture.format=jn,this.texture.encoding=o.encoding,this.texture.generateMipmaps=o.generateMipmaps,this.texture.minFilter=o.minFilter,this.texture.magFilter=o.magFilter;var s={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},l=new uo(5,5,5),c=new ui({name:"CubemapFromEquirect",uniforms:Ho(s.uniforms),vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,side:M,blending:z});c.uniforms.tEquirect.value=o;var p=new mn(l,c),C=o.minFilter;o.minFilter===tr&&(o.minFilter=nt);var S=new co(1,10,this);return S.update(n,p),o.minFilter=C,p.geometry.dispose(),p.material.dispose(),this},i.clear=function(n,o,s,l){for(var c=n.getRenderTarget(),p=0;p<6;p++)n.setRenderTarget(this,p),n.clear(o,s,l);n.setRenderTarget(c)},t}(Pa);function ba(a,t,i,r,n,o,s,l,c,p,C,S){ln.call(this,null,o,s,l,c,p,r,n,C,S),this.image={data:a||null,width:t||1,height:i||1},this.magFilter=c!==void 0?c:ar,this.minFilter=p!==void 0?p:ar,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}ba.prototype=Object.create(ln.prototype),ba.prototype.constructor=ba,ba.prototype.isDataTexture=!0;var zo=new Ia,_l=new de,Ss=function(){function a(i,r,n,o,s,l){this.planes=[i!==void 0?i:new ta,r!==void 0?r:new ta,n!==void 0?n:new ta,o!==void 0?o:new ta,s!==void 0?s:new ta,l!==void 0?l:new ta]}var t=a.prototype;return t.set=function(r,n,o,s,l,c){var p=this.planes;return p[0].copy(r),p[1].copy(n),p[2].copy(o),p[3].copy(s),p[4].copy(l),p[5].copy(c),this},t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){for(var n=this.planes,o=0;o<6;o++)n[o].copy(r.planes[o]);return this},t.setFromProjectionMatrix=function(r){var n=this.planes,o=r.elements,s=o[0],l=o[1],c=o[2],p=o[3],C=o[4],S=o[5],T=o[6],O=o[7],P=o[8],k=o[9],W=o[10],V=o[11],B=o[12],ee=o[13],ue=o[14],K=o[15];return n[0].setComponents(p-s,O-C,V-P,K-B).normalize(),n[1].setComponents(p+s,O+C,V+P,K+B).normalize(),n[2].setComponents(p+l,O+S,V+k,K+ee).normalize(),n[3].setComponents(p-l,O-S,V-k,K-ee).normalize(),n[4].setComponents(p-c,O-T,V-W,K-ue).normalize(),n[5].setComponents(p+c,O+T,V+W,K+ue).normalize(),this},t.intersectsObject=function(r){var n=r.geometry;return n.boundingSphere===null&&n.computeBoundingSphere(),zo.copy(n.boundingSphere).applyMatrix4(r.matrixWorld),this.intersectsSphere(zo)},t.intersectsSprite=function(r){return zo.center.set(0,0,0),zo.radius=.7071067811865476,zo.applyMatrix4(r.matrixWorld),this.intersectsSphere(zo)},t.intersectsSphere=function(r){for(var n=this.planes,o=r.center,s=-r.radius,l=0;l<6;l++){var c=n[l].distanceToPoint(o);if(c<s)return!1}return!0},t.intersectsBox=function(r){for(var n=this.planes,o=0;o<6;o++){var s=n[o];if(_l.x=s.normal.x>0?r.max.x:r.min.x,_l.y=s.normal.y>0?r.max.y:r.min.y,_l.z=s.normal.z>0?r.max.z:r.min.z,s.distanceToPoint(_l)<0)return!1}return!0},t.containsPoint=function(r){for(var n=this.planes,o=0;o<6;o++)if(n[o].distanceToPoint(r)<0)return!1;return!0},a}();function sc(){var a=null,t=!1,i=null,r=null;function n(o,s){i(o,s),r=a.requestAnimationFrame(n)}return{start:function(){t!==!0&&i!==null&&(r=a.requestAnimationFrame(n),t=!0)},stop:function(){a.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(s){i=s},setContext:function(s){a=s}}}function cp(a,t){var i=t.isWebGL2,r=new WeakMap;function n(p,C){var S=p.array,T=p.usage,O=a.createBuffer();a.bindBuffer(C,O),a.bufferData(C,S,T),p.onUploadCallback();var P=5126;return S instanceof Float32Array?P=5126:S instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):S instanceof Uint16Array?p.isFloat16BufferAttribute?i?P=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):P=5123:S instanceof Int16Array?P=5122:S instanceof Uint32Array?P=5125:S instanceof Int32Array?P=5124:S instanceof Int8Array?P=5120:S instanceof Uint8Array&&(P=5121),{buffer:O,type:P,bytesPerElement:S.BYTES_PER_ELEMENT,version:p.version}}function o(p,C,S){var T=C.array,O=C.updateRange;a.bindBuffer(S,p),O.count===-1?a.bufferSubData(S,0,T):(i?a.bufferSubData(S,O.offset*T.BYTES_PER_ELEMENT,T,O.offset,O.count):a.bufferSubData(S,O.offset*T.BYTES_PER_ELEMENT,T.subarray(O.offset,O.offset+O.count)),O.count=-1)}function s(p){return p.isInterleavedBufferAttribute&&(p=p.data),r.get(p)}function l(p){p.isInterleavedBufferAttribute&&(p=p.data);var C=r.get(p);C&&(a.deleteBuffer(C.buffer),r.delete(p))}function c(p,C){if(p.isGLBufferAttribute){var S=r.get(p);(!S||S.version<p.version)&&r.set(p,{buffer:p.buffer,type:p.type,bytesPerElement:p.elementSize,version:p.version});return}p.isInterleavedBufferAttribute&&(p=p.data);var T=r.get(p);T===void 0?r.set(p,n(p,C)):T.version<p.version&&(o(T.buffer,p,C),T.version=p.version)}return{get:s,remove:l,update:c}}var _s=function(a){Mr(t,a);function t(i,r,n,o){var s;i===void 0&&(i=1),r===void 0&&(r=1),n===void 0&&(n=1),o===void 0&&(o=1),s=a.call(this)||this,s.type="PlaneGeometry",s.parameters={width:i,height:r,widthSegments:n,heightSegments:o};for(var l=i/2,c=r/2,p=Math.floor(n),C=Math.floor(o),S=p+1,T=C+1,O=i/p,P=r/C,k=[],W=[],V=[],B=[],ee=0;ee<T;ee++)for(var ue=ee*P-c,K=0;K<S;K++){var Q=K*O-l;W.push(Q,-ue,0),V.push(0,0,1),B.push(K/p),B.push(1-ee/C)}for(var se=0;se<C;se++)for(var Me=0;Me<p;Me++){var xe=Me+S*se,_e=Me+S*(se+1),Pe=Me+1+S*(se+1),Ce=Me+1+S*se;k.push(xe,_e,Ce),k.push(_e,Pe,Ce)}return s.setIndex(k),s.setAttribute("position",new It(W,3)),s.setAttribute("normal",new It(V,3)),s.setAttribute("uv",new It(B,2)),s}return t}(Kt),hp=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,dp=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,fp=`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,pp=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,vp=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,mp="vec3 transformed = vec3( position );",gp=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,yp=`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,Ap=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,bp=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Ep=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,wp=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,xp=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Mp=`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,Tp=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,Sp=`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,_p=`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor.xyz *= color.xyz;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Cp=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,Lp=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Rp=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Pp=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Dp=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,Op=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Ip=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Bp="gl_FragColor = linearToOutputTexel( gl_FragColor );",Fp=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,Np=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,kp=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Up=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Hp=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Gp=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Vp=`#ifdef USE_FOG
	fogDepth = - mvPosition.z;
#endif`,zp=`#ifdef USE_FOG
	varying float fogDepth;
#endif`,Wp=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,jp=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Xp=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,Yp=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,Qp=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,qp=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,Jp=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,Zp=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,Kp=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,$p=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,ev=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,tv=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,rv=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,nv=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float specularRoughness;
	vec3 specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(		0, 1,		0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,iv=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,av=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,ov=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,sv=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,lv=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,uv=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,cv=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,hv=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,dv=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,fv=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,pv=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,vv=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,mv=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,gv=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,yv=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,Av=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,bv=`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,Ev=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,wv=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,xv=`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,Mv=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,Tv=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,Sv=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,_v=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Cv=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Lv=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Rv=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Pv=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Dv=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Ov=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
							f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
							f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,Iv=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Bv=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,Fv=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Nv=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,kv=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,Uv=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Hv=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Gv=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Vv=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,zv=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Wv=`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(	1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,	1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,	1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,jv=`#ifdef USE_TRANSMISSIONMAP
	totalTransmission *= texture2D( transmissionMap, vUv ).r;
#endif`,Xv=`#ifdef USE_TRANSMISSIONMAP
	uniform sampler2D transmissionMap;
#endif`,Yv=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,Qv=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,qv=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,Jv=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,Zv=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,Kv=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,$v=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,em=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,tm=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,rm=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,nm=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,im=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,am=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,om=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,sm=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,lm=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,um=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,cm=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,hm=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,dm=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,fm=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,pm=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vm=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,mm=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gm=`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,ym=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Am=`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,bm=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Em=`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,wm=`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSMISSION
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSMISSION
	uniform float transmission;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <transmissionmap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#ifdef TRANSMISSION
		float totalTransmission = transmission;
	#endif
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <transmissionmap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSMISSION
		diffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,xm=`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Mm=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,Tm=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Sm=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,_m=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Cm=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Lm=`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Rm=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Pm=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Fr={alphamap_fragment:hp,alphamap_pars_fragment:dp,alphatest_fragment:fp,aomap_fragment:pp,aomap_pars_fragment:vp,begin_vertex:mp,beginnormal_vertex:gp,bsdfs:yp,bumpmap_pars_fragment:Ap,clipping_planes_fragment:bp,clipping_planes_pars_fragment:Ep,clipping_planes_pars_vertex:wp,clipping_planes_vertex:xp,color_fragment:Mp,color_pars_fragment:Tp,color_pars_vertex:Sp,color_vertex:_p,common:Cp,cube_uv_reflection_fragment:Lp,defaultnormal_vertex:Rp,displacementmap_pars_vertex:Pp,displacementmap_vertex:Dp,emissivemap_fragment:Op,emissivemap_pars_fragment:Ip,encodings_fragment:Bp,encodings_pars_fragment:Fp,envmap_fragment:Np,envmap_common_pars_fragment:kp,envmap_pars_fragment:Up,envmap_pars_vertex:Hp,envmap_physical_pars_fragment:Zp,envmap_vertex:Gp,fog_vertex:Vp,fog_pars_vertex:zp,fog_fragment:Wp,fog_pars_fragment:jp,gradientmap_pars_fragment:Xp,lightmap_fragment:Yp,lightmap_pars_fragment:Qp,lights_lambert_vertex:qp,lights_pars_begin:Jp,lights_toon_fragment:Kp,lights_toon_pars_fragment:$p,lights_phong_fragment:ev,lights_phong_pars_fragment:tv,lights_physical_fragment:rv,lights_physical_pars_fragment:nv,lights_fragment_begin:iv,lights_fragment_maps:av,lights_fragment_end:ov,logdepthbuf_fragment:sv,logdepthbuf_pars_fragment:lv,logdepthbuf_pars_vertex:uv,logdepthbuf_vertex:cv,map_fragment:hv,map_pars_fragment:dv,map_particle_fragment:fv,map_particle_pars_fragment:pv,metalnessmap_fragment:vv,metalnessmap_pars_fragment:mv,morphnormal_vertex:gv,morphtarget_pars_vertex:yv,morphtarget_vertex:Av,normal_fragment_begin:bv,normal_fragment_maps:Ev,normalmap_pars_fragment:wv,clearcoat_normal_fragment_begin:xv,clearcoat_normal_fragment_maps:Mv,clearcoat_pars_fragment:Tv,packing:Sv,premultiplied_alpha_fragment:_v,project_vertex:Cv,dithering_fragment:Lv,dithering_pars_fragment:Rv,roughnessmap_fragment:Pv,roughnessmap_pars_fragment:Dv,shadowmap_pars_fragment:Ov,shadowmap_pars_vertex:Iv,shadowmap_vertex:Bv,shadowmask_pars_fragment:Fv,skinbase_vertex:Nv,skinning_pars_vertex:kv,skinning_vertex:Uv,skinnormal_vertex:Hv,specularmap_fragment:Gv,specularmap_pars_fragment:Vv,tonemapping_fragment:zv,tonemapping_pars_fragment:Wv,transmissionmap_fragment:jv,transmissionmap_pars_fragment:Xv,uv_pars_fragment:Yv,uv_pars_vertex:Qv,uv_vertex:qv,uv2_pars_fragment:Jv,uv2_pars_vertex:Zv,uv2_vertex:Kv,worldpos_vertex:$v,background_frag:em,background_vert:tm,cube_frag:rm,cube_vert:nm,depth_frag:im,depth_vert:am,distanceRGBA_frag:om,distanceRGBA_vert:sm,equirect_frag:lm,equirect_vert:um,linedashed_frag:cm,linedashed_vert:hm,meshbasic_frag:dm,meshbasic_vert:fm,meshlambert_frag:pm,meshlambert_vert:vm,meshmatcap_frag:mm,meshmatcap_vert:gm,meshtoon_frag:ym,meshtoon_vert:Am,meshphong_frag:bm,meshphong_vert:Em,meshphysical_frag:wm,meshphysical_vert:xm,normal_frag:Mm,normal_vert:Tm,points_frag:Sm,points_vert:_m,shadow_frag:Cm,shadow_vert:Lm,sprite_frag:Rm,sprite_vert:Pm},_t={common:{diffuse:{value:new Pt(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new yi},uv2Transform:{value:new yi},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new gt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Pt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Pt(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new yi}},sprite:{diffuse:{value:new Pt(15658734)},opacity:{value:1},center:{value:new gt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new yi}}},zi={basic:{uniforms:ei([_t.common,_t.specularmap,_t.envmap,_t.aomap,_t.lightmap,_t.fog]),vertexShader:Fr.meshbasic_vert,fragmentShader:Fr.meshbasic_frag},lambert:{uniforms:ei([_t.common,_t.specularmap,_t.envmap,_t.aomap,_t.lightmap,_t.emissivemap,_t.fog,_t.lights,{emissive:{value:new Pt(0)}}]),vertexShader:Fr.meshlambert_vert,fragmentShader:Fr.meshlambert_frag},phong:{uniforms:ei([_t.common,_t.specularmap,_t.envmap,_t.aomap,_t.lightmap,_t.emissivemap,_t.bumpmap,_t.normalmap,_t.displacementmap,_t.fog,_t.lights,{emissive:{value:new Pt(0)},specular:{value:new Pt(1118481)},shininess:{value:30}}]),vertexShader:Fr.meshphong_vert,fragmentShader:Fr.meshphong_frag},standard:{uniforms:ei([_t.common,_t.envmap,_t.aomap,_t.lightmap,_t.emissivemap,_t.bumpmap,_t.normalmap,_t.displacementmap,_t.roughnessmap,_t.metalnessmap,_t.fog,_t.lights,{emissive:{value:new Pt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Fr.meshphysical_vert,fragmentShader:Fr.meshphysical_frag},toon:{uniforms:ei([_t.common,_t.aomap,_t.lightmap,_t.emissivemap,_t.bumpmap,_t.normalmap,_t.displacementmap,_t.gradientmap,_t.fog,_t.lights,{emissive:{value:new Pt(0)}}]),vertexShader:Fr.meshtoon_vert,fragmentShader:Fr.meshtoon_frag},matcap:{uniforms:ei([_t.common,_t.bumpmap,_t.normalmap,_t.displacementmap,_t.fog,{matcap:{value:null}}]),vertexShader:Fr.meshmatcap_vert,fragmentShader:Fr.meshmatcap_frag},points:{uniforms:ei([_t.points,_t.fog]),vertexShader:Fr.points_vert,fragmentShader:Fr.points_frag},dashed:{uniforms:ei([_t.common,_t.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Fr.linedashed_vert,fragmentShader:Fr.linedashed_frag},depth:{uniforms:ei([_t.common,_t.displacementmap]),vertexShader:Fr.depth_vert,fragmentShader:Fr.depth_frag},normal:{uniforms:ei([_t.common,_t.bumpmap,_t.normalmap,_t.displacementmap,{opacity:{value:1}}]),vertexShader:Fr.normal_vert,fragmentShader:Fr.normal_frag},sprite:{uniforms:ei([_t.sprite,_t.fog]),vertexShader:Fr.sprite_vert,fragmentShader:Fr.sprite_frag},background:{uniforms:{uvTransform:{value:new yi},t2D:{value:null}},vertexShader:Fr.background_vert,fragmentShader:Fr.background_frag},cube:{uniforms:ei([_t.envmap,{opacity:{value:1}}]),vertexShader:Fr.cube_vert,fragmentShader:Fr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Fr.equirect_vert,fragmentShader:Fr.equirect_frag},distanceRGBA:{uniforms:ei([_t.common,_t.displacementmap,{referencePosition:{value:new de},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Fr.distanceRGBA_vert,fragmentShader:Fr.distanceRGBA_frag},shadow:{uniforms:ei([_t.lights,_t.fog,{color:{value:new Pt(0)},opacity:{value:1}}]),vertexShader:Fr.shadow_vert,fragmentShader:Fr.shadow_frag}};zi.physical={uniforms:ei([zi.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new gt(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Pt(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Fr.meshphysical_vert,fragmentShader:Fr.meshphysical_frag};function Dm(a,t,i,r,n){var o=new Pt(0),s=0,l,c,p=null,C=0,S=null;function T(P,k,W,V){var B=k.isScene===!0?k.background:null;B&&B.isTexture&&(B=t.get(B));var ee=a.xr,ue=ee.getSession&&ee.getSession();ue&&ue.environmentBlendMode==="additive"&&(B=null),B===null?O(o,s):B&&B.isColor&&(O(B,1),V=!0),(a.autoClear||V)&&a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil),B&&(B.isCubeTexture||B.isWebGLCubeRenderTarget||B.mapping===Qt)?(c===void 0&&(c=new mn(new uo(1,1,1),new ui({name:"BackgroundCubeMaterial",uniforms:Ho(zi.cube.uniforms),vertexShader:zi.cube.vertexShader,fragmentShader:zi.cube.fragmentShader,side:M,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(K,Q,se){this.matrixWorld.copyPosition(se.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(c)),B.isWebGLCubeRenderTarget&&(B=B.texture),c.material.uniforms.envMap.value=B,c.material.uniforms.flipEnvMap.value=B.isCubeTexture&&B._needsFlipEnvMap?-1:1,(p!==B||C!==B.version||S!==a.toneMapping)&&(c.material.needsUpdate=!0,p=B,C=B.version,S=a.toneMapping),P.unshift(c,c.geometry,c.material,0,0,null)):B&&B.isTexture&&(l===void 0&&(l=new mn(new _s(2,2),new ui({name:"BackgroundMaterial",uniforms:Ho(zi.background.uniforms),vertexShader:zi.background.vertexShader,fragmentShader:zi.background.fragmentShader,side:L,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=B,B.matrixAutoUpdate===!0&&B.updateMatrix(),l.material.uniforms.uvTransform.value.copy(B.matrix),(p!==B||C!==B.version||S!==a.toneMapping)&&(l.material.needsUpdate=!0,p=B,C=B.version,S=a.toneMapping),P.unshift(l,l.geometry,l.material,0,0,null))}function O(P,k){i.buffers.color.setClear(P.r,P.g,P.b,k,n)}return{getClearColor:function(){return o},setClearColor:function(k,W){W===void 0&&(W=1),o.set(k),s=W,O(o,s)},getClearAlpha:function(){return s},setClearAlpha:function(k){s=k,O(o,s)},render:T}}function Om(a,t,i,r){var n=a.getParameter(34921),o=r.isWebGL2?null:t.get("OES_vertex_array_object"),s=r.isWebGL2||o!==null,l={},c=k(null),p=c;function C(Ae,Be,Se,Te,me){var Ue=!1;if(s){var He=P(Te,Se,Be);p!==He&&(p=He,T(p.object)),Ue=W(Te,me),Ue&&V(Te,me)}else{var Ye=Be.wireframe===!0;(p.geometry!==Te.id||p.program!==Se.id||p.wireframe!==Ye)&&(p.geometry=Te.id,p.program=Se.id,p.wireframe=Ye,Ue=!0)}Ae.isInstancedMesh===!0&&(Ue=!0),me!==null&&i.update(me,34963),Ue&&(se(Ae,Be,Se,Te),me!==null&&a.bindBuffer(34963,i.get(me).buffer))}function S(){return r.isWebGL2?a.createVertexArray():o.createVertexArrayOES()}function T(Ae){return r.isWebGL2?a.bindVertexArray(Ae):o.bindVertexArrayOES(Ae)}function O(Ae){return r.isWebGL2?a.deleteVertexArray(Ae):o.deleteVertexArrayOES(Ae)}function P(Ae,Be,Se){var Te=Se.wireframe===!0,me=l[Ae.id];me===void 0&&(me={},l[Ae.id]=me);var Ue=me[Be.id];Ue===void 0&&(Ue={},me[Be.id]=Ue);var He=Ue[Te];return He===void 0&&(He=k(S()),Ue[Te]=He),He}function k(Ae){for(var Be=[],Se=[],Te=[],me=0;me<n;me++)Be[me]=0,Se[me]=0,Te[me]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Be,enabledAttributes:Se,attributeDivisors:Te,object:Ae,attributes:{},index:null}}function W(Ae,Be){var Se=p.attributes,Te=Ae.attributes,me=0;for(var Ue in Te){var He=Se[Ue],Ye=Te[Ue];if(He===void 0||He.attribute!==Ye||He.data!==Ye.data)return!0;me++}return p.attributesNum!==me||p.index!==Be}function V(Ae,Be){var Se={},Te=Ae.attributes,me=0;for(var Ue in Te){var He=Te[Ue],Ye={};Ye.attribute=He,He.data&&(Ye.data=He.data),Se[Ue]=Ye,me++}p.attributes=Se,p.attributesNum=me,p.index=Be}function B(){for(var Ae=p.newAttributes,Be=0,Se=Ae.length;Be<Se;Be++)Ae[Be]=0}function ee(Ae){ue(Ae,0)}function ue(Ae,Be){var Se=p.newAttributes,Te=p.enabledAttributes,me=p.attributeDivisors;if(Se[Ae]=1,Te[Ae]===0&&(a.enableVertexAttribArray(Ae),Te[Ae]=1),me[Ae]!==Be){var Ue=r.isWebGL2?a:t.get("ANGLE_instanced_arrays");Ue[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Ae,Be),me[Ae]=Be}}function K(){for(var Ae=p.newAttributes,Be=p.enabledAttributes,Se=0,Te=Be.length;Se<Te;Se++)Be[Se]!==Ae[Se]&&(a.disableVertexAttribArray(Se),Be[Se]=0)}function Q(Ae,Be,Se,Te,me,Ue){r.isWebGL2===!0&&(Se===5124||Se===5125)?a.vertexAttribIPointer(Ae,Be,Se,me,Ue):a.vertexAttribPointer(Ae,Be,Se,Te,me,Ue)}function se(Ae,Be,Se,Te){if(!(r.isWebGL2===!1&&(Ae.isInstancedMesh||Te.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)){B();var me=Te.attributes,Ue=Se.getAttributes(),He=Be.defaultAttributeValues;for(var Ye in Ue){var Qe=Ue[Ye];if(Qe>=0){var pt=me[Ye];if(pt!==void 0){var Et=pt.normalized,Ut=pt.itemSize,Ze=i.get(pt);if(Ze===void 0)continue;var $t=Ze.buffer,Dt=Ze.type,rr=Ze.bytesPerElement;if(pt.isInterleavedBufferAttribute){var vr=pt.data,_r=vr.stride,gr=pt.offset;vr&&vr.isInstancedInterleavedBuffer?(ue(Qe,vr.meshPerAttribute),Te._maxInstanceCount===void 0&&(Te._maxInstanceCount=vr.meshPerAttribute*vr.count)):ee(Qe),a.bindBuffer(34962,$t),Q(Qe,Ut,Dt,Et,_r*rr,gr*rr)}else pt.isInstancedBufferAttribute?(ue(Qe,pt.meshPerAttribute),Te._maxInstanceCount===void 0&&(Te._maxInstanceCount=pt.meshPerAttribute*pt.count)):ee(Qe),a.bindBuffer(34962,$t),Q(Qe,Ut,Dt,Et,0,0)}else if(Ye==="instanceMatrix"){var un=i.get(Ae.instanceMatrix);if(un===void 0)continue;var Gr=un.buffer,nn=un.type;ue(Qe+0,1),ue(Qe+1,1),ue(Qe+2,1),ue(Qe+3,1),a.bindBuffer(34962,Gr),a.vertexAttribPointer(Qe+0,4,nn,!1,64,0),a.vertexAttribPointer(Qe+1,4,nn,!1,64,16),a.vertexAttribPointer(Qe+2,4,nn,!1,64,32),a.vertexAttribPointer(Qe+3,4,nn,!1,64,48)}else if(Ye==="instanceColor"){var In=i.get(Ae.instanceColor);if(In===void 0)continue;var ni=In.buffer,Vn=In.type;ue(Qe,1),a.bindBuffer(34962,ni),a.vertexAttribPointer(Qe,3,Vn,!1,12,0)}else if(He!==void 0){var Ln=He[Ye];if(Ln!==void 0)switch(Ln.length){case 2:a.vertexAttrib2fv(Qe,Ln);break;case 3:a.vertexAttrib3fv(Qe,Ln);break;case 4:a.vertexAttrib4fv(Qe,Ln);break;default:a.vertexAttrib1fv(Qe,Ln)}}}}K()}}function Me(){Pe();for(var Ae in l){var Be=l[Ae];for(var Se in Be){var Te=Be[Se];for(var me in Te)O(Te[me].object),delete Te[me];delete Be[Se]}delete l[Ae]}}function xe(Ae){if(l[Ae.id]!==void 0){var Be=l[Ae.id];for(var Se in Be){var Te=Be[Se];for(var me in Te)O(Te[me].object),delete Te[me];delete Be[Se]}delete l[Ae.id]}}function _e(Ae){for(var Be in l){var Se=l[Be];if(Se[Ae.id]!==void 0){var Te=Se[Ae.id];for(var me in Te)O(Te[me].object),delete Te[me];delete Se[Ae.id]}}}function Pe(){Ce(),p!==c&&(p=c,T(p.object))}function Ce(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:C,reset:Pe,resetDefaultState:Ce,dispose:Me,releaseStatesOfGeometry:xe,releaseStatesOfProgram:_e,initAttributes:B,enableAttribute:ee,disableUnusedAttributes:K}}function Im(a,t,i,r){var n=r.isWebGL2,o;function s(p){o=p}function l(p,C){a.drawArrays(o,p,C),i.update(C,o,1)}function c(p,C,S){if(S!==0){var T,O;if(n)T=a,O="drawArraysInstanced";else if(T=t.get("ANGLE_instanced_arrays"),O="drawArraysInstancedANGLE",T===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}T[O](o,p,C,S),i.update(C,o,S)}}this.setMode=s,this.render=l,this.renderInstances=c}function Bm(a,t,i){var r;function n(){if(r!==void 0)return r;var Q=t.get("EXT_texture_filter_anisotropic");return Q!==null?r=a.getParameter(Q.MAX_TEXTURE_MAX_ANISOTROPY_EXT):r=0,r}function o(Q){if(Q==="highp"){if(a.getShaderPrecisionFormat(35633,36338).precision>0&&a.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";Q="mediump"}return Q==="mediump"&&a.getShaderPrecisionFormat(35633,36337).precision>0&&a.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var s=typeof WebGL2RenderingContext!="undefined"&&a instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&a instanceof WebGL2ComputeRenderingContext,l=i.precision!==void 0?i.precision:"highp",c=o(l);c!==l&&(console.warn("THREE.WebGLRenderer:",l,"not supported, using",c,"instead."),l=c);var p=i.logarithmicDepthBuffer===!0,C=a.getParameter(34930),S=a.getParameter(35660),T=a.getParameter(3379),O=a.getParameter(34076),P=a.getParameter(34921),k=a.getParameter(36347),W=a.getParameter(36348),V=a.getParameter(36349),B=S>0,ee=s||!!t.get("OES_texture_float"),ue=B&&ee,K=s?a.getParameter(36183):0;return{isWebGL2:s,getMaxAnisotropy:n,getMaxPrecision:o,precision:l,logarithmicDepthBuffer:p,maxTextures:C,maxVertexTextures:S,maxTextureSize:T,maxCubemapSize:O,maxAttributes:P,maxVertexUniforms:k,maxVaryings:W,maxFragmentUniforms:V,vertexTextures:B,floatFragmentTextures:ee,floatVertexTextures:ue,maxSamples:K}}function Fm(a){var t=this,i=null,r=0,n=!1,o=!1,s=new ta,l=new yi,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(S,T,O){var P=S.length!==0||T||r!==0||n;return n=T,i=C(S,O,0),r=S.length,P},this.beginShadows=function(){o=!0,C(null)},this.endShadows=function(){o=!1,p()},this.setState=function(S,T,O){var P=S.clippingPlanes,k=S.clipIntersection,W=S.clipShadows,V=a.get(S);if(!n||P===null||P.length===0||o&&!W)o?C(null):p();else{var B=o?0:r,ee=B*4,ue=V.clippingState||null;c.value=ue,ue=C(P,T,ee,O);for(var K=0;K!==ee;++K)ue[K]=i[K];V.clippingState=ue,this.numIntersection=k?this.numPlanes:0,this.numPlanes+=B}};function p(){c.value!==i&&(c.value=i,c.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function C(S,T,O,P){var k=S!==null?S.length:0,W=null;if(k!==0){if(W=c.value,P!==!0||W===null){var V=O+k*4,B=T.matrixWorldInverse;l.getNormalMatrix(B),(W===null||W.length<V)&&(W=new Float32Array(V));for(var ee=0,ue=O;ee!==k;++ee,ue+=4)s.copy(S[ee]).applyMatrix4(B,l),s.normal.toArray(W,ue),W[ue+3]=s.constant}c.value=W,c.needsUpdate=!0}return t.numPlanes=k,t.numIntersection=0,W}}function Nm(a){var t=new WeakMap;function i(s,l){return l===$e?s.mapping=Re:l===Rt&&(s.mapping=qe),s}function r(s){if(s&&s.isTexture){var l=s.mapping;if(l===$e||l===Rt)if(t.has(s)){var c=t.get(s).texture;return i(c,s.mapping)}else{var p=s.image;if(p&&p.height>0){var C=a.getRenderList(),S=a.getRenderTarget(),T=new oc(p.height/2);return T.fromEquirectangularTexture(a,s),t.set(s,T),a.setRenderTarget(S),a.setRenderList(C),s.addEventListener("dispose",n),i(T.texture,s.mapping)}else return null}}return s}function n(s){var l=s.target;l.removeEventListener("dispose",n);var c=t.get(l);c!==void 0&&(t.delete(l),c.dispose())}function o(){t=new WeakMap}return{get:r,dispose:o}}function km(a){var t={};function i(r){if(t[r]!==void 0)return t[r];var n;switch(r){case"WEBGL_depth_texture":n=a.getExtension("WEBGL_depth_texture")||a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=a.getExtension(r)}return t[r]=n,n}return{has:function(n){return i(n)!==null},init:function(n){n.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float")},get:function(n){var o=i(n);return o===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),o}}}function Um(a,t,i,r){var n={},o=new WeakMap;function s(S){var T=S.target;T.index!==null&&t.remove(T.index);for(var O in T.attributes)t.remove(T.attributes[O]);T.removeEventListener("dispose",s),delete n[T.id];var P=o.get(T);P&&(t.remove(P),o.delete(T)),r.releaseStatesOfGeometry(T),T.isInstancedBufferGeometry===!0&&delete T._maxInstanceCount,i.memory.geometries--}function l(S,T){return n[T.id]===!0||(T.addEventListener("dispose",s),n[T.id]=!0,i.memory.geometries++),T}function c(S){var T=S.attributes;for(var O in T)t.update(T[O],34962);var P=S.morphAttributes;for(var k in P)for(var W=P[k],V=0,B=W.length;V<B;V++)t.update(W[V],34962)}function p(S){var T=[],O=S.index,P=S.attributes.position,k=0;if(O!==null){var W=O.array;k=O.version;for(var V=0,B=W.length;V<B;V+=3){var ee=W[V+0],ue=W[V+1],K=W[V+2];T.push(ee,ue,ue,K,K,ee)}}else{var Q=P.array;k=P.version;for(var se=0,Me=Q.length/3-1;se<Me;se+=3){var xe=se+0,_e=se+1,Pe=se+2;T.push(xe,_e,_e,Pe,Pe,xe)}}var Ce=new(xh(T)>65535?lo:so)(T,1);Ce.version=k;var Ae=o.get(S);Ae&&t.remove(Ae),o.set(S,Ce)}function C(S){var T=o.get(S);if(T){var O=S.index;O!==null&&T.version<O.version&&p(S)}else p(S);return o.get(S)}return{get:l,update:c,getWireframeAttribute:C}}function Hm(a,t,i,r){var n=r.isWebGL2,o;function s(T){o=T}var l,c;function p(T){l=T.type,c=T.bytesPerElement}function C(T,O){a.drawElements(o,O,l,T*c),i.update(O,o,1)}function S(T,O,P){if(P!==0){var k,W;if(n)k=a,W="drawElementsInstanced";else if(k=t.get("ANGLE_instanced_arrays"),W="drawElementsInstancedANGLE",k===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}k[W](o,O,l,T*c,P),i.update(O,o,P)}}this.setMode=s,this.setIndex=p,this.render=C,this.renderInstances=S}function Gm(a){var t={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function r(o,s,l){switch(i.calls++,s){case 4:i.triangles+=l*(o/3);break;case 1:i.lines+=l*(o/2);break;case 3:i.lines+=l*(o-1);break;case 2:i.lines+=l*o;break;case 0:i.points+=l*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",s);break}}function n(){i.frame++,i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:t,render:i,programs:null,autoReset:!0,reset:n,update:r}}function Vm(a,t){return a[0]-t[0]}function zm(a,t){return Math.abs(t[1])-Math.abs(a[1])}function Wm(a){for(var t={},i=new Float32Array(8),r=[],n=0;n<8;n++)r[n]=[n,0];function o(s,l,c,p){var C=s.morphTargetInfluences,S=C===void 0?0:C.length,T=t[l.id];if(T===void 0){T=[];for(var O=0;O<S;O++)T[O]=[O,0];t[l.id]=T}for(var P=0;P<S;P++){var k=T[P];k[0]=P,k[1]=C[P]}T.sort(zm);for(var W=0;W<8;W++)W<S&&T[W][1]?(r[W][0]=T[W][0],r[W][1]=T[W][1]):(r[W][0]=Number.MAX_SAFE_INTEGER,r[W][1]=0);r.sort(Vm);for(var V=c.morphTargets&&l.morphAttributes.position,B=c.morphNormals&&l.morphAttributes.normal,ee=0,ue=0;ue<8;ue++){var K=r[ue],Q=K[0],se=K[1];Q!==Number.MAX_SAFE_INTEGER&&se?(V&&l.getAttribute("morphTarget"+ue)!==V[Q]&&l.setAttribute("morphTarget"+ue,V[Q]),B&&l.getAttribute("morphNormal"+ue)!==B[Q]&&l.setAttribute("morphNormal"+ue,B[Q]),i[ue]=se,ee+=se):(V&&l.hasAttribute("morphTarget"+ue)===!0&&l.deleteAttribute("morphTarget"+ue),B&&l.hasAttribute("morphNormal"+ue)===!0&&l.deleteAttribute("morphNormal"+ue),i[ue]=0)}var Me=l.morphTargetsRelative?1:1-ee;p.getUniforms().setValue(a,"morphTargetBaseInfluence",Me),p.getUniforms().setValue(a,"morphTargetInfluences",i)}return{update:o}}function jm(a,t,i,r){var n=new WeakMap;function o(c){var p=r.render.frame,C=c.geometry,S=t.get(c,C);return n.get(S)!==p&&(t.update(S),n.set(S,p)),c.isInstancedMesh&&(c.hasEventListener("dispose",l)===!1&&c.addEventListener("dispose",l),i.update(c.instanceMatrix,34962),c.instanceColor!==null&&i.update(c.instanceColor,34962)),S}function s(){n=new WeakMap}function l(c){var p=c.target;p.removeEventListener("dispose",l),i.remove(p.instanceMatrix),p.instanceColor!==null&&i.remove(p.instanceColor)}return{update:o,dispose:s}}function Wo(a,t,i,r){a===void 0&&(a=null),t===void 0&&(t=1),i===void 0&&(i=1),r===void 0&&(r=1),ln.call(this,null),this.image={data:a,width:t,height:i,depth:r},this.magFilter=ar,this.minFilter=ar,this.wrapR=Vt,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Wo.prototype=Object.create(ln.prototype),Wo.prototype.constructor=Wo,Wo.prototype.isDataTexture2DArray=!0;function jo(a,t,i,r){a===void 0&&(a=null),t===void 0&&(t=1),i===void 0&&(i=1),r===void 0&&(r=1),ln.call(this,null),this.image={data:a,width:t,height:i,depth:r},this.magFilter=ar,this.minFilter=ar,this.wrapR=Vt,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}jo.prototype=Object.create(ln.prototype),jo.prototype.constructor=jo,jo.prototype.isDataTexture3D=!0;var Sh=new ln,Xm=new Wo,Ym=new jo,_h=new aa,Ch=[],Lh=[],Rh=new Float32Array(16),Ph=new Float32Array(9),Dh=new Float32Array(4);function Xo(a,t,i){var r=a[0];if(r<=0||r>0)return a;var n=t*i,o=Ch[n];if(o===void 0&&(o=new Float32Array(n),Ch[n]=o),t!==0){r.toArray(o,0);for(var s=1,l=0;s!==t;++s)l+=i,a[s].toArray(o,l)}return o}function Pi(a,t){if(a.length!==t.length)return!1;for(var i=0,r=a.length;i<r;i++)if(a[i]!==t[i])return!1;return!0}function wi(a,t){for(var i=0,r=t.length;i<r;i++)a[i]=t[i]}function Oh(a,t){var i=Lh[t];i===void 0&&(i=new Int32Array(t),Lh[t]=i);for(var r=0;r!==t;++r)i[r]=a.allocateTextureUnit();return i}function Qm(a,t){var i=this.cache;i[0]!==t&&(a.uniform1f(this.addr,t),i[0]=t)}function qm(a,t){var i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(a.uniform2f(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(Pi(i,t))return;a.uniform2fv(this.addr,t),wi(i,t)}}function Jm(a,t){var i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(a.uniform3f(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else if(t.r!==void 0)(i[0]!==t.r||i[1]!==t.g||i[2]!==t.b)&&(a.uniform3f(this.addr,t.r,t.g,t.b),i[0]=t.r,i[1]=t.g,i[2]=t.b);else{if(Pi(i,t))return;a.uniform3fv(this.addr,t),wi(i,t)}}function Zm(a,t){var i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(a.uniform4f(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(Pi(i,t))return;a.uniform4fv(this.addr,t),wi(i,t)}}function Km(a,t){var i=this.cache,r=t.elements;if(r===void 0){if(Pi(i,t))return;a.uniformMatrix2fv(this.addr,!1,t),wi(i,t)}else{if(Pi(i,r))return;Dh.set(r),a.uniformMatrix2fv(this.addr,!1,Dh),wi(i,r)}}function $m(a,t){var i=this.cache,r=t.elements;if(r===void 0){if(Pi(i,t))return;a.uniformMatrix3fv(this.addr,!1,t),wi(i,t)}else{if(Pi(i,r))return;Ph.set(r),a.uniformMatrix3fv(this.addr,!1,Ph),wi(i,r)}}function eg(a,t){var i=this.cache,r=t.elements;if(r===void 0){if(Pi(i,t))return;a.uniformMatrix4fv(this.addr,!1,t),wi(i,t)}else{if(Pi(i,r))return;Rh.set(r),a.uniformMatrix4fv(this.addr,!1,Rh),wi(i,r)}}function tg(a,t,i){var r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(a.uniform1i(this.addr,n),r[0]=n),i.safeSetTexture2D(t||Sh,n)}function rg(a,t,i){var r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(a.uniform1i(this.addr,n),r[0]=n),i.setTexture2DArray(t||Xm,n)}function ng(a,t,i){var r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(a.uniform1i(this.addr,n),r[0]=n),i.setTexture3D(t||Ym,n)}function ig(a,t,i){var r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(a.uniform1i(this.addr,n),r[0]=n),i.safeSetTextureCube(t||_h,n)}function ag(a,t){var i=this.cache;i[0]!==t&&(a.uniform1i(this.addr,t),i[0]=t)}function og(a,t){var i=this.cache;Pi(i,t)||(a.uniform2iv(this.addr,t),wi(i,t))}function sg(a,t){var i=this.cache;Pi(i,t)||(a.uniform3iv(this.addr,t),wi(i,t))}function lg(a,t){var i=this.cache;Pi(i,t)||(a.uniform4iv(this.addr,t),wi(i,t))}function ug(a,t){var i=this.cache;i[0]!==t&&(a.uniform1ui(this.addr,t),i[0]=t)}function cg(a){switch(a){case 5126:return Qm;case 35664:return qm;case 35665:return Jm;case 35666:return Zm;case 35674:return Km;case 35675:return $m;case 35676:return eg;case 5124:case 35670:return ag;case 35667:case 35671:return og;case 35668:case 35672:return sg;case 35669:case 35673:return lg;case 5125:return ug;case 35678:case 36198:case 36298:case 36306:case 35682:return tg;case 35679:case 36299:case 36307:return ng;case 35680:case 36300:case 36308:case 36293:return ig;case 36289:case 36303:case 36311:case 36292:return rg}}function hg(a,t){a.uniform1fv(this.addr,t)}function dg(a,t){a.uniform1iv(this.addr,t)}function fg(a,t){a.uniform2iv(this.addr,t)}function pg(a,t){a.uniform3iv(this.addr,t)}function vg(a,t){a.uniform4iv(this.addr,t)}function mg(a,t){var i=Xo(t,this.size,2);a.uniform2fv(this.addr,i)}function gg(a,t){var i=Xo(t,this.size,3);a.uniform3fv(this.addr,i)}function yg(a,t){var i=Xo(t,this.size,4);a.uniform4fv(this.addr,i)}function Ag(a,t){var i=Xo(t,this.size,4);a.uniformMatrix2fv(this.addr,!1,i)}function bg(a,t){var i=Xo(t,this.size,9);a.uniformMatrix3fv(this.addr,!1,i)}function Eg(a,t){var i=Xo(t,this.size,16);a.uniformMatrix4fv(this.addr,!1,i)}function wg(a,t,i){var r=t.length,n=Oh(i,r);a.uniform1iv(this.addr,n);for(var o=0;o!==r;++o)i.safeSetTexture2D(t[o]||Sh,n[o])}function xg(a,t,i){var r=t.length,n=Oh(i,r);a.uniform1iv(this.addr,n);for(var o=0;o!==r;++o)i.safeSetTextureCube(t[o]||_h,n[o])}function Mg(a){switch(a){case 5126:return hg;case 35664:return mg;case 35665:return gg;case 35666:return yg;case 35674:return Ag;case 35675:return bg;case 35676:return Eg;case 5124:case 35670:return dg;case 35667:case 35671:return fg;case 35668:case 35672:return pg;case 35669:case 35673:return vg;case 35678:case 36198:case 36298:case 36306:case 35682:return wg;case 35680:case 36300:case 36308:case 36293:return xg}}function Tg(a,t,i){this.id=a,this.addr=i,this.cache=[],this.setValue=cg(t.type)}function Ih(a,t,i){this.id=a,this.addr=i,this.cache=[],this.size=t.size,this.setValue=Mg(t.type)}Ih.prototype.updateCache=function(a){var t=this.cache;a instanceof Float32Array&&t.length!==a.length&&(this.cache=new Float32Array(a.length)),wi(t,a)};function Bh(a){this.id=a,this.seq=[],this.map={}}Bh.prototype.setValue=function(a,t,i){for(var r=this.seq,n=0,o=r.length;n!==o;++n){var s=r[n];s.setValue(a,t[s.id],i)}};var lc=/(\w+)(\])?(\[|\.)?/g;function Fh(a,t){a.seq.push(t),a.map[t.id]=t}function Sg(a,t,i){var r=a.name,n=r.length;for(lc.lastIndex=0;;){var o=lc.exec(r),s=lc.lastIndex,l=o[1],c=o[2]==="]",p=o[3];if(c&&(l=l|0),p===void 0||p==="["&&s+2===n){Fh(i,p===void 0?new Tg(l,a,t):new Ih(l,a,t));break}else{var C=i.map,S=C[l];S===void 0&&(S=new Bh(l),Fh(i,S)),i=S}}}function Ha(a,t){this.seq=[],this.map={};for(var i=a.getProgramParameter(t,35718),r=0;r<i;++r){var n=a.getActiveUniform(t,r),o=a.getUniformLocation(t,n.name);Sg(n,o,this)}}Ha.prototype.setValue=function(a,t,i,r){var n=this.map[t];n!==void 0&&n.setValue(a,i,r)},Ha.prototype.setOptional=function(a,t,i){var r=t[i];r!==void 0&&this.setValue(a,i,r)},Ha.upload=function(a,t,i,r){for(var n=0,o=t.length;n!==o;++n){var s=t[n],l=i[s.id];l.needsUpdate!==!1&&s.setValue(a,l.value,r)}},Ha.seqWithValue=function(a,t){for(var i=[],r=0,n=a.length;r!==n;++r){var o=a[r];o.id in t&&i.push(o)}return i};function Nh(a,t,i){var r=a.createShader(t);return a.shaderSource(r,i),a.compileShader(r),r}var _g=0;function Cg(a){for(var t=a.split(`
`),i=0;i<t.length;i++)t[i]=i+1+": "+t[i];return t.join(`
`)}function kh(a){switch(a){case li:return["Linear","( value )"];case hs:return["sRGB","( value )"];case ol:return["RGBE","( value )"];case Ou:return["RGBM","( value, 7.0 )"];case Iu:return["RGBM","( value, 16.0 )"];case Bu:return["RGBD","( value, 256.0 )"];case al:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case ah:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",a),["Linear","( value )"]}}function Uh(a,t,i){var r=a.getShaderParameter(t,35713),n=a.getShaderInfoLog(t).trim();if(r&&n==="")return"";var o=a.getShaderSource(t);return"THREE.WebGLShader: gl.getShaderInfoLog() "+i+`
`+n+Cg(o)}function Cs(a,t){var i=kh(t);return"vec4 "+a+"( vec4 value ) { return "+i[0]+"ToLinear"+i[1]+"; }"}function Lg(a,t){var i=kh(t);return"vec4 "+a+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function Rg(a,t){var i;switch(t){case lt:i="Linear";break;case vt:i="Reinhard";break;case $:i="OptimizedCineon";break;case U:i="ACESFilmic";break;case H:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),i="Linear"}return"vec3 "+a+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function Pg(a){var t=[a.extensionDerivatives||a.envMapCubeUV||a.bumpMap||a.tangentSpaceNormalMap||a.clearcoatNormalMap||a.flatShading||a.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(a.extensionFragDepth||a.logarithmicDepthBuffer)&&a.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",a.extensionDrawBuffers&&a.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(a.extensionShaderTextureLOD||a.envMap)&&a.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""];return t.filter(Ls).join(`
`)}function Dg(a){var t=[];for(var i in a){var r=a[i];r!==!1&&t.push("#define "+i+" "+r)}return t.join(`
`)}function Og(a,t){for(var i={},r=a.getProgramParameter(t,35721),n=0;n<r;n++){var o=a.getActiveAttrib(t,n),s=o.name;i[s]=a.getAttribLocation(t,s)}return i}function Ls(a){return a!==""}function Hh(a,t){return a.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Gh(a,t){return a.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var Ig=/^[ \t]*#include +<([\w\d./]+)>/gm;function uc(a){return a.replace(Ig,Bg)}function Bg(a,t){var i=Fr[t];if(i===void 0)throw new Error("Can not resolve #include <"+t+">");return uc(i)}var Fg=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Ng=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Vh(a){return a.replace(Ng,zh).replace(Fg,kg)}function kg(a,t,i,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),zh(a,t,i,r)}function zh(a,t,i,r){for(var n="",o=parseInt(t);o<parseInt(i);o++)n+=r.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return n}function Wh(a){var t="precision "+a.precision+` float;
precision `+a.precision+" int;";return a.precision==="highp"?t+=`
#define HIGH_PRECISION`:a.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:a.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function Ug(a){var t="SHADOWMAP_TYPE_BASIC";return a.shadowMapType===g?t="SHADOWMAP_TYPE_PCF":a.shadowMapType===y?t="SHADOWMAP_TYPE_PCF_SOFT":a.shadowMapType===x&&(t="SHADOWMAP_TYPE_VSM"),t}function Hg(a){var t="ENVMAP_TYPE_CUBE";if(a.envMap)switch(a.envMapMode){case Re:case qe:t="ENVMAP_TYPE_CUBE";break;case Qt:case Ar:t="ENVMAP_TYPE_CUBE_UV";break}return t}function Gg(a){var t="ENVMAP_MODE_REFLECTION";if(a.envMap)switch(a.envMapMode){case qe:case Ar:t="ENVMAP_MODE_REFRACTION";break}return t}function Vg(a){var t="ENVMAP_BLENDING_NONE";if(a.envMap)switch(a.combine){case De:t="ENVMAP_BLENDING_MULTIPLY";break;case Fe:t="ENVMAP_BLENDING_MIX";break;case Xe:t="ENVMAP_BLENDING_ADD";break}return t}function zg(a,t,i,r){var n=a.getContext(),o=i.defines,s=i.vertexShader,l=i.fragmentShader,c=Ug(i),p=Hg(i),C=Gg(i),S=Vg(i),T=a.gammaFactor>0?a.gammaFactor:1,O=i.isWebGL2?"":Pg(i),P=Dg(o),k=n.createProgram(),W,V,B=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(W=[P].filter(Ls).join(`
`),W.length>0&&(W+=`
`),V=[O,P].filter(Ls).join(`
`),V.length>0&&(V+=`
`)):(W=[Wh(i),"#define SHADER_NAME "+i.shaderName,P,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+T,"#define MAX_BONES "+i.maxBones,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+C:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.useVertexTexture?"#define BONE_TEXTURE":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+c:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Ls).join(`
`),V=[O,Wh(i),"#define SHADER_NAME "+i.shaderName,P,i.alphaTest?"#define ALPHATEST "+i.alphaTest+(i.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+T,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+p:"",i.envMap?"#define "+C:"",i.envMap?"#define "+S:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.sheen?"#define USE_SHEEN":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+c:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(i.extensionShaderTextureLOD||i.envMap)&&i.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==at?"#define TONE_MAPPING":"",i.toneMapping!==at?Fr.tonemapping_pars_fragment:"",i.toneMapping!==at?Rg("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",Fr.encodings_pars_fragment,i.map?Cs("mapTexelToLinear",i.mapEncoding):"",i.matcap?Cs("matcapTexelToLinear",i.matcapEncoding):"",i.envMap?Cs("envMapTexelToLinear",i.envMapEncoding):"",i.emissiveMap?Cs("emissiveMapTexelToLinear",i.emissiveMapEncoding):"",i.lightMap?Cs("lightMapTexelToLinear",i.lightMapEncoding):"",Lg("linearToOutputTexel",i.outputEncoding),i.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(Ls).join(`
`)),s=uc(s),s=Hh(s,i),s=Gh(s,i),l=uc(l),l=Hh(l,i),l=Gh(l,i),s=Vh(s),l=Vh(l),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(B=`#version 300 es
`,W=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+W,V=["#define varying in",i.glslVersion===Fu?"":"out highp vec4 pc_fragColor;",i.glslVersion===Fu?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+V);var ee=B+W+s,ue=B+V+l,K=Nh(n,35633,ee),Q=Nh(n,35632,ue);if(n.attachShader(k,K),n.attachShader(k,Q),i.index0AttributeName!==void 0?n.bindAttribLocation(k,0,i.index0AttributeName):i.morphTargets===!0&&n.bindAttribLocation(k,0,"position"),n.linkProgram(k),a.debug.checkShaderErrors){var se=n.getProgramInfoLog(k).trim(),Me=n.getShaderInfoLog(K).trim(),xe=n.getShaderInfoLog(Q).trim(),_e=!0,Pe=!0;if(n.getProgramParameter(k,35714)===!1){_e=!1;var Ce=Uh(n,K,"vertex"),Ae=Uh(n,Q,"fragment");console.error("THREE.WebGLProgram: shader error: ",n.getError(),"35715",n.getProgramParameter(k,35715),"gl.getProgramInfoLog",se,Ce,Ae)}else se!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",se):(Me===""||xe==="")&&(Pe=!1);Pe&&(this.diagnostics={runnable:_e,programLog:se,vertexShader:{log:Me,prefix:W},fragmentShader:{log:xe,prefix:V}})}n.deleteShader(K),n.deleteShader(Q);var Be;this.getUniforms=function(){return Be===void 0&&(Be=new Ha(n,k)),Be};var Se;return this.getAttributes=function(){return Se===void 0&&(Se=Og(n,k)),Se},this.destroy=function(){r.releaseStatesOfProgram(this),n.deleteProgram(k),this.program=void 0},this.name=i.shaderName,this.id=_g++,this.cacheKey=t,this.usedTimes=1,this.program=k,this.vertexShader=K,this.fragmentShader=Q,this}function Wg(a,t,i,r,n,o){var s=[],l=r.isWebGL2,c=r.logarithmicDepthBuffer,p=r.floatVertexTextures,C=r.maxVertexUniforms,S=r.vertexTextures,T=r.precision,O={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},P=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function k(Q){var se=Q.skeleton,Me=se.bones;if(p)return 1024;var xe=C,_e=Math.floor((xe-20)/4),Pe=Math.min(_e,Me.length);return Pe<Me.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Me.length+" bones. This GPU supports "+Pe+"."),0):Pe}function W(Q){var se;return Q&&Q.isTexture?se=Q.encoding:Q&&Q.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),se=Q.texture.encoding):se=li,se}function V(Q,se,Me,xe,_e){var Pe=xe.fog,Ce=Q.isMeshStandardMaterial?xe.environment:null,Ae=t.get(Q.envMap||Ce),Be=O[Q.type],Se=_e.isSkinnedMesh?k(_e):0;Q.precision!==null&&(T=r.getMaxPrecision(Q.precision),T!==Q.precision&&console.warn("THREE.WebGLProgram.getParameters:",Q.precision,"not supported, using",T,"instead."));var Te,me;if(Be){var Ue=zi[Be];Te=Ue.vertexShader,me=Ue.fragmentShader}else Te=Q.vertexShader,me=Q.fragmentShader;var He=a.getRenderTarget(),Ye={isWebGL2:l,shaderID:Be,shaderName:Q.type,vertexShader:Te,fragmentShader:me,defines:Q.defines,isRawShaderMaterial:Q.isRawShaderMaterial===!0,glslVersion:Q.glslVersion,precision:T,instancing:_e.isInstancedMesh===!0,instancingColor:_e.isInstancedMesh===!0&&_e.instanceColor!==null,supportsVertexTextures:S,outputEncoding:He!==null?W(He.texture):a.outputEncoding,map:!!Q.map,mapEncoding:W(Q.map),matcap:!!Q.matcap,matcapEncoding:W(Q.matcap),envMap:!!Ae,envMapMode:Ae&&Ae.mapping,envMapEncoding:W(Ae),envMapCubeUV:!!Ae&&(Ae.mapping===Qt||Ae.mapping===Ar),lightMap:!!Q.lightMap,lightMapEncoding:W(Q.lightMap),aoMap:!!Q.aoMap,emissiveMap:!!Q.emissiveMap,emissiveMapEncoding:W(Q.emissiveMap),bumpMap:!!Q.bumpMap,normalMap:!!Q.normalMap,objectSpaceNormalMap:Q.normalMapType===lh,tangentSpaceNormalMap:Q.normalMapType===ro,clearcoatMap:!!Q.clearcoatMap,clearcoatRoughnessMap:!!Q.clearcoatRoughnessMap,clearcoatNormalMap:!!Q.clearcoatNormalMap,displacementMap:!!Q.displacementMap,roughnessMap:!!Q.roughnessMap,metalnessMap:!!Q.metalnessMap,specularMap:!!Q.specularMap,alphaMap:!!Q.alphaMap,gradientMap:!!Q.gradientMap,sheen:!!Q.sheen,transmissionMap:!!Q.transmissionMap,combine:Q.combine,vertexTangents:Q.normalMap&&Q.vertexTangents,vertexColors:Q.vertexColors,vertexUvs:!!Q.map||!!Q.bumpMap||!!Q.normalMap||!!Q.specularMap||!!Q.alphaMap||!!Q.emissiveMap||!!Q.roughnessMap||!!Q.metalnessMap||!!Q.clearcoatMap||!!Q.clearcoatRoughnessMap||!!Q.clearcoatNormalMap||!!Q.displacementMap||!!Q.transmissionMap,uvsVertexOnly:!(!!Q.map||!!Q.bumpMap||!!Q.normalMap||!!Q.specularMap||!!Q.alphaMap||!!Q.emissiveMap||!!Q.roughnessMap||!!Q.metalnessMap||!!Q.clearcoatNormalMap||!!Q.transmissionMap)&&!!Q.displacementMap,fog:!!Pe,useFog:Q.fog,fogExp2:Pe&&Pe.isFogExp2,flatShading:Q.flatShading,sizeAttenuation:Q.sizeAttenuation,logarithmicDepthBuffer:c,skinning:Q.skinning&&Se>0,maxBones:Se,useVertexTexture:p,morphTargets:Q.morphTargets,morphNormals:Q.morphNormals,maxMorphTargets:a.maxMorphTargets,maxMorphNormals:a.maxMorphNormals,numDirLights:se.directional.length,numPointLights:se.point.length,numSpotLights:se.spot.length,numRectAreaLights:se.rectArea.length,numHemiLights:se.hemi.length,numDirLightShadows:se.directionalShadowMap.length,numPointLightShadows:se.pointShadowMap.length,numSpotLightShadows:se.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:Q.dithering,shadowMapEnabled:a.shadowMap.enabled&&Me.length>0,shadowMapType:a.shadowMap.type,toneMapping:Q.toneMapped?a.toneMapping:at,physicallyCorrectLights:a.physicallyCorrectLights,premultipliedAlpha:Q.premultipliedAlpha,alphaTest:Q.alphaTest,doubleSided:Q.side===R,flipSided:Q.side===M,depthPacking:Q.depthPacking!==void 0?Q.depthPacking:!1,index0AttributeName:Q.index0AttributeName,extensionDerivatives:Q.extensions&&Q.extensions.derivatives,extensionFragDepth:Q.extensions&&Q.extensions.fragDepth,extensionDrawBuffers:Q.extensions&&Q.extensions.drawBuffers,extensionShaderTextureLOD:Q.extensions&&Q.extensions.shaderTextureLOD,rendererExtensionFragDepth:l||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:l||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:l||i.has("EXT_shader_texture_lod"),customProgramCacheKey:Q.customProgramCacheKey()};return Ye}function B(Q){var se=[];if(Q.shaderID?se.push(Q.shaderID):(se.push(Q.fragmentShader),se.push(Q.vertexShader)),Q.defines!==void 0)for(var Me in Q.defines)se.push(Me),se.push(Q.defines[Me]);if(Q.isRawShaderMaterial===!1){for(var xe=0;xe<P.length;xe++)se.push(Q[P[xe]]);se.push(a.outputEncoding),se.push(a.gammaFactor)}return se.push(Q.customProgramCacheKey),se.join()}function ee(Q){var se=O[Q.type],Me;if(se){var xe=zi[se];Me=Th.clone(xe.uniforms)}else Me=Q.uniforms;return Me}function ue(Q,se){for(var Me,xe=0,_e=s.length;xe<_e;xe++){var Pe=s[xe];if(Pe.cacheKey===se){Me=Pe,++Me.usedTimes;break}}return Me===void 0&&(Me=new zg(a,se,Q,n),s.push(Me)),Me}function K(Q){if(--Q.usedTimes==0){var se=s.indexOf(Q);s[se]=s[s.length-1],s.pop(),Q.destroy()}}return{getParameters:V,getProgramCacheKey:B,getUniforms:ee,acquireProgram:ue,releaseProgram:K,programs:s}}function jg(){var a=new WeakMap;function t(o){var s=a.get(o);return s===void 0&&(s={},a.set(o,s)),s}function i(o){a.delete(o)}function r(o,s,l){a.get(o)[s]=l}function n(){a=new WeakMap}return{get:t,remove:i,update:r,dispose:n}}function Xg(a,t){return a.groupOrder!==t.groupOrder?a.groupOrder-t.groupOrder:a.renderOrder!==t.renderOrder?a.renderOrder-t.renderOrder:a.program!==t.program?a.program.id-t.program.id:a.material.id!==t.material.id?a.material.id-t.material.id:a.z!==t.z?a.z-t.z:a.id-t.id}function Yg(a,t){return a.groupOrder!==t.groupOrder?a.groupOrder-t.groupOrder:a.renderOrder!==t.renderOrder?a.renderOrder-t.renderOrder:a.z!==t.z?t.z-a.z:a.id-t.id}function jh(a){var t=[],i=0,r=[],n=[],o={id:-1};function s(){i=0,r.length=0,n.length=0}function l(T,O,P,k,W,V){var B=t[i],ee=a.get(P);return B===void 0?(B={id:T.id,object:T,geometry:O,material:P,program:ee.program||o,groupOrder:k,renderOrder:T.renderOrder,z:W,group:V},t[i]=B):(B.id=T.id,B.object=T,B.geometry=O,B.material=P,B.program=ee.program||o,B.groupOrder=k,B.renderOrder=T.renderOrder,B.z=W,B.group=V),i++,B}function c(T,O,P,k,W,V){var B=l(T,O,P,k,W,V);(P.transparent===!0?n:r).push(B)}function p(T,O,P,k,W,V){var B=l(T,O,P,k,W,V);(P.transparent===!0?n:r).unshift(B)}function C(T,O){r.length>1&&r.sort(T||Xg),n.length>1&&n.sort(O||Yg)}function S(){for(var T=i,O=t.length;T<O;T++){var P=t[T];if(P.id===null)break;P.id=null,P.object=null,P.geometry=null,P.material=null,P.program=null,P.group=null}}return{opaque:r,transparent:n,init:s,push:c,unshift:p,finish:S,sort:C}}function Qg(a){var t=new WeakMap;function i(n,o){var s=t.get(n),l;return s===void 0?(l=new jh(a),t.set(n,new WeakMap),t.get(n).set(o,l)):(l=s.get(o),l===void 0&&(l=new jh(a),s.set(o,l))),l}function r(){t=new WeakMap}return{get:i,dispose:r}}function qg(){var a={};return{get:function(i){if(a[i.id]!==void 0)return a[i.id];var r;switch(i.type){case"DirectionalLight":r={direction:new de,color:new Pt};break;case"SpotLight":r={position:new de,direction:new de,color:new Pt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new de,color:new Pt,distance:0,decay:0};break;case"HemisphereLight":r={direction:new de,skyColor:new Pt,groundColor:new Pt};break;case"RectAreaLight":r={color:new Pt,position:new de,halfWidth:new de,halfHeight:new de};break}return a[i.id]=r,r}}}function Jg(){var a={};return{get:function(i){if(a[i.id]!==void 0)return a[i.id];var r;switch(i.type){case"DirectionalLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gt};break;case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gt};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gt,shadowCameraNear:1,shadowCameraFar:1e3};break}return a[i.id]=r,r}}}var Zg=0;function Kg(a,t){return(t.castShadow?1:0)-(a.castShadow?1:0)}function $g(a,t){for(var i=new qg,r=Jg(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},o=0;o<9;o++)n.probe.push(new de);var s=new de,l=new Lr,c=new Lr;function p(S){for(var T=0,O=0,P=0,k=0;k<9;k++)n.probe[k].set(0,0,0);var W=0,V=0,B=0,ee=0,ue=0,K=0,Q=0,se=0;S.sort(Kg);for(var Me=0,xe=S.length;Me<xe;Me++){var _e=S[Me],Pe=_e.color,Ce=_e.intensity,Ae=_e.distance,Be=_e.shadow&&_e.shadow.map?_e.shadow.map.texture:null;if(_e.isAmbientLight)T+=Pe.r*Ce,O+=Pe.g*Ce,P+=Pe.b*Ce;else if(_e.isLightProbe)for(var Se=0;Se<9;Se++)n.probe[Se].addScaledVector(_e.sh.coefficients[Se],Ce);else if(_e.isDirectionalLight){var Te=i.get(_e);if(Te.color.copy(_e.color).multiplyScalar(_e.intensity),_e.castShadow){var me=_e.shadow,Ue=r.get(_e);Ue.shadowBias=me.bias,Ue.shadowNormalBias=me.normalBias,Ue.shadowRadius=me.radius,Ue.shadowMapSize=me.mapSize,n.directionalShadow[W]=Ue,n.directionalShadowMap[W]=Be,n.directionalShadowMatrix[W]=_e.shadow.matrix,K++}n.directional[W]=Te,W++}else if(_e.isSpotLight){var He=i.get(_e);if(He.position.setFromMatrixPosition(_e.matrixWorld),He.color.copy(Pe).multiplyScalar(Ce),He.distance=Ae,He.coneCos=Math.cos(_e.angle),He.penumbraCos=Math.cos(_e.angle*(1-_e.penumbra)),He.decay=_e.decay,_e.castShadow){var Ye=_e.shadow,Qe=r.get(_e);Qe.shadowBias=Ye.bias,Qe.shadowNormalBias=Ye.normalBias,Qe.shadowRadius=Ye.radius,Qe.shadowMapSize=Ye.mapSize,n.spotShadow[B]=Qe,n.spotShadowMap[B]=Be,n.spotShadowMatrix[B]=_e.shadow.matrix,se++}n.spot[B]=He,B++}else if(_e.isRectAreaLight){var pt=i.get(_e);pt.color.copy(Pe).multiplyScalar(Ce),pt.halfWidth.set(_e.width*.5,0,0),pt.halfHeight.set(0,_e.height*.5,0),n.rectArea[ee]=pt,ee++}else if(_e.isPointLight){var Et=i.get(_e);if(Et.color.copy(_e.color).multiplyScalar(_e.intensity),Et.distance=_e.distance,Et.decay=_e.decay,_e.castShadow){var Ut=_e.shadow,Ze=r.get(_e);Ze.shadowBias=Ut.bias,Ze.shadowNormalBias=Ut.normalBias,Ze.shadowRadius=Ut.radius,Ze.shadowMapSize=Ut.mapSize,Ze.shadowCameraNear=Ut.camera.near,Ze.shadowCameraFar=Ut.camera.far,n.pointShadow[V]=Ze,n.pointShadowMap[V]=Be,n.pointShadowMatrix[V]=_e.shadow.matrix,Q++}n.point[V]=Et,V++}else if(_e.isHemisphereLight){var $t=i.get(_e);$t.skyColor.copy(_e.color).multiplyScalar(Ce),$t.groundColor.copy(_e.groundColor).multiplyScalar(Ce),n.hemi[ue]=$t,ue++}}ee>0&&(t.isWebGL2||a.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=_t.LTC_FLOAT_1,n.rectAreaLTC2=_t.LTC_FLOAT_2):a.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=_t.LTC_HALF_1,n.rectAreaLTC2=_t.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=T,n.ambient[1]=O,n.ambient[2]=P;var Dt=n.hash;(Dt.directionalLength!==W||Dt.pointLength!==V||Dt.spotLength!==B||Dt.rectAreaLength!==ee||Dt.hemiLength!==ue||Dt.numDirectionalShadows!==K||Dt.numPointShadows!==Q||Dt.numSpotShadows!==se)&&(n.directional.length=W,n.spot.length=B,n.rectArea.length=ee,n.point.length=V,n.hemi.length=ue,n.directionalShadow.length=K,n.directionalShadowMap.length=K,n.pointShadow.length=Q,n.pointShadowMap.length=Q,n.spotShadow.length=se,n.spotShadowMap.length=se,n.directionalShadowMatrix.length=K,n.pointShadowMatrix.length=Q,n.spotShadowMatrix.length=se,Dt.directionalLength=W,Dt.pointLength=V,Dt.spotLength=B,Dt.rectAreaLength=ee,Dt.hemiLength=ue,Dt.numDirectionalShadows=K,Dt.numPointShadows=Q,Dt.numSpotShadows=se,n.version=Zg++)}function C(S,T){for(var O=0,P=0,k=0,W=0,V=0,B=T.matrixWorldInverse,ee=0,ue=S.length;ee<ue;ee++){var K=S[ee];if(K.isDirectionalLight){var Q=n.directional[O];Q.direction.setFromMatrixPosition(K.matrixWorld),s.setFromMatrixPosition(K.target.matrixWorld),Q.direction.sub(s),Q.direction.transformDirection(B),O++}else if(K.isSpotLight){var se=n.spot[k];se.position.setFromMatrixPosition(K.matrixWorld),se.position.applyMatrix4(B),se.direction.setFromMatrixPosition(K.matrixWorld),s.setFromMatrixPosition(K.target.matrixWorld),se.direction.sub(s),se.direction.transformDirection(B),k++}else if(K.isRectAreaLight){var Me=n.rectArea[W];Me.position.setFromMatrixPosition(K.matrixWorld),Me.position.applyMatrix4(B),c.identity(),l.copy(K.matrixWorld),l.premultiply(B),c.extractRotation(l),Me.halfWidth.set(K.width*.5,0,0),Me.halfHeight.set(0,K.height*.5,0),Me.halfWidth.applyMatrix4(c),Me.halfHeight.applyMatrix4(c),W++}else if(K.isPointLight){var xe=n.point[P];xe.position.setFromMatrixPosition(K.matrixWorld),xe.position.applyMatrix4(B),P++}else if(K.isHemisphereLight){var _e=n.hemi[V];_e.direction.setFromMatrixPosition(K.matrixWorld),_e.direction.transformDirection(B),_e.direction.normalize(),V++}}}return{setup:p,setupView:C,state:n}}function Xh(a,t){var i=new $g(a,t),r=[],n=[];function o(){r.length=0,n.length=0}function s(S){r.push(S)}function l(S){n.push(S)}function c(){i.setup(r)}function p(S){i.setupView(r,S)}var C={lightsArray:r,shadowsArray:n,lights:i};return{init:o,state:C,setupLights:c,setupLightsView:p,pushLight:s,pushShadow:l}}function e0(a,t){var i=new WeakMap;function r(o,s){s===void 0&&(s=0);var l;return i.has(o)===!1?(l=new Xh(a,t),i.set(o,[]),i.get(o).push(l)):s>=i.get(o).length?(l=new Xh(a,t),i.get(o).push(l)):l=i.get(o)[s],l}function n(){i=new WeakMap}return{get:r,dispose:n}}function Ga(a){sr.call(this),this.type="MeshDepthMaterial",this.depthPacking=oh,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(a)}Ga.prototype=Object.create(sr.prototype),Ga.prototype.constructor=Ga,Ga.prototype.isMeshDepthMaterial=!0,Ga.prototype.copy=function(a){return sr.prototype.copy.call(this,a),this.depthPacking=a.depthPacking,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this};function Va(a){sr.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new de,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(a)}Va.prototype=Object.create(sr.prototype),Va.prototype.constructor=Va,Va.prototype.isMeshDistanceMaterial=!0,Va.prototype.copy=function(a){return sr.prototype.copy.call(this,a),this.referencePosition.copy(a.referencePosition),this.nearDistance=a.nearDistance,this.farDistance=a.farDistance,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this};var t0=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );
	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean * HALF_SAMPLE_RATE;
	squared_mean = squared_mean * HALF_SAMPLE_RATE;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`,r0=`void main() {
	gl_Position = vec4( position, 1.0 );
}`;function Yh(a,t,i){var r=new Ss,n=new gt,o=new gt,s=new rn,l=[],c=[],p={},C={0:M,1:L,2:R},S=new ui({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new gt},radius:{value:4}},vertexShader:r0,fragmentShader:t0}),T=S.clone();T.defines.HORIZONTAL_PASS=1;var O=new Kt;O.setAttribute("position",new lr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var P=new mn(O,S),k=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=g,this.render=function(K,Q,se){if(k.enabled!==!1&&!(k.autoUpdate===!1&&k.needsUpdate===!1)&&K.length!==0){var Me=a.getRenderTarget(),xe=a.getActiveCubeFace(),_e=a.getActiveMipmapLevel(),Pe=a.state;Pe.setBlending(z),Pe.buffers.color.setClear(1,1,1,1),Pe.buffers.depth.setTest(!0),Pe.setScissorTest(!1);for(var Ce=0,Ae=K.length;Ce<Ae;Ce++){var Be=K[Ce],Se=Be.shadow;if(Se===void 0){console.warn("THREE.WebGLShadowMap:",Be,"has no shadow.");continue}if(!(Se.autoUpdate===!1&&Se.needsUpdate===!1)){n.copy(Se.mapSize);var Te=Se.getFrameExtents();if(n.multiply(Te),o.copy(Se.mapSize),(n.x>i||n.y>i)&&(n.x>i&&(o.x=Math.floor(i/Te.x),n.x=o.x*Te.x,Se.mapSize.x=o.x),n.y>i&&(o.y=Math.floor(i/Te.y),n.y=o.y*Te.y,Se.mapSize.y=o.y)),Se.map===null&&!Se.isPointLightShadow&&this.type===x){var me={minFilter:nt,magFilter:nt,format:jn};Se.map=new Pa(n.x,n.y,me),Se.map.texture.name=Be.name+".shadowMap",Se.mapPass=new Pa(n.x,n.y,me),Se.camera.updateProjectionMatrix()}if(Se.map===null){var Ue={minFilter:ar,magFilter:ar,format:jn};Se.map=new Pa(n.x,n.y,Ue),Se.map.texture.name=Be.name+".shadowMap",Se.camera.updateProjectionMatrix()}a.setRenderTarget(Se.map),a.clear();for(var He=Se.getViewportCount(),Ye=0;Ye<He;Ye++){var Qe=Se.getViewport(Ye);s.set(o.x*Qe.x,o.y*Qe.y,o.x*Qe.z,o.y*Qe.w),Pe.viewport(s),Se.updateMatrices(Be,Ye),r=Se.getFrustum(),ue(Q,se,Se.camera,Be,this.type)}!Se.isPointLightShadow&&this.type===x&&W(Se,se),Se.needsUpdate=!1}}k.needsUpdate=!1,a.setRenderTarget(Me,xe,_e)}};function W(K,Q){var se=t.update(P);S.uniforms.shadow_pass.value=K.map.texture,S.uniforms.resolution.value=K.mapSize,S.uniforms.radius.value=K.radius,a.setRenderTarget(K.mapPass),a.clear(),a.renderBufferDirect(Q,null,se,S,P,null),T.uniforms.shadow_pass.value=K.mapPass.texture,T.uniforms.resolution.value=K.mapSize,T.uniforms.radius.value=K.radius,a.setRenderTarget(K.map),a.clear(),a.renderBufferDirect(Q,null,se,T,P,null)}function V(K,Q,se){var Me=K<<0|Q<<1|se<<2,xe=l[Me];return xe===void 0&&(xe=new Ga({depthPacking:sh,morphTargets:K,skinning:Q}),l[Me]=xe),xe}function B(K,Q,se){var Me=K<<0|Q<<1|se<<2,xe=c[Me];return xe===void 0&&(xe=new Va({morphTargets:K,skinning:Q}),c[Me]=xe),xe}function ee(K,Q,se,Me,xe,_e,Pe){var Ce=null,Ae=V,Be=K.customDepthMaterial;if(Me.isPointLight===!0&&(Ae=B,Be=K.customDistanceMaterial),Be===void 0){var Se=!1;se.morphTargets===!0&&(Se=Q.morphAttributes&&Q.morphAttributes.position&&Q.morphAttributes.position.length>0);var Te=!1;K.isSkinnedMesh===!0&&(se.skinning===!0?Te=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",K));var me=K.isInstancedMesh===!0;Ce=Ae(Se,Te,me)}else Ce=Be;if(a.localClippingEnabled&&se.clipShadows===!0&&se.clippingPlanes.length!==0){var Ue=Ce.uuid,He=se.uuid,Ye=p[Ue];Ye===void 0&&(Ye={},p[Ue]=Ye);var Qe=Ye[He];Qe===void 0&&(Qe=Ce.clone(),Ye[He]=Qe),Ce=Qe}return Ce.visible=se.visible,Ce.wireframe=se.wireframe,Pe===x?Ce.side=se.shadowSide!==null?se.shadowSide:se.side:Ce.side=se.shadowSide!==null?se.shadowSide:C[se.side],Ce.clipShadows=se.clipShadows,Ce.clippingPlanes=se.clippingPlanes,Ce.clipIntersection=se.clipIntersection,Ce.wireframeLinewidth=se.wireframeLinewidth,Ce.linewidth=se.linewidth,Me.isPointLight===!0&&Ce.isMeshDistanceMaterial===!0&&(Ce.referencePosition.setFromMatrixPosition(Me.matrixWorld),Ce.nearDistance=xe,Ce.farDistance=_e),Ce}function ue(K,Q,se,Me,xe){if(K.visible!==!1){var _e=K.layers.test(Q.layers);if(_e&&(K.isMesh||K.isLine||K.isPoints)&&(K.castShadow||K.receiveShadow&&xe===x)&&(!K.frustumCulled||r.intersectsObject(K))){K.modelViewMatrix.multiplyMatrices(se.matrixWorldInverse,K.matrixWorld);var Pe=t.update(K),Ce=K.material;if(Array.isArray(Ce))for(var Ae=Pe.groups,Be=0,Se=Ae.length;Be<Se;Be++){var Te=Ae[Be],me=Ce[Te.materialIndex];if(me&&me.visible){var Ue=ee(K,Pe,me,Me,se.near,se.far,xe);a.renderBufferDirect(se,null,Pe,Ue,K,Te)}}else if(Ce.visible){var He=ee(K,Pe,Ce,Me,se.near,se.far,xe);a.renderBufferDirect(se,null,Pe,He,K,null)}}for(var Ye=K.children,Qe=0,pt=Ye.length;Qe<pt;Qe++)ue(Ye[Qe],Q,se,Me,xe)}}}function n0(a,t,i){var r,n,o=i.isWebGL2;function s(){var Ve=!1,Ht=new rn,Ft=null,nr=new rn(0,0,0,0);return{setMask:function(xt){Ft!==xt&&!Ve&&(a.colorMask(xt,xt,xt,xt),Ft=xt)},setLocked:function(xt){Ve=xt},setClear:function(xt,yr,Cr,Sn,cn){cn===!0&&(xt*=Sn,yr*=Sn,Cr*=Sn),Ht.set(xt,yr,Cr,Sn),nr.equals(Ht)===!1&&(a.clearColor(xt,yr,Cr,Sn),nr.copy(Ht))},reset:function(){Ve=!1,Ft=null,nr.set(-1,0,0,0)}}}function l(){var Ve=!1,Ht=null,Ft=null,nr=null;return{setTest:function(xt){xt?pt(2929):Et(2929)},setMask:function(xt){Ht!==xt&&!Ve&&(a.depthMask(xt),Ht=xt)},setFunc:function(xt){if(Ft!==xt){if(xt)switch(xt){case en:a.depthFunc(512);break;case Nt:a.depthFunc(519);break;case ne:a.depthFunc(513);break;case ie:a.depthFunc(515);break;case ge:a.depthFunc(514);break;case ve:a.depthFunc(518);break;case we:a.depthFunc(516);break;case Ie:a.depthFunc(517);break;default:a.depthFunc(515)}else a.depthFunc(515);Ft=xt}},setLocked:function(xt){Ve=xt},setClear:function(xt){nr!==xt&&(a.clearDepth(xt),nr=xt)},reset:function(){Ve=!1,Ht=null,Ft=null,nr=null}}}function c(){var Ve=!1,Ht=null,Ft=null,nr=null,Ot=null,xt=null,yr=null,Cr=null,Sn=null;return{setTest:function(Qr){Ve||(Qr?pt(2960):Et(2960))},setMask:function(Qr){Ht!==Qr&&!Ve&&(a.stencilMask(Qr),Ht=Qr)},setFunc:function(Qr,Kr,Bn){(Ft!==Qr||nr!==Kr||Ot!==Bn)&&(a.stencilFunc(Qr,Kr,Bn),Ft=Qr,nr=Kr,Ot=Bn)},setOp:function(Qr,Kr,Bn){(xt!==Qr||yr!==Kr||Cr!==Bn)&&(a.stencilOp(Qr,Kr,Bn),xt=Qr,yr=Kr,Cr=Bn)},setLocked:function(Qr){Ve=Qr},setClear:function(Qr){Sn!==Qr&&(a.clearStencil(Qr),Sn=Qr)},reset:function(){Ve=!1,Ht=null,Ft=null,nr=null,Ot=null,xt=null,yr=null,Cr=null,Sn=null}}}var p=new s,C=new l,S=new c,T={},O=null,P=null,k=null,W=null,V=null,B=null,ee=null,ue=null,K=null,Q=!1,se=null,Me=null,xe=null,_e=null,Pe=null,Ce=a.getParameter(35661),Ae=!1,Be=0,Se=a.getParameter(7938);Se.indexOf("WebGL")!==-1?(Be=parseFloat(/^WebGL (\d)/.exec(Se)[1]),Ae=Be>=1):Se.indexOf("OpenGL ES")!==-1&&(Be=parseFloat(/^OpenGL ES (\d)/.exec(Se)[1]),Ae=Be>=2);var Te=null,me={},Ue=new rn,He=new rn;function Ye(Ve,Ht,Ft){var nr=new Uint8Array(4),Ot=a.createTexture();a.bindTexture(Ve,Ot),a.texParameteri(Ve,10241,9728),a.texParameteri(Ve,10240,9728);for(var xt=0;xt<Ft;xt++)a.texImage2D(Ht+xt,0,6408,1,1,0,6408,5121,nr);return Ot}var Qe={};Qe[3553]=Ye(3553,3553,1),Qe[34067]=Ye(34067,34069,6),p.setClear(0,0,0,1),C.setClear(1),S.setClear(0),pt(2929),C.setFunc(ie),_r(!1),gr(d),pt(2884),rr(z);function pt(Ve){T[Ve]!==!0&&(a.enable(Ve),T[Ve]=!0)}function Et(Ve){T[Ve]!==!1&&(a.disable(Ve),T[Ve]=!1)}function Ut(Ve){return O!==Ve?(a.useProgram(Ve),O=Ve,!0):!1}var Ze=(r={},r[j]=32774,r[ae]=32778,r[Z]=32779,r);if(o)Ze[ye]=32775,Ze[Ne]=32776;else{var $t=t.get("EXT_blend_minmax");$t!==null&&(Ze[ye]=$t.MIN_EXT,Ze[Ne]=$t.MAX_EXT)}var Dt=(n={},n[We]=0,n[ke]=1,n[it]=768,n[At]=770,n[kr]=776,n[zt]=774,n[Gt]=772,n[rt]=769,n[St]=771,n[wt]=775,n[er]=773,n);function rr(Ve,Ht,Ft,nr,Ot,xt,yr,Cr){if(Ve===z){P&&(Et(3042),P=!1);return}if(P||(pt(3042),P=!0),Ve!==le){if(Ve!==k||Cr!==Q){if((W!==j||ee!==j)&&(a.blendEquation(32774),W=j,ee=j),Cr)switch(Ve){case re:a.blendFuncSeparate(1,771,1,771);break;case Y:a.blendFunc(1,1);break;case te:a.blendFuncSeparate(0,0,769,771);break;case J:a.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ve);break}else switch(Ve){case re:a.blendFuncSeparate(770,771,1,771);break;case Y:a.blendFunc(770,1);break;case te:a.blendFunc(0,769);break;case J:a.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ve);break}V=null,B=null,ue=null,K=null,k=Ve,Q=Cr}return}Ot=Ot||Ht,xt=xt||Ft,yr=yr||nr,(Ht!==W||Ot!==ee)&&(a.blendEquationSeparate(Ze[Ht],Ze[Ot]),W=Ht,ee=Ot),(Ft!==V||nr!==B||xt!==ue||yr!==K)&&(a.blendFuncSeparate(Dt[Ft],Dt[nr],Dt[xt],Dt[yr]),V=Ft,B=nr,ue=xt,K=yr),k=Ve,Q=null}function vr(Ve,Ht){Ve.side===R?Et(2884):pt(2884);var Ft=Ve.side===M;Ht&&(Ft=!Ft),_r(Ft),Ve.blending===re&&Ve.transparent===!1?rr(z):rr(Ve.blending,Ve.blendEquation,Ve.blendSrc,Ve.blendDst,Ve.blendEquationAlpha,Ve.blendSrcAlpha,Ve.blendDstAlpha,Ve.premultipliedAlpha),C.setFunc(Ve.depthFunc),C.setTest(Ve.depthTest),C.setMask(Ve.depthWrite),p.setMask(Ve.colorWrite);var nr=Ve.stencilWrite;S.setTest(nr),nr&&(S.setMask(Ve.stencilWriteMask),S.setFunc(Ve.stencilFunc,Ve.stencilRef,Ve.stencilFuncMask),S.setOp(Ve.stencilFail,Ve.stencilZFail,Ve.stencilZPass)),Gr(Ve.polygonOffset,Ve.polygonOffsetFactor,Ve.polygonOffsetUnits)}function _r(Ve){se!==Ve&&(Ve?a.frontFace(2304):a.frontFace(2305),se=Ve)}function gr(Ve){Ve!==v?(pt(2884),Ve!==Me&&(Ve===d?a.cullFace(1029):Ve===m?a.cullFace(1028):a.cullFace(1032))):Et(2884),Me=Ve}function un(Ve){Ve!==xe&&(Ae&&a.lineWidth(Ve),xe=Ve)}function Gr(Ve,Ht,Ft){Ve?(pt(32823),(_e!==Ht||Pe!==Ft)&&(a.polygonOffset(Ht,Ft),_e=Ht,Pe=Ft)):Et(32823)}function nn(Ve){Ve?pt(3089):Et(3089)}function In(Ve){Ve===void 0&&(Ve=33984+Ce-1),Te!==Ve&&(a.activeTexture(Ve),Te=Ve)}function ni(Ve,Ht){Te===null&&In();var Ft=me[Te];Ft===void 0&&(Ft={type:void 0,texture:void 0},me[Te]=Ft),(Ft.type!==Ve||Ft.texture!==Ht)&&(a.bindTexture(Ve,Ht||Qe[Ve]),Ft.type=Ve,Ft.texture=Ht)}function Vn(){var Ve=me[Te];Ve!==void 0&&Ve.type!==void 0&&(a.bindTexture(Ve.type,null),Ve.type=void 0,Ve.texture=void 0)}function Ln(){try{a.compressedTexImage2D.apply(a,arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function Le(){try{a.texImage2D.apply(a,arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function Ee(){try{a.texImage3D.apply(a,arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function Lt(Ve){Ue.equals(Ve)===!1&&(a.scissor(Ve.x,Ve.y,Ve.z,Ve.w),Ue.copy(Ve))}function Tt(Ve){He.equals(Ve)===!1&&(a.viewport(Ve.x,Ve.y,Ve.z,Ve.w),He.copy(Ve))}function pr(){T={},Te=null,me={},O=null,P=null,k=null,W=null,V=null,B=null,ee=null,ue=null,K=null,Q=!1,se=null,Me=null,xe=null,_e=null,Pe=null,p.reset(),C.reset(),S.reset()}return{buffers:{color:p,depth:C,stencil:S},enable:pt,disable:Et,useProgram:Ut,setBlending:rr,setMaterial:vr,setFlipSided:_r,setCullFace:gr,setLineWidth:un,setPolygonOffset:Gr,setScissorTest:nn,activeTexture:In,bindTexture:ni,unbindTexture:Vn,compressedTexImage2D:Ln,texImage2D:Le,texImage3D:Ee,scissor:Lt,viewport:Tt,reset:pr}}function i0(a,t,i,r,n,o,s){var l,c,p=n.isWebGL2,C=n.maxTextures,S=n.maxCubemapSize,T=n.maxTextureSize,O=n.maxSamples,P=new WeakMap,k,W=!1;try{W=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function V(Le,Ee){return W?new OffscreenCanvas(Le,Ee):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function B(Le,Ee,Lt,Tt){var pr=1;if((Le.width>Tt||Le.height>Tt)&&(pr=Tt/Math.max(Le.width,Le.height)),pr<1||Ee===!0)if(typeof HTMLImageElement!="undefined"&&Le instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&Le instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&Le instanceof ImageBitmap){var Ve=Ee?dr.floorPowerOfTwo:Math.floor,Ht=Ve(pr*Le.width),Ft=Ve(pr*Le.height);k===void 0&&(k=V(Ht,Ft));var nr=Lt?V(Ht,Ft):k;nr.width=Ht,nr.height=Ft;var Ot=nr.getContext("2d");return Ot.drawImage(Le,0,0,Ht,Ft),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Le.width+"x"+Le.height+") to ("+Ht+"x"+Ft+")."),nr}else return"data"in Le&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Le.width+"x"+Le.height+")."),Le;return Le}function ee(Le){return dr.isPowerOfTwo(Le.width)&&dr.isPowerOfTwo(Le.height)}function ue(Le){return p?!1:Le.wrapS!==Vt||Le.wrapT!==Vt||Le.minFilter!==ar&&Le.minFilter!==nt}function K(Le,Ee){return Le.generateMipmaps&&Ee&&Le.minFilter!==ar&&Le.minFilter!==nt}function Q(Le,Ee,Lt,Tt){a.generateMipmap(Le);var pr=r.get(Ee);pr.__maxMipLevel=Math.log(Math.max(Lt,Tt))*Math.LOG2E}function se(Le,Ee,Lt){if(p===!1)return Ee;if(Le!==null){if(a[Le]!==void 0)return a[Le];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Le+"'")}var Tt=Ee;return Ee===6403&&(Lt===5126&&(Tt=33326),Lt===5131&&(Tt=33325),Lt===5121&&(Tt=33321)),Ee===6407&&(Lt===5126&&(Tt=34837),Lt===5131&&(Tt=34843),Lt===5121&&(Tt=32849)),Ee===6408&&(Lt===5126&&(Tt=34836),Lt===5131&&(Tt=34842),Lt===5121&&(Tt=32856)),(Tt===33325||Tt===33326||Tt===34842||Tt===34836)&&t.get("EXT_color_buffer_float"),Tt}function Me(Le){return Le===ar||Le===hn||Le===dn?9728:9729}function xe(Le){var Ee=Le.target;Ee.removeEventListener("dispose",xe),Pe(Ee),Ee.isVideoTexture&&P.delete(Ee),s.memory.textures--}function _e(Le){var Ee=Le.target;Ee.removeEventListener("dispose",_e),Ce(Ee),s.memory.textures--}function Pe(Le){var Ee=r.get(Le);Ee.__webglInit!==void 0&&(a.deleteTexture(Ee.__webglTexture),r.remove(Le))}function Ce(Le){var Ee=r.get(Le),Lt=r.get(Le.texture);if(!!Le){if(Lt.__webglTexture!==void 0&&a.deleteTexture(Lt.__webglTexture),Le.depthTexture&&Le.depthTexture.dispose(),Le.isWebGLCubeRenderTarget)for(var Tt=0;Tt<6;Tt++)a.deleteFramebuffer(Ee.__webglFramebuffer[Tt]),Ee.__webglDepthbuffer&&a.deleteRenderbuffer(Ee.__webglDepthbuffer[Tt]);else a.deleteFramebuffer(Ee.__webglFramebuffer),Ee.__webglDepthbuffer&&a.deleteRenderbuffer(Ee.__webglDepthbuffer),Ee.__webglMultisampledFramebuffer&&a.deleteFramebuffer(Ee.__webglMultisampledFramebuffer),Ee.__webglColorRenderbuffer&&a.deleteRenderbuffer(Ee.__webglColorRenderbuffer),Ee.__webglDepthRenderbuffer&&a.deleteRenderbuffer(Ee.__webglDepthRenderbuffer);r.remove(Le.texture),r.remove(Le)}}var Ae=0;function Be(){Ae=0}function Se(){var Le=Ae;return Le>=C&&console.warn("THREE.WebGLTextures: Trying to use "+Le+" texture units while this GPU supports only "+C),Ae+=1,Le}function Te(Le,Ee){var Lt=r.get(Le);if(Le.isVideoTexture&&nn(Le),Le.version>0&&Lt.__version!==Le.version){var Tt=Le.image;if(Tt===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(Tt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Ut(Lt,Le,Ee);return}}i.activeTexture(33984+Ee),i.bindTexture(3553,Lt.__webglTexture)}function me(Le,Ee){var Lt=r.get(Le);if(Le.version>0&&Lt.__version!==Le.version){Ut(Lt,Le,Ee);return}i.activeTexture(33984+Ee),i.bindTexture(35866,Lt.__webglTexture)}function Ue(Le,Ee){var Lt=r.get(Le);if(Le.version>0&&Lt.__version!==Le.version){Ut(Lt,Le,Ee);return}i.activeTexture(33984+Ee),i.bindTexture(32879,Lt.__webglTexture)}function He(Le,Ee){var Lt=r.get(Le);if(Le.version>0&&Lt.__version!==Le.version){Ze(Lt,Le,Ee);return}i.activeTexture(33984+Ee),i.bindTexture(34067,Lt.__webglTexture)}var Ye=(l={},l[Pr]=10497,l[Vt]=33071,l[jr]=33648,l),Qe=(c={},c[ar]=9728,c[hn]=9984,c[dn]=9986,c[nt]=9729,c[yt]=9985,c[tr]=9987,c);function pt(Le,Ee,Lt){Lt?(a.texParameteri(Le,10242,Ye[Ee.wrapS]),a.texParameteri(Le,10243,Ye[Ee.wrapT]),(Le===32879||Le===35866)&&a.texParameteri(Le,32882,Ye[Ee.wrapR]),a.texParameteri(Le,10240,Qe[Ee.magFilter]),a.texParameteri(Le,10241,Qe[Ee.minFilter])):(a.texParameteri(Le,10242,33071),a.texParameteri(Le,10243,33071),(Le===32879||Le===35866)&&a.texParameteri(Le,32882,33071),(Ee.wrapS!==Vt||Ee.wrapT!==Vt)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),a.texParameteri(Le,10240,Me(Ee.magFilter)),a.texParameteri(Le,10241,Me(Ee.minFilter)),Ee.minFilter!==ar&&Ee.minFilter!==nt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var Tt=t.get("EXT_texture_filter_anisotropic");if(Tt){if(Ee.type===Ur&&t.get("OES_texture_float_linear")===null||Ee.type===on&&(p||t.get("OES_texture_half_float_linear"))===null)return;(Ee.anisotropy>1||r.get(Ee).__currentAnisotropy)&&(a.texParameterf(Le,Tt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Ee.anisotropy,n.getMaxAnisotropy())),r.get(Ee).__currentAnisotropy=Ee.anisotropy)}}function Et(Le,Ee){Le.__webglInit===void 0&&(Le.__webglInit=!0,Ee.addEventListener("dispose",xe),Le.__webglTexture=a.createTexture(),s.memory.textures++)}function Ut(Le,Ee,Lt){var Tt=3553;Ee.isDataTexture2DArray&&(Tt=35866),Ee.isDataTexture3D&&(Tt=32879),Et(Le,Ee),i.activeTexture(33984+Lt),i.bindTexture(Tt,Le.__webglTexture),a.pixelStorei(37440,Ee.flipY),a.pixelStorei(37441,Ee.premultiplyAlpha),a.pixelStorei(3317,Ee.unpackAlignment);var pr=ue(Ee)&&ee(Ee.image)===!1,Ve=B(Ee.image,pr,!1,T),Ht=ee(Ve)||p,Ft=o.convert(Ee.format),nr=o.convert(Ee.type),Ot=se(Ee.internalFormat,Ft,nr);pt(Tt,Ee,Ht);var xt,yr=Ee.mipmaps;if(Ee.isDepthTexture)Ot=6402,p?Ee.type===Ur?Ot=36012:Ee.type===Yr?Ot=33190:Ee.type===Li?Ot=35056:Ot=33189:Ee.type===Ur&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Ee.format===et&&Ot===6402&&Ee.type!==Dr&&Ee.type!==Yr&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Ee.type=Dr,nr=o.convert(Ee.type)),Ee.format===je&&Ot===6402&&(Ot=34041,Ee.type!==Li&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Ee.type=Li,nr=o.convert(Ee.type))),i.texImage2D(3553,0,Ot,Ve.width,Ve.height,0,Ft,nr,null);else if(Ee.isDataTexture)if(yr.length>0&&Ht){for(var Cr=0,Sn=yr.length;Cr<Sn;Cr++)xt=yr[Cr],i.texImage2D(3553,Cr,Ot,xt.width,xt.height,0,Ft,nr,xt.data);Ee.generateMipmaps=!1,Le.__maxMipLevel=yr.length-1}else i.texImage2D(3553,0,Ot,Ve.width,Ve.height,0,Ft,nr,Ve.data),Le.__maxMipLevel=0;else if(Ee.isCompressedTexture){for(var cn=0,Qr=yr.length;cn<Qr;cn++)xt=yr[cn],Ee.format!==jn&&Ee.format!==Ri?Ft!==null?i.compressedTexImage2D(3553,cn,Ot,xt.width,xt.height,0,xt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(3553,cn,Ot,xt.width,xt.height,0,Ft,nr,xt.data);Le.__maxMipLevel=yr.length-1}else if(Ee.isDataTexture2DArray)i.texImage3D(35866,0,Ot,Ve.width,Ve.height,Ve.depth,0,Ft,nr,Ve.data),Le.__maxMipLevel=0;else if(Ee.isDataTexture3D)i.texImage3D(32879,0,Ot,Ve.width,Ve.height,Ve.depth,0,Ft,nr,Ve.data),Le.__maxMipLevel=0;else if(yr.length>0&&Ht){for(var Kr=0,Bn=yr.length;Kr<Bn;Kr++)xt=yr[Kr],i.texImage2D(3553,Kr,Ot,Ft,nr,xt);Ee.generateMipmaps=!1,Le.__maxMipLevel=yr.length-1}else i.texImage2D(3553,0,Ot,Ft,nr,Ve),Le.__maxMipLevel=0;K(Ee,Ht)&&Q(Tt,Ee,Ve.width,Ve.height),Le.__version=Ee.version,Ee.onUpdate&&Ee.onUpdate(Ee)}function Ze(Le,Ee,Lt){if(Ee.image.length===6){Et(Le,Ee),i.activeTexture(33984+Lt),i.bindTexture(34067,Le.__webglTexture),a.pixelStorei(37440,Ee.flipY),a.pixelStorei(37441,Ee.premultiplyAlpha),a.pixelStorei(3317,Ee.unpackAlignment);for(var Tt=Ee&&(Ee.isCompressedTexture||Ee.image[0].isCompressedTexture),pr=Ee.image[0]&&Ee.image[0].isDataTexture,Ve=[],Ht=0;Ht<6;Ht++)!Tt&&!pr?Ve[Ht]=B(Ee.image[Ht],!1,!0,S):Ve[Ht]=pr?Ee.image[Ht].image:Ee.image[Ht];var Ft=Ve[0],nr=ee(Ft)||p,Ot=o.convert(Ee.format),xt=o.convert(Ee.type),yr=se(Ee.internalFormat,Ot,xt);pt(34067,Ee,nr);var Cr;if(Tt){for(var Sn=0;Sn<6;Sn++){Cr=Ve[Sn].mipmaps;for(var cn=0;cn<Cr.length;cn++){var Qr=Cr[cn];Ee.format!==jn&&Ee.format!==Ri?Ot!==null?i.compressedTexImage2D(34069+Sn,cn,yr,Qr.width,Qr.height,0,Qr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(34069+Sn,cn,yr,Qr.width,Qr.height,0,Ot,xt,Qr.data)}}Le.__maxMipLevel=Cr.length-1}else{Cr=Ee.mipmaps;for(var Kr=0;Kr<6;Kr++)if(pr){i.texImage2D(34069+Kr,0,yr,Ve[Kr].width,Ve[Kr].height,0,Ot,xt,Ve[Kr].data);for(var Bn=0;Bn<Cr.length;Bn++){var cs=Cr[Bn],$a=cs.image[Kr].image;i.texImage2D(34069+Kr,Bn+1,yr,$a.width,$a.height,0,Ot,xt,$a.data)}}else{i.texImage2D(34069+Kr,0,yr,Ot,xt,Ve[Kr]);for(var Zi=0;Zi<Cr.length;Zi++){var Sa=Cr[Zi];i.texImage2D(34069+Kr,Zi+1,yr,Ot,xt,Sa.image[Kr])}}Le.__maxMipLevel=Cr.length}K(Ee,nr)&&Q(34067,Ee,Ft.width,Ft.height),Le.__version=Ee.version,Ee.onUpdate&&Ee.onUpdate(Ee)}}function $t(Le,Ee,Lt,Tt){var pr=o.convert(Ee.texture.format),Ve=o.convert(Ee.texture.type),Ht=se(Ee.texture.internalFormat,pr,Ve);i.texImage2D(Tt,0,Ht,Ee.width,Ee.height,0,pr,Ve,null),a.bindFramebuffer(36160,Le),a.framebufferTexture2D(36160,Lt,Tt,r.get(Ee.texture).__webglTexture,0),a.bindFramebuffer(36160,null)}function Dt(Le,Ee,Lt){if(a.bindRenderbuffer(36161,Le),Ee.depthBuffer&&!Ee.stencilBuffer){var Tt=33189;if(Lt){var pr=Ee.depthTexture;pr&&pr.isDepthTexture&&(pr.type===Ur?Tt=36012:pr.type===Yr&&(Tt=33190));var Ve=Gr(Ee);a.renderbufferStorageMultisample(36161,Ve,Tt,Ee.width,Ee.height)}else a.renderbufferStorage(36161,Tt,Ee.width,Ee.height);a.framebufferRenderbuffer(36160,36096,36161,Le)}else if(Ee.depthBuffer&&Ee.stencilBuffer){if(Lt){var Ht=Gr(Ee);a.renderbufferStorageMultisample(36161,Ht,35056,Ee.width,Ee.height)}else a.renderbufferStorage(36161,34041,Ee.width,Ee.height);a.framebufferRenderbuffer(36160,33306,36161,Le)}else{var Ft=o.convert(Ee.texture.format),nr=o.convert(Ee.texture.type),Ot=se(Ee.texture.internalFormat,Ft,nr);if(Lt){var xt=Gr(Ee);a.renderbufferStorageMultisample(36161,xt,Ot,Ee.width,Ee.height)}else a.renderbufferStorage(36161,Ot,Ee.width,Ee.height)}a.bindRenderbuffer(36161,null)}function rr(Le,Ee){var Lt=Ee&&Ee.isWebGLCubeRenderTarget;if(Lt)throw new Error("Depth Texture with cube render targets is not supported");if(a.bindFramebuffer(36160,Le),!(Ee.depthTexture&&Ee.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(Ee.depthTexture).__webglTexture||Ee.depthTexture.image.width!==Ee.width||Ee.depthTexture.image.height!==Ee.height)&&(Ee.depthTexture.image.width=Ee.width,Ee.depthTexture.image.height=Ee.height,Ee.depthTexture.needsUpdate=!0),Te(Ee.depthTexture,0);var Tt=r.get(Ee.depthTexture).__webglTexture;if(Ee.depthTexture.format===et)a.framebufferTexture2D(36160,36096,3553,Tt,0);else if(Ee.depthTexture.format===je)a.framebufferTexture2D(36160,33306,3553,Tt,0);else throw new Error("Unknown depthTexture format")}function vr(Le){var Ee=r.get(Le),Lt=Le.isWebGLCubeRenderTarget===!0;if(Le.depthTexture){if(Lt)throw new Error("target.depthTexture not supported in Cube render targets");rr(Ee.__webglFramebuffer,Le)}else if(Lt){Ee.__webglDepthbuffer=[];for(var Tt=0;Tt<6;Tt++)a.bindFramebuffer(36160,Ee.__webglFramebuffer[Tt]),Ee.__webglDepthbuffer[Tt]=a.createRenderbuffer(),Dt(Ee.__webglDepthbuffer[Tt],Le,!1)}else a.bindFramebuffer(36160,Ee.__webglFramebuffer),Ee.__webglDepthbuffer=a.createRenderbuffer(),Dt(Ee.__webglDepthbuffer,Le,!1);a.bindFramebuffer(36160,null)}function _r(Le){var Ee=r.get(Le),Lt=r.get(Le.texture);Le.addEventListener("dispose",_e),Lt.__webglTexture=a.createTexture(),s.memory.textures++;var Tt=Le.isWebGLCubeRenderTarget===!0,pr=Le.isWebGLMultisampleRenderTarget===!0,Ve=ee(Le)||p;if(p&&Le.texture.format===Ri&&(Le.texture.type===Ur||Le.texture.type===on)&&(Le.texture.format=jn,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),Tt){Ee.__webglFramebuffer=[];for(var Ht=0;Ht<6;Ht++)Ee.__webglFramebuffer[Ht]=a.createFramebuffer()}else if(Ee.__webglFramebuffer=a.createFramebuffer(),pr)if(p){Ee.__webglMultisampledFramebuffer=a.createFramebuffer(),Ee.__webglColorRenderbuffer=a.createRenderbuffer(),a.bindRenderbuffer(36161,Ee.__webglColorRenderbuffer);var Ft=o.convert(Le.texture.format),nr=o.convert(Le.texture.type),Ot=se(Le.texture.internalFormat,Ft,nr),xt=Gr(Le);a.renderbufferStorageMultisample(36161,xt,Ot,Le.width,Le.height),a.bindFramebuffer(36160,Ee.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(36160,36064,36161,Ee.__webglColorRenderbuffer),a.bindRenderbuffer(36161,null),Le.depthBuffer&&(Ee.__webglDepthRenderbuffer=a.createRenderbuffer(),Dt(Ee.__webglDepthRenderbuffer,Le,!0)),a.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(Tt){i.bindTexture(34067,Lt.__webglTexture),pt(34067,Le.texture,Ve);for(var yr=0;yr<6;yr++)$t(Ee.__webglFramebuffer[yr],Le,36064,34069+yr);K(Le.texture,Ve)&&Q(34067,Le.texture,Le.width,Le.height),i.bindTexture(34067,null)}else i.bindTexture(3553,Lt.__webglTexture),pt(3553,Le.texture,Ve),$t(Ee.__webglFramebuffer,Le,36064,3553),K(Le.texture,Ve)&&Q(3553,Le.texture,Le.width,Le.height),i.bindTexture(3553,null);Le.depthBuffer&&vr(Le)}function gr(Le){var Ee=Le.texture,Lt=ee(Le)||p;if(K(Ee,Lt)){var Tt=Le.isWebGLCubeRenderTarget?34067:3553,pr=r.get(Ee).__webglTexture;i.bindTexture(Tt,pr),Q(Tt,Ee,Le.width,Le.height),i.bindTexture(Tt,null)}}function un(Le){if(Le.isWebGLMultisampleRenderTarget)if(p){var Ee=r.get(Le);a.bindFramebuffer(36008,Ee.__webglMultisampledFramebuffer),a.bindFramebuffer(36009,Ee.__webglFramebuffer);var Lt=Le.width,Tt=Le.height,pr=16384;Le.depthBuffer&&(pr|=256),Le.stencilBuffer&&(pr|=1024),a.blitFramebuffer(0,0,Lt,Tt,0,0,Lt,Tt,pr,9728),a.bindFramebuffer(36160,Ee.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function Gr(Le){return p&&Le.isWebGLMultisampleRenderTarget?Math.min(O,Le.samples):0}function nn(Le){var Ee=s.render.frame;P.get(Le)!==Ee&&(P.set(Le,Ee),Le.update())}var In=!1,ni=!1;function Vn(Le,Ee){Le&&Le.isWebGLRenderTarget&&(In===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),In=!0),Le=Le.texture),Te(Le,Ee)}function Ln(Le,Ee){Le&&Le.isWebGLCubeRenderTarget&&(ni===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),ni=!0),Le=Le.texture),He(Le,Ee)}this.allocateTextureUnit=Se,this.resetTextureUnits=Be,this.setTexture2D=Te,this.setTexture2DArray=me,this.setTexture3D=Ue,this.setTextureCube=He,this.setupRenderTarget=_r,this.updateRenderTargetMipmap=gr,this.updateMultisampleRenderTarget=un,this.safeSetTexture2D=Vn,this.safeSetTextureCube=Ln}function Qh(a,t,i){var r=i.isWebGL2;function n(o){var s;if(o===ir)return 5121;if(o===vi)return 32819;if(o===qn)return 32820;if(o===qr)return 33635;if(o===xr)return 5120;if(o===Xr)return 5122;if(o===Dr)return 5123;if(o===Nn)return 5124;if(o===Yr)return 5125;if(o===Ur)return 5126;if(o===on)return r?5131:(s=t.get("OES_texture_half_float"),s!==null?s.HALF_FLOAT_OES:null);if(o===Wn)return 6406;if(o===Ri)return 6407;if(o===jn)return 6408;if(o===oe)return 6409;if(o===be)return 6410;if(o===et)return 6402;if(o===je)return 34041;if(o===ht)return 6403;if(o===bt)return 36244;if(o===kt)return 33319;if(o===Mt)return 33320;if(o===ct)return 36248;if(o===Wt)return 36249;if(o===qt||o===cr||o===fn||o===Or)if(s=t.get("WEBGL_compressed_texture_s3tc"),s!==null){if(o===qt)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(o===cr)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(o===fn)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(o===Or)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(o===br||o===Hr||o===yn||o===Hn)if(s=t.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(o===br)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(o===Hr)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(o===yn)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(o===Hn)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(o===hr)return s=t.get("WEBGL_compressed_texture_etc1"),s!==null?s.COMPRESSED_RGB_ETC1_WEBGL:null;if((o===Tr||o===Sr)&&(s=t.get("WEBGL_compressed_texture_etc"),s!==null)){if(o===Tr)return s.COMPRESSED_RGB8_ETC2;if(o===Sr)return s.COMPRESSED_RGBA8_ETC2_EAC}if(o===si||o===sn||o===pn||o===I||o===F||o===X||o===q||o===he||o===Oe||o===Je||o===ft||o===dt||o===ze||o===tt||o===Bt||o===jt||o===Zt||o===Er||o===fr||o===or||o===tn||o===Mn||o===Pn||o===An||o===Un||o===Jn||o===Zn||o===Kn)return s=t.get("WEBGL_compressed_texture_astc"),s!==null?o:null;if(o===mt)return s=t.get("EXT_texture_compression_bptc"),s!==null?o:null;if(o===Li)return r?34042:(s=t.get("WEBGL_depth_texture"),s!==null?s.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:n}}function Ea(){Xt.call(this),this.type="Group"}Ea.prototype=Object.assign(Object.create(Xt.prototype),{constructor:Ea,isGroup:!0});function Rs(a){a===void 0&&(a=[]),_n.call(this),this.cameras=a}Rs.prototype=Object.assign(Object.create(_n.prototype),{constructor:Rs,isArrayCamera:!0});var qh=new de,Jh=new de;function a0(a,t,i){qh.setFromMatrixPosition(t.matrixWorld),Jh.setFromMatrixPosition(i.matrixWorld);var r=qh.distanceTo(Jh),n=t.projectionMatrix.elements,o=i.projectionMatrix.elements,s=n[14]/(n[10]-1),l=n[14]/(n[10]+1),c=(n[9]+1)/n[5],p=(n[9]-1)/n[5],C=(n[8]-1)/n[0],S=(o[8]+1)/o[0],T=s*C,O=s*S,P=r/(-C+S),k=P*-C;t.matrixWorld.decompose(a.position,a.quaternion,a.scale),a.translateX(k),a.translateZ(P),a.matrixWorld.compose(a.position,a.quaternion,a.scale),a.matrixWorldInverse.getInverse(a.matrixWorld);var W=s+P,V=l+P,B=T-k,ee=O+(r-k),ue=c*l/V*W,K=p*l/V*W;a.projectionMatrix.makePerspective(B,ee,ue,K,W,V)}function Zh(a){var t,i,r=this,n=null,o=null,s=null,l=[],c=new Lr,p=new Lr,C=1,S="local-floor";typeof window!="undefined"&&"VRFrameData"in window&&(o=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",ue,!1));var T=new Lr,O=new Yn,P=new de,k=new _n;k.viewport=new rn,k.layers.enable(1);var W=new _n;W.viewport=new rn,W.layers.enable(2);var V=new Rs([k,W]);V.layers.enable(1),V.layers.enable(2);var B=new gt,ee;function ue(){var Pe=r.isPresenting=n!==null&&n.isPresenting===!0;if(Pe){var Ce=n.getEyeParameters("left");t=2*Ce.renderWidth*C,i=Ce.renderHeight*C,ee=a.getPixelRatio(),a.getSize(B),a.setDrawingBufferSize(t,i,1),k.viewport.set(0,0,t/2,i),W.viewport.set(t/2,0,t/2,i),_e.start(),r.dispatchEvent({type:"sessionstart"})}else r.enabled&&a.setDrawingBufferSize(B.width,B.height,ee),_e.stop(),r.dispatchEvent({type:"sessionend"})}var K=[],Q=[];function se(Pe){for(var Ce=navigator.getGamepads&&navigator.getGamepads(),Ae=0,Be=Ce.length;Ae<Be;Ae++){var Se=Ce[Ae];if(Se&&(Se.id==="Daydream Controller"||Se.id==="Gear VR Controller"||Se.id==="Oculus Go Controller"||Se.id==="OpenVR Gamepad"||Se.id.startsWith("Oculus Touch")||Se.id.startsWith("HTC Vive Focus")||Se.id.startsWith("Spatial Controller"))){var Te=Se.hand;if(Pe===0&&(Te===""||Te==="right")||Pe===1&&Te==="left")return Se}}}function Me(){for(var Pe=0;Pe<l.length;Pe++){var Ce=l[Pe],Ae=se(Pe);if(Ae!==void 0&&Ae.pose!==void 0){if(Ae.pose===null)return;var Be=Ae.pose;Be.hasPosition===!1&&Ce.position.set(.2,-.6,-.05),Be.position!==null&&Ce.position.fromArray(Be.position),Be.orientation!==null&&Ce.quaternion.fromArray(Be.orientation),Ce.matrix.compose(Ce.position,Ce.quaternion,Ce.scale),Ce.matrix.premultiply(c),Ce.matrix.decompose(Ce.position,Ce.quaternion,Ce.scale),Ce.matrixWorldNeedsUpdate=!0,Ce.visible=!0;var Se=Ae.id==="Daydream Controller"?0:1;K[Pe]===void 0&&(K[Pe]=!1),K[Pe]!==Ae.buttons[Se].pressed&&(K[Pe]=Ae.buttons[Se].pressed,K[Pe]===!0?Ce.dispatchEvent({type:"selectstart"}):(Ce.dispatchEvent({type:"selectend"}),Ce.dispatchEvent({type:"select"}))),Se=2,Q[Pe]===void 0&&(Q[Pe]=!1),Ae.buttons[Se]!==void 0&&Q[Pe]!==Ae.buttons[Se].pressed&&(Q[Pe]=Ae.buttons[Se].pressed,Q[Pe]===!0?Ce.dispatchEvent({type:"squeezestart"}):(Ce.dispatchEvent({type:"squeezeend"}),Ce.dispatchEvent({type:"squeeze"})))}else Ce.visible=!1}}function xe(Pe,Ce){Ce!==null&&Ce.length===4&&Pe.set(Ce[0]*t,Ce[1]*i,Ce[2]*t,Ce[3]*i)}this.enabled=!1,this.getController=function(Pe){var Ce=l[Pe];return Ce===void 0&&(Ce=new Ea,Ce.matrixAutoUpdate=!1,Ce.visible=!1,l[Pe]=Ce),Ce},this.getDevice=function(){return n},this.setDevice=function(Pe){Pe!==void 0&&(n=Pe),_e.setContext(Pe)},this.setFramebufferScaleFactor=function(Pe){C=Pe},this.setReferenceSpaceType=function(Pe){S=Pe},this.setPoseTarget=function(Pe){Pe!==void 0&&(s=Pe)},this.getCamera=function(Pe){var Ce=S==="local-floor"?1.6:0;if(n.depthNear=Pe.near,n.depthFar=Pe.far,n.getFrameData(o),S==="local-floor"){var Ae=n.stageParameters;Ae?c.fromArray(Ae.sittingToStandingTransform):c.makeTranslation(0,Ce,0)}var Be=o.pose,Se=s!==null?s:Pe;Se.matrix.copy(c),Se.matrix.decompose(Se.position,Se.quaternion,Se.scale),Be.orientation!==null&&(O.fromArray(Be.orientation),Se.quaternion.multiply(O)),Be.position!==null&&(O.setFromRotationMatrix(c),P.fromArray(Be.position),P.applyQuaternion(O),Se.position.add(P)),Se.updateMatrixWorld();for(var Te=Se.children,me=0,Ue=Te.length;me<Ue;me++)Te[me].updateMatrixWorld(!0);k.near=Pe.near,W.near=Pe.near,k.far=Pe.far,W.far=Pe.far,k.matrixWorldInverse.fromArray(o.leftViewMatrix),W.matrixWorldInverse.fromArray(o.rightViewMatrix),p.getInverse(c),S==="local-floor"&&(k.matrixWorldInverse.multiply(p),W.matrixWorldInverse.multiply(p));var He=Se.parent;He!==null&&(T.getInverse(He.matrixWorld),k.matrixWorldInverse.multiply(T),W.matrixWorldInverse.multiply(T)),k.matrixWorld.getInverse(k.matrixWorldInverse),W.matrixWorld.getInverse(W.matrixWorldInverse),k.projectionMatrix.fromArray(o.leftProjectionMatrix),W.projectionMatrix.fromArray(o.rightProjectionMatrix),a0(V,k,W);var Ye=n.getLayers();if(Ye.length){var Qe=Ye[0];xe(k.viewport,Qe.leftBounds),xe(W.viewport,Qe.rightBounds)}return Me(),V},this.getStandingMatrix=function(){return c},this.isPresenting=!1;var _e=new sc;this.setAnimationLoop=function(Pe){_e.setAnimationLoop(Pe),this.isPresenting&&_e.start()},this.submitFrame=function(){this.isPresenting&&n.submitFrame()},this.dispose=function(){typeof window!="undefined"&&window.removeEventListener("vrdisplaypresentchange",ue)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}Object.assign(Zh.prototype,ea.prototype);function Ps(){this._targetRay=null,this._grip=null,this._hand=null}Object.assign(Ps.prototype,{constructor:Ps,getHandSpace:function(){return this._hand===null&&(this._hand=new Ea,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new Ea,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new Ea,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this},update:function(t,i,r){var n=null,o=null,s=null,l=this._targetRay,c=this._grip,p=this._hand;if(t&&i.session.visibilityState!=="visible-blurred")if(p&&t.hand){s=!0;for(var C=Xf(t.hand.values()),S;!(S=C()).done;){var T=S.value,O=i.getJointPose(T,r);if(p.joints[T.jointName]===void 0){var P=new Ea;P.matrixAutoUpdate=!1,P.visible=!1,p.joints[T.jointName]=P,p.add(P)}var k=p.joints[T.jointName];O!==null&&(k.matrix.fromArray(O.transform.matrix),k.matrix.decompose(k.position,k.rotation,k.scale),k.jointRadius=O.radius),k.visible=O!==null}var W=p.joints["index-finger-tip"],V=p.joints["thumb-tip"],B=W.position.distanceTo(V.position),ee=.02,ue=.005;p.inputState.pinching&&B>ee+ue?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!p.inputState.pinching&&B<=ee-ue&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else l!==null&&(n=i.getPose(t.targetRaySpace,r),n!==null&&(l.matrix.fromArray(n.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale))),c!==null&&t.gripSpace&&(o=i.getPose(t.gripSpace,r),o!==null&&(c.matrix.fromArray(o.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale)));return l!==null&&(l.visible=n!==null),c!==null&&(c.visible=o!==null),p!==null&&(p.visible=s!==null),this}});function Kh(a,t){var i=this,r=null,n=1,o=null,s="local-floor",l=null,c=null,p=[],C=new Map,S=[],T,O=new _n;O.layers.enable(1),O.viewport=new rn;var P=new _n;P.layers.enable(2),P.viewport=new rn;var k=[O,P],W=new Rs;W.layers.enable(1),W.layers.enable(2);var V=null,B=null;this.layersEnabled=!1,this.enabled=!1,this.isPresenting=!1,this.getCameraPose=function(){return l},this.getController=function(Ae){var Be=p[Ae];return Be===void 0&&(Be=new Ps,p[Ae]=Be),Be.getTargetRaySpace()},this.getControllerGrip=function(Ae){var Be=p[Ae];return Be===void 0&&(Be=new Ps,p[Ae]=Be),Be.getGripSpace()},this.getHand=function(Ae){var Be=p[Ae];return Be===void 0&&(Be=new Ps,p[Ae]=Be),Be.getHandSpace()};function ee(Ae){var Be=C.get(Ae.inputSource);Be&&Be.dispatchEvent({type:Ae.type,data:Ae.inputSource})}function ue(){C.forEach(function(Ae,Be){Ae.disconnect(Be)}),C.clear(),V=null,B=null,a.setFramebuffer(null),a.setRenderTarget(a.getRenderTarget()),Ce.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Ae){n=Ae,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ae){s=Ae,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o},this.getSession=function(){return r},this.setSession=function(){var Ae=Wf(regeneratorRuntime.mark(function Be(Se){var Te,me;return regeneratorRuntime.wrap(function(He){for(;;)switch(He.prev=He.next){case 0:if(r=Se,r===null){He.next=24;break}if(r.addEventListener("select",ee),r.addEventListener("selectstart",ee),r.addEventListener("selectend",ee),r.addEventListener("squeeze",ee),r.addEventListener("squeezestart",ee),r.addEventListener("squeezeend",ee),r.addEventListener("end",ue),r.addEventListener("inputsourceschange",K),Te=t.getContextAttributes(),Te.xrCompatible===!0){He.next=14;break}return He.next=14,t.makeXRCompatible();case 14:return me={antialias:Te.antialias,alpha:Te.alpha,depth:Te.depth,stencil:Te.stencil,framebufferScaleFactor:n},T=new XRWebGLLayer(r,t,me),window.XRWebGLBinding&&this.layersEnabled?this.addLayer(T):r.updateRenderState({baseLayer:T}),He.next=19,r.requestReferenceSpace(s);case 19:o=He.sent,Ce.setContext(r),Ce.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"});case 24:case"end":return He.stop()}},Be,this)}));return function(Be){return Ae.apply(this,arguments)}}(),this.addLayer=function(Ae){!window.XRWebGLBinding||!this.layersEnabled||!r||(S.push(Ae),r.updateRenderState({layers:S}))},this.removeLayer=function(Ae){!window.XRWebGLBinding||!this.layersEnabled||!r||(S.splice(S.indexOf(Ae),1),r.updateRenderState({layers:S}))};function K(Ae){for(var Be=r.inputSources,Se=0;Se<p.length;Se++)C.set(Be[Se],p[Se]);for(var Te=0;Te<Ae.removed.length;Te++){var me=Ae.removed[Te],Ue=C.get(me);Ue&&(Ue.dispatchEvent({type:"disconnected",data:me}),C.delete(me))}for(var He=0;He<Ae.added.length;He++){var Ye=Ae.added[He],Qe=C.get(Ye);Qe&&Qe.dispatchEvent({type:"connected",data:Ye})}}var Q=new de,se=new de;function Me(Ae,Be,Se){Q.setFromMatrixPosition(Be.matrixWorld),se.setFromMatrixPosition(Se.matrixWorld);var Te=Q.distanceTo(se),me=Be.projectionMatrix.elements,Ue=Se.projectionMatrix.elements,He=me[14]/(me[10]-1),Ye=me[14]/(me[10]+1),Qe=(me[9]+1)/me[5],pt=(me[9]-1)/me[5],Et=(me[8]-1)/me[0],Ut=(Ue[8]+1)/Ue[0],Ze=He*Et,$t=He*Ut,Dt=Te/(-Et+Ut),rr=Dt*-Et;Be.matrixWorld.decompose(Ae.position,Ae.quaternion,Ae.scale),Ae.translateX(rr),Ae.translateZ(Dt),Ae.matrixWorld.compose(Ae.position,Ae.quaternion,Ae.scale),Ae.matrixWorldInverse.copy(Ae.matrixWorld).invert();var vr=He+Dt,_r=Ye+Dt,gr=Ze-rr,un=$t+(Te-rr),Gr=Qe*Ye/_r*vr,nn=pt*Ye/_r*vr;Ae.projectionMatrix.makePerspective(gr,un,Gr,nn,vr,_r)}function xe(Ae,Be){Be===null?Ae.matrixWorld.copy(Ae.matrix):Ae.matrixWorld.multiplyMatrices(Be.matrixWorld,Ae.matrix),Ae.matrixWorldInverse.copy(Ae.matrixWorld).invert()}this.setPoseTarget=function(Ae){Ae!==void 0&&(c=Ae)},this.getCamera=function(Ae){W.near=P.near=O.near=Ae.near,W.far=P.far=O.far=Ae.far,(V!==W.near||B!==W.far)&&(r.updateRenderState({depthNear:W.near,depthFar:W.far}),V=W.near,B=W.far);var Be=Ae.parent,Se=W.cameras,Te=c||Ae;xe(W,Be);for(var me=0;me<Se.length;me++)xe(Se[me],Be);Te.matrixWorld.copy(W.matrixWorld);for(var Ue=Te.children,He=0,Ye=Ue.length;He<Ye;He++)Ue[He].updateMatrixWorld(!0);return Se.length===2?Me(W,O,P):W.projectionMatrix.copy(O.projectionMatrix),W};var _e=null;function Pe(Ae,Be){if(l=Be.getViewerPose(o),l!==null){var Se=l.views;a.setFramebuffer(T.framebuffer);var Te=!1;Se.length!==W.cameras.length&&(W.cameras.length=0,Te=!0);for(var me=0;me<Se.length;me++){var Ue=Se[me],He=T.getViewport(Ue),Ye=k[me];Ye.matrix.fromArray(Ue.transform.matrix),Ye.projectionMatrix.fromArray(Ue.projectionMatrix),Ye.viewport.set(He.x,He.y,He.width,He.height),me===0&&W.matrix.copy(Ye.matrix),Te===!0&&W.cameras.push(Ye)}}for(var Qe=r.inputSources,pt=0;pt<p.length;pt++){var Et=p[pt],Ut=Qe[pt];Et.update(Ut,Be,o)}_e&&_e(Ae,Be)}var Ce=new sc;Ce.setAnimationLoop(Pe),this.setAnimationLoop=function(Ae){_e=Ae},this.dispose=function(){}}Object.assign(Kh.prototype,ea.prototype);function o0(a){function t(V,B){V.fogColor.value.copy(B.color),B.isFog?(V.fogNear.value=B.near,V.fogFar.value=B.far):B.isFogExp2&&(V.fogDensity.value=B.density)}function i(V,B,ee,ue){B.isMeshBasicMaterial?r(V,B):B.isMeshLambertMaterial?(r(V,B),c(V,B)):B.isMeshToonMaterial?(r(V,B),C(V,B)):B.isMeshPhongMaterial?(r(V,B),p(V,B)):B.isMeshStandardMaterial?(r(V,B),B.isMeshPhysicalMaterial?T(V,B):S(V,B)):B.isMeshMatcapMaterial?(r(V,B),O(V,B)):B.isMeshDepthMaterial?(r(V,B),P(V,B)):B.isMeshDistanceMaterial?(r(V,B),k(V,B)):B.isMeshNormalMaterial?(r(V,B),W(V,B)):B.isLineBasicMaterial?(n(V,B),B.isLineDashedMaterial&&o(V,B)):B.isPointsMaterial?s(V,B,ee,ue):B.isSpriteMaterial?l(V,B):B.isShadowMaterial?(V.color.value.copy(B.color),V.opacity.value=B.opacity):B.isShaderMaterial&&(B.uniformsNeedUpdate=!1)}function r(V,B){V.opacity.value=B.opacity,B.color&&V.diffuse.value.copy(B.color),B.emissive&&V.emissive.value.copy(B.emissive).multiplyScalar(B.emissiveIntensity),B.map&&(V.map.value=B.map),B.alphaMap&&(V.alphaMap.value=B.alphaMap),B.specularMap&&(V.specularMap.value=B.specularMap);var ee=a.get(B).envMap;if(ee){V.envMap.value=ee,V.flipEnvMap.value=ee.isCubeTexture&&ee._needsFlipEnvMap?-1:1,V.reflectivity.value=B.reflectivity,V.refractionRatio.value=B.refractionRatio;var ue=a.get(ee).__maxMipLevel;ue!==void 0&&(V.maxMipLevel.value=ue)}B.lightMap&&(V.lightMap.value=B.lightMap,V.lightMapIntensity.value=B.lightMapIntensity),B.aoMap&&(V.aoMap.value=B.aoMap,V.aoMapIntensity.value=B.aoMapIntensity);var K;B.map?K=B.map:B.specularMap?K=B.specularMap:B.displacementMap?K=B.displacementMap:B.normalMap?K=B.normalMap:B.bumpMap?K=B.bumpMap:B.roughnessMap?K=B.roughnessMap:B.metalnessMap?K=B.metalnessMap:B.alphaMap?K=B.alphaMap:B.emissiveMap?K=B.emissiveMap:B.clearcoatMap?K=B.clearcoatMap:B.clearcoatNormalMap?K=B.clearcoatNormalMap:B.clearcoatRoughnessMap&&(K=B.clearcoatRoughnessMap),K!==void 0&&(K.isWebGLRenderTarget&&(K=K.texture),K.matrixAutoUpdate===!0&&K.updateMatrix(),V.uvTransform.value.copy(K.matrix));var Q;B.aoMap?Q=B.aoMap:B.lightMap&&(Q=B.lightMap),Q!==void 0&&(Q.isWebGLRenderTarget&&(Q=Q.texture),Q.matrixAutoUpdate===!0&&Q.updateMatrix(),V.uv2Transform.value.copy(Q.matrix))}function n(V,B){V.diffuse.value.copy(B.color),V.opacity.value=B.opacity}function o(V,B){V.dashSize.value=B.dashSize,V.totalSize.value=B.dashSize+B.gapSize,V.scale.value=B.scale}function s(V,B,ee,ue){V.diffuse.value.copy(B.color),V.opacity.value=B.opacity,V.size.value=B.size*ee,V.scale.value=ue*.5,B.map&&(V.map.value=B.map),B.alphaMap&&(V.alphaMap.value=B.alphaMap);var K;B.map?K=B.map:B.alphaMap&&(K=B.alphaMap),K!==void 0&&(K.matrixAutoUpdate===!0&&K.updateMatrix(),V.uvTransform.value.copy(K.matrix))}function l(V,B){V.diffuse.value.copy(B.color),V.opacity.value=B.opacity,V.rotation.value=B.rotation,B.map&&(V.map.value=B.map),B.alphaMap&&(V.alphaMap.value=B.alphaMap);var ee;B.map?ee=B.map:B.alphaMap&&(ee=B.alphaMap),ee!==void 0&&(ee.matrixAutoUpdate===!0&&ee.updateMatrix(),V.uvTransform.value.copy(ee.matrix))}function c(V,B){B.emissiveMap&&(V.emissiveMap.value=B.emissiveMap)}function p(V,B){V.specular.value.copy(B.specular),V.shininess.value=Math.max(B.shininess,1e-4),B.emissiveMap&&(V.emissiveMap.value=B.emissiveMap),B.bumpMap&&(V.bumpMap.value=B.bumpMap,V.bumpScale.value=B.bumpScale,B.side===M&&(V.bumpScale.value*=-1)),B.normalMap&&(V.normalMap.value=B.normalMap,V.normalScale.value.copy(B.normalScale),B.side===M&&V.normalScale.value.negate()),B.displacementMap&&(V.displacementMap.value=B.displacementMap,V.displacementScale.value=B.displacementScale,V.displacementBias.value=B.displacementBias)}function C(V,B){B.gradientMap&&(V.gradientMap.value=B.gradientMap),B.emissiveMap&&(V.emissiveMap.value=B.emissiveMap),B.bumpMap&&(V.bumpMap.value=B.bumpMap,V.bumpScale.value=B.bumpScale,B.side===M&&(V.bumpScale.value*=-1)),B.normalMap&&(V.normalMap.value=B.normalMap,V.normalScale.value.copy(B.normalScale),B.side===M&&V.normalScale.value.negate()),B.displacementMap&&(V.displacementMap.value=B.displacementMap,V.displacementScale.value=B.displacementScale,V.displacementBias.value=B.displacementBias)}function S(V,B){V.roughness.value=B.roughness,V.metalness.value=B.metalness,B.roughnessMap&&(V.roughnessMap.value=B.roughnessMap),B.metalnessMap&&(V.metalnessMap.value=B.metalnessMap),B.emissiveMap&&(V.emissiveMap.value=B.emissiveMap),B.bumpMap&&(V.bumpMap.value=B.bumpMap,V.bumpScale.value=B.bumpScale,B.side===M&&(V.bumpScale.value*=-1)),B.normalMap&&(V.normalMap.value=B.normalMap,V.normalScale.value.copy(B.normalScale),B.side===M&&V.normalScale.value.negate()),B.displacementMap&&(V.displacementMap.value=B.displacementMap,V.displacementScale.value=B.displacementScale,V.displacementBias.value=B.displacementBias);var ee=a.get(B).envMap;ee&&(V.envMapIntensity.value=B.envMapIntensity)}function T(V,B){S(V,B),V.reflectivity.value=B.reflectivity,V.clearcoat.value=B.clearcoat,V.clearcoatRoughness.value=B.clearcoatRoughness,B.sheen&&V.sheen.value.copy(B.sheen),B.clearcoatMap&&(V.clearcoatMap.value=B.clearcoatMap),B.clearcoatRoughnessMap&&(V.clearcoatRoughnessMap.value=B.clearcoatRoughnessMap),B.clearcoatNormalMap&&(V.clearcoatNormalScale.value.copy(B.clearcoatNormalScale),V.clearcoatNormalMap.value=B.clearcoatNormalMap,B.side===M&&V.clearcoatNormalScale.value.negate()),V.transmission.value=B.transmission,B.transmissionMap&&(V.transmissionMap.value=B.transmissionMap)}function O(V,B){B.matcap&&(V.matcap.value=B.matcap),B.bumpMap&&(V.bumpMap.value=B.bumpMap,V.bumpScale.value=B.bumpScale,B.side===M&&(V.bumpScale.value*=-1)),B.normalMap&&(V.normalMap.value=B.normalMap,V.normalScale.value.copy(B.normalScale),B.side===M&&V.normalScale.value.negate()),B.displacementMap&&(V.displacementMap.value=B.displacementMap,V.displacementScale.value=B.displacementScale,V.displacementBias.value=B.displacementBias)}function P(V,B){B.displacementMap&&(V.displacementMap.value=B.displacementMap,V.displacementScale.value=B.displacementScale,V.displacementBias.value=B.displacementBias)}function k(V,B){B.displacementMap&&(V.displacementMap.value=B.displacementMap,V.displacementScale.value=B.displacementScale,V.displacementBias.value=B.displacementBias),V.referencePosition.value.copy(B.referencePosition),V.nearDistance.value=B.nearDistance,V.farDistance.value=B.farDistance}function W(V,B){B.bumpMap&&(V.bumpMap.value=B.bumpMap,V.bumpScale.value=B.bumpScale,B.side===M&&(V.bumpScale.value*=-1)),B.normalMap&&(V.normalMap.value=B.normalMap,V.normalScale.value.copy(B.normalScale),B.side===M&&V.normalScale.value.negate()),B.displacementMap&&(V.displacementMap.value=B.displacementMap,V.displacementScale.value=B.displacementScale,V.displacementBias.value=B.displacementBias)}return{refreshFogUniforms:t,refreshMaterialUniforms:i}}function s0(){var a=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return a.style.display="block",a}function Ds(a){a=a||{};var t=a.canvas!==void 0?a.canvas:s0(),i=a.context!==void 0?a.context:null,r=a.alpha!==void 0?a.alpha:!1,n=a.depth!==void 0?a.depth:!0,o=a.stencil!==void 0?a.stencil:!0,s=a.antialias!==void 0?a.antialias:!1,l=a.premultipliedAlpha!==void 0?a.premultipliedAlpha:!0,c=a.preserveDrawingBuffer!==void 0?a.preserveDrawingBuffer:!1,p=a.powerPreference!==void 0?a.powerPreference:"default",C=a.failIfMajorPerformanceCaveat!==void 0?a.failIfMajorPerformanceCaveat:!1,S=null,T=null,O=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=li,this.physicallyCorrectLights=!1,this.toneMapping=at,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var P=this,k=!1,W=null,V=0,B=0,ee=null,ue=null,K=-1,Q=null,se=new rn,Me=new rn,xe=null,_e=t.width,Pe=t.height,Ce=1,Ae=null,Be=null,Se=new rn(0,0,_e,Pe),Te=new rn(0,0,_e,Pe),me=!1,Ue=new Ss,He=!1,Ye=!1,Qe=new Lr,pt=new de,Et={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Ut(){return ee===null?Ce:1}var Ze=i;function $t(pe,st){for(var Ke=0;Ke<pe.length;Ke++){var ut=pe[Ke],Ct=t.getContext(ut,st);if(Ct!==null)return Ct}return null}try{var Dt={alpha:r,depth:n,stencil:o,antialias:s,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:p,failIfMajorPerformanceCaveat:C};if(t.addEventListener("webglcontextlost",cn,!1),t.addEventListener("webglcontextrestored",Qr,!1),Ze===null){var rr=["webgl2","webgl","experimental-webgl"];if(P.isWebGL1Renderer===!0&&rr.shift(),Ze=$t(rr,Dt),Ze===null)throw $t(rr)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}Ze.getShaderPrecisionFormat===void 0&&(Ze.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(pe){throw console.error("THREE.WebGLRenderer: "+pe.message),pe}var vr,_r,gr,un,Gr,nn,In,ni,Vn,Ln,Le,Ee,Lt,Tt,pr,Ve,Ht,Ft,nr,Ot,xt;function yr(){vr=new km(Ze),_r=new Bm(Ze,vr,a),vr.init(_r),Ot=new Qh(Ze,vr,_r),gr=new n0(Ze,vr,_r),gr.scissor(Me.copy(Te).multiplyScalar(Ce).floor()),gr.viewport(se.copy(Se).multiplyScalar(Ce).floor()),un=new Gm(Ze),Gr=new jg,nn=new i0(Ze,vr,gr,Gr,_r,Ot,un),In=new Nm(P),ni=new cp(Ze,_r),xt=new Om(Ze,vr,ni,_r),Vn=new Um(Ze,ni,un,xt),Ln=new jm(Ze,Vn,ni,un),Ht=new Wm(Ze),pr=new Fm(Gr),Le=new Wg(P,In,vr,_r,xt,pr),Ee=new o0(Gr),Lt=new Qg(Gr),Tt=new e0(vr,_r),Ve=new Dm(P,In,gr,Ln,l),Ft=new Im(Ze,vr,un,_r),nr=new Hm(Ze,vr,un,_r),un.programs=Le.programs,P.capabilities=_r,P.extensions=vr,P.properties=Gr,P.renderLists=Lt,P.state=gr,P.info=un}yr();var Cr=typeof navigator!="undefined"&&"xr"in navigator?new Kh(P,Ze):new Zh(P);this.xr=Cr;var Sn=new Yh(P,Ln,_r.maxTextureSize);this.shadowMap=Sn,this.getContext=function(){return Ze},this.getContextAttributes=function(){return Ze.getContextAttributes()},this.forceContextLoss=function(){var pe=vr.get("WEBGL_lose_context");pe&&pe.loseContext()},this.forceContextRestore=function(){var pe=vr.get("WEBGL_lose_context");pe&&pe.restoreContext()},this.getPixelRatio=function(){return Ce},this.setPixelRatio=function(pe){pe!==void 0&&(Ce=pe,this.setSize(_e,Pe,!1))},this.getSize=function(pe){return pe===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),pe=new gt),pe.set(_e,Pe)},this.setSize=function(pe,st,Ke){if(Cr.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}_e=pe,Pe=st,t.width=Math.floor(pe*Ce),t.height=Math.floor(st*Ce),Ke!==!1&&(t.style.width=pe+"px",t.style.height=st+"px"),this.setViewport(0,0,pe,st)},this.getDrawingBufferSize=function(pe){return pe===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),pe=new gt),pe.set(_e*Ce,Pe*Ce).floor()},this.setDrawingBufferSize=function(pe,st,Ke){_e=pe,Pe=st,Ce=Ke,t.width=Math.floor(pe*Ke),t.height=Math.floor(st*Ke),this.setViewport(0,0,pe,st)},this.getCurrentViewport=function(pe){return pe===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),pe=new rn),pe.copy(se)},this.getViewport=function(pe){return pe.copy(Se)},this.setViewport=function(pe,st,Ke,ut){pe.isVector4?Se.set(pe.x,pe.y,pe.z,pe.w):Se.set(pe,st,Ke,ut),gr.viewport(se.copy(Se).multiplyScalar(Ce).floor())},this.getScissor=function(pe){return pe.copy(Te)},this.setScissor=function(pe,st,Ke,ut){pe.isVector4?Te.set(pe.x,pe.y,pe.z,pe.w):Te.set(pe,st,Ke,ut),gr.scissor(Me.copy(Te).multiplyScalar(Ce).floor())},this.getScissorTest=function(){return me},this.setScissorTest=function(pe){gr.setScissorTest(me=pe)},this.setOpaqueSort=function(pe){Ae=pe},this.setTransparentSort=function(pe){Be=pe},this.getClearColor=function(pe){return pe===void 0&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),pe=new Pt),pe.copy(Ve.getClearColor())},this.setClearColor=function(){Ve.setClearColor.apply(Ve,arguments)},this.getClearAlpha=function(){return Ve.getClearAlpha()},this.setClearAlpha=function(){Ve.setClearAlpha.apply(Ve,arguments)},this.clear=function(pe,st,Ke){var ut=0;(pe===void 0||pe)&&(ut|=16384),(st===void 0||st)&&(ut|=256),(Ke===void 0||Ke)&&(ut|=1024),Ze.clear(ut)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",cn,!1),t.removeEventListener("webglcontextrestored",Qr,!1),Lt.dispose(),Tt.dispose(),Gr.dispose(),In.dispose(),Ln.dispose(),xt.dispose(),Cr.dispose(),ha.stop()};function cn(pe){pe.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),k=!0}function Qr(){console.log("THREE.WebGLRenderer: Context Restored."),k=!1,yr()}function Kr(pe){var st=pe.target;st.removeEventListener("dispose",Kr),Bn(st)}function Bn(pe){cs(pe),Gr.remove(pe)}function cs(pe){var st=Gr.get(pe).program;st!==void 0&&Le.releaseProgram(st)}function $a(pe,st){pe.render(function(Ke){P.renderBufferImmediate(Ke,st)})}this.renderBufferImmediate=function(pe,st){xt.initAttributes();var Ke=Gr.get(pe);pe.hasPositions&&!Ke.position&&(Ke.position=Ze.createBuffer()),pe.hasNormals&&!Ke.normal&&(Ke.normal=Ze.createBuffer()),pe.hasUvs&&!Ke.uv&&(Ke.uv=Ze.createBuffer()),pe.hasColors&&!Ke.color&&(Ke.color=Ze.createBuffer());var ut=st.getAttributes();pe.hasPositions&&(Ze.bindBuffer(34962,Ke.position),Ze.bufferData(34962,pe.positionArray,35048),xt.enableAttribute(ut.position),Ze.vertexAttribPointer(ut.position,3,5126,!1,0,0)),pe.hasNormals&&(Ze.bindBuffer(34962,Ke.normal),Ze.bufferData(34962,pe.normalArray,35048),xt.enableAttribute(ut.normal),Ze.vertexAttribPointer(ut.normal,3,5126,!1,0,0)),pe.hasUvs&&(Ze.bindBuffer(34962,Ke.uv),Ze.bufferData(34962,pe.uvArray,35048),xt.enableAttribute(ut.uv),Ze.vertexAttribPointer(ut.uv,2,5126,!1,0,0)),pe.hasColors&&(Ze.bindBuffer(34962,Ke.color),Ze.bufferData(34962,pe.colorArray,35048),xt.enableAttribute(ut.color),Ze.vertexAttribPointer(ut.color,3,5126,!1,0,0)),xt.disableUnusedAttributes(),Ze.drawArrays(4,0,pe.count),pe.count=0},this.renderBufferDirect=function(pe,st,Ke,ut,Ct,Vr){st===null&&(st=Et);var Ir=Ct.isMesh&&Ct.matrixWorld.determinant()<0,$r=nl(pe,st,ut,Ct);gr.setMaterial(ut,Ir);var mr=Ke.index,Fn=Ke.attributes.position;if(mr===null){if(Fn===void 0||Fn.count===0)return}else if(mr.count===0)return;var xn=1;ut.wireframe===!0&&(mr=Vn.getWireframeAttribute(Ke),xn=2),(ut.morphTargets||ut.morphNormals)&&Ht.update(Ct,Ke,ut,$r),xt.setup(Ct,ut,$r,Ke,mr);var Rr,Br=Ft;mr!==null&&(Rr=ni.get(mr),Br=nr,Br.setIndex(Rr));var zn=mr!==null?mr.count:Fn.count,ii=Ke.drawRange.start*xn,Jr=Ke.drawRange.count*xn,kn=Vr!==null?Vr.start*xn:0,Wr=Vr!==null?Vr.count*xn:1/0,wr=Math.max(ii,kn),Zr=Math.min(zn,ii+Jr,kn+Wr)-1,Nr=Math.max(0,Zr-wr+1);if(Nr!==0){if(Ct.isMesh)ut.wireframe===!0?(gr.setLineWidth(ut.wireframeLinewidth*Ut()),Br.setMode(1)):Br.setMode(4);else if(Ct.isLine){var zr=ut.linewidth;zr===void 0&&(zr=1),gr.setLineWidth(zr*Ut()),Ct.isLineSegments?Br.setMode(1):Ct.isLineLoop?Br.setMode(2):Br.setMode(3)}else Ct.isPoints?Br.setMode(0):Ct.isSprite&&Br.setMode(4);if(Ct.isInstancedMesh)Br.renderInstances(wr,Nr,Ct.count);else if(Ke.isInstancedBufferGeometry){var En=Math.min(Ke.instanceCount,Ke._maxInstanceCount);Br.renderInstances(wr,Nr,En)}else Br.render(wr,Nr)}},this.compile=function(pe,st){T=Tt.get(pe),T.init(),pe.traverseVisible(function(ut){ut.isLight&&ut.layers.test(st.layers)&&(T.pushLight(ut),ut.castShadow&&T.pushShadow(ut))}),T.setupLights();var Ke=new WeakMap;pe.traverse(function(ut){var Ct=ut.material;if(Ct)if(Array.isArray(Ct))for(var Vr=0;Vr<Ct.length;Vr++){var Ir=Ct[Vr];Ke.has(Ir)===!1&&(_i(Ir,pe,ut),Ke.set(Ir))}else Ke.has(Ct)===!1&&(_i(Ct,pe,ut),Ke.set(Ct))})};var Zi=null;function Sa(pe){Cr.isPresenting||Zi&&Zi(pe)}var ha=new sc;ha.setAnimationLoop(Sa),typeof window!="undefined"&&ha.setContext(window),this.setAnimationLoop=function(pe){Zi=pe,Cr.setAnimationLoop(pe),pe===null?ha.stop():ha.start()},this.render=function(pe,st){var Ke,ut;if(arguments[2]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),Ke=arguments[2]),arguments[3]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),ut=arguments[3]),st!==void 0&&st.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(k!==!0){xt.resetDefaultState(),K=-1,Q=null,pe.autoUpdate===!0&&pe.updateMatrixWorld(),st.parent===null&&st.updateMatrixWorld(),Cr.enabled===!0&&Cr.isPresenting===!0&&(st=Cr.getCamera(st)),pe.isScene===!0&&pe.onBeforeRender(P,pe,st,Ke||ee),T=Tt.get(pe,O.length),T.init(),O.push(T),Qe.multiplyMatrices(st.projectionMatrix,st.matrixWorldInverse),Ue.setFromProjectionMatrix(Qe),Ye=this.localClippingEnabled,He=pr.init(this.clippingPlanes,Ye,st),S=Lt.get(pe,st),S.init(),_a(pe,st,0,P.sortObjects),S.finish(),P.sortObjects===!0&&S.sort(Ae,Be),He===!0&&pr.beginShadows();var Ct=T.state.shadowsArray;Sn.render(Ct,pe,st),T.setupLights(),T.setupLightsView(st),He===!0&&pr.endShadows(),this.info.autoReset===!0&&this.info.reset(),Ke!==void 0&&this.setRenderTarget(Ke),Ve.render(S,pe,st,ut);var Vr=S.opaque,Ir=S.transparent;Vr.length>0&&eo(Vr,pe,st),Ir.length>0&&eo(Ir,pe,st),pe.isScene===!0&&pe.onAfterRender(P,pe,st),ee!==null&&(nn.updateRenderTargetMipmap(ee),nn.updateMultisampleRenderTarget(ee)),gr.buffers.depth.setTest(!0),gr.buffers.depth.setMask(!0),gr.buffers.color.setMask(!0),gr.setPolygonOffset(!1),Cr.enabled&&Cr.submitFrame&&Cr.submitFrame(),O.pop(),O.length>0?T=O[O.length-1]:T=null,S=null}};function _a(pe,st,Ke,ut){if(pe.visible!==!1){var Ct=pe.layers.test(st.layers);if(Ct){if(pe.isGroup)Ke=pe.renderOrder;else if(pe.isLOD)pe.autoUpdate===!0&&pe.update(st);else if(pe.isLight)T.pushLight(pe),pe.castShadow&&T.pushShadow(pe);else if(pe.isSprite){if(!pe.frustumCulled||Ue.intersectsSprite(pe)){ut&&pt.setFromMatrixPosition(pe.matrixWorld).applyMatrix4(Qe);var Vr=Ln.update(pe),Ir=pe.material;Ir.visible&&S.push(pe,Vr,Ir,Ke,pt.z,null)}}else if(pe.isImmediateRenderObject)ut&&pt.setFromMatrixPosition(pe.matrixWorld).applyMatrix4(Qe),S.push(pe,null,pe.material,Ke,pt.z,null);else if((pe.isMesh||pe.isLine||pe.isPoints)&&(pe.isSkinnedMesh&&pe.skeleton.frame!==un.render.frame&&(pe.skeleton.update(),pe.skeleton.frame=un.render.frame),!pe.frustumCulled||Ue.intersectsObject(pe))){ut&&pt.setFromMatrixPosition(pe.matrixWorld).applyMatrix4(Qe);var $r=Ln.update(pe),mr=pe.material;if(Array.isArray(mr))for(var Fn=$r.groups,xn=0,Rr=Fn.length;xn<Rr;xn++){var Br=Fn[xn],zn=mr[Br.materialIndex];zn&&zn.visible&&S.push(pe,$r,zn,Ke,pt.z,Br)}else mr.visible&&S.push(pe,$r,mr,Ke,pt.z,null)}}for(var ii=pe.children,Jr=0,kn=ii.length;Jr<kn;Jr++)_a(ii[Jr],st,Ke,ut)}}function eo(pe,st,Ke){for(var ut=st.isScene===!0?st.overrideMaterial:null,Ct=0,Vr=pe.length;Ct<Vr;Ct++){var Ir=pe[Ct],$r=Ir.object,mr=Ir.geometry,Fn=ut===null?Ir.material:ut,xn=Ir.group;if(Ke.isArrayCamera)for(var Rr=Ke.cameras,Br=0,zn=Rr.length;Br<zn;Br++){var ii=Rr[Br];$r.layers.test(ii.layers)&&(gr.viewport(se.copy(ii.viewport)),T.setupLightsView(ii),Co($r,st,ii,mr,Fn,xn))}else Co($r,st,Ke,mr,Fn,xn)}}function Co(pe,st,Ke,ut,Ct,Vr){if(pe.onBeforeRender(P,st,Ke,ut,Ct,Vr),pe.modelViewMatrix.multiplyMatrices(Ke.matrixWorldInverse,pe.matrixWorld),pe.normalMatrix.getNormalMatrix(pe.modelViewMatrix),pe.isImmediateRenderObject){var Ir=nl(Ke,st,Ct,pe);gr.setMaterial(Ct),xt.reset(),$a(pe,Ir)}else P.renderBufferDirect(Ke,st,ut,Ct,pe,Vr);pe.onAfterRender(P,st,Ke,ut,Ct,Vr)}function _i(pe,st,Ke){st.isScene!==!0&&(st=Et);var ut=Gr.get(pe),Ct=T.state.lights,Vr=T.state.shadowsArray,Ir=Ct.state.version,$r=Le.getParameters(pe,Ct.state,Vr,st,Ke),mr=Le.getProgramCacheKey($r),Fn=ut.program,xn=!0;if(ut.environment=pe.isMeshStandardMaterial?st.environment:null,ut.fog=st.fog,ut.envMap=In.get(pe.envMap||ut.environment),Fn===void 0)pe.addEventListener("dispose",Kr);else if(Fn.cacheKey!==mr)cs(pe);else if(ut.lightsStateVersion!==Ir)xn=!1;else{if($r.shaderID!==void 0)return;xn=!1}xn&&($r.uniforms=Le.getUniforms(pe),pe.onBeforeCompile($r,P),Fn=Le.acquireProgram($r,mr),ut.program=Fn,ut.uniforms=$r.uniforms,ut.outputEncoding=$r.outputEncoding);var Rr=ut.uniforms;(!pe.isShaderMaterial&&!pe.isRawShaderMaterial||pe.clipping===!0)&&(ut.numClippingPlanes=pr.numPlanes,ut.numIntersection=pr.numIntersection,Rr.clippingPlanes=pr.uniform),ut.needsLights=Lu(pe),ut.lightsStateVersion=Ir,ut.needsLights&&(Rr.ambientLightColor.value=Ct.state.ambient,Rr.lightProbe.value=Ct.state.probe,Rr.directionalLights.value=Ct.state.directional,Rr.directionalLightShadows.value=Ct.state.directionalShadow,Rr.spotLights.value=Ct.state.spot,Rr.spotLightShadows.value=Ct.state.spotShadow,Rr.rectAreaLights.value=Ct.state.rectArea,Rr.ltc_1.value=Ct.state.rectAreaLTC1,Rr.ltc_2.value=Ct.state.rectAreaLTC2,Rr.pointLights.value=Ct.state.point,Rr.pointLightShadows.value=Ct.state.pointShadow,Rr.hemisphereLights.value=Ct.state.hemi,Rr.directionalShadowMap.value=Ct.state.directionalShadowMap,Rr.directionalShadowMatrix.value=Ct.state.directionalShadowMatrix,Rr.spotShadowMap.value=Ct.state.spotShadowMap,Rr.spotShadowMatrix.value=Ct.state.spotShadowMatrix,Rr.pointShadowMap.value=Ct.state.pointShadowMap,Rr.pointShadowMatrix.value=Ct.state.pointShadowMatrix);var Br=ut.program.getUniforms(),zn=Ha.seqWithValue(Br.seq,Rr);ut.uniformsList=zn}function nl(pe,st,Ke,ut){st.isScene!==!0&&(st=Et),nn.resetTextureUnits();var Ct=st.fog,Vr=Ke.isMeshStandardMaterial?st.environment:null,Ir=ee===null?P.outputEncoding:ee.texture.encoding,$r=In.get(Ke.envMap||Vr),mr=Gr.get(Ke),Fn=T.state.lights;if(He===!0&&(Ye===!0||pe!==Q)){var xn=pe===Q&&Ke.id===K;pr.setState(Ke,pe,xn)}Ke.version===mr.__version?(Ke.fog&&mr.fog!==Ct||mr.environment!==Vr||mr.needsLights&&mr.lightsStateVersion!==Fn.state.version||mr.numClippingPlanes!==void 0&&(mr.numClippingPlanes!==pr.numPlanes||mr.numIntersection!==pr.numIntersection)||mr.outputEncoding!==Ir||mr.envMap!==$r)&&_i(Ke,st,ut):(_i(Ke,st,ut),mr.__version=Ke.version);var Rr=!1,Br=!1,zn=!1,ii=mr.program,Jr=ii.getUniforms(),kn=mr.uniforms;if(gr.useProgram(ii.program)&&(Rr=!0,Br=!0,zn=!0),Ke.id!==K&&(K=Ke.id,Br=!0),Rr||Q!==pe){if(Jr.setValue(Ze,"projectionMatrix",pe.projectionMatrix),_r.logarithmicDepthBuffer&&Jr.setValue(Ze,"logDepthBufFC",2/(Math.log(pe.far+1)/Math.LN2)),Q!==pe&&(Q=pe,Br=!0,zn=!0),Ke.isShaderMaterial||Ke.isMeshPhongMaterial||Ke.isMeshToonMaterial||Ke.isMeshStandardMaterial||Ke.envMap){var Wr=Jr.map.cameraPosition;Wr!==void 0&&Wr.setValue(Ze,pt.setFromMatrixPosition(pe.matrixWorld))}(Ke.isMeshPhongMaterial||Ke.isMeshToonMaterial||Ke.isMeshLambertMaterial||Ke.isMeshBasicMaterial||Ke.isMeshStandardMaterial||Ke.isShaderMaterial)&&Jr.setValue(Ze,"isOrthographic",pe.isOrthographicCamera===!0),(Ke.isMeshPhongMaterial||Ke.isMeshToonMaterial||Ke.isMeshLambertMaterial||Ke.isMeshBasicMaterial||Ke.isMeshStandardMaterial||Ke.isShaderMaterial||Ke.isShadowMaterial||Ke.skinning)&&Jr.setValue(Ze,"viewMatrix",pe.matrixWorldInverse)}if(Ke.skinning){Jr.setOptional(Ze,ut,"bindMatrix"),Jr.setOptional(Ze,ut,"bindMatrixInverse");var wr=ut.skeleton;if(wr){var Zr=wr.bones;if(_r.floatVertexTextures){if(wr.boneTexture===null){var Nr=Math.sqrt(Zr.length*4);Nr=dr.ceilPowerOfTwo(Nr),Nr=Math.max(Nr,4);var zr=new Float32Array(Nr*Nr*4);zr.set(wr.boneMatrices);var En=new ba(zr,Nr,Nr,jn,Ur);wr.boneMatrices=zr,wr.boneTexture=En,wr.boneTextureSize=Nr}Jr.setValue(Ze,"boneTexture",wr.boneTexture,nn),Jr.setValue(Ze,"boneTextureSize",wr.boneTextureSize)}else Jr.setOptional(Ze,wr,"boneMatrices")}}return(Br||mr.receiveShadow!==ut.receiveShadow)&&(mr.receiveShadow=ut.receiveShadow,Jr.setValue(Ze,"receiveShadow",ut.receiveShadow)),Br&&(Jr.setValue(Ze,"toneMappingExposure",P.toneMappingExposure),mr.needsLights&&il(kn,zn),Ct&&Ke.fog&&Ee.refreshFogUniforms(kn,Ct),Ee.refreshMaterialUniforms(kn,Ke,Ce,Pe),Ha.upload(Ze,mr.uniformsList,kn,nn)),Ke.isShaderMaterial&&Ke.uniformsNeedUpdate===!0&&(Ha.upload(Ze,mr.uniformsList,kn,nn),Ke.uniformsNeedUpdate=!1),Ke.isSpriteMaterial&&Jr.setValue(Ze,"center",ut.center),Jr.setValue(Ze,"modelViewMatrix",ut.modelViewMatrix),Jr.setValue(Ze,"normalMatrix",ut.normalMatrix),Jr.setValue(Ze,"modelMatrix",ut.matrixWorld),ii}function il(pe,st){pe.ambientLightColor.needsUpdate=st,pe.lightProbe.needsUpdate=st,pe.directionalLights.needsUpdate=st,pe.directionalLightShadows.needsUpdate=st,pe.pointLights.needsUpdate=st,pe.pointLightShadows.needsUpdate=st,pe.spotLights.needsUpdate=st,pe.spotLightShadows.needsUpdate=st,pe.rectAreaLights.needsUpdate=st,pe.hemisphereLights.needsUpdate=st}function Lu(pe){return pe.isMeshLambertMaterial||pe.isMeshToonMaterial||pe.isMeshPhongMaterial||pe.isMeshStandardMaterial||pe.isShadowMaterial||pe.isShaderMaterial&&pe.lights===!0}this.setTexture2D=function(){var pe=!1;return function(Ke,ut){Ke&&Ke.isWebGLRenderTarget&&(pe||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),pe=!0),Ke=Ke.texture),nn.setTexture2D(Ke,ut)}}(),this.setFramebuffer=function(pe){W!==pe&&ee===null&&Ze.bindFramebuffer(36160,pe),W=pe},this.getActiveCubeFace=function(){return V},this.getActiveMipmapLevel=function(){return B},this.getRenderList=function(){return S},this.setRenderList=function(pe){S=pe},this.getRenderTarget=function(){return ee},this.setRenderTarget=function(pe,st,Ke){st===void 0&&(st=0),Ke===void 0&&(Ke=0),ee=pe,V=st,B=Ke,pe&&Gr.get(pe).__webglFramebuffer===void 0&&nn.setupRenderTarget(pe);var ut=W,Ct=!1;if(pe){var Vr=Gr.get(pe).__webglFramebuffer;pe.isWebGLCubeRenderTarget?(ut=Vr[st],Ct=!0):pe.isWebGLMultisampleRenderTarget?ut=Gr.get(pe).__webglMultisampledFramebuffer:ut=Vr,se.copy(pe.viewport),Me.copy(pe.scissor),xe=pe.scissorTest}else se.copy(Se).multiplyScalar(Ce).floor(),Me.copy(Te).multiplyScalar(Ce).floor(),xe=me;if(ue!==ut&&(Ze.bindFramebuffer(36160,ut),ue=ut),gr.viewport(se),gr.scissor(Me),gr.setScissorTest(xe),Ct){var Ir=Gr.get(pe.texture);Ze.framebufferTexture2D(36160,36064,34069+st,Ir.__webglTexture,Ke)}},this.readRenderTargetPixels=function(pe,st,Ke,ut,Ct,Vr,Ir){if(!(pe&&pe.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}var $r=Gr.get(pe).__webglFramebuffer;if(pe.isWebGLCubeRenderTarget&&Ir!==void 0&&($r=$r[Ir]),$r){var mr=!1;$r!==ue&&(Ze.bindFramebuffer(36160,$r),mr=!0);try{var Fn=pe.texture,xn=Fn.format,Rr=Fn.type;if(xn!==jn&&Ot.convert(xn)!==Ze.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}var Br=Rr===on&&(vr.has("EXT_color_buffer_half_float")||_r.isWebGL2&&vr.has("EXT_color_buffer_float"));if(Rr!==ir&&Ot.convert(Rr)!==Ze.getParameter(35738)&&!(Rr===Ur&&(_r.isWebGL2||vr.has("OES_texture_float")||vr.has("WEBGL_color_buffer_float")))&&!Br){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Ze.checkFramebufferStatus(36160)===36053?st>=0&&st<=pe.width-ut&&Ke>=0&&Ke<=pe.height-Ct&&Ze.readPixels(st,Ke,ut,Ct,Ot.convert(xn),Ot.convert(Rr),Vr):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{mr&&Ze.bindFramebuffer(36160,ue)}}},this.copyFramebufferToTexture=function(pe,st,Ke){Ke===void 0&&(Ke=0);var ut=Math.pow(2,-Ke),Ct=Math.floor(st.image.width*ut),Vr=Math.floor(st.image.height*ut),Ir=Ot.convert(st.format);nn.setTexture2D(st,0),Ze.copyTexImage2D(3553,Ke,Ir,pe.x,pe.y,Ct,Vr,0),gr.unbindTexture()},this.copyTextureToTexture=function(pe,st,Ke,ut){ut===void 0&&(ut=0);var Ct=st.image.width,Vr=st.image.height,Ir=Ot.convert(Ke.format),$r=Ot.convert(Ke.type);nn.setTexture2D(Ke,0),Ze.pixelStorei(37440,Ke.flipY),Ze.pixelStorei(37441,Ke.premultiplyAlpha),Ze.pixelStorei(3317,Ke.unpackAlignment),st.isDataTexture?Ze.texSubImage2D(3553,ut,pe.x,pe.y,Ct,Vr,Ir,$r,st.image.data):st.isCompressedTexture?Ze.compressedTexSubImage2D(3553,ut,pe.x,pe.y,st.mipmaps[0].width,st.mipmaps[0].height,Ir,st.mipmaps[0].data):Ze.texSubImage2D(3553,ut,pe.x,pe.y,Ir,$r,st.image),ut===0&&Ke.generateMipmaps&&Ze.generateMipmap(3553),gr.unbindTexture()},this.initTexture=function(pe){nn.setTexture2D(pe,0),gr.unbindTexture()},this.resetState=function(){gr.reset(),xt.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function cc(a){Ds.call(this,a)}cc.prototype=Object.assign(Object.create(Ds.prototype),{constructor:cc,isWebGL1Renderer:!0});var $h=function(){function a(i,r){Object.defineProperty(this,"isFogExp2",{value:!0}),this.name="",this.color=new Pt(i),this.density=r!==void 0?r:25e-5}var t=a.prototype;return t.clone=function(){return new a(this.color,this.density)},t.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},a}(),ed=function(){function a(i,r,n){Object.defineProperty(this,"isFog",{value:!0}),this.name="",this.color=new Pt(i),this.near=r!==void 0?r:1,this.far=n!==void 0?n:1e3}var t=a.prototype;return t.clone=function(){return new a(this.color,this.near,this.far)},t.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},a}(),hc=function(a){Mr(t,a);function t(){var r;return r=a.call(this)||this,Object.defineProperty(Ui(r),"isScene",{value:!0}),r.type="Scene",r.background=null,r.environment=null,r.fog=null,r.overrideMaterial=null,r.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:Ui(r)})),r}var i=t.prototype;return i.copy=function(n,o){return a.prototype.copy.call(this,n,o),n.background!==null&&(this.background=n.background.clone()),n.environment!==null&&(this.environment=n.environment.clone()),n.fog!==null&&(this.fog=n.fog.clone()),n.overrideMaterial!==null&&(this.overrideMaterial=n.overrideMaterial.clone()),this.autoUpdate=n.autoUpdate,this.matrixAutoUpdate=n.matrixAutoUpdate,this},i.toJSON=function(n){var o=a.prototype.toJSON.call(this,n);return this.background!==null&&(o.object.background=this.background.toJSON(n)),this.environment!==null&&(o.object.environment=this.environment.toJSON(n)),this.fog!==null&&(o.object.fog=this.fog.toJSON()),o},t}(Xt);function xi(a,t){this.array=a,this.stride=t,this.count=a!==void 0?a.length/t:0,this.usage=ds,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=dr.generateUUID()}Object.defineProperty(xi.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}}),Object.assign(xi.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,i,r){t*=this.stride,r*=i.stride;for(var n=0,o=this.stride;n<o;n++)this.array[t+n]=i.array[r+n];return this},set:function(t,i){return i===void 0&&(i=0),this.array.set(t,i),this},clone:function(t){t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=dr.generateUUID()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var i=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),r=new xi(i,this.stride);return r.setUsage(this.usage),r},onUpload:function(t){return this.onUploadCallback=t,this},toJSON:function(t){return t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=dr.generateUUID()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});var ho=new de;function za(a,t,i,r){this.name="",this.data=a,this.itemSize=t,this.offset=i,this.normalized=r===!0}Object.defineProperties(za.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(t){this.data.needsUpdate=t}}}),Object.assign(za.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var i=0,r=this.data.count;i<r;i++)ho.x=this.getX(i),ho.y=this.getY(i),ho.z=this.getZ(i),ho.applyMatrix4(t),this.setXYZ(i,ho.x,ho.y,ho.z);return this},setX:function(t,i){return this.data.array[t*this.data.stride+this.offset]=i,this},setY:function(t,i){return this.data.array[t*this.data.stride+this.offset+1]=i,this},setZ:function(t,i){return this.data.array[t*this.data.stride+this.offset+2]=i,this},setW:function(t,i){return this.data.array[t*this.data.stride+this.offset+3]=i,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,i,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=i,this.data.array[t+1]=r,this},setXYZ:function(t,i,r,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=i,this.data.array[t+1]=r,this.data.array[t+2]=n,this},setXYZW:function(t,i,r,n,o){return t=t*this.data.stride+this.offset,this.data.array[t+0]=i,this.data.array[t+1]=r,this.data.array[t+2]=n,this.data.array[t+3]=o,this},clone:function(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var i=[],r=0;r<this.count;r++)for(var n=r*this.data.stride+this.offset,o=0;o<this.itemSize;o++)i.push(this.data.array[n+o]);return new lr(new this.array.constructor(i),this.itemSize,this.normalized)}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new za(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var i=[],r=0;r<this.count;r++)for(var n=r*this.data.stride+this.offset,o=0;o<this.itemSize;o++)i.push(this.data.array[n+o]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:i,normalized:this.normalized}}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}});function Wa(a){sr.call(this),this.type="SpriteMaterial",this.color=new Pt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(a)}Wa.prototype=Object.create(sr.prototype),Wa.prototype.constructor=Wa,Wa.prototype.isSpriteMaterial=!0,Wa.prototype.copy=function(a){return sr.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.alphaMap=a.alphaMap,this.rotation=a.rotation,this.sizeAttenuation=a.sizeAttenuation,this};var Yo,Os=new de,Qo=new de,qo=new de,Jo=new gt,Is=new gt,td=new Lr,Cl=new de,Bs=new de,Ll=new de,rd=new gt,dc=new gt,nd=new gt;function Fs(a){if(Xt.call(this),this.type="Sprite",Yo===void 0){Yo=new Kt;var t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new xi(t,5);Yo.setIndex([0,1,2,0,2,3]),Yo.setAttribute("position",new za(i,3,0,!1)),Yo.setAttribute("uv",new za(i,2,3,!1))}this.geometry=Yo,this.material=a!==void 0?a:new Wa,this.center=new gt(.5,.5)}Fs.prototype=Object.assign(Object.create(Xt.prototype),{constructor:Fs,isSprite:!0,raycast:function(t,i){t.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Qo.setFromMatrixScale(this.matrixWorld),td.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),qo.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Qo.multiplyScalar(-qo.z);var r=this.material.rotation,n,o;r!==0&&(o=Math.cos(r),n=Math.sin(r));var s=this.center;Rl(Cl.set(-.5,-.5,0),qo,s,Qo,n,o),Rl(Bs.set(.5,-.5,0),qo,s,Qo,n,o),Rl(Ll.set(.5,.5,0),qo,s,Qo,n,o),rd.set(0,0),dc.set(1,0),nd.set(1,1);var l=t.ray.intersectTriangle(Cl,Bs,Ll,!1,Os);if(!(l===null&&(Rl(Bs.set(-.5,.5,0),qo,s,Qo,n,o),dc.set(0,1),l=t.ray.intersectTriangle(Cl,Ll,Bs,!1,Os),l===null))){var c=t.ray.origin.distanceTo(Os);c<t.near||c>t.far||i.push({distance:c,point:Os.clone(),uv:ra.getUV(Os,Cl,Bs,Ll,rd,dc,nd,new gt),face:null,object:this})}},copy:function(t){return Xt.prototype.copy.call(this,t),t.center!==void 0&&this.center.copy(t.center),this.material=t.material,this}});function Rl(a,t,i,r,n,o){Jo.subVectors(a,i).addScalar(.5).multiply(r),n!==void 0?(Is.x=o*Jo.x-n*Jo.y,Is.y=n*Jo.x+o*Jo.y):Is.copy(Jo),a.copy(t),a.x+=Is.x,a.y+=Is.y,a.applyMatrix4(td)}var Pl=new de,id=new de;function Ns(){Xt.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}Ns.prototype=Object.assign(Object.create(Xt.prototype),{constructor:Ns,isLOD:!0,copy:function(t){Xt.prototype.copy.call(this,t,!1);for(var i=t.levels,r=0,n=i.length;r<n;r++){var o=i[r];this.addLevel(o.object.clone(),o.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,i){i===void 0&&(i=0),i=Math.abs(i);var r=this.levels,n;for(n=0;n<r.length&&!(i<r[n].distance);n++);return r.splice(n,0,{distance:i,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){var i=this.levels;if(i.length>0){var r,n;for(r=1,n=i.length;r<n&&!(t<i[r].distance);r++);return i[r-1].object}return null},raycast:function(t,i){var r=this.levels;if(r.length>0){Pl.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(Pl);this.getObjectForDistance(n).raycast(t,i)}},update:function(t){var i=this.levels;if(i.length>1){Pl.setFromMatrixPosition(t.matrixWorld),id.setFromMatrixPosition(this.matrixWorld);var r=Pl.distanceTo(id)/t.zoom;i[0].object.visible=!0;var n,o;for(n=1,o=i.length;n<o&&r>=i[n].distance;n++)i[n-1].object.visible=!1,i[n].object.visible=!0;for(this._currentLevel=n-1;n<o;n++)i[n].object.visible=!1}},toJSON:function(t){var i=Xt.prototype.toJSON.call(this,t);this.autoUpdate===!1&&(i.object.autoUpdate=!1),i.object.levels=[];for(var r=this.levels,n=0,o=r.length;n<o;n++){var s=r[n];i.object.levels.push({object:s.object.uuid,distance:s.distance})}return i}});var ad=new de,od=new rn,sd=new rn,l0=new de,ld=new Lr;function ks(a,t){a&&a.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),mn.call(this,a,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Lr,this.bindMatrixInverse=new Lr}ks.prototype=Object.assign(Object.create(mn.prototype),{constructor:ks,isSkinnedMesh:!0,copy:function(t){return mn.prototype.copy.call(this,t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this},bind:function(t,i){this.skeleton=t,i===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.copy(i).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new rn,i=this.geometry.attributes.skinWeight,r=0,n=i.count;r<n;r++){t.x=i.getX(r),t.y=i.getY(r),t.z=i.getZ(r),t.w=i.getW(r);var o=1/t.manhattanLength();o!==1/0?t.multiplyScalar(o):t.set(1,0,0,0),i.setXYZW(r,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){mn.prototype.updateMatrixWorld.call(this,t),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(t,i){var r=this.skeleton,n=this.geometry;od.fromBufferAttribute(n.attributes.skinIndex,t),sd.fromBufferAttribute(n.attributes.skinWeight,t),ad.fromBufferAttribute(n.attributes.position,t).applyMatrix4(this.bindMatrix),i.set(0,0,0);for(var o=0;o<4;o++){var s=sd.getComponent(o);if(s!==0){var l=od.getComponent(o);ld.multiplyMatrices(r.bones[l].matrixWorld,r.boneInverses[l]),i.addScaledVector(l0.copy(ad).applyMatrix4(ld),s)}}return i.applyMatrix4(this.bindMatrixInverse)}});function Us(){Xt.call(this),this.type="Bone"}Us.prototype=Object.assign(Object.create(Xt.prototype),{constructor:Us,isBone:!0});var ud=new Lr,u0=new Lr;function Hs(a,t){a===void 0&&(a=[]),t===void 0&&(t=[]),this.uuid=dr.generateUUID(),this.bones=a.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}Object.assign(Hs.prototype,{init:function(){var t=this.bones,i=this.boneInverses;if(this.boneMatrices=new Float32Array(t.length*16),i.length===0)this.calculateInverses();else if(t.length!==i.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var r=0,n=this.bones.length;r<n;r++)this.boneInverses.push(new Lr)}},calculateInverses:function(){this.boneInverses.length=0;for(var t=0,i=this.bones.length;t<i;t++){var r=new Lr;this.bones[t]&&r.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(r)}},pose:function(){for(var t=0,i=this.bones.length;t<i;t++){var r=this.bones[t];r&&r.matrixWorld.copy(this.boneInverses[t]).invert()}for(var n=0,o=this.bones.length;n<o;n++){var s=this.bones[n];s&&(s.parent&&s.parent.isBone?(s.matrix.copy(s.parent.matrixWorld).invert(),s.matrix.multiply(s.matrixWorld)):s.matrix.copy(s.matrixWorld),s.matrix.decompose(s.position,s.quaternion,s.scale))}},update:function(){for(var t=this.bones,i=this.boneInverses,r=this.boneMatrices,n=this.boneTexture,o=0,s=t.length;o<s;o++){var l=t[o]?t[o].matrixWorld:u0;ud.multiplyMatrices(l,i[o]),ud.toArray(r,o*16)}n!==null&&(n.needsUpdate=!0)},clone:function(){return new Hs(this.bones,this.boneInverses)},getBoneByName:function(t){for(var i=0,r=this.bones.length;i<r;i++){var n=this.bones[i];if(n.name===t)return n}},dispose:function(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)},fromJSON:function(t,i){this.uuid=t.uuid;for(var r=0,n=t.bones.length;r<n;r++){var o=t.bones[r],s=i[o];s===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),s=new Us),this.bones.push(s),this.boneInverses.push(new Lr().fromArray(t.boneInverses[r]))}return this.init(),this},toJSON:function(){var t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;for(var i=this.bones,r=this.boneInverses,n=0,o=i.length;n<o;n++){var s=i[n];t.bones.push(s.uuid);var l=r[n];t.boneInverses.push(l.toArray())}return t}});var cd=new Lr,hd=new Lr,Dl=[],Gs=new mn;function Ol(a,t,i){mn.call(this,a,t),this.instanceMatrix=new lr(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1}Ol.prototype=Object.assign(Object.create(mn.prototype),{constructor:Ol,isInstancedMesh:!0,copy:function(t){return mn.prototype.copy.call(this,t),this.instanceMatrix.copy(t.instanceMatrix),t.instanceColor!==null&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this},getColorAt:function(t,i){i.fromArray(this.instanceColor.array,t*3)},getMatrixAt:function(t,i){i.fromArray(this.instanceMatrix.array,t*16)},raycast:function(t,i){var r=this.matrixWorld,n=this.count;if(Gs.geometry=this.geometry,Gs.material=this.material,Gs.material!==void 0)for(var o=0;o<n;o++){this.getMatrixAt(o,cd),hd.multiplyMatrices(r,cd),Gs.matrixWorld=hd,Gs.raycast(t,Dl);for(var s=0,l=Dl.length;s<l;s++){var c=Dl[s];c.instanceId=o,c.object=this,i.push(c)}Dl.length=0}},setColorAt:function(t,i){this.instanceColor===null&&(this.instanceColor=new lr(new Float32Array(this.count*3),3)),i.toArray(this.instanceColor.array,t*3)},setMatrixAt:function(t,i){i.toArray(this.instanceMatrix.array,t*16)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}});function wn(a){sr.call(this),this.type="LineBasicMaterial",this.color=new Pt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(a)}wn.prototype=Object.create(sr.prototype),wn.prototype.constructor=wn,wn.prototype.isLineBasicMaterial=!0,wn.prototype.copy=function(a){return sr.prototype.copy.call(this,a),this.color.copy(a.color),this.linewidth=a.linewidth,this.linecap=a.linecap,this.linejoin=a.linejoin,this.morphTargets=a.morphTargets,this};var dd=new de,fd=new de,pd=new Lr,fc=new Oo,Il=new Ia;function Di(a,t){a===void 0&&(a=new Kt),t===void 0&&(t=new wn),Xt.call(this),this.type="Line",this.geometry=a,this.material=t,this.updateMorphTargets()}Di.prototype=Object.assign(Object.create(Xt.prototype),{constructor:Di,isLine:!0,copy:function(t){return Xt.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(t.index===null){for(var i=t.attributes.position,r=[0],n=1,o=i.count;n<o;n++)dd.fromBufferAttribute(i,n-1),fd.fromBufferAttribute(i,n),r[n]=r[n-1],r[n]+=dd.distanceTo(fd);t.setAttribute("lineDistance",new It(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},raycast:function(t,i){var r=this.geometry,n=this.matrixWorld,o=t.params.Line.threshold;if(r.boundingSphere===null&&r.computeBoundingSphere(),Il.copy(r.boundingSphere),Il.applyMatrix4(n),Il.radius+=o,t.ray.intersectsSphere(Il)!==!1){pd.copy(n).invert(),fc.copy(t.ray).applyMatrix4(pd);var s=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=s*s,c=new de,p=new de,C=new de,S=new de,T=this.isLineSegments?2:1;if(r.isBufferGeometry){var O=r.index,P=r.attributes,k=P.position;if(O!==null)for(var W=O.array,V=0,B=W.length-1;V<B;V+=T){var ee=W[V],ue=W[V+1];c.fromBufferAttribute(k,ee),p.fromBufferAttribute(k,ue);var K=fc.distanceSqToSegment(c,p,S,C);if(!(K>l)){S.applyMatrix4(this.matrixWorld);var Q=t.ray.origin.distanceTo(S);Q<t.near||Q>t.far||i.push({distance:Q,point:C.clone().applyMatrix4(this.matrixWorld),index:V,face:null,faceIndex:null,object:this})}}else for(var se=0,Me=k.count-1;se<Me;se+=T){c.fromBufferAttribute(k,se),p.fromBufferAttribute(k,se+1);var xe=fc.distanceSqToSegment(c,p,S,C);if(!(xe>l)){S.applyMatrix4(this.matrixWorld);var _e=t.ray.origin.distanceTo(S);_e<t.near||_e>t.far||i.push({distance:_e,point:C.clone().applyMatrix4(this.matrixWorld),index:se,face:null,faceIndex:null,object:this})}}}else r.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){var i=t.morphAttributes,r=Object.keys(i);if(r.length>0){var n=i[r[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var o=0,s=n.length;o<s;o++){var l=n[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}else{var c=t.morphTargets;c!==void 0&&c.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});var vd=new de,md=new de;function ci(a,t){Di.call(this,a,t),this.type="LineSegments"}ci.prototype=Object.assign(Object.create(Di.prototype),{constructor:ci,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(t.index===null){for(var i=t.attributes.position,r=[],n=0,o=i.count;n<o;n+=2)vd.fromBufferAttribute(i,n),md.fromBufferAttribute(i,n+1),r[n]=n===0?0:r[n-1],r[n+1]=r[n]+vd.distanceTo(md);t.setAttribute("lineDistance",new It(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}});function Bl(a,t){Di.call(this,a,t),this.type="LineLoop"}Bl.prototype=Object.assign(Object.create(Di.prototype),{constructor:Bl,isLineLoop:!0});function Wi(a){sr.call(this),this.type="PointsMaterial",this.color=new Pt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(a)}Wi.prototype=Object.create(sr.prototype),Wi.prototype.constructor=Wi,Wi.prototype.isPointsMaterial=!0,Wi.prototype.copy=function(a){return sr.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.alphaMap=a.alphaMap,this.size=a.size,this.sizeAttenuation=a.sizeAttenuation,this.morphTargets=a.morphTargets,this};var gd=new Lr,pc=new Oo,Fl=new Ia,Nl=new de;function Zo(a,t){a===void 0&&(a=new Kt),t===void 0&&(t=new Wi),Xt.call(this),this.type="Points",this.geometry=a,this.material=t,this.updateMorphTargets()}Zo.prototype=Object.assign(Object.create(Xt.prototype),{constructor:Zo,isPoints:!0,copy:function(t){return Xt.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},raycast:function(t,i){var r=this.geometry,n=this.matrixWorld,o=t.params.Points.threshold;if(r.boundingSphere===null&&r.computeBoundingSphere(),Fl.copy(r.boundingSphere),Fl.applyMatrix4(n),Fl.radius+=o,t.ray.intersectsSphere(Fl)!==!1){gd.copy(n).invert(),pc.copy(t.ray).applyMatrix4(gd);var s=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=s*s;if(r.isBufferGeometry){var c=r.index,p=r.attributes,C=p.position;if(c!==null)for(var S=c.array,T=0,O=S.length;T<O;T++){var P=S[T];Nl.fromBufferAttribute(C,P),yd(Nl,P,l,n,t,i,this)}else for(var k=0,W=C.count;k<W;k++)Nl.fromBufferAttribute(C,k),yd(Nl,k,l,n,t,i,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){var i=t.morphAttributes,r=Object.keys(i);if(r.length>0){var n=i[r[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var o=0,s=n.length;o<s;o++){var l=n[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}else{var c=t.morphTargets;c!==void 0&&c.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});function yd(a,t,i,r,n,o,s){var l=pc.distanceSqToPoint(a);if(l<i){var c=new de;pc.closestPointToPoint(a,c),c.applyMatrix4(r);var p=n.ray.origin.distanceTo(c);if(p<n.near||p>n.far)return;o.push({distance:p,distanceToRay:Math.sqrt(l),point:c,index:t,face:null,object:s})}}function vc(a,t,i,r,n,o,s,l,c){ln.call(this,a,t,i,r,n,o,s,l,c),this.format=s!==void 0?s:Ri,this.minFilter=o!==void 0?o:nt,this.magFilter=n!==void 0?n:nt,this.generateMipmaps=!1;var p=this;function C(){p.needsUpdate=!0,a.requestVideoFrameCallback(C)}"requestVideoFrameCallback"in a&&a.requestVideoFrameCallback(C)}vc.prototype=Object.assign(Object.create(ln.prototype),{constructor:vc,clone:function(){return new this.constructor(this.image).copy(this)},isVideoTexture:!0,update:function(){var t=this.image,i="requestVideoFrameCallback"in t;i===!1&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});function Ko(a,t,i,r,n,o,s,l,c,p,C,S){ln.call(this,null,o,s,l,c,p,r,n,C,S),this.image={width:t,height:i},this.mipmaps=a,this.flipY=!1,this.generateMipmaps=!1}Ko.prototype=Object.create(ln.prototype),Ko.prototype.constructor=Ko,Ko.prototype.isCompressedTexture=!0;function Vs(a,t,i,r,n,o,s,l,c){ln.call(this,a,t,i,r,n,o,s,l,c),this.needsUpdate=!0}Vs.prototype=Object.create(ln.prototype),Vs.prototype.constructor=Vs,Vs.prototype.isCanvasTexture=!0;function zs(a,t,i,r,n,o,s,l,c,p){if(p=p!==void 0?p:et,p!==et&&p!==je)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&p===et&&(i=Dr),i===void 0&&p===je&&(i=Li),ln.call(this,null,r,n,o,s,l,p,i,c),this.image={width:a,height:t},this.magFilter=s!==void 0?s:ar,this.minFilter=l!==void 0?l:ar,this.flipY=!1,this.generateMipmaps=!1}zs.prototype=Object.create(ln.prototype),zs.prototype.constructor=zs,zs.prototype.isDepthTexture=!0;var kl=function(a){Mr(t,a);function t(i,r,n,o){var s;i===void 0&&(i=1),r===void 0&&(r=8),n===void 0&&(n=0),o===void 0&&(o=Math.PI*2),s=a.call(this)||this,s.type="CircleGeometry",s.parameters={radius:i,segments:r,thetaStart:n,thetaLength:o},r=Math.max(3,r);var l=[],c=[],p=[],C=[],S=new de,T=new gt;c.push(0,0,0),p.push(0,0,1),C.push(.5,.5);for(var O=0,P=3;O<=r;O++,P+=3){var k=n+O/r*o;S.x=i*Math.cos(k),S.y=i*Math.sin(k),c.push(S.x,S.y,S.z),p.push(0,0,1),T.x=(c[P]/i+1)/2,T.y=(c[P+1]/i+1)/2,C.push(T.x,T.y)}for(var W=1;W<=r;W++)l.push(W,W+1,0);return s.setIndex(l),s.setAttribute("position",new It(c,3)),s.setAttribute("normal",new It(p,3)),s.setAttribute("uv",new It(C,2)),s}return t}(Kt),$o=function(a){Mr(t,a);function t(i,r,n,o,s,l,c,p){var C;i===void 0&&(i=1),r===void 0&&(r=1),n===void 0&&(n=1),o===void 0&&(o=8),s===void 0&&(s=1),l===void 0&&(l=!1),c===void 0&&(c=0),p===void 0&&(p=Math.PI*2),C=a.call(this)||this,C.type="CylinderGeometry",C.parameters={radiusTop:i,radiusBottom:r,height:n,radialSegments:o,heightSegments:s,openEnded:l,thetaStart:c,thetaLength:p};var S=Ui(C);o=Math.floor(o),s=Math.floor(s);var T=[],O=[],P=[],k=[],W=0,V=[],B=n/2,ee=0;ue(),l===!1&&(i>0&&K(!0),r>0&&K(!1)),C.setIndex(T),C.setAttribute("position",new It(O,3)),C.setAttribute("normal",new It(P,3)),C.setAttribute("uv",new It(k,2));function ue(){for(var Q=new de,se=new de,Me=0,xe=(r-i)/n,_e=0;_e<=s;_e++){for(var Pe=[],Ce=_e/s,Ae=Ce*(r-i)+i,Be=0;Be<=o;Be++){var Se=Be/o,Te=Se*p+c,me=Math.sin(Te),Ue=Math.cos(Te);se.x=Ae*me,se.y=-Ce*n+B,se.z=Ae*Ue,O.push(se.x,se.y,se.z),Q.set(me,xe,Ue).normalize(),P.push(Q.x,Q.y,Q.z),k.push(Se,1-Ce),Pe.push(W++)}V.push(Pe)}for(var He=0;He<o;He++)for(var Ye=0;Ye<s;Ye++){var Qe=V[Ye][He],pt=V[Ye+1][He],Et=V[Ye+1][He+1],Ut=V[Ye][He+1];T.push(Qe,pt,Ut),T.push(pt,Et,Ut),Me+=6}S.addGroup(ee,Me,0),ee+=Me}function K(Q){for(var se=W,Me=new gt,xe=new de,_e=0,Pe=Q===!0?i:r,Ce=Q===!0?1:-1,Ae=1;Ae<=o;Ae++)O.push(0,B*Ce,0),P.push(0,Ce,0),k.push(.5,.5),W++;for(var Be=W,Se=0;Se<=o;Se++){var Te=Se/o,me=Te*p+c,Ue=Math.cos(me),He=Math.sin(me);xe.x=Pe*He,xe.y=B*Ce,xe.z=Pe*Ue,O.push(xe.x,xe.y,xe.z),P.push(0,Ce,0),Me.x=Ue*.5+.5,Me.y=He*.5*Ce+.5,k.push(Me.x,Me.y),W++}for(var Ye=0;Ye<o;Ye++){var Qe=se+Ye,pt=Be+Ye;Q===!0?T.push(pt,pt+1,Qe):T.push(pt+1,pt,Qe),_e+=3}S.addGroup(ee,_e,Q===!0?1:2),ee+=_e}return C}return t}(Kt),Ul=function(a){Mr(t,a);function t(i,r,n,o,s,l,c){var p;return i===void 0&&(i=1),r===void 0&&(r=1),n===void 0&&(n=8),o===void 0&&(o=1),s===void 0&&(s=!1),l===void 0&&(l=0),c===void 0&&(c=Math.PI*2),p=a.call(this,0,i,r,n,o,s,l,c)||this,p.type="ConeGeometry",p.parameters={radius:i,height:r,radialSegments:n,heightSegments:o,openEnded:s,thetaStart:l,thetaLength:c},p}return t}($o),ja=function(a){Mr(t,a);function t(i,r,n,o){var s;n===void 0&&(n=1),o===void 0&&(o=0),s=a.call(this)||this,s.type="PolyhedronGeometry",s.parameters={vertices:i,indices:r,radius:n,detail:o};var l=[],c=[];p(o),S(n),T(),s.setAttribute("position",new It(l,3)),s.setAttribute("normal",new It(l.slice(),3)),s.setAttribute("uv",new It(c,2)),o===0?s.computeVertexNormals():s.normalizeNormals();function p(ue){for(var K=new de,Q=new de,se=new de,Me=0;Me<r.length;Me+=3)k(r[Me+0],K),k(r[Me+1],Q),k(r[Me+2],se),C(K,Q,se,ue)}function C(ue,K,Q,se){for(var Me=se+1,xe=[],_e=0;_e<=Me;_e++){xe[_e]=[];for(var Pe=ue.clone().lerp(Q,_e/Me),Ce=K.clone().lerp(Q,_e/Me),Ae=Me-_e,Be=0;Be<=Ae;Be++)Be===0&&_e===Me?xe[_e][Be]=Pe:xe[_e][Be]=Pe.clone().lerp(Ce,Be/Ae)}for(var Se=0;Se<Me;Se++)for(var Te=0;Te<2*(Me-Se)-1;Te++){var me=Math.floor(Te/2);Te%2==0?(P(xe[Se][me+1]),P(xe[Se+1][me]),P(xe[Se][me])):(P(xe[Se][me+1]),P(xe[Se+1][me+1]),P(xe[Se+1][me]))}}function S(ue){for(var K=new de,Q=0;Q<l.length;Q+=3)K.x=l[Q+0],K.y=l[Q+1],K.z=l[Q+2],K.normalize().multiplyScalar(ue),l[Q+0]=K.x,l[Q+1]=K.y,l[Q+2]=K.z}function T(){for(var ue=new de,K=0;K<l.length;K+=3){ue.x=l[K+0],ue.y=l[K+1],ue.z=l[K+2];var Q=B(ue)/2/Math.PI+.5,se=ee(ue)/Math.PI+.5;c.push(Q,1-se)}W(),O()}function O(){for(var ue=0;ue<c.length;ue+=6){var K=c[ue+0],Q=c[ue+2],se=c[ue+4],Me=Math.max(K,Q,se),xe=Math.min(K,Q,se);Me>.9&&xe<.1&&(K<.2&&(c[ue+0]+=1),Q<.2&&(c[ue+2]+=1),se<.2&&(c[ue+4]+=1))}}function P(ue){l.push(ue.x,ue.y,ue.z)}function k(ue,K){var Q=ue*3;K.x=i[Q+0],K.y=i[Q+1],K.z=i[Q+2]}function W(){for(var ue=new de,K=new de,Q=new de,se=new de,Me=new gt,xe=new gt,_e=new gt,Pe=0,Ce=0;Pe<l.length;Pe+=9,Ce+=6){ue.set(l[Pe+0],l[Pe+1],l[Pe+2]),K.set(l[Pe+3],l[Pe+4],l[Pe+5]),Q.set(l[Pe+6],l[Pe+7],l[Pe+8]),Me.set(c[Ce+0],c[Ce+1]),xe.set(c[Ce+2],c[Ce+3]),_e.set(c[Ce+4],c[Ce+5]),se.copy(ue).add(K).add(Q).divideScalar(3);var Ae=B(se);V(Me,Ce+0,ue,Ae),V(xe,Ce+2,K,Ae),V(_e,Ce+4,Q,Ae)}}function V(ue,K,Q,se){se<0&&ue.x===1&&(c[K]=ue.x-1),Q.x===0&&Q.z===0&&(c[K]=se/2/Math.PI+.5)}function B(ue){return Math.atan2(ue.z,-ue.x)}function ee(ue){return Math.atan2(-ue.y,Math.sqrt(ue.x*ue.x+ue.z*ue.z))}return s}return t}(Kt),Hl=function(a){Mr(t,a);function t(i,r){var n;i===void 0&&(i=1),r===void 0&&(r=0);var o=(1+Math.sqrt(5))/2,s=1/o,l=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-o,0,-s,o,0,s,-o,0,s,o,-s,-o,0,-s,o,0,s,-o,0,s,o,0,-o,0,-s,o,0,-s,-o,0,s,o,0,s],c=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];return n=a.call(this,l,c,i,r)||this,n.type="DodecahedronGeometry",n.parameters={radius:i,detail:r},n}return t}(ja),Gl=new de,Vl=new de,mc=new de,es=new ra,gc=function(a){Mr(t,a);function t(i,r){var n;if(n=a.call(this)||this,n.type="EdgesGeometry",n.parameters={thresholdAngle:r},r=r!==void 0?r:1,i.isGeometry===!0)return console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Ui(n);for(var o=4,s=Math.pow(10,o),l=Math.cos(dr.DEG2RAD*r),c=i.getIndex(),p=i.getAttribute("position"),C=c?c.count:p.count,S=[0,0,0],T=["a","b","c"],O=new Array(3),P={},k=[],W=0;W<C;W+=3){c?(S[0]=c.getX(W),S[1]=c.getX(W+1),S[2]=c.getX(W+2)):(S[0]=W,S[1]=W+1,S[2]=W+2);var V=es.a,B=es.b,ee=es.c;if(V.fromBufferAttribute(p,S[0]),B.fromBufferAttribute(p,S[1]),ee.fromBufferAttribute(p,S[2]),es.getNormal(mc),O[0]=Math.round(V.x*s)+","+Math.round(V.y*s)+","+Math.round(V.z*s),O[1]=Math.round(B.x*s)+","+Math.round(B.y*s)+","+Math.round(B.z*s),O[2]=Math.round(ee.x*s)+","+Math.round(ee.y*s)+","+Math.round(ee.z*s),!(O[0]===O[1]||O[1]===O[2]||O[2]===O[0]))for(var ue=0;ue<3;ue++){var K=(ue+1)%3,Q=O[ue],se=O[K],Me=es[T[ue]],xe=es[T[K]],_e=Q+"_"+se,Pe=se+"_"+Q;Pe in P&&P[Pe]?(mc.dot(P[Pe].normal)<=l&&(k.push(Me.x,Me.y,Me.z),k.push(xe.x,xe.y,xe.z)),P[Pe]=null):_e in P||(P[_e]={index0:S[ue],index1:S[K],normal:mc.clone()})}}for(var Ce in P)if(P[Ce]){var Ae=P[Ce],Be=Ae.index0,Se=Ae.index1;Gl.fromBufferAttribute(p,Be),Vl.fromBufferAttribute(p,Se),k.push(Gl.x,Gl.y,Gl.z),k.push(Vl.x,Vl.y,Vl.z)}return n.setAttribute("position",new It(k,3)),n}return t}(Kt),c0={triangulate:function(t,i,r){r=r||2;var n=i&&i.length,o=n?i[0]*r:t.length,s=Ad(t,0,o,r,!0),l=[];if(!s||s.next===s.prev)return l;var c,p,C,S,T,O,P;if(n&&(s=v0(t,i,s,r)),t.length>80*r){c=C=t[0],p=S=t[1];for(var k=r;k<o;k+=r)T=t[k],O=t[k+1],T<c&&(c=T),O<p&&(p=O),T>C&&(C=T),O>S&&(S=O);P=Math.max(C-c,S-p),P=P!==0?1/P:0}return Ws(s,l,r,c,p,P),l}};function Ad(a,t,i,r,n){var o,s;if(n===S0(a,t,i,r)>0)for(o=t;o<i;o+=r)s=wd(o,a[o],a[o+1],s);else for(o=i-r;o>=t;o-=r)s=wd(o,a[o],a[o+1],s);return s&&zl(s,s.next)&&(Xs(s),s=s.next),s}function Xa(a,t){if(!a)return a;t||(t=a);var i=a,r;do if(r=!1,!i.steiner&&(zl(i,i.next)||Tn(i.prev,i,i.next)===0)){if(Xs(i),i=t=i.prev,i===i.next)break;r=!0}else i=i.next;while(r||i!==t);return t}function Ws(a,t,i,r,n,o,s){if(!!a){!s&&o&&b0(a,r,n,o);for(var l=a,c,p;a.prev!==a.next;){if(c=a.prev,p=a.next,o?d0(a,r,n,o):h0(a)){t.push(c.i/i),t.push(a.i/i),t.push(p.i/i),Xs(a),a=p.next,l=p.next;continue}if(a=p,a===l){s?s===1?(a=f0(Xa(a),t,i),Ws(a,t,i,r,n,o,2)):s===2&&p0(a,t,i,r,n,o):Ws(Xa(a),t,i,r,n,o,1);break}}}}function h0(a){var t=a.prev,i=a,r=a.next;if(Tn(t,i,r)>=0)return!1;for(var n=a.next.next;n!==a.prev;){if(ts(t.x,t.y,i.x,i.y,r.x,r.y,n.x,n.y)&&Tn(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function d0(a,t,i,r){var n=a.prev,o=a,s=a.next;if(Tn(n,o,s)>=0)return!1;for(var l=n.x<o.x?n.x<s.x?n.x:s.x:o.x<s.x?o.x:s.x,c=n.y<o.y?n.y<s.y?n.y:s.y:o.y<s.y?o.y:s.y,p=n.x>o.x?n.x>s.x?n.x:s.x:o.x>s.x?o.x:s.x,C=n.y>o.y?n.y>s.y?n.y:s.y:o.y>s.y?o.y:s.y,S=yc(l,c,t,i,r),T=yc(p,C,t,i,r),O=a.prevZ,P=a.nextZ;O&&O.z>=S&&P&&P.z<=T;){if(O!==a.prev&&O!==a.next&&ts(n.x,n.y,o.x,o.y,s.x,s.y,O.x,O.y)&&Tn(O.prev,O,O.next)>=0||(O=O.prevZ,P!==a.prev&&P!==a.next&&ts(n.x,n.y,o.x,o.y,s.x,s.y,P.x,P.y)&&Tn(P.prev,P,P.next)>=0))return!1;P=P.nextZ}for(;O&&O.z>=S;){if(O!==a.prev&&O!==a.next&&ts(n.x,n.y,o.x,o.y,s.x,s.y,O.x,O.y)&&Tn(O.prev,O,O.next)>=0)return!1;O=O.prevZ}for(;P&&P.z<=T;){if(P!==a.prev&&P!==a.next&&ts(n.x,n.y,o.x,o.y,s.x,s.y,P.x,P.y)&&Tn(P.prev,P,P.next)>=0)return!1;P=P.nextZ}return!0}function f0(a,t,i){var r=a;do{var n=r.prev,o=r.next.next;!zl(n,o)&&bd(n,r,r.next,o)&&js(n,o)&&js(o,n)&&(t.push(n.i/i),t.push(r.i/i),t.push(o.i/i),Xs(r),Xs(r.next),r=a=o),r=r.next}while(r!==a);return Xa(r)}function p0(a,t,i,r,n,o){var s=a;do{for(var l=s.next.next;l!==s.prev;){if(s.i!==l.i&&x0(s,l)){var c=Ed(s,l);s=Xa(s,s.next),c=Xa(c,c.next),Ws(s,t,i,r,n,o),Ws(c,t,i,r,n,o);return}l=l.next}s=s.next}while(s!==a)}function v0(a,t,i,r){var n=[],o,s,l,c,p;for(o=0,s=t.length;o<s;o++)l=t[o]*r,c=o<s-1?t[o+1]*r:a.length,p=Ad(a,l,c,r,!1),p===p.next&&(p.steiner=!0),n.push(w0(p));for(n.sort(m0),o=0;o<n.length;o++)g0(n[o],i),i=Xa(i,i.next);return i}function m0(a,t){return a.x-t.x}function g0(a,t){if(t=y0(a,t),t){var i=Ed(t,a);Xa(t,t.next),Xa(i,i.next)}}function y0(a,t){var i=t,r=a.x,n=a.y,o=-1/0,s;do{if(n<=i.y&&n>=i.next.y&&i.next.y!==i.y){var l=i.x+(n-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(l<=r&&l>o){if(o=l,l===r){if(n===i.y)return i;if(n===i.next.y)return i.next}s=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!s)return null;if(r===o)return s;var c=s,p=s.x,C=s.y,S=1/0,T;i=s;do r>=i.x&&i.x>=p&&r!==i.x&&ts(n<C?r:o,n,p,C,n<C?o:r,n,i.x,i.y)&&(T=Math.abs(n-i.y)/(r-i.x),js(i,a)&&(T<S||T===S&&(i.x>s.x||i.x===s.x&&A0(s,i)))&&(s=i,S=T)),i=i.next;while(i!==c);return s}function A0(a,t){return Tn(a.prev,a,t.prev)<0&&Tn(t.next,a,a.next)<0}function b0(a,t,i,r){var n=a;do n.z===null&&(n.z=yc(n.x,n.y,t,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==a);n.prevZ.nextZ=null,n.prevZ=null,E0(n)}function E0(a){var t,i,r,n,o,s,l,c,p=1;do{for(i=a,a=null,o=null,s=0;i;){for(s++,r=i,l=0,t=0;t<p&&(l++,r=r.nextZ,!!r);t++);for(c=p;l>0||c>0&&r;)l!==0&&(c===0||!r||i.z<=r.z)?(n=i,i=i.nextZ,l--):(n=r,r=r.nextZ,c--),o?o.nextZ=n:a=n,n.prevZ=o,o=n;i=r}o.nextZ=null,p*=2}while(s>1);return a}function yc(a,t,i,r,n){return a=32767*(a-i)*n,t=32767*(t-r)*n,a=(a|a<<8)&16711935,a=(a|a<<4)&252645135,a=(a|a<<2)&858993459,a=(a|a<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,a|t<<1}function w0(a){var t=a,i=a;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==a);return i}function ts(a,t,i,r,n,o,s,l){return(n-s)*(t-l)-(a-s)*(o-l)>=0&&(a-s)*(r-l)-(i-s)*(t-l)>=0&&(i-s)*(o-l)-(n-s)*(r-l)>=0}function x0(a,t){return a.next.i!==t.i&&a.prev.i!==t.i&&!M0(a,t)&&(js(a,t)&&js(t,a)&&T0(a,t)&&(Tn(a.prev,a,t.prev)||Tn(a,t.prev,t))||zl(a,t)&&Tn(a.prev,a,a.next)>0&&Tn(t.prev,t,t.next)>0)}function Tn(a,t,i){return(t.y-a.y)*(i.x-t.x)-(t.x-a.x)*(i.y-t.y)}function zl(a,t){return a.x===t.x&&a.y===t.y}function bd(a,t,i,r){var n=jl(Tn(a,t,i)),o=jl(Tn(a,t,r)),s=jl(Tn(i,r,a)),l=jl(Tn(i,r,t));return!!(n!==o&&s!==l||n===0&&Wl(a,i,t)||o===0&&Wl(a,r,t)||s===0&&Wl(i,a,r)||l===0&&Wl(i,t,r))}function Wl(a,t,i){return t.x<=Math.max(a.x,i.x)&&t.x>=Math.min(a.x,i.x)&&t.y<=Math.max(a.y,i.y)&&t.y>=Math.min(a.y,i.y)}function jl(a){return a>0?1:a<0?-1:0}function M0(a,t){var i=a;do{if(i.i!==a.i&&i.next.i!==a.i&&i.i!==t.i&&i.next.i!==t.i&&bd(i,i.next,a,t))return!0;i=i.next}while(i!==a);return!1}function js(a,t){return Tn(a.prev,a,a.next)<0?Tn(a,t,a.next)>=0&&Tn(a,a.prev,t)>=0:Tn(a,t,a.prev)<0||Tn(a,a.next,t)<0}function T0(a,t){var i=a,r=!1,n=(a.x+t.x)/2,o=(a.y+t.y)/2;do i.y>o!=i.next.y>o&&i.next.y!==i.y&&n<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next;while(i!==a);return r}function Ed(a,t){var i=new Ac(a.i,a.x,a.y),r=new Ac(t.i,t.x,t.y),n=a.next,o=t.prev;return a.next=t,t.prev=a,i.next=n,n.prev=i,r.next=i,i.prev=r,o.next=r,r.prev=o,r}function wd(a,t,i,r){var n=new Ac(a,t,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function Xs(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Ac(a,t,i){this.i=a,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function S0(a,t,i,r){for(var n=0,o=t,s=i-r;o<i;o+=r)n+=(a[s]-a[o])*(a[o+1]+a[s+1]),s=o;return n}var wa={area:function(t){for(var i=t.length,r=0,n=i-1,o=0;o<i;n=o++)r+=t[n].x*t[o].y-t[o].x*t[n].y;return r*.5},isClockWise:function(t){return wa.area(t)<0},triangulateShape:function(t,i){var r=[],n=[],o=[];xd(t),Md(r,t);var s=t.length;i.forEach(xd);for(var l=0;l<i.length;l++)n.push(s),s+=i[l].length,Md(r,i[l]);for(var c=c0.triangulate(r,n),p=0;p<c.length;p+=3)o.push(c.slice(p,p+3));return o}};function xd(a){var t=a.length;t>2&&a[t-1].equals(a[0])&&a.pop()}function Md(a,t){for(var i=0;i<t.length;i++)a.push(t[i].x),a.push(t[i].y)}var fo=function(a){Mr(t,a);function t(r,n){var o;o=a.call(this)||this,o.type="ExtrudeGeometry",o.parameters={shapes:r,options:n},r=Array.isArray(r)?r:[r];for(var s=Ui(o),l=[],c=[],p=0,C=r.length;p<C;p++){var S=r[p];T(S)}o.setAttribute("position",new It(l,3)),o.setAttribute("uv",new It(c,2)),o.computeVertexNormals();function T(O){var P=[],k=n.curveSegments!==void 0?n.curveSegments:12,W=n.steps!==void 0?n.steps:1,V=n.depth!==void 0?n.depth:100,B=n.bevelEnabled!==void 0?n.bevelEnabled:!0,ee=n.bevelThickness!==void 0?n.bevelThickness:6,ue=n.bevelSize!==void 0?n.bevelSize:ee-2,K=n.bevelOffset!==void 0?n.bevelOffset:0,Q=n.bevelSegments!==void 0?n.bevelSegments:3,se=n.extrudePath,Me=n.UVGenerator!==void 0?n.UVGenerator:_0;n.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),V=n.amount);var xe,_e=!1,Pe,Ce,Ae,Be;se&&(xe=se.getSpacedPoints(W),_e=!0,B=!1,Pe=se.computeFrenetFrames(W,!1),Ce=new de,Ae=new de,Be=new de),B||(Q=0,ee=0,ue=0,K=0);var Se=O.extractPoints(k),Te=Se.shape,me=Se.holes,Ue=!wa.isClockWise(Te);if(Ue){Te=Te.reverse();for(var He=0,Ye=me.length;He<Ye;He++){var Qe=me[He];wa.isClockWise(Qe)&&(me[He]=Qe.reverse())}}for(var pt=wa.triangulateShape(Te,me),Et=Te,Ut=0,Ze=me.length;Ut<Ze;Ut++){var $t=me[Ut];Te=Te.concat($t)}function Dt(Wr,wr,Zr){return wr||console.error("THREE.ExtrudeGeometry: vec does not exist"),wr.clone().multiplyScalar(Zr).add(Wr)}var rr=Te.length,vr=pt.length;function _r(Wr,wr,Zr){var Nr,zr,En,ai=Wr.x-wr.x,oi=Wr.y-wr.y,di=Zr.x-Wr.x,Ci=Zr.y-Wr.y,Ca=ai*ai+oi*oi,rh=ai*Ci-oi*di;if(Math.abs(rh)>Number.EPSILON){var Ru=Math.sqrt(Ca),gf=Math.sqrt(di*di+Ci*Ci),yf=wr.x-oi/Ru,Af=wr.y+ai/Ru,aA=Zr.x-Ci/gf,oA=Zr.y+di/gf,bf=((aA-yf)*Ci-(oA-Af)*di)/(ai*Ci-oi*di);Nr=yf+ai*bf-Wr.x,zr=Af+oi*bf-Wr.y;var Ef=Nr*Nr+zr*zr;if(Ef<=2)return new gt(Nr,zr);En=Math.sqrt(Ef/2)}else{var Pu=!1;ai>Number.EPSILON?di>Number.EPSILON&&(Pu=!0):ai<-Number.EPSILON?di<-Number.EPSILON&&(Pu=!0):Math.sign(oi)===Math.sign(Ci)&&(Pu=!0),Pu?(Nr=-oi,zr=ai,En=Math.sqrt(Ca)):(Nr=ai,zr=oi,En=Math.sqrt(Ca/2))}return new gt(Nr/En,zr/En)}for(var gr=[],un=0,Gr=Et.length,nn=Gr-1,In=un+1;un<Gr;un++,nn++,In++)nn===Gr&&(nn=0),In===Gr&&(In=0),gr[un]=_r(Et[un],Et[nn],Et[In]);for(var ni=[],Vn,Ln=gr.concat(),Le=0,Ee=me.length;Le<Ee;Le++){var Lt=me[Le];Vn=[];for(var Tt=0,pr=Lt.length,Ve=pr-1,Ht=Tt+1;Tt<pr;Tt++,Ve++,Ht++)Ve===pr&&(Ve=0),Ht===pr&&(Ht=0),Vn[Tt]=_r(Lt[Tt],Lt[Ve],Lt[Ht]);ni.push(Vn),Ln=Ln.concat(Vn)}for(var Ft=0;Ft<Q;Ft++){for(var nr=Ft/Q,Ot=ee*Math.cos(nr*Math.PI/2),xt=ue*Math.sin(nr*Math.PI/2)+K,yr=0,Cr=Et.length;yr<Cr;yr++){var Sn=Dt(Et[yr],gr[yr],xt);Br(Sn.x,Sn.y,-Ot)}for(var cn=0,Qr=me.length;cn<Qr;cn++){var Kr=me[cn];Vn=ni[cn];for(var Bn=0,cs=Kr.length;Bn<cs;Bn++){var $a=Dt(Kr[Bn],Vn[Bn],xt);Br($a.x,$a.y,-Ot)}}}for(var Zi=ue+K,Sa=0;Sa<rr;Sa++){var ha=B?Dt(Te[Sa],Ln[Sa],Zi):Te[Sa];_e?(Ae.copy(Pe.normals[0]).multiplyScalar(ha.x),Ce.copy(Pe.binormals[0]).multiplyScalar(ha.y),Be.copy(xe[0]).add(Ae).add(Ce),Br(Be.x,Be.y,Be.z)):Br(ha.x,ha.y,0)}for(var _a=1;_a<=W;_a++)for(var eo=0;eo<rr;eo++){var Co=B?Dt(Te[eo],Ln[eo],Zi):Te[eo];_e?(Ae.copy(Pe.normals[_a]).multiplyScalar(Co.x),Ce.copy(Pe.binormals[_a]).multiplyScalar(Co.y),Be.copy(xe[_a]).add(Ae).add(Ce),Br(Be.x,Be.y,Be.z)):Br(Co.x,Co.y,V/W*_a)}for(var _i=Q-1;_i>=0;_i--){for(var nl=_i/Q,il=ee*Math.cos(nl*Math.PI/2),Lu=ue*Math.sin(nl*Math.PI/2)+K,pe=0,st=Et.length;pe<st;pe++){var Ke=Dt(Et[pe],gr[pe],Lu);Br(Ke.x,Ke.y,V+il)}for(var ut=0,Ct=me.length;ut<Ct;ut++){var Vr=me[ut];Vn=ni[ut];for(var Ir=0,$r=Vr.length;Ir<$r;Ir++){var mr=Dt(Vr[Ir],Vn[Ir],Lu);_e?Br(mr.x,mr.y+xe[W-1].y,xe[W-1].x+il):Br(mr.x,mr.y,V+il)}}}Fn(),xn();function Fn(){var Wr=l.length/3;if(B){for(var wr=0,Zr=rr*wr,Nr=0;Nr<vr;Nr++){var zr=pt[Nr];zn(zr[2]+Zr,zr[1]+Zr,zr[0]+Zr)}wr=W+Q*2,Zr=rr*wr;for(var En=0;En<vr;En++){var ai=pt[En];zn(ai[0]+Zr,ai[1]+Zr,ai[2]+Zr)}}else{for(var oi=0;oi<vr;oi++){var di=pt[oi];zn(di[2],di[1],di[0])}for(var Ci=0;Ci<vr;Ci++){var Ca=pt[Ci];zn(Ca[0]+rr*W,Ca[1]+rr*W,Ca[2]+rr*W)}}s.addGroup(Wr,l.length/3-Wr,0)}function xn(){var Wr=l.length/3,wr=0;Rr(Et,wr),wr+=Et.length;for(var Zr=0,Nr=me.length;Zr<Nr;Zr++){var zr=me[Zr];Rr(zr,wr),wr+=zr.length}s.addGroup(Wr,l.length/3-Wr,1)}function Rr(Wr,wr){for(var Zr=Wr.length;--Zr>=0;){var Nr=Zr,zr=Zr-1;zr<0&&(zr=Wr.length-1);for(var En=0,ai=W+Q*2;En<ai;En++){var oi=rr*En,di=rr*(En+1),Ci=wr+Nr+oi,Ca=wr+zr+oi,rh=wr+zr+di,Ru=wr+Nr+di;ii(Ci,Ca,rh,Ru)}}}function Br(Wr,wr,Zr){P.push(Wr),P.push(wr),P.push(Zr)}function zn(Wr,wr,Zr){Jr(Wr),Jr(wr),Jr(Zr);var Nr=l.length/3,zr=Me.generateTopUV(s,l,Nr-3,Nr-2,Nr-1);kn(zr[0]),kn(zr[1]),kn(zr[2])}function ii(Wr,wr,Zr,Nr){Jr(Wr),Jr(wr),Jr(Nr),Jr(wr),Jr(Zr),Jr(Nr);var zr=l.length/3,En=Me.generateSideWallUV(s,l,zr-6,zr-3,zr-2,zr-1);kn(En[0]),kn(En[1]),kn(En[3]),kn(En[1]),kn(En[2]),kn(En[3])}function Jr(Wr){l.push(P[Wr*3+0]),l.push(P[Wr*3+1]),l.push(P[Wr*3+2])}function kn(Wr){c.push(Wr.x),c.push(Wr.y)}}return o}var i=t.prototype;return i.toJSON=function(){var n=Kt.prototype.toJSON.call(this),o=this.parameters.shapes,s=this.parameters.options;return C0(o,s,n)},t}(Kt),_0={generateTopUV:function(t,i,r,n,o){var s=i[r*3],l=i[r*3+1],c=i[n*3],p=i[n*3+1],C=i[o*3],S=i[o*3+1];return[new gt(s,l),new gt(c,p),new gt(C,S)]},generateSideWallUV:function(t,i,r,n,o,s){var l=i[r*3],c=i[r*3+1],p=i[r*3+2],C=i[n*3],S=i[n*3+1],T=i[n*3+2],O=i[o*3],P=i[o*3+1],k=i[o*3+2],W=i[s*3],V=i[s*3+1],B=i[s*3+2];return Math.abs(c-S)<.01?[new gt(l,1-p),new gt(C,1-T),new gt(O,1-k),new gt(W,1-B)]:[new gt(c,1-p),new gt(S,1-T),new gt(P,1-k),new gt(V,1-B)]}};function C0(a,t,i){if(i.shapes=[],Array.isArray(a))for(var r=0,n=a.length;r<n;r++){var o=a[r];i.shapes.push(o.uuid)}else i.shapes.push(a.uuid);return t.extrudePath!==void 0&&(i.options.extrudePath=t.extrudePath.toJSON()),i}var Xl=function(a){Mr(t,a);function t(i,r){var n;i===void 0&&(i=1),r===void 0&&(r=0);var o=(1+Math.sqrt(5))/2,s=[-1,o,0,1,o,0,-1,-o,0,1,-o,0,0,-1,o,0,1,o,0,-1,-o,0,1,-o,o,0,-1,o,0,1,-o,0,-1,-o,0,1],l=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];return n=a.call(this,s,l,i,r)||this,n.type="IcosahedronGeometry",n.parameters={radius:i,detail:r},n}return t}(ja),Yl=function(a){Mr(t,a);function t(i,r,n,o){var s;r===void 0&&(r=12),n===void 0&&(n=0),o===void 0&&(o=Math.PI*2),s=a.call(this)||this,s.type="LatheGeometry",s.parameters={points:i,segments:r,phiStart:n,phiLength:o},r=Math.floor(r),o=dr.clamp(o,0,Math.PI*2);for(var l=[],c=[],p=[],C=1/r,S=new de,T=new gt,O=0;O<=r;O++)for(var P=n+O*C*o,k=Math.sin(P),W=Math.cos(P),V=0;V<=i.length-1;V++)S.x=i[V].x*k,S.y=i[V].y,S.z=i[V].x*W,c.push(S.x,S.y,S.z),T.x=O/r,T.y=V/(i.length-1),p.push(T.x,T.y);for(var B=0;B<r;B++)for(var ee=0;ee<i.length-1;ee++){var ue=ee+B*i.length,K=ue,Q=ue+i.length,se=ue+i.length+1,Me=ue+1;l.push(K,Q,Me),l.push(Q,se,Me)}if(s.setIndex(l),s.setAttribute("position",new It(c,3)),s.setAttribute("uv",new It(p,2)),s.computeVertexNormals(),o===Math.PI*2)for(var xe=s.attributes.normal.array,_e=new de,Pe=new de,Ce=new de,Ae=r*i.length*3,Be=0,Se=0;Be<i.length;Be++,Se+=3)_e.x=xe[Se+0],_e.y=xe[Se+1],_e.z=xe[Se+2],Pe.x=xe[Ae+Se+0],Pe.y=xe[Ae+Se+1],Pe.z=xe[Ae+Se+2],Ce.addVectors(_e,Pe).normalize(),xe[Se+0]=xe[Ae+Se+0]=Ce.x,xe[Se+1]=xe[Ae+Se+1]=Ce.y,xe[Se+2]=xe[Ae+Se+2]=Ce.z;return s}return t}(Kt),Ys=function(a){Mr(t,a);function t(i,r){var n;i===void 0&&(i=1),r===void 0&&(r=0);var o=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];return n=a.call(this,o,s,i,r)||this,n.type="OctahedronGeometry",n.parameters={radius:i,detail:r},n}return t}(ja);function po(a,t,i){Kt.call(this),this.type="ParametricGeometry",this.parameters={func:a,slices:t,stacks:i};var r=[],n=[],o=[],s=[],l=1e-5,c=new de,p=new de,C=new de,S=new de,T=new de;a.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var O=t+1,P=0;P<=i;P++)for(var k=P/i,W=0;W<=t;W++){var V=W/t;a(V,k,p),n.push(p.x,p.y,p.z),V-l>=0?(a(V-l,k,C),S.subVectors(p,C)):(a(V+l,k,C),S.subVectors(C,p)),k-l>=0?(a(V,k-l,C),T.subVectors(p,C)):(a(V,k+l,C),T.subVectors(C,p)),c.crossVectors(S,T).normalize(),o.push(c.x,c.y,c.z),s.push(V,k)}for(var B=0;B<i;B++)for(var ee=0;ee<t;ee++){var ue=B*O+ee,K=B*O+ee+1,Q=(B+1)*O+ee+1,se=(B+1)*O+ee;r.push(ue,K,se),r.push(K,Q,se)}this.setIndex(r),this.setAttribute("position",new It(n,3)),this.setAttribute("normal",new It(o,3)),this.setAttribute("uv",new It(s,2))}po.prototype=Object.create(Kt.prototype),po.prototype.constructor=po;var Ql=function(a){Mr(t,a);function t(i,r,n,o,s,l){var c;i===void 0&&(i=.5),r===void 0&&(r=1),n===void 0&&(n=8),o===void 0&&(o=1),s===void 0&&(s=0),l===void 0&&(l=Math.PI*2),c=a.call(this)||this,c.type="RingGeometry",c.parameters={innerRadius:i,outerRadius:r,thetaSegments:n,phiSegments:o,thetaStart:s,thetaLength:l},n=Math.max(3,n),o=Math.max(1,o);for(var p=[],C=[],S=[],T=[],O=i,P=(r-i)/o,k=new de,W=new gt,V=0;V<=o;V++){for(var B=0;B<=n;B++){var ee=s+B/n*l;k.x=O*Math.cos(ee),k.y=O*Math.sin(ee),C.push(k.x,k.y,k.z),S.push(0,0,1),W.x=(k.x/r+1)/2,W.y=(k.y/r+1)/2,T.push(W.x,W.y)}O+=P}for(var ue=0;ue<o;ue++)for(var K=ue*(n+1),Q=0;Q<n;Q++){var se=Q+K,Me=se,xe=se+n+1,_e=se+n+2,Pe=se+1;p.push(Me,xe,Pe),p.push(xe,_e,Pe)}return c.setIndex(p),c.setAttribute("position",new It(C,3)),c.setAttribute("normal",new It(S,3)),c.setAttribute("uv",new It(T,2)),c}return t}(Kt),Qs=function(a){Mr(t,a);function t(r,n){var o;n===void 0&&(n=12),o=a.call(this)||this,o.type="ShapeGeometry",o.parameters={shapes:r,curveSegments:n};var s=[],l=[],c=[],p=[],C=0,S=0;if(Array.isArray(r)===!1)O(r);else for(var T=0;T<r.length;T++)O(r[T]),o.addGroup(C,S,T),C+=S,S=0;o.setIndex(s),o.setAttribute("position",new It(l,3)),o.setAttribute("normal",new It(c,3)),o.setAttribute("uv",new It(p,2));function O(P){var k=l.length/3,W=P.extractPoints(n),V=W.shape,B=W.holes;wa.isClockWise(V)===!1&&(V=V.reverse());for(var ee=0,ue=B.length;ee<ue;ee++){var K=B[ee];wa.isClockWise(K)===!0&&(B[ee]=K.reverse())}for(var Q=wa.triangulateShape(V,B),se=0,Me=B.length;se<Me;se++){var xe=B[se];V=V.concat(xe)}for(var _e=0,Pe=V.length;_e<Pe;_e++){var Ce=V[_e];l.push(Ce.x,Ce.y,0),c.push(0,0,1),p.push(Ce.x,Ce.y)}for(var Ae=0,Be=Q.length;Ae<Be;Ae++){var Se=Q[Ae],Te=Se[0]+k,me=Se[1]+k,Ue=Se[2]+k;s.push(Te,me,Ue),S+=3}}return o}var i=t.prototype;return i.toJSON=function(){var n=Kt.prototype.toJSON.call(this),o=this.parameters.shapes;return L0(o,n)},t}(Kt);function L0(a,t){if(t.shapes=[],Array.isArray(a))for(var i=0,r=a.length;i<r;i++){var n=a[i];t.shapes.push(n.uuid)}else t.shapes.push(a.uuid);return t}var qs=function(a){Mr(t,a);function t(i,r,n,o,s,l,c){var p;i===void 0&&(i=1),r===void 0&&(r=8),n===void 0&&(n=6),o===void 0&&(o=0),s===void 0&&(s=Math.PI*2),l===void 0&&(l=0),c===void 0&&(c=Math.PI),p=a.call(this)||this,p.type="SphereGeometry",p.parameters={radius:i,widthSegments:r,heightSegments:n,phiStart:o,phiLength:s,thetaStart:l,thetaLength:c},r=Math.max(3,Math.floor(r)),n=Math.max(2,Math.floor(n));for(var C=Math.min(l+c,Math.PI),S=0,T=[],O=new de,P=new de,k=[],W=[],V=[],B=[],ee=0;ee<=n;ee++){var ue=[],K=ee/n,Q=0;ee==0&&l==0?Q=.5/r:ee==n&&C==Math.PI&&(Q=-.5/r);for(var se=0;se<=r;se++){var Me=se/r;O.x=-i*Math.cos(o+Me*s)*Math.sin(l+K*c),O.y=i*Math.cos(l+K*c),O.z=i*Math.sin(o+Me*s)*Math.sin(l+K*c),W.push(O.x,O.y,O.z),P.copy(O).normalize(),V.push(P.x,P.y,P.z),B.push(Me+Q,1-K),ue.push(S++)}T.push(ue)}for(var xe=0;xe<n;xe++)for(var _e=0;_e<r;_e++){var Pe=T[xe][_e+1],Ce=T[xe][_e],Ae=T[xe+1][_e],Be=T[xe+1][_e+1];(xe!==0||l>0)&&k.push(Pe,Ce,Be),(xe!==n-1||C<Math.PI)&&k.push(Ce,Ae,Be)}return p.setIndex(k),p.setAttribute("position",new It(W,3)),p.setAttribute("normal",new It(V,3)),p.setAttribute("uv",new It(B,2)),p}return t}(Kt),ql=function(a){Mr(t,a);function t(i,r){var n;i===void 0&&(i=1),r===void 0&&(r=0);var o=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];return n=a.call(this,o,s,i,r)||this,n.type="TetrahedronGeometry",n.parameters={radius:i,detail:r},n}return t}(ja),Jl=function(a){Mr(t,a);function t(i,r){var n;r===void 0&&(r={});var o=r.font;if(!(o&&o.isFont))return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Kt||Ui(n);var s=o.generateShapes(i,r.size);return r.depth=r.height!==void 0?r.height:50,r.bevelThickness===void 0&&(r.bevelThickness=10),r.bevelSize===void 0&&(r.bevelSize=8),r.bevelEnabled===void 0&&(r.bevelEnabled=!1),n=a.call(this,s,r)||this,n.type="TextGeometry",n}return t}(fo),Zl=function(a){Mr(t,a);function t(i,r,n,o,s){var l;i===void 0&&(i=1),r===void 0&&(r=.4),n===void 0&&(n=8),o===void 0&&(o=6),s===void 0&&(s=Math.PI*2),l=a.call(this)||this,l.type="TorusGeometry",l.parameters={radius:i,tube:r,radialSegments:n,tubularSegments:o,arc:s},n=Math.floor(n),o=Math.floor(o);for(var c=[],p=[],C=[],S=[],T=new de,O=new de,P=new de,k=0;k<=n;k++)for(var W=0;W<=o;W++){var V=W/o*s,B=k/n*Math.PI*2;O.x=(i+r*Math.cos(B))*Math.cos(V),O.y=(i+r*Math.cos(B))*Math.sin(V),O.z=r*Math.sin(B),p.push(O.x,O.y,O.z),T.x=i*Math.cos(V),T.y=i*Math.sin(V),P.subVectors(O,T).normalize(),C.push(P.x,P.y,P.z),S.push(W/o),S.push(k/n)}for(var ee=1;ee<=n;ee++)for(var ue=1;ue<=o;ue++){var K=(o+1)*ee+ue-1,Q=(o+1)*(ee-1)+ue-1,se=(o+1)*(ee-1)+ue,Me=(o+1)*ee+ue;c.push(K,Q,Me),c.push(Q,se,Me)}return l.setIndex(c),l.setAttribute("position",new It(p,3)),l.setAttribute("normal",new It(C,3)),l.setAttribute("uv",new It(S,2)),l}return t}(Kt),Kl=function(a){Mr(t,a);function t(i,r,n,o,s,l){var c;i===void 0&&(i=1),r===void 0&&(r=.4),n===void 0&&(n=64),o===void 0&&(o=8),s===void 0&&(s=2),l===void 0&&(l=3),c=a.call(this)||this,c.type="TorusKnotGeometry",c.parameters={radius:i,tube:r,tubularSegments:n,radialSegments:o,p:s,q:l},n=Math.floor(n),o=Math.floor(o);for(var p=[],C=[],S=[],T=[],O=new de,P=new de,k=new de,W=new de,V=new de,B=new de,ee=new de,ue=0;ue<=n;++ue){var K=ue/n*s*Math.PI*2;Te(K,s,l,i,k),Te(K+.01,s,l,i,W),B.subVectors(W,k),ee.addVectors(W,k),V.crossVectors(B,ee),ee.crossVectors(V,B),V.normalize(),ee.normalize();for(var Q=0;Q<=o;++Q){var se=Q/o*Math.PI*2,Me=-r*Math.cos(se),xe=r*Math.sin(se);O.x=k.x+(Me*ee.x+xe*V.x),O.y=k.y+(Me*ee.y+xe*V.y),O.z=k.z+(Me*ee.z+xe*V.z),C.push(O.x,O.y,O.z),P.subVectors(O,k).normalize(),S.push(P.x,P.y,P.z),T.push(ue/n),T.push(Q/o)}}for(var _e=1;_e<=n;_e++)for(var Pe=1;Pe<=o;Pe++){var Ce=(o+1)*(_e-1)+(Pe-1),Ae=(o+1)*_e+(Pe-1),Be=(o+1)*_e+Pe,Se=(o+1)*(_e-1)+Pe;p.push(Ce,Ae,Se),p.push(Ae,Be,Se)}c.setIndex(p),c.setAttribute("position",new It(C,3)),c.setAttribute("normal",new It(S,3)),c.setAttribute("uv",new It(T,2));function Te(me,Ue,He,Ye,Qe){var pt=Math.cos(me),Et=Math.sin(me),Ut=He/Ue*me,Ze=Math.cos(Ut);Qe.x=Ye*(2+Ze)*.5*pt,Qe.y=Ye*(2+Ze)*Et*.5,Qe.z=Ye*Math.sin(Ut)*.5}return c}return t}(Kt),$l=function(a){Mr(t,a);function t(r,n,o,s,l){var c;n===void 0&&(n=64),o===void 0&&(o=1),s===void 0&&(s=8),l===void 0&&(l=!1),c=a.call(this)||this,c.type="TubeGeometry",c.parameters={path:r,tubularSegments:n,radius:o,radialSegments:s,closed:l};var p=r.computeFrenetFrames(n,l);c.tangents=p.tangents,c.normals=p.normals,c.binormals=p.binormals;var C=new de,S=new de,T=new gt,O=new de,P=[],k=[],W=[],V=[];B(),c.setIndex(V),c.setAttribute("position",new It(P,3)),c.setAttribute("normal",new It(k,3)),c.setAttribute("uv",new It(W,2));function B(){for(var Q=0;Q<n;Q++)ee(Q);ee(l===!1?n:0),K(),ue()}function ee(Q){O=r.getPointAt(Q/n,O);for(var se=p.normals[Q],Me=p.binormals[Q],xe=0;xe<=s;xe++){var _e=xe/s*Math.PI*2,Pe=Math.sin(_e),Ce=-Math.cos(_e);S.x=Ce*se.x+Pe*Me.x,S.y=Ce*se.y+Pe*Me.y,S.z=Ce*se.z+Pe*Me.z,S.normalize(),k.push(S.x,S.y,S.z),C.x=O.x+o*S.x,C.y=O.y+o*S.y,C.z=O.z+o*S.z,P.push(C.x,C.y,C.z)}}function ue(){for(var Q=1;Q<=n;Q++)for(var se=1;se<=s;se++){var Me=(s+1)*(Q-1)+(se-1),xe=(s+1)*Q+(se-1),_e=(s+1)*Q+se,Pe=(s+1)*(Q-1)+se;V.push(Me,xe,Pe),V.push(xe,_e,Pe)}}function K(){for(var Q=0;Q<=n;Q++)for(var se=0;se<=s;se++)T.x=Q/n,T.y=se/s,W.push(T.x,T.y)}return c}var i=t.prototype;return i.toJSON=function(){var n=Kt.prototype.toJSON.call(this);return n.path=this.parameters.path.toJSON(),n},t}(Kt),bc=function(a){Mr(t,a);function t(i){var r;if(r=a.call(this)||this,r.type="WireframeGeometry",i.isGeometry===!0)return console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Ui(r);var n=[],o=[0,0],s={},l=new de;if(i.index!==null){var c=i.attributes.position,p=i.index,C=i.groups;C.length===0&&(C=[{start:0,count:p.count,materialIndex:0}]);for(var S=0,T=C.length;S<T;++S)for(var O=C[S],P=O.start,k=O.count,W=P,V=P+k;W<V;W+=3)for(var B=0;B<3;B++){var ee=p.getX(W+B),ue=p.getX(W+(B+1)%3);o[0]=Math.min(ee,ue),o[1]=Math.max(ee,ue);var K=o[0]+","+o[1];s[K]===void 0&&(s[K]={index1:o[0],index2:o[1]})}for(var Q in s){var se=s[Q];l.fromBufferAttribute(c,se.index1),n.push(l.x,l.y,l.z),l.fromBufferAttribute(c,se.index2),n.push(l.x,l.y,l.z)}}else for(var Me=i.attributes.position,xe=0,_e=Me.count/3;xe<_e;xe++)for(var Pe=0;Pe<3;Pe++){var Ce=3*xe+Pe;l.fromBufferAttribute(Me,Ce),n.push(l.x,l.y,l.z);var Ae=3*xe+(Pe+1)%3;l.fromBufferAttribute(Me,Ae),n.push(l.x,l.y,l.z)}return r.setAttribute("position",new It(n,3)),r}return t}(Kt),hi=Object.freeze({__proto__:null,BoxGeometry:uo,BoxBufferGeometry:uo,CircleGeometry:kl,CircleBufferGeometry:kl,ConeGeometry:Ul,ConeBufferGeometry:Ul,CylinderGeometry:$o,CylinderBufferGeometry:$o,DodecahedronGeometry:Hl,DodecahedronBufferGeometry:Hl,EdgesGeometry:gc,ExtrudeGeometry:fo,ExtrudeBufferGeometry:fo,IcosahedronGeometry:Xl,IcosahedronBufferGeometry:Xl,LatheGeometry:Yl,LatheBufferGeometry:Yl,OctahedronGeometry:Ys,OctahedronBufferGeometry:Ys,ParametricGeometry:po,ParametricBufferGeometry:po,PlaneGeometry:_s,PlaneBufferGeometry:_s,PolyhedronGeometry:ja,PolyhedronBufferGeometry:ja,RingGeometry:Ql,RingBufferGeometry:Ql,ShapeGeometry:Qs,ShapeBufferGeometry:Qs,SphereGeometry:qs,SphereBufferGeometry:qs,TetrahedronGeometry:ql,TetrahedronBufferGeometry:ql,TextGeometry:Jl,TextBufferGeometry:Jl,TorusGeometry:Zl,TorusBufferGeometry:Zl,TorusKnotGeometry:Kl,TorusKnotBufferGeometry:Kl,TubeGeometry:$l,TubeBufferGeometry:$l,WireframeGeometry:bc});function vo(a){sr.call(this),this.type="ShadowMaterial",this.color=new Pt(0),this.transparent=!0,this.setValues(a)}vo.prototype=Object.create(sr.prototype),vo.prototype.constructor=vo,vo.prototype.isShadowMaterial=!0,vo.prototype.copy=function(a){return sr.prototype.copy.call(this,a),this.color.copy(a.color),this};function xa(a){ui.call(this,a),this.type="RawShaderMaterial"}xa.prototype=Object.create(ui.prototype),xa.prototype.constructor=xa,xa.prototype.isRawShaderMaterial=!0;function oa(a){sr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Pt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ro,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(a)}oa.prototype=Object.create(sr.prototype),oa.prototype.constructor=oa,oa.prototype.isMeshStandardMaterial=!0,oa.prototype.copy=function(a){return sr.prototype.copy.call(this,a),this.defines={STANDARD:""},this.color.copy(a.color),this.roughness=a.roughness,this.metalness=a.metalness,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.roughnessMap=a.roughnessMap,this.metalnessMap=a.metalnessMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapIntensity=a.envMapIntensity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this.vertexTangents=a.vertexTangents,this};function Ya(a){oa.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new gt(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(i){this.reflectivity=dr.clamp(2.5*(i-1)/(i+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(a)}Ya.prototype=Object.create(oa.prototype),Ya.prototype.constructor=Ya,Ya.prototype.isMeshPhysicalMaterial=!0,Ya.prototype.copy=function(a){return oa.prototype.copy.call(this,a),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=a.clearcoat,this.clearcoatMap=a.clearcoatMap,this.clearcoatRoughness=a.clearcoatRoughness,this.clearcoatRoughnessMap=a.clearcoatRoughnessMap,this.clearcoatNormalMap=a.clearcoatNormalMap,this.clearcoatNormalScale.copy(a.clearcoatNormalScale),this.reflectivity=a.reflectivity,a.sheen?this.sheen=(this.sheen||new Pt).copy(a.sheen):this.sheen=null,this.transmission=a.transmission,this.transmissionMap=a.transmissionMap,this};function Qa(a){sr.call(this),this.type="MeshPhongMaterial",this.color=new Pt(16777215),this.specular=new Pt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ro,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=De,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)}Qa.prototype=Object.create(sr.prototype),Qa.prototype.constructor=Qa,Qa.prototype.isMeshPhongMaterial=!0,Qa.prototype.copy=function(a){return sr.prototype.copy.call(this,a),this.color.copy(a.color),this.specular.copy(a.specular),this.shininess=a.shininess,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this};function mo(a){sr.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Pt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ro,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)}mo.prototype=Object.create(sr.prototype),mo.prototype.constructor=mo,mo.prototype.isMeshToonMaterial=!0,mo.prototype.copy=function(a){return sr.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.gradientMap=a.gradientMap,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this};function go(a){sr.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ro,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)}go.prototype=Object.create(sr.prototype),go.prototype.constructor=go,go.prototype.isMeshNormalMaterial=!0,go.prototype.copy=function(a){return sr.prototype.copy.call(this,a),this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this};function yo(a){sr.call(this),this.type="MeshLambertMaterial",this.color=new Pt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=De,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)}yo.prototype=Object.create(sr.prototype),yo.prototype.constructor=yo,yo.prototype.isMeshLambertMaterial=!0,yo.prototype.copy=function(a){return sr.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this};function Ao(a){sr.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Pt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ro,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)}Ao.prototype=Object.create(sr.prototype),Ao.prototype.constructor=Ao,Ao.prototype.isMeshMatcapMaterial=!0,Ao.prototype.copy=function(a){return sr.prototype.copy.call(this,a),this.defines={MATCAP:""},this.color.copy(a.color),this.matcap=a.matcap,this.map=a.map,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this};function bo(a){wn.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(a)}bo.prototype=Object.create(wn.prototype),bo.prototype.constructor=bo,bo.prototype.isLineDashedMaterial=!0,bo.prototype.copy=function(a){return wn.prototype.copy.call(this,a),this.scale=a.scale,this.dashSize=a.dashSize,this.gapSize=a.gapSize,this};var R0=Object.freeze({__proto__:null,ShadowMaterial:vo,SpriteMaterial:Wa,RawShaderMaterial:xa,ShaderMaterial:ui,PointsMaterial:Wi,MeshPhysicalMaterial:Ya,MeshStandardMaterial:oa,MeshPhongMaterial:Qa,MeshToonMaterial:mo,MeshNormalMaterial:go,MeshLambertMaterial:yo,MeshDepthMaterial:Ga,MeshDistanceMaterial:Va,MeshBasicMaterial:bi,MeshMatcapMaterial:Ao,LineDashedMaterial:bo,LineBasicMaterial:wn,Material:sr}),bn={arraySlice:function(t,i,r){return bn.isTypedArray(t)?new t.constructor(t.subarray(i,r!==void 0?r:t.length)):t.slice(i,r)},convertArray:function(t,i,r){return!t||!r&&t.constructor===i?t:typeof i.BYTES_PER_ELEMENT=="number"?new i(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){function i(s,l){return t[s]-t[l]}for(var r=t.length,n=new Array(r),o=0;o!==r;++o)n[o]=o;return n.sort(i),n},sortedArray:function(t,i,r){for(var n=t.length,o=new t.constructor(n),s=0,l=0;l!==n;++s)for(var c=r[s]*i,p=0;p!==i;++p)o[l++]=t[c+p];return o},flattenJSON:function(t,i,r,n){for(var o=1,s=t[0];s!==void 0&&s[n]===void 0;)s=t[o++];if(s!==void 0){var l=s[n];if(l!==void 0)if(Array.isArray(l))do l=s[n],l!==void 0&&(i.push(s.time),r.push.apply(r,l)),s=t[o++];while(s!==void 0);else if(l.toArray!==void 0)do l=s[n],l!==void 0&&(i.push(s.time),l.toArray(r,r.length)),s=t[o++];while(s!==void 0);else do l=s[n],l!==void 0&&(i.push(s.time),r.push(l)),s=t[o++];while(s!==void 0)}},subclip:function(t,i,r,n,o){o===void 0&&(o=30);var s=t.clone();s.name=i;for(var l=[],c=0;c<s.tracks.length;++c){for(var p=s.tracks[c],C=p.getValueSize(),S=[],T=[],O=0;O<p.times.length;++O){var P=p.times[O]*o;if(!(P<r||P>=n)){S.push(p.times[O]);for(var k=0;k<C;++k)T.push(p.values[O*C+k])}}S.length!==0&&(p.times=bn.convertArray(S,p.times.constructor),p.values=bn.convertArray(T,p.values.constructor),l.push(p))}s.tracks=l;for(var W=1/0,V=0;V<s.tracks.length;++V)W>s.tracks[V].times[0]&&(W=s.tracks[V].times[0]);for(var B=0;B<s.tracks.length;++B)s.tracks[B].shift(-1*W);return s.resetDuration(),s},makeClipAdditive:function(t,i,r,n){i===void 0&&(i=0),r===void 0&&(r=t),n===void 0&&(n=30),n<=0&&(n=30);for(var o=r.tracks.length,s=i/n,l=function(S){var T=r.tracks[S],O=T.ValueTypeName;if(O==="bool"||O==="string")return"continue";var P=t.tracks.find(function(Ue){return Ue.name===T.name&&Ue.ValueTypeName===O});if(P===void 0)return"continue";var k=0,W=T.getValueSize();T.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(k=W/3);var V=0,B=P.getValueSize();P.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(V=B/3);var ee=T.times.length-1,ue=void 0;if(s<=T.times[0]){var K=k,Q=W-k;ue=bn.arraySlice(T.values,K,Q)}else if(s>=T.times[ee]){var se=ee*W+k,Me=se+W-k;ue=bn.arraySlice(T.values,se,Me)}else{var xe=T.createInterpolant(),_e=k,Pe=W-k;xe.evaluate(s),ue=bn.arraySlice(xe.resultBuffer,_e,Pe)}if(O==="quaternion"){var Ce=new Yn().fromArray(ue).normalize().conjugate();Ce.toArray(ue)}for(var Ae=P.times.length,Be=0;Be<Ae;++Be){var Se=Be*B+V;if(O==="quaternion")Yn.multiplyQuaternionsFlat(P.values,Se,ue,0,P.values,Se);else for(var Te=B-V*2,me=0;me<Te;++me)P.values[Se+me]-=ue[me]}},c=0;c<o;++c)var p=l(c);return t.blendMode=fa,t}};function Mi(a,t,i,r){this.parameterPositions=a,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i}Object.assign(Mi.prototype,{evaluate:function(t){var i=this.parameterPositions,r=this._cachedIndex,n=i[r],o=i[r-1];e:{t:{var s;r:{n:if(!(t<n)){for(var l=r+2;;){if(n===void 0){if(t<o)break n;return r=i.length,this._cachedIndex=r,this.afterEnd_(r-1,t,o)}if(r===l)break;if(o=n,n=i[++r],t<n)break t}s=i.length;break r}if(!(t>=o)){var c=i[1];t<c&&(r=2,o=c);for(var p=r-2;;){if(o===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(r===p)break;if(n=o,o=i[--r-1],t>=o)break t}s=r,r=0;break r}break e}for(;r<s;){var C=r+s>>>1;t<i[C]?s=C:r=C+1}if(n=i[r],o=i[r-1],o===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(n===void 0)return r=i.length,this._cachedIndex=r,this.afterEnd_(r-1,o,t)}this._cachedIndex=r,this.intervalChanged_(r,o,n)}return this.interpolate_(r,o,t,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var i=this.resultBuffer,r=this.sampleValues,n=this.valueSize,o=t*n,s=0;s!==n;++s)i[s]=r[o+s];return i},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Mi.prototype,{beforeStart_:Mi.prototype.copySampleValue_,afterEnd_:Mi.prototype.copySampleValue_});function eu(a,t,i,r){Mi.call(this,a,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}eu.prototype=Object.assign(Object.create(Mi.prototype),{constructor:eu,DefaultSettings_:{endingStart:mi,endingEnd:mi},intervalChanged_:function(t,i,r){var n=this.parameterPositions,o=t-2,s=t+1,l=n[o],c=n[s];if(l===void 0)switch(this.getSettings_().endingStart){case gi:o=t,l=2*i-r;break;case ki:o=n.length-2,l=i+n[o]-n[o+1];break;default:o=t,l=r}if(c===void 0)switch(this.getSettings_().endingEnd){case gi:s=t,c=2*r-i;break;case ki:s=1,c=r+n[1]-n[0];break;default:s=t-1,c=i}var p=(r-i)*.5,C=this.valueSize;this._weightPrev=p/(i-l),this._weightNext=p/(c-r),this._offsetPrev=o*C,this._offsetNext=s*C},interpolate_:function(t,i,r,n){for(var o=this.resultBuffer,s=this.sampleValues,l=this.valueSize,c=t*l,p=c-l,C=this._offsetPrev,S=this._offsetNext,T=this._weightPrev,O=this._weightNext,P=(r-i)/(n-i),k=P*P,W=k*P,V=-T*W+2*T*k-T*P,B=(1+T)*W+(-1.5-2*T)*k+(-.5+T)*P+1,ee=(-1-O)*W+(1.5+O)*k+.5*P,ue=O*W-O*k,K=0;K!==l;++K)o[K]=V*s[C+K]+B*s[p+K]+ee*s[c+K]+ue*s[S+K];return o}});function Js(a,t,i,r){Mi.call(this,a,t,i,r)}Js.prototype=Object.assign(Object.create(Mi.prototype),{constructor:Js,interpolate_:function(t,i,r,n){for(var o=this.resultBuffer,s=this.sampleValues,l=this.valueSize,c=t*l,p=c-l,C=(r-i)/(n-i),S=1-C,T=0;T!==l;++T)o[T]=s[p+T]*S+s[c+T]*C;return o}});function tu(a,t,i,r){Mi.call(this,a,t,i,r)}tu.prototype=Object.assign(Object.create(Mi.prototype),{constructor:tu,interpolate_:function(t){return this.copySampleValue_(t-1)}});function Qn(a,t,i,r){if(a===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+a);this.name=a,this.times=bn.convertArray(t,this.TimeBufferType),this.values=bn.convertArray(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}Object.assign(Qn,{toJSON:function(t){var i=t.constructor,r;if(i.toJSON!==void 0)r=i.toJSON(t);else{r={name:t.name,times:bn.convertArray(t.times,Array),values:bn.convertArray(t.values,Array)};var n=t.getInterpolation();n!==t.DefaultInterpolation&&(r.interpolation=n)}return r.type=t.ValueTypeName,r}}),Object.assign(Qn.prototype,{constructor:Qn,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Ni,InterpolantFactoryMethodDiscrete:function(t){return new tu(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new Js(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new eu(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var i;switch(t){case Fi:i=this.InterpolantFactoryMethodDiscrete;break;case Ni:i=this.InterpolantFactoryMethodLinear;break;case Ki:i=this.InterpolantFactoryMethodSmooth;break}if(i===void 0){var r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=i,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Fi;case this.InterpolantFactoryMethodLinear:return Ni;case this.InterpolantFactoryMethodSmooth:return Ki}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(t!==0)for(var i=this.times,r=0,n=i.length;r!==n;++r)i[r]+=t;return this},scale:function(t){if(t!==1)for(var i=this.times,r=0,n=i.length;r!==n;++r)i[r]*=t;return this},trim:function(t,i){for(var r=this.times,n=r.length,o=0,s=n-1;o!==n&&r[o]<t;)++o;for(;s!==-1&&r[s]>i;)--s;if(++s,o!==0||s!==n){o>=s&&(s=Math.max(s,1),o=s-1);var l=this.getValueSize();this.times=bn.arraySlice(r,o,s),this.values=bn.arraySlice(this.values,o*l,s*l)}return this},validate:function(){var t=!0,i=this.getValueSize();i-Math.floor(i)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var r=this.times,n=this.values,o=r.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var s=null,l=0;l!==o;l++){var c=r[l];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,l,c),t=!1;break}if(s!==null&&s>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,l,c,s),t=!1;break}s=c}if(n!==void 0&&bn.isTypedArray(n))for(var p=0,C=n.length;p!==C;++p){var S=n[p];if(isNaN(S)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,p,S),t=!1;break}}return t},optimize:function(){for(var t=bn.arraySlice(this.times),i=bn.arraySlice(this.values),r=this.getValueSize(),n=this.getInterpolation()===Ki,o=t.length-1,s=1,l=1;l<o;++l){var c=!1,p=t[l],C=t[l+1];if(p!==C&&(l!==1||p!==t[0]))if(n)c=!0;else for(var S=l*r,T=S-r,O=S+r,P=0;P!==r;++P){var k=i[S+P];if(k!==i[T+P]||k!==i[O+P]){c=!0;break}}if(c){if(l!==s){t[s]=t[l];for(var W=l*r,V=s*r,B=0;B!==r;++B)i[V+B]=i[W+B]}++s}}if(o>0){t[s]=t[o];for(var ee=o*r,ue=s*r,K=0;K!==r;++K)i[ue+K]=i[ee+K];++s}return s!==t.length?(this.times=bn.arraySlice(t,0,s),this.values=bn.arraySlice(i,0,s*r)):(this.times=t,this.values=i),this},clone:function(){var t=bn.arraySlice(this.times,0),i=bn.arraySlice(this.values,0),r=this.constructor,n=new r(this.name,t,i);return n.createInterpolant=this.createInterpolant,n}});function ru(a,t,i){Qn.call(this,a,t,i)}ru.prototype=Object.assign(Object.create(Qn.prototype),{constructor:ru,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Fi,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function nu(a,t,i,r){Qn.call(this,a,t,i,r)}nu.prototype=Object.assign(Object.create(Qn.prototype),{constructor:nu,ValueTypeName:"color"});function rs(a,t,i,r){Qn.call(this,a,t,i,r)}rs.prototype=Object.assign(Object.create(Qn.prototype),{constructor:rs,ValueTypeName:"number"});function iu(a,t,i,r){Mi.call(this,a,t,i,r)}iu.prototype=Object.assign(Object.create(Mi.prototype),{constructor:iu,interpolate_:function(t,i,r,n){for(var o=this.resultBuffer,s=this.sampleValues,l=this.valueSize,c=(r-i)/(n-i),p=t*l,C=p+l;p!==C;p+=4)Yn.slerpFlat(o,0,s,p-l,s,p,c);return o}});function Zs(a,t,i,r){Qn.call(this,a,t,i,r)}Zs.prototype=Object.assign(Object.create(Qn.prototype),{constructor:Zs,ValueTypeName:"quaternion",DefaultInterpolation:Ni,InterpolantFactoryMethodLinear:function(t){return new iu(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0});function au(a,t,i,r){Qn.call(this,a,t,i,r)}au.prototype=Object.assign(Object.create(Qn.prototype),{constructor:au,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Fi,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function ns(a,t,i,r){Qn.call(this,a,t,i,r)}ns.prototype=Object.assign(Object.create(Qn.prototype),{constructor:ns,ValueTypeName:"vector"});function Ti(a,t,i,r){t===void 0&&(t=-1),r===void 0&&(r=$i),this.name=a,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=dr.generateUUID(),this.duration<0&&this.resetDuration()}function P0(a){switch(a.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return rs;case"vector":case"vector2":case"vector3":case"vector4":return ns;case"color":return nu;case"quaternion":return Zs;case"bool":case"boolean":return ru;case"string":return au}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+a)}function D0(a){if(a.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=P0(a.type);if(a.times===void 0){var i=[],r=[];bn.flattenJSON(a.keys,i,r,"value"),a.times=i,a.values=r}return t.parse!==void 0?t.parse(a):new t(a.name,a.times,a.values,a.interpolation)}Object.assign(Ti,{parse:function(t){for(var i=[],r=t.tracks,n=1/(t.fps||1),o=0,s=r.length;o!==s;++o)i.push(D0(r[o]).scale(n));var l=new Ti(t.name,t.duration,i,t.blendMode);return l.uuid=t.uuid,l},toJSON:function(t){for(var i=[],r=t.tracks,n={name:t.name,duration:t.duration,tracks:i,uuid:t.uuid,blendMode:t.blendMode},o=0,s=r.length;o!==s;++o)i.push(Qn.toJSON(r[o]));return n},CreateFromMorphTargetSequence:function(t,i,r,n){for(var o=i.length,s=[],l=0;l<o;l++){var c=[],p=[];c.push((l+o-1)%o,l,(l+1)%o),p.push(0,1,0);var C=bn.getKeyframeOrder(c);c=bn.sortedArray(c,1,C),p=bn.sortedArray(p,1,C),!n&&c[0]===0&&(c.push(o),p.push(p[0])),s.push(new rs(".morphTargetInfluences["+i[l].name+"]",c,p).scale(1/r))}return new Ti(t,-1,s)},findByName:function(t,i){var r=t;if(!Array.isArray(t)){var n=t;r=n.geometry&&n.geometry.animations||n.animations}for(var o=0;o<r.length;o++)if(r[o].name===i)return r[o];return null},CreateClipsFromMorphTargetSequences:function(t,i,r){for(var n={},o=/^([\w-]*?)([\d]+)$/,s=0,l=t.length;s<l;s++){var c=t[s],p=c.name.match(o);if(p&&p.length>1){var C=p[1],S=n[C];S||(n[C]=S=[]),S.push(c)}}var T=[];for(var O in n)T.push(Ti.CreateFromMorphTargetSequence(O,n[O],i,r));return T},parseAnimation:function(t,i){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var r=function(se,Me,xe,_e,Pe){if(xe.length!==0){var Ce=[],Ae=[];bn.flattenJSON(xe,Ce,Ae,_e),Ce.length!==0&&Pe.push(new se(Me,Ce,Ae))}},n=[],o=t.name||"default",s=t.fps||30,l=t.blendMode,c=t.length||-1,p=t.hierarchy||[],C=0;C<p.length;C++){var S=p[C].keys;if(!(!S||S.length===0))if(S[0].morphTargets){var T={},O=void 0;for(O=0;O<S.length;O++)if(S[O].morphTargets)for(var P=0;P<S[O].morphTargets.length;P++)T[S[O].morphTargets[P]]=-1;for(var k in T){for(var W=[],V=[],B=0;B!==S[O].morphTargets.length;++B){var ee=S[O];W.push(ee.time),V.push(ee.morphTarget===k?1:0)}n.push(new rs(".morphTargetInfluence["+k+"]",W,V))}c=T.length*(s||1)}else{var ue=".bones["+i[C].name+"]";r(ns,ue+".position",S,"pos",n),r(Zs,ue+".quaternion",S,"rot",n),r(ns,ue+".scale",S,"scl",n)}}if(n.length===0)return null;var K=new Ti(o,c,n,l);return K}}),Object.assign(Ti.prototype,{resetDuration:function(){for(var t=this.tracks,i=0,r=0,n=t.length;r!==n;++r){var o=this.tracks[r];i=Math.max(i,o.times[o.times.length-1])}return this.duration=i,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,i=0;i<this.tracks.length;i++)t=t&&this.tracks[i].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],i=0;i<this.tracks.length;i++)t.push(this.tracks[i].clone());return new Ti(this.name,this.duration,t,this.blendMode)},toJSON:function(){return Ti.toJSON(this)}});var Eo={enabled:!1,files:{},add:function(t,i){this.enabled!==!1&&(this.files[t]=i)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function Ec(a,t,i){var r=this,n=!1,o=0,s=0,l=void 0,c=[];this.onStart=void 0,this.onLoad=a,this.onProgress=t,this.onError=i,this.itemStart=function(p){s++,n===!1&&r.onStart!==void 0&&r.onStart(p,o,s),n=!0},this.itemEnd=function(p){o++,r.onProgress!==void 0&&r.onProgress(p,o,s),o===s&&(n=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(p){r.onError!==void 0&&r.onError(p)},this.resolveURL=function(p){return l?l(p):p},this.setURLModifier=function(p){return l=p,this},this.addHandler=function(p,C){return c.push(p,C),this},this.removeHandler=function(p){var C=c.indexOf(p);return C!==-1&&c.splice(C,2),this},this.getHandler=function(p){for(var C=0,S=c.length;C<S;C+=2){var T=c[C],O=c[C+1];if(T.global&&(T.lastIndex=0),T.test(p))return O}return null}}var Td=new Ec;function an(a){this.manager=a!==void 0?a:Td,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(an.prototype,{load:function(){},loadAsync:function(t,i){var r=this;return new Promise(function(n,o){r.load(t,n,i,o)})},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});var ji={};function Oi(a){an.call(this,a)}Oi.prototype=Object.assign(Object.create(an.prototype),{constructor:Oi,load:function(t,i,r,n){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);var o=this,s=Eo.get(t);if(s!==void 0)return o.manager.itemStart(t),setTimeout(function(){i&&i(s),o.manager.itemEnd(t)},0),s;if(ji[t]!==void 0){ji[t].push({onLoad:i,onProgress:r,onError:n});return}var l=/^data:(.*?)(;base64)?,(.*)$/,c=t.match(l),p;if(c){var C=c[1],S=!!c[2],T=c[3];T=decodeURIComponent(T),S&&(T=atob(T));try{var O,P=(this.responseType||"").toLowerCase();switch(P){case"arraybuffer":case"blob":for(var k=new Uint8Array(T.length),W=0;W<T.length;W++)k[W]=T.charCodeAt(W);P==="blob"?O=new Blob([k.buffer],{type:C}):O=k.buffer;break;case"document":var V=new DOMParser;O=V.parseFromString(T,C);break;case"json":O=JSON.parse(T);break;default:O=T;break}setTimeout(function(){i&&i(O),o.manager.itemEnd(t)},0)}catch(ee){setTimeout(function(){n&&n(ee),o.manager.itemError(t),o.manager.itemEnd(t)},0)}}else{ji[t]=[],ji[t].push({onLoad:i,onProgress:r,onError:n}),p=new XMLHttpRequest,p.open("GET",t,!0),p.addEventListener("load",function(ee){var ue=this.response,K=ji[t];if(delete ji[t],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Eo.add(t,ue);for(var Q=0,se=K.length;Q<se;Q++){var Me=K[Q];Me.onLoad&&Me.onLoad(ue)}o.manager.itemEnd(t)}else{for(var xe=0,_e=K.length;xe<_e;xe++){var Pe=K[xe];Pe.onError&&Pe.onError(ee)}o.manager.itemError(t),o.manager.itemEnd(t)}},!1),p.addEventListener("progress",function(ee){for(var ue=ji[t],K=0,Q=ue.length;K<Q;K++){var se=ue[K];se.onProgress&&se.onProgress(ee)}},!1),p.addEventListener("error",function(ee){var ue=ji[t];delete ji[t];for(var K=0,Q=ue.length;K<Q;K++){var se=ue[K];se.onError&&se.onError(ee)}o.manager.itemError(t),o.manager.itemEnd(t)},!1),p.addEventListener("abort",function(ee){var ue=ji[t];delete ji[t];for(var K=0,Q=ue.length;K<Q;K++){var se=ue[K];se.onError&&se.onError(ee)}o.manager.itemError(t),o.manager.itemEnd(t)},!1),this.responseType!==void 0&&(p.responseType=this.responseType),this.withCredentials!==void 0&&(p.withCredentials=this.withCredentials),p.overrideMimeType&&p.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(var B in this.requestHeader)p.setRequestHeader(B,this.requestHeader[B]);p.send(null)}return o.manager.itemStart(t),p},setResponseType:function(t){return this.responseType=t,this},setMimeType:function(t){return this.mimeType=t,this}});function wc(a){an.call(this,a)}wc.prototype=Object.assign(Object.create(an.prototype),{constructor:wc,load:function(t,i,r,n){var o=this,s=new Oi(o.manager);s.setPath(o.path),s.setRequestHeader(o.requestHeader),s.setWithCredentials(o.withCredentials),s.load(t,function(l){try{i(o.parse(JSON.parse(l)))}catch(c){n?n(c):console.error(c),o.manager.itemError(t)}},r,n)},parse:function(t){for(var i=[],r=0;r<t.length;r++){var n=Ti.parse(t[r]);i.push(n)}return i}});function xc(a){an.call(this,a)}xc.prototype=Object.assign(Object.create(an.prototype),{constructor:xc,load:function(t,i,r,n){var o=this,s=[],l=new Ko,c=new Oi(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(o.withCredentials);var p=0;function C(O){c.load(t[O],function(P){var k=o.parse(P,!0);s[O]={width:k.width,height:k.height,format:k.format,mipmaps:k.mipmaps},p+=1,p===6&&(k.mipmapCount===1&&(l.minFilter=nt),l.image=s,l.format=k.format,l.needsUpdate=!0,i&&i(l))},r,n)}if(Array.isArray(t))for(var S=0,T=t.length;S<T;++S)C(S);else c.load(t,function(O){var P=o.parse(O,!0);if(P.isCubemap){for(var k=P.mipmaps.length/P.mipmapCount,W=0;W<k;W++){s[W]={mipmaps:[]};for(var V=0;V<P.mipmapCount;V++)s[W].mipmaps.push(P.mipmaps[W*P.mipmapCount+V]),s[W].format=P.format,s[W].width=P.width,s[W].height=P.height}l.image=s}else l.image.width=P.width,l.image.height=P.height,l.mipmaps=P.mipmaps;P.mipmapCount===1&&(l.minFilter=nt),l.format=P.format,l.needsUpdate=!0,i&&i(l)},r,n);return l}});function is(a){an.call(this,a)}is.prototype=Object.assign(Object.create(an.prototype),{constructor:is,load:function(t,i,r,n){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);var o=this,s=Eo.get(t);if(s!==void 0)return o.manager.itemStart(t),setTimeout(function(){i&&i(s),o.manager.itemEnd(t)},0),s;var l=document.createElementNS("http://www.w3.org/1999/xhtml","img");function c(){l.removeEventListener("load",c,!1),l.removeEventListener("error",p,!1),Eo.add(t,this),i&&i(this),o.manager.itemEnd(t)}function p(C){l.removeEventListener("load",c,!1),l.removeEventListener("error",p,!1),n&&n(C),o.manager.itemError(t),o.manager.itemEnd(t)}return l.addEventListener("load",c,!1),l.addEventListener("error",p,!1),t.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(l.crossOrigin=this.crossOrigin),o.manager.itemStart(t),l.src=t,l}});function ou(a){an.call(this,a)}ou.prototype=Object.assign(Object.create(an.prototype),{constructor:ou,load:function(t,i,r,n){var o=new aa,s=new is(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);var l=0;function c(C){s.load(t[C],function(S){o.images[C]=S,l++,l===6&&(o.needsUpdate=!0,i&&i(o))},void 0,n)}for(var p=0;p<t.length;++p)c(p);return o}});function su(a){an.call(this,a)}su.prototype=Object.assign(Object.create(an.prototype),{constructor:su,load:function(t,i,r,n){var o=this,s=new ba,l=new Oi(this.manager);return l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setPath(this.path),l.setWithCredentials(o.withCredentials),l.load(t,function(c){var p=o.parse(c);!p||(p.image!==void 0?s.image=p.image:p.data!==void 0&&(s.image.width=p.width,s.image.height=p.height,s.image.data=p.data),s.wrapS=p.wrapS!==void 0?p.wrapS:Vt,s.wrapT=p.wrapT!==void 0?p.wrapT:Vt,s.magFilter=p.magFilter!==void 0?p.magFilter:nt,s.minFilter=p.minFilter!==void 0?p.minFilter:nt,s.anisotropy=p.anisotropy!==void 0?p.anisotropy:1,p.encoding!==void 0&&(s.encoding=p.encoding),p.flipY!==void 0&&(s.flipY=p.flipY),p.format!==void 0&&(s.format=p.format),p.type!==void 0&&(s.type=p.type),p.mipmaps!==void 0&&(s.mipmaps=p.mipmaps,s.minFilter=tr),p.mipmapCount===1&&(s.minFilter=nt),s.needsUpdate=!0,i&&i(s,p))},r,n),s}});function lu(a){an.call(this,a)}lu.prototype=Object.assign(Object.create(an.prototype),{constructor:lu,load:function(t,i,r,n){var o=new ln,s=new is(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,function(l){o.image=l;var c=t.search(/\.jpe?g($|\?)/i)>0||t.search(/^data\:image\/jpeg/)===0;o.format=c?Ri:jn,o.needsUpdate=!0,i!==void 0&&i(o)},r,n),o}});function Yt(){this.type="Curve",this.arcLengthDivisions=200}Object.assign(Yt.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,i){var r=this.getUtoTmapping(t);return this.getPoint(r,i)},getPoints:function(t){t===void 0&&(t=5);for(var i=[],r=0;r<=t;r++)i.push(this.getPoint(r/t));return i},getSpacedPoints:function(t){t===void 0&&(t=5);for(var i=[],r=0;r<=t;r++)i.push(this.getPointAt(r/t));return i},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(t===void 0&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var i=[],r,n=this.getPoint(0),o=0;i.push(0);for(var s=1;s<=t;s++)r=this.getPoint(s/t),o+=r.distanceTo(n),i.push(o),n=r;return this.cacheArcLengths=i,i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,i){var r=this.getLengths(),n=0,o=r.length,s;i?s=i:s=t*r[o-1];for(var l=0,c=o-1,p;l<=c;)if(n=Math.floor(l+(c-l)/2),p=r[n]-s,p<0)l=n+1;else if(p>0)c=n-1;else{c=n;break}if(n=c,r[n]===s)return n/(o-1);var C=r[n],S=r[n+1],T=S-C,O=(s-C)/T,P=(n+O)/(o-1);return P},getTangent:function(t,i){var r=1e-4,n=t-r,o=t+r;n<0&&(n=0),o>1&&(o=1);var s=this.getPoint(n),l=this.getPoint(o),c=i||(s.isVector2?new gt:new de);return c.copy(l).sub(s).normalize(),c},getTangentAt:function(t,i){var r=this.getUtoTmapping(t);return this.getTangent(r,i)},computeFrenetFrames:function(t,i){for(var r=new de,n=[],o=[],s=[],l=new de,c=new Lr,p=0;p<=t;p++){var C=p/t;n[p]=this.getTangentAt(C,new de),n[p].normalize()}o[0]=new de,s[0]=new de;var S=Number.MAX_VALUE,T=Math.abs(n[0].x),O=Math.abs(n[0].y),P=Math.abs(n[0].z);T<=S&&(S=T,r.set(1,0,0)),O<=S&&(S=O,r.set(0,1,0)),P<=S&&r.set(0,0,1),l.crossVectors(n[0],r).normalize(),o[0].crossVectors(n[0],l),s[0].crossVectors(n[0],o[0]);for(var k=1;k<=t;k++){if(o[k]=o[k-1].clone(),s[k]=s[k-1].clone(),l.crossVectors(n[k-1],n[k]),l.length()>Number.EPSILON){l.normalize();var W=Math.acos(dr.clamp(n[k-1].dot(n[k]),-1,1));o[k].applyMatrix4(c.makeRotationAxis(l,W))}s[k].crossVectors(n[k],o[k])}if(i===!0){var V=Math.acos(dr.clamp(o[0].dot(o[t]),-1,1));V/=t,n[0].dot(l.crossVectors(o[0],o[t]))>0&&(V=-V);for(var B=1;B<=t;B++)o[B].applyMatrix4(c.makeRotationAxis(n[B],V*B)),s[B].crossVectors(n[B],o[B])}return{tangents:n,normals:o,binormals:s}},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}});function Si(a,t,i,r,n,o,s,l){Yt.call(this),this.type="EllipseCurve",this.aX=a||0,this.aY=t||0,this.xRadius=i||1,this.yRadius=r||1,this.aStartAngle=n||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=s||!1,this.aRotation=l||0}Si.prototype=Object.create(Yt.prototype),Si.prototype.constructor=Si,Si.prototype.isEllipseCurve=!0,Si.prototype.getPoint=function(a,t){for(var i=t||new gt,r=Math.PI*2,n=this.aEndAngle-this.aStartAngle,o=Math.abs(n)<Number.EPSILON;n<0;)n+=r;for(;n>r;)n-=r;n<Number.EPSILON&&(o?n=0:n=r),this.aClockwise===!0&&!o&&(n===r?n=-r:n=n-r);var s=this.aStartAngle+a*n,l=this.aX+this.xRadius*Math.cos(s),c=this.aY+this.yRadius*Math.sin(s);if(this.aRotation!==0){var p=Math.cos(this.aRotation),C=Math.sin(this.aRotation),S=l-this.aX,T=c-this.aY;l=S*p-T*C+this.aX,c=S*C+T*p+this.aY}return i.set(l,c)},Si.prototype.copy=function(a){return Yt.prototype.copy.call(this,a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this},Si.prototype.toJSON=function(){var a=Yt.prototype.toJSON.call(this);return a.aX=this.aX,a.aY=this.aY,a.xRadius=this.xRadius,a.yRadius=this.yRadius,a.aStartAngle=this.aStartAngle,a.aEndAngle=this.aEndAngle,a.aClockwise=this.aClockwise,a.aRotation=this.aRotation,a},Si.prototype.fromJSON=function(a){return Yt.prototype.fromJSON.call(this,a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this};function as(a,t,i,r,n,o){Si.call(this,a,t,i,i,r,n,o),this.type="ArcCurve"}as.prototype=Object.create(Si.prototype),as.prototype.constructor=as,as.prototype.isArcCurve=!0;function Mc(){var a=0,t=0,i=0,r=0;function n(o,s,l,c){a=o,t=l,i=-3*o+3*s-2*l-c,r=2*o-2*s+l+c}return{initCatmullRom:function(s,l,c,p,C){n(l,c,C*(c-s),C*(p-l))},initNonuniformCatmullRom:function(s,l,c,p,C,S,T){var O=(l-s)/C-(c-s)/(C+S)+(c-l)/S,P=(c-l)/S-(p-l)/(S+T)+(p-c)/T;O*=S,P*=S,n(l,c,O,P)},calc:function(s){var l=s*s,c=l*s;return a+t*s+i*l+r*c}}}var uu=new de,Tc=new Mc,Sc=new Mc,_c=new Mc;function ti(a,t,i,r){a===void 0&&(a=[]),t===void 0&&(t=!1),i===void 0&&(i="centripetal"),r===void 0&&(r=.5),Yt.call(this),this.type="CatmullRomCurve3",this.points=a,this.closed=t,this.curveType=i,this.tension=r}ti.prototype=Object.create(Yt.prototype),ti.prototype.constructor=ti,ti.prototype.isCatmullRomCurve3=!0,ti.prototype.getPoint=function(a,t){t===void 0&&(t=new de);var i=t,r=this.points,n=r.length,o=(n-(this.closed?0:1))*a,s=Math.floor(o),l=o-s;this.closed?s+=s>0?0:(Math.floor(Math.abs(s)/n)+1)*n:l===0&&s===n-1&&(s=n-2,l=1);var c,p;this.closed||s>0?c=r[(s-1)%n]:(uu.subVectors(r[0],r[1]).add(r[0]),c=uu);var C=r[s%n],S=r[(s+1)%n];if(this.closed||s+2<n?p=r[(s+2)%n]:(uu.subVectors(r[n-1],r[n-2]).add(r[n-1]),p=uu),this.curveType==="centripetal"||this.curveType==="chordal"){var T=this.curveType==="chordal"?.5:.25,O=Math.pow(c.distanceToSquared(C),T),P=Math.pow(C.distanceToSquared(S),T),k=Math.pow(S.distanceToSquared(p),T);P<1e-4&&(P=1),O<1e-4&&(O=P),k<1e-4&&(k=P),Tc.initNonuniformCatmullRom(c.x,C.x,S.x,p.x,O,P,k),Sc.initNonuniformCatmullRom(c.y,C.y,S.y,p.y,O,P,k),_c.initNonuniformCatmullRom(c.z,C.z,S.z,p.z,O,P,k)}else this.curveType==="catmullrom"&&(Tc.initCatmullRom(c.x,C.x,S.x,p.x,this.tension),Sc.initCatmullRom(c.y,C.y,S.y,p.y,this.tension),_c.initCatmullRom(c.z,C.z,S.z,p.z,this.tension));return i.set(Tc.calc(l),Sc.calc(l),_c.calc(l)),i},ti.prototype.copy=function(a){Yt.prototype.copy.call(this,a),this.points=[];for(var t=0,i=a.points.length;t<i;t++){var r=a.points[t];this.points.push(r.clone())}return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this},ti.prototype.toJSON=function(){var a=Yt.prototype.toJSON.call(this);a.points=[];for(var t=0,i=this.points.length;t<i;t++){var r=this.points[t];a.points.push(r.toArray())}return a.closed=this.closed,a.curveType=this.curveType,a.tension=this.tension,a},ti.prototype.fromJSON=function(a){Yt.prototype.fromJSON.call(this,a),this.points=[];for(var t=0,i=a.points.length;t<i;t++){var r=a.points[t];this.points.push(new de().fromArray(r))}return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this};function Sd(a,t,i,r,n){var o=(r-t)*.5,s=(n-i)*.5,l=a*a,c=a*l;return(2*i-2*r+o+s)*c+(-3*i+3*r-2*o-s)*l+o*a+i}function O0(a,t){var i=1-a;return i*i*t}function I0(a,t){return 2*(1-a)*a*t}function B0(a,t){return a*a*t}function Ks(a,t,i,r){return O0(a,t)+I0(a,i)+B0(a,r)}function F0(a,t){var i=1-a;return i*i*i*t}function N0(a,t){var i=1-a;return 3*i*i*a*t}function k0(a,t){return 3*(1-a)*a*a*t}function U0(a,t){return a*a*a*t}function $s(a,t,i,r,n){return F0(a,t)+N0(a,i)+k0(a,r)+U0(a,n)}function Xi(a,t,i,r){a===void 0&&(a=new gt),t===void 0&&(t=new gt),i===void 0&&(i=new gt),r===void 0&&(r=new gt),Yt.call(this),this.type="CubicBezierCurve",this.v0=a,this.v1=t,this.v2=i,this.v3=r}Xi.prototype=Object.create(Yt.prototype),Xi.prototype.constructor=Xi,Xi.prototype.isCubicBezierCurve=!0,Xi.prototype.getPoint=function(a,t){t===void 0&&(t=new gt);var i=t,r=this.v0,n=this.v1,o=this.v2,s=this.v3;return i.set($s(a,r.x,n.x,o.x,s.x),$s(a,r.y,n.y,o.y,s.y)),i},Xi.prototype.copy=function(a){return Yt.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this},Xi.prototype.toJSON=function(){var a=Yt.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a},Xi.prototype.fromJSON=function(a){return Yt.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this};function sa(a,t,i,r){a===void 0&&(a=new de),t===void 0&&(t=new de),i===void 0&&(i=new de),r===void 0&&(r=new de),Yt.call(this),this.type="CubicBezierCurve3",this.v0=a,this.v1=t,this.v2=i,this.v3=r}sa.prototype=Object.create(Yt.prototype),sa.prototype.constructor=sa,sa.prototype.isCubicBezierCurve3=!0,sa.prototype.getPoint=function(a,t){t===void 0&&(t=new de);var i=t,r=this.v0,n=this.v1,o=this.v2,s=this.v3;return i.set($s(a,r.x,n.x,o.x,s.x),$s(a,r.y,n.y,o.y,s.y),$s(a,r.z,n.z,o.z,s.z)),i},sa.prototype.copy=function(a){return Yt.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this},sa.prototype.toJSON=function(){var a=Yt.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a},sa.prototype.fromJSON=function(a){return Yt.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this};function fi(a,t){a===void 0&&(a=new gt),t===void 0&&(t=new gt),Yt.call(this),this.type="LineCurve",this.v1=a,this.v2=t}fi.prototype=Object.create(Yt.prototype),fi.prototype.constructor=fi,fi.prototype.isLineCurve=!0,fi.prototype.getPoint=function(a,t){t===void 0&&(t=new gt);var i=t;return a===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(a).add(this.v1)),i},fi.prototype.getPointAt=function(a,t){return this.getPoint(a,t)},fi.prototype.getTangent=function(a,t){var i=t||new gt;return i.copy(this.v2).sub(this.v1).normalize(),i},fi.prototype.copy=function(a){return Yt.prototype.copy.call(this,a),this.v1.copy(a.v1),this.v2.copy(a.v2),this},fi.prototype.toJSON=function(){var a=Yt.prototype.toJSON.call(this);return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a},fi.prototype.fromJSON=function(a){return Yt.prototype.fromJSON.call(this,a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this};function Yi(a,t){a===void 0&&(a=new de),t===void 0&&(t=new de),Yt.call(this),this.type="LineCurve3",this.v1=a,this.v2=t}Yi.prototype=Object.create(Yt.prototype),Yi.prototype.constructor=Yi,Yi.prototype.isLineCurve3=!0,Yi.prototype.getPoint=function(a,t){t===void 0&&(t=new de);var i=t;return a===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(a).add(this.v1)),i},Yi.prototype.getPointAt=function(a,t){return this.getPoint(a,t)},Yi.prototype.copy=function(a){return Yt.prototype.copy.call(this,a),this.v1.copy(a.v1),this.v2.copy(a.v2),this},Yi.prototype.toJSON=function(){var a=Yt.prototype.toJSON.call(this);return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a},Yi.prototype.fromJSON=function(a){return Yt.prototype.fromJSON.call(this,a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this};function Qi(a,t,i){a===void 0&&(a=new gt),t===void 0&&(t=new gt),i===void 0&&(i=new gt),Yt.call(this),this.type="QuadraticBezierCurve",this.v0=a,this.v1=t,this.v2=i}Qi.prototype=Object.create(Yt.prototype),Qi.prototype.constructor=Qi,Qi.prototype.isQuadraticBezierCurve=!0,Qi.prototype.getPoint=function(a,t){t===void 0&&(t=new gt);var i=t,r=this.v0,n=this.v1,o=this.v2;return i.set(Ks(a,r.x,n.x,o.x),Ks(a,r.y,n.y,o.y)),i},Qi.prototype.copy=function(a){return Yt.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this},Qi.prototype.toJSON=function(){var a=Yt.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a},Qi.prototype.fromJSON=function(a){return Yt.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this};function la(a,t,i){a===void 0&&(a=new de),t===void 0&&(t=new de),i===void 0&&(i=new de),Yt.call(this),this.type="QuadraticBezierCurve3",this.v0=a,this.v1=t,this.v2=i}la.prototype=Object.create(Yt.prototype),la.prototype.constructor=la,la.prototype.isQuadraticBezierCurve3=!0,la.prototype.getPoint=function(a,t){t===void 0&&(t=new de);var i=t,r=this.v0,n=this.v1,o=this.v2;return i.set(Ks(a,r.x,n.x,o.x),Ks(a,r.y,n.y,o.y),Ks(a,r.z,n.z,o.z)),i},la.prototype.copy=function(a){return Yt.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this},la.prototype.toJSON=function(){var a=Yt.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a},la.prototype.fromJSON=function(a){return Yt.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this};function qi(a){a===void 0&&(a=[]),Yt.call(this),this.type="SplineCurve",this.points=a}qi.prototype=Object.create(Yt.prototype),qi.prototype.constructor=qi,qi.prototype.isSplineCurve=!0,qi.prototype.getPoint=function(a,t){t===void 0&&(t=new gt);var i=t,r=this.points,n=(r.length-1)*a,o=Math.floor(n),s=n-o,l=r[o===0?o:o-1],c=r[o],p=r[o>r.length-2?r.length-1:o+1],C=r[o>r.length-3?r.length-1:o+2];return i.set(Sd(s,l.x,c.x,p.x,C.x),Sd(s,l.y,c.y,p.y,C.y)),i},qi.prototype.copy=function(a){Yt.prototype.copy.call(this,a),this.points=[];for(var t=0,i=a.points.length;t<i;t++){var r=a.points[t];this.points.push(r.clone())}return this},qi.prototype.toJSON=function(){var a=Yt.prototype.toJSON.call(this);a.points=[];for(var t=0,i=this.points.length;t<i;t++){var r=this.points[t];a.points.push(r.toArray())}return a},qi.prototype.fromJSON=function(a){Yt.prototype.fromJSON.call(this,a),this.points=[];for(var t=0,i=a.points.length;t<i;t++){var r=a.points[t];this.points.push(new gt().fromArray(r))}return this};var Cc=Object.freeze({__proto__:null,ArcCurve:as,CatmullRomCurve3:ti,CubicBezierCurve:Xi,CubicBezierCurve3:sa,EllipseCurve:Si,LineCurve:fi,LineCurve3:Yi,QuadraticBezierCurve:Qi,QuadraticBezierCurve3:la,SplineCurve:qi});function qa(){Yt.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}qa.prototype=Object.assign(Object.create(Yt.prototype),{constructor:qa,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);t.equals(i)||this.curves.push(new fi(i,t))},getPoint:function(t){for(var i=t*this.getLength(),r=this.getCurveLengths(),n=0;n<r.length;){if(r[n]>=i){var o=r[n]-i,s=this.curves[n],l=s.getLength(),c=l===0?0:1-o/l;return s.getPointAt(c)}n++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],i=0,r=0,n=this.curves.length;r<n;r++)i+=this.curves[r].getLength(),t.push(i);return this.cacheLengths=t,t},getSpacedPoints:function(t){t===void 0&&(t=40);for(var i=[],r=0;r<=t;r++)i.push(this.getPoint(r/t));return this.autoClose&&i.push(i[0]),i},getPoints:function(t){t===void 0&&(t=12);for(var i=[],r,n=0,o=this.curves;n<o.length;n++)for(var s=o[n],l=s&&s.isEllipseCurve?t*2:s&&(s.isLineCurve||s.isLineCurve3)?1:s&&s.isSplineCurve?t*s.points.length:t,c=s.getPoints(l),p=0;p<c.length;p++){var C=c[p];r&&r.equals(C)||(i.push(C),r=C)}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},copy:function(t){Yt.prototype.copy.call(this,t),this.curves=[];for(var i=0,r=t.curves.length;i<r;i++){var n=t.curves[i];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=Yt.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var i=0,r=this.curves.length;i<r;i++){var n=this.curves[i];t.curves.push(n.toJSON())}return t},fromJSON:function(t){Yt.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var i=0,r=t.curves.length;i<r;i++){var n=t.curves[i];this.curves.push(new Cc[n.type]().fromJSON(n))}return this}});function Ji(a){qa.call(this),this.type="Path",this.currentPoint=new gt,a&&this.setFromPoints(a)}Ji.prototype=Object.assign(Object.create(qa.prototype),{constructor:Ji,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var i=1,r=t.length;i<r;i++)this.lineTo(t[i].x,t[i].y);return this},moveTo:function(t,i){return this.currentPoint.set(t,i),this},lineTo:function(t,i){var r=new fi(this.currentPoint.clone(),new gt(t,i));return this.curves.push(r),this.currentPoint.set(t,i),this},quadraticCurveTo:function(t,i,r,n){var o=new Qi(this.currentPoint.clone(),new gt(t,i),new gt(r,n));return this.curves.push(o),this.currentPoint.set(r,n),this},bezierCurveTo:function(t,i,r,n,o,s){var l=new Xi(this.currentPoint.clone(),new gt(t,i),new gt(r,n),new gt(o,s));return this.curves.push(l),this.currentPoint.set(o,s),this},splineThru:function(t){var i=[this.currentPoint.clone()].concat(t),r=new qi(i);return this.curves.push(r),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,i,r,n,o,s){var l=this.currentPoint.x,c=this.currentPoint.y;return this.absarc(t+l,i+c,r,n,o,s),this},absarc:function(t,i,r,n,o,s){return this.absellipse(t,i,r,r,n,o,s),this},ellipse:function(t,i,r,n,o,s,l,c){var p=this.currentPoint.x,C=this.currentPoint.y;return this.absellipse(t+p,i+C,r,n,o,s,l,c),this},absellipse:function(t,i,r,n,o,s,l,c){var p=new Si(t,i,r,n,o,s,l,c);if(this.curves.length>0){var C=p.getPoint(0);C.equals(this.currentPoint)||this.lineTo(C.x,C.y)}this.curves.push(p);var S=p.getPoint(1);return this.currentPoint.copy(S),this},copy:function(t){return qa.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=qa.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return qa.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}});function Ja(a){Ji.call(this,a),this.uuid=dr.generateUUID(),this.type="Shape",this.holes=[]}Ja.prototype=Object.assign(Object.create(Ji.prototype),{constructor:Ja,getPointsHoles:function(t){for(var i=[],r=0,n=this.holes.length;r<n;r++)i[r]=this.holes[r].getPoints(t);return i},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){Ji.prototype.copy.call(this,t),this.holes=[];for(var i=0,r=t.holes.length;i<r;i++){var n=t.holes[i];this.holes.push(n.clone())}return this},toJSON:function(){var t=Ji.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var i=0,r=this.holes.length;i<r;i++){var n=this.holes[i];t.holes.push(n.toJSON())}return t},fromJSON:function(t){Ji.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var i=0,r=t.holes.length;i<r;i++){var n=t.holes[i];this.holes.push(new Ji().fromJSON(n))}return this}});function gn(a,t){t===void 0&&(t=1),Xt.call(this),this.type="Light",this.color=new Pt(a),this.intensity=t}gn.prototype=Object.assign(Object.create(Xt.prototype),{constructor:gn,isLight:!0,copy:function(t){return Xt.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var i=Xt.prototype.toJSON.call(this,t);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}});function cu(a,t,i){gn.call(this,a,i),this.type="HemisphereLight",this.position.copy(Xt.DefaultUp),this.updateMatrix(),this.groundColor=new Pt(t)}cu.prototype=Object.assign(Object.create(gn.prototype),{constructor:cu,isHemisphereLight:!0,copy:function(t){return gn.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}});function Ma(a){this.camera=a,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new gt(512,512),this.map=null,this.mapPass=null,this.matrix=new Lr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ss,this._frameExtents=new gt(1,1),this._viewportCount=1,this._viewports=[new rn(0,0,1,1)]}Object.assign(Ma.prototype,{_projScreenMatrix:new Lr,_lightPositionWorld:new de,_lookTarget:new de,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){var i=this.camera,r=this.matrix,n=this._projScreenMatrix,o=this._lookTarget,s=this._lightPositionWorld;s.setFromMatrixPosition(t.matrixWorld),i.position.copy(s),o.setFromMatrixPosition(t.target.matrixWorld),i.lookAt(o),i.updateMatrixWorld(),n.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(n),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(i.projectionMatrix),r.multiply(i.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}});function Lc(){Ma.call(this,new _n(50,1,.5,500)),this.focus=1}Lc.prototype=Object.assign(Object.create(Ma.prototype),{constructor:Lc,isSpotLightShadow:!0,updateMatrices:function(t){var i=this.camera,r=dr.RAD2DEG*2*t.angle*this.focus,n=this.mapSize.width/this.mapSize.height,o=t.distance||i.far;(r!==i.fov||n!==i.aspect||o!==i.far)&&(i.fov=r,i.aspect=n,i.far=o,i.updateProjectionMatrix()),Ma.prototype.updateMatrices.call(this,t)}});function hu(a,t,i,r,n,o){gn.call(this,a,t),this.type="SpotLight",this.position.copy(Xt.DefaultUp),this.updateMatrix(),this.target=new Xt,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(l){this.intensity=l/Math.PI}}),this.distance=i!==void 0?i:0,this.angle=r!==void 0?r:Math.PI/3,this.penumbra=n!==void 0?n:0,this.decay=o!==void 0?o:1,this.shadow=new Lc}hu.prototype=Object.assign(Object.create(gn.prototype),{constructor:hu,isSpotLight:!0,copy:function(t){return gn.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}});function Rc(){Ma.call(this,new _n(90,1,.5,500)),this._frameExtents=new gt(4,2),this._viewportCount=6,this._viewports=[new rn(2,1,1,1),new rn(0,1,1,1),new rn(3,1,1,1),new rn(1,1,1,1),new rn(3,0,1,1),new rn(1,0,1,1)],this._cubeDirections=[new de(1,0,0),new de(-1,0,0),new de(0,0,1),new de(0,0,-1),new de(0,1,0),new de(0,-1,0)],this._cubeUps=[new de(0,1,0),new de(0,1,0),new de(0,1,0),new de(0,1,0),new de(0,0,1),new de(0,0,-1)]}Rc.prototype=Object.assign(Object.create(Ma.prototype),{constructor:Rc,isPointLightShadow:!0,updateMatrices:function(t,i){i===void 0&&(i=0);var r=this.camera,n=this.matrix,o=this._lightPositionWorld,s=this._lookTarget,l=this._projScreenMatrix;o.setFromMatrixPosition(t.matrixWorld),r.position.copy(o),s.copy(r.position),s.add(this._cubeDirections[i]),r.up.copy(this._cubeUps[i]),r.lookAt(s),r.updateMatrixWorld(),n.makeTranslation(-o.x,-o.y,-o.z),l.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(l)}});function du(a,t,i,r){gn.call(this,a,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(o){this.intensity=o/(4*Math.PI)}}),this.distance=i!==void 0?i:0,this.decay=r!==void 0?r:1,this.shadow=new Rc}du.prototype=Object.assign(Object.create(gn.prototype),{constructor:du,isPointLight:!0,copy:function(t){return gn.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}});function os(a,t,i,r,n,o){a===void 0&&(a=-1),t===void 0&&(t=1),i===void 0&&(i=1),r===void 0&&(r=-1),n===void 0&&(n=.1),o===void 0&&(o=2e3),ia.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=a,this.right=t,this.top=i,this.bottom=r,this.near=n,this.far=o,this.updateProjectionMatrix()}os.prototype=Object.assign(Object.create(ia.prototype),{constructor:os,isOrthographicCamera:!0,copy:function(t,i){return ia.prototype.copy.call(this,t,i),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this},setViewOffset:function(t,i,r,n,o,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=i,this.view.offsetX=r,this.view.offsetY=n,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,o=r-t,s=r+t,l=n+i,c=n-i;if(this.view!==null&&this.view.enabled){var p=(this.right-this.left)/this.view.fullWidth/this.zoom,C=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=p*this.view.offsetX,s=o+p*this.view.width,l-=C*this.view.offsetY,c=l-C*this.view.height}this.projectionMatrix.makeOrthographic(o,s,l,c,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(t){var i=Xt.prototype.toJSON.call(this,t);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}});function Pc(){Ma.call(this,new os(-5,5,5,-5,.5,500))}Pc.prototype=Object.assign(Object.create(Ma.prototype),{constructor:Pc,isDirectionalLightShadow:!0,updateMatrices:function(t){Ma.prototype.updateMatrices.call(this,t)}});function fu(a,t){gn.call(this,a,t),this.type="DirectionalLight",this.position.copy(Xt.DefaultUp),this.updateMatrix(),this.target=new Xt,this.shadow=new Pc}fu.prototype=Object.assign(Object.create(gn.prototype),{constructor:fu,isDirectionalLight:!0,copy:function(t){return gn.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}});function pu(a,t){gn.call(this,a,t),this.type="AmbientLight"}pu.prototype=Object.assign(Object.create(gn.prototype),{constructor:pu,isAmbientLight:!0});function vu(a,t,i,r){gn.call(this,a,t),this.type="RectAreaLight",this.width=i!==void 0?i:10,this.height=r!==void 0?r:10}vu.prototype=Object.assign(Object.create(gn.prototype),{constructor:vu,isRectAreaLight:!0,copy:function(t){return gn.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var i=gn.prototype.toJSON.call(this,t);return i.object.width=this.width,i.object.height=this.height,i}});var _d=function(){function a(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(var i=0;i<9;i++)this.coefficients.push(new de)}var t=a.prototype;return t.set=function(r){for(var n=0;n<9;n++)this.coefficients[n].copy(r[n]);return this},t.zero=function(){for(var r=0;r<9;r++)this.coefficients[r].set(0,0,0);return this},t.getAt=function(r,n){var o=r.x,s=r.y,l=r.z,c=this.coefficients;return n.copy(c[0]).multiplyScalar(.282095),n.addScaledVector(c[1],.488603*s),n.addScaledVector(c[2],.488603*l),n.addScaledVector(c[3],.488603*o),n.addScaledVector(c[4],1.092548*(o*s)),n.addScaledVector(c[5],1.092548*(s*l)),n.addScaledVector(c[6],.315392*(3*l*l-1)),n.addScaledVector(c[7],1.092548*(o*l)),n.addScaledVector(c[8],.546274*(o*o-s*s)),n},t.getIrradianceAt=function(r,n){var o=r.x,s=r.y,l=r.z,c=this.coefficients;return n.copy(c[0]).multiplyScalar(.886227),n.addScaledVector(c[1],2*.511664*s),n.addScaledVector(c[2],2*.511664*l),n.addScaledVector(c[3],2*.511664*o),n.addScaledVector(c[4],2*.429043*o*s),n.addScaledVector(c[5],2*.429043*s*l),n.addScaledVector(c[6],.743125*l*l-.247708),n.addScaledVector(c[7],2*.429043*o*l),n.addScaledVector(c[8],.429043*(o*o-s*s)),n},t.add=function(r){for(var n=0;n<9;n++)this.coefficients[n].add(r.coefficients[n]);return this},t.addScaledSH=function(r,n){for(var o=0;o<9;o++)this.coefficients[o].addScaledVector(r.coefficients[o],n);return this},t.scale=function(r){for(var n=0;n<9;n++)this.coefficients[n].multiplyScalar(r);return this},t.lerp=function(r,n){for(var o=0;o<9;o++)this.coefficients[o].lerp(r.coefficients[o],n);return this},t.equals=function(r){for(var n=0;n<9;n++)if(!this.coefficients[n].equals(r.coefficients[n]))return!1;return!0},t.copy=function(r){return this.set(r.coefficients)},t.clone=function(){return new this.constructor().copy(this)},t.fromArray=function(r,n){n===void 0&&(n=0);for(var o=this.coefficients,s=0;s<9;s++)o[s].fromArray(r,n+s*3);return this},t.toArray=function(r,n){r===void 0&&(r=[]),n===void 0&&(n=0);for(var o=this.coefficients,s=0;s<9;s++)o[s].toArray(r,n+s*3);return r},a.getBasisAt=function(r,n){var o=r.x,s=r.y,l=r.z;n[0]=.282095,n[1]=.488603*s,n[2]=.488603*l,n[3]=.488603*o,n[4]=1.092548*o*s,n[5]=1.092548*s*l,n[6]=.315392*(3*l*l-1),n[7]=1.092548*o*l,n[8]=.546274*(o*o-s*s)},a}();function Ii(a,t){gn.call(this,void 0,t),this.type="LightProbe",this.sh=a!==void 0?a:new _d}Ii.prototype=Object.assign(Object.create(gn.prototype),{constructor:Ii,isLightProbe:!0,copy:function(t){return gn.prototype.copy.call(this,t),this.sh.copy(t.sh),this},fromJSON:function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},toJSON:function(t){var i=gn.prototype.toJSON.call(this,t);return i.object.sh=this.sh.toArray(),i}});function mu(a){an.call(this,a),this.textures={}}mu.prototype=Object.assign(Object.create(an.prototype),{constructor:mu,load:function(t,i,r,n){var o=this,s=new Oi(o.manager);s.setPath(o.path),s.setRequestHeader(o.requestHeader),s.setWithCredentials(o.withCredentials),s.load(t,function(l){try{i(o.parse(JSON.parse(l)))}catch(c){n?n(c):console.error(c),o.manager.itemError(t)}},r,n)},parse:function(t){var i=this.textures;function r(p){return i[p]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",p),i[p]}var n=new R0[t.type];if(t.uuid!==void 0&&(n.uuid=t.uuid),t.name!==void 0&&(n.name=t.name),t.color!==void 0&&n.color!==void 0&&n.color.setHex(t.color),t.roughness!==void 0&&(n.roughness=t.roughness),t.metalness!==void 0&&(n.metalness=t.metalness),t.sheen!==void 0&&(n.sheen=new Pt().setHex(t.sheen)),t.emissive!==void 0&&n.emissive!==void 0&&n.emissive.setHex(t.emissive),t.specular!==void 0&&n.specular!==void 0&&n.specular.setHex(t.specular),t.shininess!==void 0&&(n.shininess=t.shininess),t.clearcoat!==void 0&&(n.clearcoat=t.clearcoat),t.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=t.clearcoatRoughness),t.fog!==void 0&&(n.fog=t.fog),t.flatShading!==void 0&&(n.flatShading=t.flatShading),t.blending!==void 0&&(n.blending=t.blending),t.combine!==void 0&&(n.combine=t.combine),t.side!==void 0&&(n.side=t.side),t.opacity!==void 0&&(n.opacity=t.opacity),t.transparent!==void 0&&(n.transparent=t.transparent),t.alphaTest!==void 0&&(n.alphaTest=t.alphaTest),t.depthTest!==void 0&&(n.depthTest=t.depthTest),t.depthWrite!==void 0&&(n.depthWrite=t.depthWrite),t.colorWrite!==void 0&&(n.colorWrite=t.colorWrite),t.stencilWrite!==void 0&&(n.stencilWrite=t.stencilWrite),t.stencilWriteMask!==void 0&&(n.stencilWriteMask=t.stencilWriteMask),t.stencilFunc!==void 0&&(n.stencilFunc=t.stencilFunc),t.stencilRef!==void 0&&(n.stencilRef=t.stencilRef),t.stencilFuncMask!==void 0&&(n.stencilFuncMask=t.stencilFuncMask),t.stencilFail!==void 0&&(n.stencilFail=t.stencilFail),t.stencilZFail!==void 0&&(n.stencilZFail=t.stencilZFail),t.stencilZPass!==void 0&&(n.stencilZPass=t.stencilZPass),t.wireframe!==void 0&&(n.wireframe=t.wireframe),t.wireframeLinewidth!==void 0&&(n.wireframeLinewidth=t.wireframeLinewidth),t.wireframeLinecap!==void 0&&(n.wireframeLinecap=t.wireframeLinecap),t.wireframeLinejoin!==void 0&&(n.wireframeLinejoin=t.wireframeLinejoin),t.rotation!==void 0&&(n.rotation=t.rotation),t.linewidth!==1&&(n.linewidth=t.linewidth),t.dashSize!==void 0&&(n.dashSize=t.dashSize),t.gapSize!==void 0&&(n.gapSize=t.gapSize),t.scale!==void 0&&(n.scale=t.scale),t.polygonOffset!==void 0&&(n.polygonOffset=t.polygonOffset),t.polygonOffsetFactor!==void 0&&(n.polygonOffsetFactor=t.polygonOffsetFactor),t.polygonOffsetUnits!==void 0&&(n.polygonOffsetUnits=t.polygonOffsetUnits),t.skinning!==void 0&&(n.skinning=t.skinning),t.morphTargets!==void 0&&(n.morphTargets=t.morphTargets),t.morphNormals!==void 0&&(n.morphNormals=t.morphNormals),t.dithering!==void 0&&(n.dithering=t.dithering),t.vertexTangents!==void 0&&(n.vertexTangents=t.vertexTangents),t.visible!==void 0&&(n.visible=t.visible),t.toneMapped!==void 0&&(n.toneMapped=t.toneMapped),t.userData!==void 0&&(n.userData=t.userData),t.vertexColors!==void 0&&(typeof t.vertexColors=="number"?n.vertexColors=t.vertexColors>0:n.vertexColors=t.vertexColors),t.uniforms!==void 0)for(var o in t.uniforms){var s=t.uniforms[o];switch(n.uniforms[o]={},s.type){case"t":n.uniforms[o].value=r(s.value);break;case"c":n.uniforms[o].value=new Pt().setHex(s.value);break;case"v2":n.uniforms[o].value=new gt().fromArray(s.value);break;case"v3":n.uniforms[o].value=new de().fromArray(s.value);break;case"v4":n.uniforms[o].value=new rn().fromArray(s.value);break;case"m3":n.uniforms[o].value=new yi().fromArray(s.value);break;case"m4":n.uniforms[o].value=new Lr().fromArray(s.value);break;default:n.uniforms[o].value=s.value}}if(t.defines!==void 0&&(n.defines=t.defines),t.vertexShader!==void 0&&(n.vertexShader=t.vertexShader),t.fragmentShader!==void 0&&(n.fragmentShader=t.fragmentShader),t.extensions!==void 0)for(var l in t.extensions)n.extensions[l]=t.extensions[l];if(t.shading!==void 0&&(n.flatShading=t.shading===1),t.size!==void 0&&(n.size=t.size),t.sizeAttenuation!==void 0&&(n.sizeAttenuation=t.sizeAttenuation),t.map!==void 0&&(n.map=r(t.map)),t.matcap!==void 0&&(n.matcap=r(t.matcap)),t.alphaMap!==void 0&&(n.alphaMap=r(t.alphaMap)),t.bumpMap!==void 0&&(n.bumpMap=r(t.bumpMap)),t.bumpScale!==void 0&&(n.bumpScale=t.bumpScale),t.normalMap!==void 0&&(n.normalMap=r(t.normalMap)),t.normalMapType!==void 0&&(n.normalMapType=t.normalMapType),t.normalScale!==void 0){var c=t.normalScale;Array.isArray(c)===!1&&(c=[c,c]),n.normalScale=new gt().fromArray(c)}return t.displacementMap!==void 0&&(n.displacementMap=r(t.displacementMap)),t.displacementScale!==void 0&&(n.displacementScale=t.displacementScale),t.displacementBias!==void 0&&(n.displacementBias=t.displacementBias),t.roughnessMap!==void 0&&(n.roughnessMap=r(t.roughnessMap)),t.metalnessMap!==void 0&&(n.metalnessMap=r(t.metalnessMap)),t.emissiveMap!==void 0&&(n.emissiveMap=r(t.emissiveMap)),t.emissiveIntensity!==void 0&&(n.emissiveIntensity=t.emissiveIntensity),t.specularMap!==void 0&&(n.specularMap=r(t.specularMap)),t.envMap!==void 0&&(n.envMap=r(t.envMap)),t.envMapIntensity!==void 0&&(n.envMapIntensity=t.envMapIntensity),t.reflectivity!==void 0&&(n.reflectivity=t.reflectivity),t.refractionRatio!==void 0&&(n.refractionRatio=t.refractionRatio),t.lightMap!==void 0&&(n.lightMap=r(t.lightMap)),t.lightMapIntensity!==void 0&&(n.lightMapIntensity=t.lightMapIntensity),t.aoMap!==void 0&&(n.aoMap=r(t.aoMap)),t.aoMapIntensity!==void 0&&(n.aoMapIntensity=t.aoMapIntensity),t.gradientMap!==void 0&&(n.gradientMap=r(t.gradientMap)),t.clearcoatMap!==void 0&&(n.clearcoatMap=r(t.clearcoatMap)),t.clearcoatRoughnessMap!==void 0&&(n.clearcoatRoughnessMap=r(t.clearcoatRoughnessMap)),t.clearcoatNormalMap!==void 0&&(n.clearcoatNormalMap=r(t.clearcoatNormalMap)),t.clearcoatNormalScale!==void 0&&(n.clearcoatNormalScale=new gt().fromArray(t.clearcoatNormalScale)),t.transmission!==void 0&&(n.transmission=t.transmission),t.transmissionMap!==void 0&&(n.transmissionMap=r(t.transmissionMap)),n},setTextures:function(t){return this.textures=t,this}});var Dc={decodeText:function(t){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(t);for(var i="",r=0,n=t.length;r<n;r++)i+=String.fromCharCode(t[r]);try{return decodeURIComponent(escape(i))}catch{return i}},extractUrlBase:function(t){var i=t.lastIndexOf("/");return i===-1?"./":t.substr(0,i+1)}};function el(){Kt.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}el.prototype=Object.assign(Object.create(Kt.prototype),{constructor:el,isInstancedBufferGeometry:!0,copy:function(t){return Kt.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var t=Kt.prototype.toJSON.call(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}});function gu(a,t,i,r){typeof i=="number"&&(r=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),lr.call(this,a,t,i),this.meshPerAttribute=r||1}gu.prototype=Object.assign(Object.create(lr.prototype),{constructor:gu,isInstancedBufferAttribute:!0,copy:function(t){return lr.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=lr.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}});function yu(a){an.call(this,a)}yu.prototype=Object.assign(Object.create(an.prototype),{constructor:yu,load:function(t,i,r,n){var o=this,s=new Oi(o.manager);s.setPath(o.path),s.setRequestHeader(o.requestHeader),s.setWithCredentials(o.withCredentials),s.load(t,function(l){try{i(o.parse(JSON.parse(l)))}catch(c){n?n(c):console.error(c),o.manager.itemError(t)}},r,n)},parse:function(t){var i={},r={};function n(me,Ue){if(i[Ue]!==void 0)return i[Ue];var He=me.interleavedBuffers,Ye=He[Ue],Qe=o(me,Ye.buffer),pt=Ms(Ye.type,Qe),Et=new xi(pt,Ye.stride);return Et.uuid=Ye.uuid,i[Ue]=Et,Et}function o(me,Ue){if(r[Ue]!==void 0)return r[Ue];var He=me.arrayBuffers,Ye=He[Ue],Qe=new Uint32Array(Ye).buffer;return r[Ue]=Qe,Qe}var s=t.isInstancedBufferGeometry?new el:new Kt,l=t.data.index;if(l!==void 0){var c=Ms(l.type,l.array);s.setIndex(new lr(c,1))}var p=t.data.attributes;for(var C in p){var S=p[C],T=void 0;if(S.isInterleavedBufferAttribute){var O=n(t.data,S.data);T=new za(O,S.itemSize,S.offset,S.normalized)}else{var P=Ms(S.type,S.array),k=S.isInstancedBufferAttribute?gu:lr;T=new k(P,S.itemSize,S.normalized)}S.name!==void 0&&(T.name=S.name),s.setAttribute(C,T)}var W=t.data.morphAttributes;if(W)for(var V in W){for(var B=W[V],ee=[],ue=0,K=B.length;ue<K;ue++){var Q=B[ue],se=void 0;if(Q.isInterleavedBufferAttribute){var Me=n(t.data,Q.data);se=new za(Me,Q.itemSize,Q.offset,Q.normalized)}else{var xe=Ms(Q.type,Q.array);se=new lr(xe,Q.itemSize,Q.normalized)}Q.name!==void 0&&(se.name=Q.name),ee.push(se)}s.morphAttributes[V]=ee}var _e=t.data.morphTargetsRelative;_e&&(s.morphTargetsRelative=!0);var Pe=t.data.groups||t.data.drawcalls||t.data.offsets;if(Pe!==void 0)for(var Ce=0,Ae=Pe.length;Ce!==Ae;++Ce){var Be=Pe[Ce];s.addGroup(Be.start,Be.count,Be.materialIndex)}var Se=t.data.boundingSphere;if(Se!==void 0){var Te=new de;Se.center!==void 0&&Te.fromArray(Se.center),s.boundingSphere=new Ia(Te,Se.radius)}return t.name&&(s.name=t.name),t.userData&&(s.userData=t.userData),s}});var H0=function(a){Mr(t,a);function t(r){return a.call(this,r)||this}var i=t.prototype;return i.load=function(n,o,s,l){var c=this,p=this.path===""?Dc.extractUrlBase(n):this.path;this.resourcePath=this.resourcePath||p;var C=new Oi(this.manager);C.setPath(this.path),C.setRequestHeader(this.requestHeader),C.setWithCredentials(this.withCredentials),C.load(n,function(S){var T=null;try{T=JSON.parse(S)}catch(P){l!==void 0&&l(P),console.error("THREE:ObjectLoader: Can't parse "+n+".",P.message);return}var O=T.metadata;if(O===void 0||O.type===void 0||O.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+n);return}c.parse(T,o)},s,l)},i.parse=function(n,o){var s=this.parseAnimations(n.animations),l=this.parseShapes(n.shapes),c=this.parseGeometries(n.geometries,l),p=this.parseImages(n.images,function(){o!==void 0&&o(T)}),C=this.parseTextures(n.textures,p),S=this.parseMaterials(n.materials,C),T=this.parseObject(n.object,c,S,s),O=this.parseSkeletons(n.skeletons,T);if(this.bindSkeletons(T,O),o!==void 0){var P=!1;for(var k in p)if(p[k]instanceof HTMLImageElement){P=!0;break}P===!1&&o(T)}return T},i.parseShapes=function(n){var o={};if(n!==void 0)for(var s=0,l=n.length;s<l;s++){var c=new Ja().fromJSON(n[s]);o[c.uuid]=c}return o},i.parseSkeletons=function(n,o){var s={},l={};if(o.traverse(function(S){S.isBone&&(l[S.uuid]=S)}),n!==void 0)for(var c=0,p=n.length;c<p;c++){var C=new Hs().fromJSON(n[c],l);s[C.uuid]=C}return s},i.parseGeometries=function(n,o){var s={},l;if(n!==void 0)for(var c=new yu,p=0,C=n.length;p<C;p++){var S=void 0,T=n[p];switch(T.type){case"PlaneGeometry":case"PlaneBufferGeometry":S=new hi[T.type](T.width,T.height,T.widthSegments,T.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":S=new hi[T.type](T.width,T.height,T.depth,T.widthSegments,T.heightSegments,T.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":S=new hi[T.type](T.radius,T.segments,T.thetaStart,T.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":S=new hi[T.type](T.radiusTop,T.radiusBottom,T.height,T.radialSegments,T.heightSegments,T.openEnded,T.thetaStart,T.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":S=new hi[T.type](T.radius,T.height,T.radialSegments,T.heightSegments,T.openEnded,T.thetaStart,T.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":S=new hi[T.type](T.radius,T.widthSegments,T.heightSegments,T.phiStart,T.phiLength,T.thetaStart,T.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":S=new hi[T.type](T.radius,T.detail);break;case"RingGeometry":case"RingBufferGeometry":S=new hi[T.type](T.innerRadius,T.outerRadius,T.thetaSegments,T.phiSegments,T.thetaStart,T.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":S=new hi[T.type](T.radius,T.tube,T.radialSegments,T.tubularSegments,T.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":S=new hi[T.type](T.radius,T.tube,T.tubularSegments,T.radialSegments,T.p,T.q);break;case"TubeGeometry":case"TubeBufferGeometry":S=new hi[T.type](new Cc[T.path.type]().fromJSON(T.path),T.tubularSegments,T.radius,T.radialSegments,T.closed);break;case"LatheGeometry":case"LatheBufferGeometry":S=new hi[T.type](T.points,T.segments,T.phiStart,T.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":S=new hi[T.type](T.vertices,T.indices,T.radius,T.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":l=[];for(var O=0,P=T.shapes.length;O<P;O++){var k=o[T.shapes[O]];l.push(k)}S=new hi[T.type](l,T.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":l=[];for(var W=0,V=T.shapes.length;W<V;W++){var B=o[T.shapes[W]];l.push(B)}var ee=T.options.extrudePath;ee!==void 0&&(T.options.extrudePath=new Cc[ee.type]().fromJSON(ee)),S=new hi[T.type](l,T.options);break;case"BufferGeometry":case"InstancedBufferGeometry":S=c.parse(T);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE){var ue=new THREE.LegacyJSONLoader;S=ue.parse(T,this.resourcePath).geometry}else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+T.type+'"');continue}S.uuid=T.uuid,T.name!==void 0&&(S.name=T.name),S.isBufferGeometry===!0&&T.userData!==void 0&&(S.userData=T.userData),s[T.uuid]=S}return s},i.parseMaterials=function(n,o){var s={},l={};if(n!==void 0){var c=new mu;c.setTextures(o);for(var p=0,C=n.length;p<C;p++){var S=n[p];if(S.type==="MultiMaterial"){for(var T=[],O=0;O<S.materials.length;O++){var P=S.materials[O];s[P.uuid]===void 0&&(s[P.uuid]=c.parse(P)),T.push(s[P.uuid])}l[S.uuid]=T}else s[S.uuid]===void 0&&(s[S.uuid]=c.parse(S)),l[S.uuid]=s[S.uuid]}}return l},i.parseAnimations=function(n){var o={};if(n!==void 0)for(var s=0;s<n.length;s++){var l=n[s],c=Ti.parse(l);o[c.uuid]=c}return o},i.parseImages=function(n,o){var s=this,l={},c;function p(K){return s.manager.itemStart(K),c.load(K,function(){s.manager.itemEnd(K)},void 0,function(){s.manager.itemError(K),s.manager.itemEnd(K)})}function C(K){if(typeof K=="string"){var Q=K,se=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(Q)?Q:s.resourcePath+Q;return p(se)}else return K.data?{data:Ms(K.type,K.data),width:K.width,height:K.height}:null}if(n!==void 0&&n.length>0){var S=new Ec(o);c=new is(S),c.setCrossOrigin(this.crossOrigin);for(var T=0,O=n.length;T<O;T++){var P=n[T],k=P.url;if(Array.isArray(k)){l[P.uuid]=[];for(var W=0,V=k.length;W<V;W++){var B=k[W],ee=C(B);ee!==null&&(ee instanceof HTMLImageElement?l[P.uuid].push(ee):l[P.uuid].push(new ba(ee.data,ee.width,ee.height)))}}else{var ue=C(P.url);ue!==null&&(l[P.uuid]=ue)}}}return l},i.parseTextures=function(n,o){function s(O,P){return typeof O=="number"?O:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",O),P[O])}var l={};if(n!==void 0)for(var c=0,p=n.length;c<p;c++){var C=n[c];C.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',C.uuid),o[C.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",C.image);var S=void 0,T=o[C.image];Array.isArray(T)?(S=new aa(T),T.length===6&&(S.needsUpdate=!0)):(T&&T.data?S=new ba(T.data,T.width,T.height):S=new ln(T),T&&(S.needsUpdate=!0)),S.uuid=C.uuid,C.name!==void 0&&(S.name=C.name),C.mapping!==void 0&&(S.mapping=s(C.mapping,G0)),C.offset!==void 0&&S.offset.fromArray(C.offset),C.repeat!==void 0&&S.repeat.fromArray(C.repeat),C.center!==void 0&&S.center.fromArray(C.center),C.rotation!==void 0&&(S.rotation=C.rotation),C.wrap!==void 0&&(S.wrapS=s(C.wrap[0],Cd),S.wrapT=s(C.wrap[1],Cd)),C.format!==void 0&&(S.format=C.format),C.type!==void 0&&(S.type=C.type),C.encoding!==void 0&&(S.encoding=C.encoding),C.minFilter!==void 0&&(S.minFilter=s(C.minFilter,Ld)),C.magFilter!==void 0&&(S.magFilter=s(C.magFilter,Ld)),C.anisotropy!==void 0&&(S.anisotropy=C.anisotropy),C.flipY!==void 0&&(S.flipY=C.flipY),C.premultiplyAlpha!==void 0&&(S.premultiplyAlpha=C.premultiplyAlpha),C.unpackAlignment!==void 0&&(S.unpackAlignment=C.unpackAlignment),l[C.uuid]=S}return l},i.parseObject=function(n,o,s,l){var c;function p(Me){return o[Me]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",Me),o[Me]}function C(Me){if(Me!==void 0){if(Array.isArray(Me)){for(var xe=[],_e=0,Pe=Me.length;_e<Pe;_e++){var Ce=Me[_e];s[Ce]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",Ce),xe.push(s[Ce])}return xe}return s[Me]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",Me),s[Me]}}var S,T;switch(n.type){case"Scene":c=new hc,n.background!==void 0&&Number.isInteger(n.background)&&(c.background=new Pt(n.background)),n.fog!==void 0&&(n.fog.type==="Fog"?c.fog=new ed(n.fog.color,n.fog.near,n.fog.far):n.fog.type==="FogExp2"&&(c.fog=new $h(n.fog.color,n.fog.density)));break;case"PerspectiveCamera":c=new _n(n.fov,n.aspect,n.near,n.far),n.focus!==void 0&&(c.focus=n.focus),n.zoom!==void 0&&(c.zoom=n.zoom),n.filmGauge!==void 0&&(c.filmGauge=n.filmGauge),n.filmOffset!==void 0&&(c.filmOffset=n.filmOffset),n.view!==void 0&&(c.view=Object.assign({},n.view));break;case"OrthographicCamera":c=new os(n.left,n.right,n.top,n.bottom,n.near,n.far),n.zoom!==void 0&&(c.zoom=n.zoom),n.view!==void 0&&(c.view=Object.assign({},n.view));break;case"AmbientLight":c=new pu(n.color,n.intensity);break;case"DirectionalLight":c=new fu(n.color,n.intensity);break;case"PointLight":c=new du(n.color,n.intensity,n.distance,n.decay);break;case"RectAreaLight":c=new vu(n.color,n.intensity,n.width,n.height);break;case"SpotLight":c=new hu(n.color,n.intensity,n.distance,n.angle,n.penumbra,n.decay);break;case"HemisphereLight":c=new cu(n.color,n.groundColor,n.intensity);break;case"LightProbe":c=new Ii().fromJSON(n);break;case"SkinnedMesh":S=p(n.geometry),T=C(n.material),c=new ks(S,T),n.bindMode!==void 0&&(c.bindMode=n.bindMode),n.bindMatrix!==void 0&&c.bindMatrix.fromArray(n.bindMatrix),n.skeleton!==void 0&&(c.skeleton=n.skeleton);break;case"Mesh":S=p(n.geometry),T=C(n.material),c=new mn(S,T);break;case"InstancedMesh":S=p(n.geometry),T=C(n.material);var O=n.count,P=n.instanceMatrix;c=new Ol(S,T,O),c.instanceMatrix=new lr(new Float32Array(P.array),16);break;case"LOD":c=new Ns;break;case"Line":c=new Di(p(n.geometry),C(n.material));break;case"LineLoop":c=new Bl(p(n.geometry),C(n.material));break;case"LineSegments":c=new ci(p(n.geometry),C(n.material));break;case"PointCloud":case"Points":c=new Zo(p(n.geometry),C(n.material));break;case"Sprite":c=new Fs(C(n.material));break;case"Group":c=new Ea;break;case"Bone":c=new Us;break;default:c=new Xt}if(c.uuid=n.uuid,n.name!==void 0&&(c.name=n.name),n.matrix!==void 0?(c.matrix.fromArray(n.matrix),n.matrixAutoUpdate!==void 0&&(c.matrixAutoUpdate=n.matrixAutoUpdate),c.matrixAutoUpdate&&c.matrix.decompose(c.position,c.quaternion,c.scale)):(n.position!==void 0&&c.position.fromArray(n.position),n.rotation!==void 0&&c.rotation.fromArray(n.rotation),n.quaternion!==void 0&&c.quaternion.fromArray(n.quaternion),n.scale!==void 0&&c.scale.fromArray(n.scale)),n.castShadow!==void 0&&(c.castShadow=n.castShadow),n.receiveShadow!==void 0&&(c.receiveShadow=n.receiveShadow),n.shadow&&(n.shadow.bias!==void 0&&(c.shadow.bias=n.shadow.bias),n.shadow.normalBias!==void 0&&(c.shadow.normalBias=n.shadow.normalBias),n.shadow.radius!==void 0&&(c.shadow.radius=n.shadow.radius),n.shadow.mapSize!==void 0&&c.shadow.mapSize.fromArray(n.shadow.mapSize),n.shadow.camera!==void 0&&(c.shadow.camera=this.parseObject(n.shadow.camera))),n.visible!==void 0&&(c.visible=n.visible),n.frustumCulled!==void 0&&(c.frustumCulled=n.frustumCulled),n.renderOrder!==void 0&&(c.renderOrder=n.renderOrder),n.userData!==void 0&&(c.userData=n.userData),n.layers!==void 0&&(c.layers.mask=n.layers),n.children!==void 0)for(var k=n.children,W=0;W<k.length;W++)c.add(this.parseObject(k[W],o,s,l));if(n.animations!==void 0)for(var V=n.animations,B=0;B<V.length;B++){var ee=V[B];c.animations.push(l[ee])}if(n.type==="LOD"){n.autoUpdate!==void 0&&(c.autoUpdate=n.autoUpdate);for(var ue=n.levels,K=0;K<ue.length;K++){var Q=ue[K],se=c.getObjectByProperty("uuid",Q.object);se!==void 0&&c.addLevel(se,Q.distance)}}return c},i.bindSkeletons=function(n,o){Object.keys(o).length!==0&&n.traverse(function(s){if(s.isSkinnedMesh===!0&&s.skeleton!==void 0){var l=o[s.skeleton];l===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",s.skeleton):s.bind(l,s.bindMatrix)}})},i.setTexturePath=function(n){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(n)},t}(an),G0={UVMapping:ce,CubeReflectionMapping:Re,CubeRefractionMapping:qe,EquirectangularReflectionMapping:$e,EquirectangularRefractionMapping:Rt,CubeUVReflectionMapping:Qt,CubeUVRefractionMapping:Ar},Cd={RepeatWrapping:Pr,ClampToEdgeWrapping:Vt,MirroredRepeatWrapping:jr},Ld={NearestFilter:ar,NearestMipmapNearestFilter:hn,NearestMipmapLinearFilter:dn,LinearFilter:nt,LinearMipmapNearestFilter:yt,LinearMipmapLinearFilter:tr};function Oc(a){typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),an.call(this,a),this.options={premultiplyAlpha:"none"}}Oc.prototype=Object.assign(Object.create(an.prototype),{constructor:Oc,isImageBitmapLoader:!0,setOptions:function(t){return this.options=t,this},load:function(t,i,r,n){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);var o=this,s=Eo.get(t);if(s!==void 0)return o.manager.itemStart(t),setTimeout(function(){i&&i(s),o.manager.itemEnd(t)},0),s;var l={};l.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",fetch(t,l).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,o.options)}).then(function(c){Eo.add(t,c),i&&i(c),o.manager.itemEnd(t)}).catch(function(c){n&&n(c),o.manager.itemError(t),o.manager.itemEnd(t)}),o.manager.itemStart(t)}});function Ic(){this.type="ShapePath",this.color=new Pt,this.subPaths=[],this.currentPath=null}Object.assign(Ic.prototype,{moveTo:function(t,i){return this.currentPath=new Ji,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,i),this},lineTo:function(t,i){return this.currentPath.lineTo(t,i),this},quadraticCurveTo:function(t,i,r,n){return this.currentPath.quadraticCurveTo(t,i,r,n),this},bezierCurveTo:function(t,i,r,n,o,s){return this.currentPath.bezierCurveTo(t,i,r,n,o,s),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,i){function r(He){for(var Ye=[],Qe=0,pt=He.length;Qe<pt;Qe++){var Et=He[Qe],Ut=new Ja;Ut.curves=Et.curves,Ye.push(Ut)}return Ye}function n(He,Ye){for(var Qe=Ye.length,pt=!1,Et=Qe-1,Ut=0;Ut<Qe;Et=Ut++){var Ze=Ye[Et],$t=Ye[Ut],Dt=$t.x-Ze.x,rr=$t.y-Ze.y;if(Math.abs(rr)>Number.EPSILON){if(rr<0&&(Ze=Ye[Ut],Dt=-Dt,$t=Ye[Et],rr=-rr),He.y<Ze.y||He.y>$t.y)continue;if(He.y===Ze.y){if(He.x===Ze.x)return!0}else{var vr=rr*(He.x-Ze.x)-Dt*(He.y-Ze.y);if(vr===0)return!0;if(vr<0)continue;pt=!pt}}else{if(He.y!==Ze.y)continue;if($t.x<=He.x&&He.x<=Ze.x||Ze.x<=He.x&&He.x<=$t.x)return!0}}return pt}var o=wa.isClockWise,s=this.subPaths;if(s.length===0)return[];if(i===!0)return r(s);var l,c,p,C=[];if(s.length===1)return c=s[0],p=new Ja,p.curves=c.curves,C.push(p),C;var S=!o(s[0].getPoints());S=t?!S:S;var T=[],O=[],P=[],k=0,W;O[k]=void 0,P[k]=[];for(var V=0,B=s.length;V<B;V++)c=s[V],W=c.getPoints(),l=o(W),l=t?!l:l,l?(!S&&O[k]&&k++,O[k]={s:new Ja,p:W},O[k].s.curves=c.curves,S&&k++,P[k]=[]):P[k].push({h:c,p:W[0]});if(!O[0])return r(s);if(O.length>1){for(var ee=!1,ue=[],K=0,Q=O.length;K<Q;K++)T[K]=[];for(var se=0,Me=O.length;se<Me;se++)for(var xe=P[se],_e=0;_e<xe.length;_e++){for(var Pe=xe[_e],Ce=!0,Ae=0;Ae<O.length;Ae++)n(Pe.p,O[Ae].p)&&(se!==Ae&&ue.push({froms:se,tos:Ae,hole:_e}),Ce?(Ce=!1,T[Ae].push(Pe)):ee=!0);Ce&&T[se].push(Pe)}ue.length>0&&(ee||(P=T))}for(var Be,Se=0,Te=O.length;Se<Te;Se++){p=O[Se].s,C.push(p),Be=P[Se];for(var me=0,Ue=Be.length;me<Ue;me++)p.holes.push(Be[me].h)}return C}});var Rd=function(){function a(i){Object.defineProperty(this,"isFont",{value:!0}),this.type="Font",this.data=i}var t=a.prototype;return t.generateShapes=function(r,n){n===void 0&&(n=100);for(var o=[],s=V0(r,n,this.data),l=0,c=s.length;l<c;l++)Array.prototype.push.apply(o,s[l].toShapes());return o},a}();function V0(a,t,i){for(var r=Array.from?Array.from(a):String(a).split(""),n=t/i.resolution,o=(i.boundingBox.yMax-i.boundingBox.yMin+i.underlineThickness)*n,s=[],l=0,c=0,p=0;p<r.length;p++){var C=r[p];if(C===`
`)l=0,c-=o;else{var S=z0(C,n,l,c,i);l+=S.offsetX,s.push(S.path)}}return s}function z0(a,t,i,r,n){var o=n.glyphs[a]||n.glyphs["?"];if(!o){console.error('THREE.Font: character "'+a+'" does not exists in font family '+n.familyName+".");return}var s=new Ic,l,c,p,C,S,T,O,P;if(o.o)for(var k=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),W=0,V=k.length;W<V;){var B=k[W++];switch(B){case"m":l=k[W++]*t+i,c=k[W++]*t+r,s.moveTo(l,c);break;case"l":l=k[W++]*t+i,c=k[W++]*t+r,s.lineTo(l,c);break;case"q":p=k[W++]*t+i,C=k[W++]*t+r,S=k[W++]*t+i,T=k[W++]*t+r,s.quadraticCurveTo(S,T,p,C);break;case"b":p=k[W++]*t+i,C=k[W++]*t+r,S=k[W++]*t+i,T=k[W++]*t+r,O=k[W++]*t+i,P=k[W++]*t+r,s.bezierCurveTo(S,T,O,P,p,C);break}}return{offsetX:o.ha*t,path:s}}function Bc(a){an.call(this,a)}Bc.prototype=Object.assign(Object.create(an.prototype),{constructor:Bc,load:function(t,i,r,n){var o=this,s=new Oi(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(o.withCredentials),s.load(t,function(l){var c;try{c=JSON.parse(l)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),c=JSON.parse(l.substring(65,l.length-2))}var p=o.parse(c);i&&i(p)},r,n)},parse:function(t){return new Rd(t)}});var Au,Fc={getContext:function(){return Au===void 0&&(Au=new(window.AudioContext||window.webkitAudioContext)),Au},setContext:function(t){Au=t}};function bu(a){an.call(this,a)}bu.prototype=Object.assign(Object.create(an.prototype),{constructor:bu,load:function(t,i,r,n){var o=this,s=new Oi(o.manager);s.setResponseType("arraybuffer"),s.setPath(o.path),s.setRequestHeader(o.requestHeader),s.setWithCredentials(o.withCredentials),s.load(t,function(l){try{var c=l.slice(0),p=Fc.getContext();p.decodeAudioData(c,function(C){i(C)})}catch(C){n?n(C):console.error(C),o.manager.itemError(t)}},r,n)}});function Nc(a,t,i){Ii.call(this,void 0,i);var r=new Pt().set(a),n=new Pt().set(t),o=new de(r.r,r.g,r.b),s=new de(n.r,n.g,n.b),l=Math.sqrt(Math.PI),c=l*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(s).multiplyScalar(l),this.sh.coefficients[1].copy(o).sub(s).multiplyScalar(c)}Nc.prototype=Object.assign(Object.create(Ii.prototype),{constructor:Nc,isHemisphereLightProbe:!0,copy:function(t){return Ii.prototype.copy.call(this,t),this},toJSON:function(t){var i=Ii.prototype.toJSON.call(this,t);return i}});function kc(a,t){Ii.call(this,void 0,t);var i=new Pt().set(a);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}kc.prototype=Object.assign(Object.create(Ii.prototype),{constructor:kc,isAmbientLightProbe:!0,copy:function(t){return Ii.prototype.copy.call(this,t),this},toJSON:function(t){var i=Ii.prototype.toJSON.call(this,t);return i}});var Pd=new Lr,Dd=new Lr;function Od(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new _n,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new _n,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(Od.prototype,{update:function(t){var i=this._cache,r=i.focus!==t.focus||i.fov!==t.fov||i.aspect!==t.aspect*this.aspect||i.near!==t.near||i.far!==t.far||i.zoom!==t.zoom||i.eyeSep!==this.eyeSep;if(r){i.focus=t.focus,i.fov=t.fov,i.aspect=t.aspect*this.aspect,i.near=t.near,i.far=t.far,i.zoom=t.zoom,i.eyeSep=this.eyeSep;var n=t.projectionMatrix.clone(),o=i.eyeSep/2,s=o*i.near/i.focus,l=i.near*Math.tan(dr.DEG2RAD*i.fov*.5)/i.zoom,c,p;Dd.elements[12]=-o,Pd.elements[12]=o,c=-l*i.aspect+s,p=l*i.aspect+s,n.elements[0]=2*i.near/(p-c),n.elements[8]=(p+c)/(p-c),this.cameraL.projectionMatrix.copy(n),c=-l*i.aspect-s,p=l*i.aspect-s,n.elements[0]=2*i.near/(p-c),n.elements[8]=(p+c)/(p-c),this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(Dd),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(Pd)}});var Id=function(){function a(i){this.autoStart=i!==void 0?i:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}var t=a.prototype;return t.start=function(){this.startTime=Bd(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},t.stop=function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},t.getElapsedTime=function(){return this.getDelta(),this.elapsedTime},t.getDelta=function(){var r=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var n=Bd();r=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=r}return r},a}();function Bd(){return(typeof performance=="undefined"?Date:performance).now()}var wo=new de,Fd=new Yn,W0=new de,xo=new de,j0=function(a){Mr(t,a);function t(){var r;return r=a.call(this)||this,r.type="AudioListener",r.context=Fc.getContext(),r.gain=r.context.createGain(),r.gain.connect(r.context.destination),r.filter=null,r.timeDelta=0,r._clock=new Id,r}var i=t.prototype;return i.getInput=function(){return this.gain},i.removeFilter=function(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},i.getFilter=function(){return this.filter},i.setFilter=function(n){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=n,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},i.getMasterVolume=function(){return this.gain.gain.value},i.setMasterVolume=function(n){return this.gain.gain.setTargetAtTime(n,this.context.currentTime,.01),this},i.updateMatrixWorld=function(n){a.prototype.updateMatrixWorld.call(this,n);var o=this.context.listener,s=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(wo,Fd,W0),xo.set(0,0,-1).applyQuaternion(Fd),o.positionX){var l=this.context.currentTime+this.timeDelta;o.positionX.linearRampToValueAtTime(wo.x,l),o.positionY.linearRampToValueAtTime(wo.y,l),o.positionZ.linearRampToValueAtTime(wo.z,l),o.forwardX.linearRampToValueAtTime(xo.x,l),o.forwardY.linearRampToValueAtTime(xo.y,l),o.forwardZ.linearRampToValueAtTime(xo.z,l),o.upX.linearRampToValueAtTime(s.x,l),o.upY.linearRampToValueAtTime(s.y,l),o.upZ.linearRampToValueAtTime(s.z,l)}else o.setPosition(wo.x,wo.y,wo.z),o.setOrientation(xo.x,xo.y,xo.z,s.x,s.y,s.z)},t}(Xt),Uc=function(a){Mr(t,a);function t(r){var n;return n=a.call(this)||this,n.type="Audio",n.listener=r,n.context=r.context,n.gain=n.context.createGain(),n.gain.connect(r.getInput()),n.autoplay=!1,n.buffer=null,n.detune=0,n.loop=!1,n.loopStart=0,n.loopEnd=0,n.offset=0,n.duration=void 0,n.playbackRate=1,n.isPlaying=!1,n.hasPlaybackControl=!0,n.source=null,n.sourceType="empty",n._startedAt=0,n._progress=0,n._connected=!1,n.filters=[],n}var i=t.prototype;return i.getOutput=function(){return this.gain},i.setNodeSource=function(n){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=n,this.connect(),this},i.setMediaElementSource=function(n){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(n),this.connect(),this},i.setMediaStreamSource=function(n){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(n),this.connect(),this},i.setBuffer=function(n){return this.buffer=n,this.sourceType="buffer",this.autoplay&&this.play(),this},i.play=function(n){if(n===void 0&&(n=0),this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+n;var o=this.context.createBufferSource();return o.buffer=this.buffer,o.loop=this.loop,o.loopStart=this.loopStart,o.loopEnd=this.loopEnd,o.onended=this.onEnded.bind(this),o.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=o,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},i.pause=function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this},i.stop=function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this},i.connect=function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var n=1,o=this.filters.length;n<o;n++)this.filters[n-1].connect(this.filters[n]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this},i.disconnect=function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var n=1,o=this.filters.length;n<o;n++)this.filters[n-1].disconnect(this.filters[n]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this},i.getFilters=function(){return this.filters},i.setFilters=function(n){return n||(n=[]),this._connected===!0?(this.disconnect(),this.filters=n.slice(),this.connect()):this.filters=n.slice(),this},i.setDetune=function(n){if(this.detune=n,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},i.getDetune=function(){return this.detune},i.getFilter=function(){return this.getFilters()[0]},i.setFilter=function(n){return this.setFilters(n?[n]:[])},i.setPlaybackRate=function(n){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=n,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},i.getPlaybackRate=function(){return this.playbackRate},i.onEnded=function(){this.isPlaying=!1},i.getLoop=function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},i.setLoop=function(n){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=n,this.isPlaying===!0&&(this.source.loop=this.loop),this},i.setLoopStart=function(n){return this.loopStart=n,this},i.setLoopEnd=function(n){return this.loopEnd=n,this},i.getVolume=function(){return this.gain.gain.value},i.setVolume=function(n){return this.gain.gain.setTargetAtTime(n,this.context.currentTime,.01),this},t}(Xt),Mo=new de,Nd=new Yn,X0=new de,To=new de,Y0=function(a){Mr(t,a);function t(r){var n;return n=a.call(this,r)||this,n.panner=n.context.createPanner(),n.panner.panningModel="HRTF",n.panner.connect(n.gain),n}var i=t.prototype;return i.getOutput=function(){return this.panner},i.getRefDistance=function(){return this.panner.refDistance},i.setRefDistance=function(n){return this.panner.refDistance=n,this},i.getRolloffFactor=function(){return this.panner.rolloffFactor},i.setRolloffFactor=function(n){return this.panner.rolloffFactor=n,this},i.getDistanceModel=function(){return this.panner.distanceModel},i.setDistanceModel=function(n){return this.panner.distanceModel=n,this},i.getMaxDistance=function(){return this.panner.maxDistance},i.setMaxDistance=function(n){return this.panner.maxDistance=n,this},i.setDirectionalCone=function(n,o,s){return this.panner.coneInnerAngle=n,this.panner.coneOuterAngle=o,this.panner.coneOuterGain=s,this},i.updateMatrixWorld=function(n){if(a.prototype.updateMatrixWorld.call(this,n),!(this.hasPlaybackControl===!0&&this.isPlaying===!1)){this.matrixWorld.decompose(Mo,Nd,X0),To.set(0,0,1).applyQuaternion(Nd);var o=this.panner;if(o.positionX){var s=this.context.currentTime+this.listener.timeDelta;o.positionX.linearRampToValueAtTime(Mo.x,s),o.positionY.linearRampToValueAtTime(Mo.y,s),o.positionZ.linearRampToValueAtTime(Mo.z,s),o.orientationX.linearRampToValueAtTime(To.x,s),o.orientationY.linearRampToValueAtTime(To.y,s),o.orientationZ.linearRampToValueAtTime(To.z,s)}else o.setPosition(Mo.x,Mo.y,Mo.z),o.setOrientation(To.x,To.y,To.z)}},t}(Uc),kd=function(){function a(i,r){r===void 0&&(r=2048),this.analyser=i.context.createAnalyser(),this.analyser.fftSize=r,this.data=new Uint8Array(this.analyser.frequencyBinCount),i.getOutput().connect(this.analyser)}var t=a.prototype;return t.getFrequencyData=function(){return this.analyser.getByteFrequencyData(this.data),this.data},t.getAverageFrequency=function(){for(var r=0,n=this.getFrequencyData(),o=0;o<n.length;o++)r+=n[o];return r/n.length},a}();function Hc(a,t,i){this.binding=a,this.valueSize=i;var r,n,o;switch(t){case"quaternion":r=this._slerp,n=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,n=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,n=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=n,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(Hc.prototype,{accumulate:function(t,i){var r=this.buffer,n=this.valueSize,o=t*n+n,s=this.cumulativeWeight;if(s===0){for(var l=0;l!==n;++l)r[o+l]=r[l];s=i}else{s+=i;var c=i/s;this._mixBufferRegion(r,o,0,c,n)}this.cumulativeWeight=s},accumulateAdditive:function(t){var i=this.buffer,r=this.valueSize,n=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(i,n,0,t,r),this.cumulativeWeightAdditive+=t},apply:function(t){var i=this.valueSize,r=this.buffer,n=t*i+i,o=this.cumulativeWeight,s=this.cumulativeWeightAdditive,l=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){var c=i*this._origIndex;this._mixBufferRegion(r,n,c,1-o,i)}s>0&&this._mixBufferRegionAdditive(r,n,this._addIndex*i,1,i);for(var p=i,C=i+i;p!==C;++p)if(r[p]!==r[p+i]){l.setValue(r,n);break}},saveOriginalState:function(){var t=this.binding,i=this.buffer,r=this.valueSize,n=r*this._origIndex;t.getValue(i,n);for(var o=r,s=n;o!==s;++o)i[o]=i[n+o%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){var t=this.valueSize*3;this.binding.setValue(this.buffer,t)},_setAdditiveIdentityNumeric:function(){for(var t=this._addIndex*this.valueSize,i=t+this.valueSize,r=t;r<i;r++)this.buffer[r]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){for(var t=this._origIndex*this.valueSize,i=this._addIndex*this.valueSize,r=0;r<this.valueSize;r++)this.buffer[i+r]=this.buffer[t+r]},_select:function(t,i,r,n,o){if(n>=.5)for(var s=0;s!==o;++s)t[i+s]=t[r+s]},_slerp:function(t,i,r,n){Yn.slerpFlat(t,i,t,i,t,r,n)},_slerpAdditive:function(t,i,r,n,o){var s=this._workIndex*o;Yn.multiplyQuaternionsFlat(t,s,t,i,t,r),Yn.slerpFlat(t,i,t,i,t,s,n)},_lerp:function(t,i,r,n,o){for(var s=1-n,l=0;l!==o;++l){var c=i+l;t[c]=t[c]*s+t[r+l]*n}},_lerpAdditive:function(t,i,r,n,o){for(var s=0;s!==o;++s){var l=i+s;t[l]=t[l]+t[r+s]*n}}});var Gc="\\[\\]\\.:\\/",Q0=new RegExp("["+Gc+"]","g"),Vc="[^"+Gc+"]",q0="[^"+Gc.replace("\\.","")+"]",J0=/((?:WC+[\/:])*)/.source.replace("WC",Vc),Z0=/(WCOD+)?/.source.replace("WCOD",q0),K0=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Vc),$0=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Vc),ey=new RegExp("^"+J0+Z0+K0+$0+"$"),ty=["material","materials","bones"];function Ud(a,t,i){var r=i||ri.parseTrackName(t);this._targetGroup=a,this._bindings=a.subscribe_(t,r)}Object.assign(Ud.prototype,{getValue:function(t,i){this.bind();var r=this._targetGroup.nCachedObjects_,n=this._bindings[r];n!==void 0&&n.getValue(t,i)},setValue:function(t,i){for(var r=this._bindings,n=this._targetGroup.nCachedObjects_,o=r.length;n!==o;++n)r[n].setValue(t,i)},bind:function(){for(var t=this._bindings,i=this._targetGroup.nCachedObjects_,r=t.length;i!==r;++i)t[i].bind()},unbind:function(){for(var t=this._bindings,i=this._targetGroup.nCachedObjects_,r=t.length;i!==r;++i)t[i].unbind()}});function ri(a,t,i){this.path=t,this.parsedPath=i||ri.parseTrackName(t),this.node=ri.findNode(a,this.parsedPath.nodeName)||a,this.rootNode=a}Object.assign(ri,{Composite:Ud,create:function(t,i,r){return t&&t.isAnimationObjectGroup?new ri.Composite(t,i,r):new ri(t,i,r)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(Q0,"")},parseTrackName:function(t){var i=ey.exec(t);if(!i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(n!==void 0&&n!==-1){var o=r.nodeName.substring(n+1);ty.indexOf(o)!==-1&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=o)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r},findNode:function(t,i){if(!i||i===""||i==="."||i===-1||i===t.name||i===t.uuid)return t;if(t.skeleton){var r=t.skeleton.getBoneByName(i);if(r!==void 0)return r}if(t.children){var n=function s(l){for(var c=0;c<l.length;c++){var p=l[c];if(p.name===i||p.uuid===i)return p;var C=s(p.children);if(C)return C}return null},o=n(t.children);if(o)return o}return null}}),Object.assign(ri.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,i){t[i]=this.node[this.propertyName]},function(t,i){for(var r=this.resolvedProperty,n=0,o=r.length;n!==o;++n)t[i++]=r[n]},function(t,i){t[i]=this.resolvedProperty[this.propertyIndex]},function(t,i){this.resolvedProperty.toArray(t,i)}],SetterByBindingTypeAndVersioning:[[function(t,i){this.targetObject[this.propertyName]=t[i]},function(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0},function(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,i){for(var r=this.resolvedProperty,n=0,o=r.length;n!==o;++n)r[n]=t[i++]},function(t,i){for(var r=this.resolvedProperty,n=0,o=r.length;n!==o;++n)r[n]=t[i++];this.targetObject.needsUpdate=!0},function(t,i){for(var r=this.resolvedProperty,n=0,o=r.length;n!==o;++n)r[n]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,i){this.resolvedProperty[this.propertyIndex]=t[i]},function(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0},function(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,i){this.resolvedProperty.fromArray(t,i)},function(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0},function(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,i){this.bind(),this.getValue(t,i)},setValue:function(t,i){this.bind(),this.setValue(t,i)},bind:function(){var t=this.node,i=this.parsedPath,r=i.objectName,n=i.propertyName,o=i.propertyIndex;if(t||(t=ri.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){var s=i.objectIndex;switch(r){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(var l=0;l<t.length;l++)if(t[l].name===s){s=l;break}break;default:if(t[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[r]}if(s!==void 0){if(t[s]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[s]}}var c=t[n];if(c===void 0){var p=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+p+"."+n+" but it wasn't found.",t);return}var C=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?C=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(C=this.Versioning.MatrixWorldNeedsUpdate);var S=this.BindingType.Direct;if(o!==void 0){if(n==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[o]!==void 0&&(o=t.morphTargetDictionary[o])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}S=this.BindingType.ArrayElement,this.resolvedProperty=c,this.propertyIndex=o}else c.fromArray!==void 0&&c.toArray!==void 0?(S=this.BindingType.HasFromToArray,this.resolvedProperty=c):Array.isArray(c)?(S=this.BindingType.EntireArray,this.resolvedProperty=c):this.propertyName=n;this.getValue=this.GetterByBindingType[S],this.setValue=this.SetterByBindingTypeAndVersioning[S][C]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(ri.prototype,{_getValue_unbound:ri.prototype.getValue,_setValue_unbound:ri.prototype.setValue});function Hd(){this.uuid=dr.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var a={};this._indicesByUUID=a;for(var t=0,i=arguments.length;t!==i;++t)a[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}Object.assign(Hd.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,i=this._indicesByUUID,r=this._paths,n=this._parsedPaths,o=this._bindings,s=o.length,l=void 0,c=t.length,p=this.nCachedObjects_,C=0,S=arguments.length;C!==S;++C){var T=arguments[C],O=T.uuid,P=i[O];if(P===void 0){P=c++,i[O]=P,t.push(T);for(var k=0,W=s;k!==W;++k)o[k].push(new ri(T,r[k],n[k]))}else if(P<p){l=t[P];var V=--p,B=t[V];i[B.uuid]=P,t[P]=B,i[O]=V,t[V]=T;for(var ee=0,ue=s;ee!==ue;++ee){var K=o[ee],Q=K[V],se=K[P];K[P]=Q,se===void 0&&(se=new ri(T,r[ee],n[ee])),K[V]=se}}else t[P]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=p},remove:function(){for(var t=this._objects,i=this._indicesByUUID,r=this._bindings,n=r.length,o=this.nCachedObjects_,s=0,l=arguments.length;s!==l;++s){var c=arguments[s],p=c.uuid,C=i[p];if(C!==void 0&&C>=o){var S=o++,T=t[S];i[T.uuid]=C,t[C]=T,i[p]=S,t[S]=c;for(var O=0,P=n;O!==P;++O){var k=r[O],W=k[S],V=k[C];k[C]=W,k[S]=V}}}this.nCachedObjects_=o},uncache:function(){for(var t=this._objects,i=this._indicesByUUID,r=this._bindings,n=r.length,o=this.nCachedObjects_,s=t.length,l=0,c=arguments.length;l!==c;++l){var p=arguments[l],C=p.uuid,S=i[C];if(S!==void 0)if(delete i[C],S<o){var T=--o,O=t[T],P=--s,k=t[P];i[O.uuid]=S,t[S]=O,i[k.uuid]=T,t[T]=k,t.pop();for(var W=0,V=n;W!==V;++W){var B=r[W],ee=B[T],ue=B[P];B[S]=ee,B[T]=ue,B.pop()}}else{var K=--s,Q=t[K];K>0&&(i[Q.uuid]=S),t[S]=Q,t.pop();for(var se=0,Me=n;se!==Me;++se){var xe=r[se];xe[S]=xe[K],xe.pop()}}}this.nCachedObjects_=o},subscribe_:function(t,i){var r=this._bindingsIndicesByPath,n=r[t],o=this._bindings;if(n!==void 0)return o[n];var s=this._paths,l=this._parsedPaths,c=this._objects,p=c.length,C=this.nCachedObjects_,S=new Array(p);n=o.length,r[t]=n,s.push(t),l.push(i),o.push(S);for(var T=C,O=c.length;T!==O;++T){var P=c[T];S[T]=new ri(P,t,i)}return S},unsubscribe_:function(t){var i=this._bindingsIndicesByPath,r=i[t];if(r!==void 0){var n=this._paths,o=this._parsedPaths,s=this._bindings,l=s.length-1,c=s[l],p=t[l];i[p]=r,s[r]=c,s.pop(),o[r]=o[l],o.pop(),n[r]=n[l],n.pop()}}});var ry=function(){function a(i,r,n,o){n===void 0&&(n=null),o===void 0&&(o=r.blendMode),this._mixer=i,this._clip=r,this._localRoot=n,this.blendMode=o;for(var s=r.tracks,l=s.length,c=new Array(l),p={endingStart:mi,endingEnd:mi},C=0;C!==l;++C){var S=s[C].createInterpolant(null);c[C]=S,S.settings=p}this._interpolantSettings=p,this._interpolants=c,this._propertyBindings=new Array(l),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Bi,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}var t=a.prototype;return t.play=function(){return this._mixer._activateAction(this),this},t.stop=function(){return this._mixer._deactivateAction(this),this.reset()},t.reset=function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},t.isRunning=function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},t.isScheduled=function(){return this._mixer._isActiveAction(this)},t.startAt=function(r){return this._startTime=r,this},t.setLoop=function(r,n){return this.loop=r,this.repetitions=n,this},t.setEffectiveWeight=function(r){return this.weight=r,this._effectiveWeight=this.enabled?r:0,this.stopFading()},t.getEffectiveWeight=function(){return this._effectiveWeight},t.fadeIn=function(r){return this._scheduleFading(r,0,1)},t.fadeOut=function(r){return this._scheduleFading(r,1,0)},t.crossFadeFrom=function(r,n,o){if(r.fadeOut(n),this.fadeIn(n),o){var s=this._clip.duration,l=r._clip.duration,c=l/s,p=s/l;r.warp(1,c,n),this.warp(p,1,n)}return this},t.crossFadeTo=function(r,n,o){return r.crossFadeFrom(this,n,o)},t.stopFading=function(){var r=this._weightInterpolant;return r!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(r)),this},t.setEffectiveTimeScale=function(r){return this.timeScale=r,this._effectiveTimeScale=this.paused?0:r,this.stopWarping()},t.getEffectiveTimeScale=function(){return this._effectiveTimeScale},t.setDuration=function(r){return this.timeScale=this._clip.duration/r,this.stopWarping()},t.syncWith=function(r){return this.time=r.time,this.timeScale=r.timeScale,this.stopWarping()},t.halt=function(r){return this.warp(this._effectiveTimeScale,0,r)},t.warp=function(r,n,o){var s=this._mixer,l=s.time,c=this.timeScale,p=this._timeScaleInterpolant;p===null&&(p=s._lendControlInterpolant(),this._timeScaleInterpolant=p);var C=p.parameterPositions,S=p.sampleValues;return C[0]=l,C[1]=l+o,S[0]=r/c,S[1]=n/c,this},t.stopWarping=function(){var r=this._timeScaleInterpolant;return r!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(r)),this},t.getMixer=function(){return this._mixer},t.getClip=function(){return this._clip},t.getRoot=function(){return this._localRoot||this._mixer._root},t._update=function(r,n,o,s){if(!this.enabled){this._updateWeight(r);return}var l=this._startTime;if(l!==null){var c=(r-l)*o;if(c<0||o===0)return;this._startTime=null,n=o*c}n*=this._updateTimeScale(r);var p=this._updateTime(n),C=this._updateWeight(r);if(C>0){var S=this._interpolants,T=this._propertyBindings;switch(this.blendMode){case fa:for(var O=0,P=S.length;O!==P;++O)S[O].evaluate(p),T[O].accumulateAdditive(C);break;case $i:default:for(var k=0,W=S.length;k!==W;++k)S[k].evaluate(p),T[k].accumulate(s,C)}}},t._updateWeight=function(r){var n=0;if(this.enabled){n=this.weight;var o=this._weightInterpolant;if(o!==null){var s=o.evaluate(r)[0];n*=s,r>o.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n},t._updateTimeScale=function(r){var n=0;if(!this.paused){n=this.timeScale;var o=this._timeScaleInterpolant;if(o!==null){var s=o.evaluate(r)[0];n*=s,r>o.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n},t._updateTime=function(r){var n=this._clip.duration,o=this.loop,s=this.time+r,l=this._loopCount,c=o===La;if(r===0)return l===-1?s:c&&(l&1)==1?n-s:s;if(o===$n){l===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=n)s=n;else if(s<0)s=0;else{this.time=s;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:r<0?-1:1})}}else{if(l===-1&&(r>=0?(l=0,this._setEndings(!0,this.repetitions===0,c)):this._setEndings(this.repetitions===0,!0,c)),s>=n||s<0){var p=Math.floor(s/n);s-=n*p,l+=Math.abs(p);var C=this.repetitions-l;if(C<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=r>0?n:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:r>0?1:-1});else{if(C===1){var S=r<0;this._setEndings(S,!S,c)}else this._setEndings(!1,!1,c);this._loopCount=l,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:p})}}else this.time=s;if(c&&(l&1)==1)return n-s}return s},t._setEndings=function(r,n,o){var s=this._interpolantSettings;o?(s.endingStart=gi,s.endingEnd=gi):(r?s.endingStart=this.zeroSlopeAtStart?gi:mi:s.endingStart=ki,n?s.endingEnd=this.zeroSlopeAtEnd?gi:mi:s.endingEnd=ki)},t._scheduleFading=function(r,n,o){var s=this._mixer,l=s.time,c=this._weightInterpolant;c===null&&(c=s._lendControlInterpolant(),this._weightInterpolant=c);var p=c.parameterPositions,C=c.sampleValues;return p[0]=l,C[0]=n,p[1]=l+r,C[1]=o,this},a}();function zc(a){this._root=a,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}zc.prototype=Object.assign(Object.create(ea.prototype),{constructor:zc,_bindAction:function(t,i){var r=t._localRoot||this._root,n=t._clip.tracks,o=n.length,s=t._propertyBindings,l=t._interpolants,c=r.uuid,p=this._bindingsByRootAndName,C=p[c];C===void 0&&(C={},p[c]=C);for(var S=0;S!==o;++S){var T=n[S],O=T.name,P=C[O];if(P!==void 0)s[S]=P;else{if(P=s[S],P!==void 0){P._cacheIndex===null&&(++P.referenceCount,this._addInactiveBinding(P,c,O));continue}var k=i&&i._propertyBindings[S].binding.parsedPath;P=new Hc(ri.create(r,O,k),T.ValueTypeName,T.getValueSize()),++P.referenceCount,this._addInactiveBinding(P,c,O),s[S]=P}l[S].resultBuffer=P.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(t._cacheIndex===null){var i=(t._localRoot||this._root).uuid,r=t._clip.uuid,n=this._actionsByClip[r];this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,r,i)}for(var o=t._propertyBindings,s=0,l=o.length;s!==l;++s){var c=o[s];c.useCount++==0&&(this._lendBinding(c),c.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var i=t._propertyBindings,r=0,n=i.length;r!==n;++r){var o=i[r];--o.useCount==0&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var i=t._cacheIndex;return i!==null&&i<this._nActiveActions},_addInactiveAction:function(t,i,r){var n=this._actions,o=this._actionsByClip,s=o[i];if(s===void 0)s={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,o[i]=s;else{var l=s.knownActions;t._byClipCacheIndex=l.length,l.push(t)}t._cacheIndex=n.length,n.push(t),s.actionByRoot[r]=t},_removeInactiveAction:function(t){var i=this._actions,r=i[i.length-1],n=t._cacheIndex;r._cacheIndex=n,i[n]=r,i.pop(),t._cacheIndex=null;var o=t._clip.uuid,s=this._actionsByClip,l=s[o],c=l.knownActions,p=c[c.length-1],C=t._byClipCacheIndex;p._byClipCacheIndex=C,c[C]=p,c.pop(),t._byClipCacheIndex=null;var S=l.actionByRoot,T=(t._localRoot||this._root).uuid;delete S[T],c.length===0&&delete s[o],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var i=t._propertyBindings,r=0,n=i.length;r!==n;++r){var o=i[r];--o.referenceCount==0&&this._removeInactiveBinding(o)}},_lendAction:function(t){var i=this._actions,r=t._cacheIndex,n=this._nActiveActions++,o=i[n];t._cacheIndex=n,i[n]=t,o._cacheIndex=r,i[r]=o},_takeBackAction:function(t){var i=this._actions,r=t._cacheIndex,n=--this._nActiveActions,o=i[n];t._cacheIndex=n,i[n]=t,o._cacheIndex=r,i[r]=o},_addInactiveBinding:function(t,i,r){var n=this._bindingsByRootAndName,o=this._bindings,s=n[i];s===void 0&&(s={},n[i]=s),s[r]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var i=this._bindings,r=t.binding,n=r.rootNode.uuid,o=r.path,s=this._bindingsByRootAndName,l=s[n],c=i[i.length-1],p=t._cacheIndex;c._cacheIndex=p,i[p]=c,i.pop(),delete l[o],Object.keys(l).length===0&&delete s[n]},_lendBinding:function(t){var i=this._bindings,r=t._cacheIndex,n=this._nActiveBindings++,o=i[n];t._cacheIndex=n,i[n]=t,o._cacheIndex=r,i[r]=o},_takeBackBinding:function(t){var i=this._bindings,r=t._cacheIndex,n=--this._nActiveBindings,o=i[n];t._cacheIndex=n,i[n]=t,o._cacheIndex=r,i[r]=o},_lendControlInterpolant:function(){var t=this._controlInterpolants,i=this._nActiveControlInterpolants++,r=t[i];return r===void 0&&(r=new Js(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),r.__cacheIndex=i,t[i]=r),r},_takeBackControlInterpolant:function(t){var i=this._controlInterpolants,r=t.__cacheIndex,n=--this._nActiveControlInterpolants,o=i[n];t.__cacheIndex=n,i[n]=t,o.__cacheIndex=r,i[r]=o},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,i,r){var n=i||this._root,o=n.uuid,s=typeof t=="string"?Ti.findByName(n,t):t,l=s!==null?s.uuid:t,c=this._actionsByClip[l],p=null;if(r===void 0&&(s!==null?r=s.blendMode:r=$i),c!==void 0){var C=c.actionByRoot[o];if(C!==void 0&&C.blendMode===r)return C;p=c.knownActions[0],s===null&&(s=p._clip)}if(s===null)return null;var S=new ry(this,s,i,r);return this._bindAction(S,p),this._addInactiveAction(S,l,o),S},existingAction:function(t,i){var r=i||this._root,n=r.uuid,o=typeof t=="string"?Ti.findByName(r,t):t,s=o?o.uuid:t,l=this._actionsByClip[s];return l!==void 0&&l.actionByRoot[n]||null},stopAllAction:function(){for(var t=this._actions,i=this._nActiveActions,r=i-1;r>=0;--r)t[r].stop();return this},update:function(t){t*=this.timeScale;for(var i=this._actions,r=this._nActiveActions,n=this.time+=t,o=Math.sign(t),s=this._accuIndex^=1,l=0;l!==r;++l){var c=i[l];c._update(n,t,o,s)}for(var p=this._bindings,C=this._nActiveBindings,S=0;S!==C;++S)p[S].apply(s);return this},setTime:function(t){this.time=0;for(var i=0;i<this._actions.length;i++)this._actions[i].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var i=this._actions,r=t.uuid,n=this._actionsByClip,o=n[r];if(o!==void 0){for(var s=o.knownActions,l=0,c=s.length;l!==c;++l){var p=s[l];this._deactivateAction(p);var C=p._cacheIndex,S=i[i.length-1];p._cacheIndex=null,p._byClipCacheIndex=null,S._cacheIndex=C,i[C]=S,i.pop(),this._removeInactiveBindingsForAction(p)}delete n[r]}},uncacheRoot:function(t){var i=t.uuid,r=this._actionsByClip;for(var n in r){var o=r[n].actionByRoot,s=o[i];s!==void 0&&(this._deactivateAction(s),this._removeInactiveAction(s))}var l=this._bindingsByRootAndName,c=l[i];if(c!==void 0)for(var p in c){var C=c[p];C.restoreOriginalState(),this._removeInactiveBinding(C)}},uncacheAction:function(t,i){var r=this.existingAction(t,i);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}});var Gd=function(){function a(i){typeof i=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),i=arguments[1]),this.value=i}var t=a.prototype;return t.clone=function(){return new a(this.value.clone===void 0?this.value:this.value.clone())},a}();function Wc(a,t,i){xi.call(this,a,t),this.meshPerAttribute=i||1}Wc.prototype=Object.assign(Object.create(xi.prototype),{constructor:Wc,isInstancedInterleavedBuffer:!0,copy:function(t){return xi.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},clone:function(t){var i=xi.prototype.clone.call(this,t);return i.meshPerAttribute=this.meshPerAttribute,i},toJSON:function(t){var i=xi.prototype.toJSON.call(this,t);return i.isInstancedInterleavedBuffer=!0,i.meshPerAttribute=this.meshPerAttribute,i}});function jc(a,t,i,r,n){this.buffer=a,this.type=t,this.itemSize=i,this.elementSize=r,this.count=n,this.version=0}Object.defineProperty(jc.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}}),Object.assign(jc.prototype,{isGLBufferAttribute:!0,setBuffer:function(t){return this.buffer=t,this},setType:function(t,i){return this.type=t,this.elementSize=i,this},setItemSize:function(t){return this.itemSize=t,this},setCount:function(t){return this.count=t,this}});function Xc(a,t,i,r){this.ray=new Oo(a,t),this.near=i||0,this.far=r||1/0,this.camera=null,this.layers=new Wu,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Vd(a,t){return a.distance-t.distance}function Yc(a,t,i,r){if(a.layers.test(t.layers)&&a.raycast(t,i),r===!0)for(var n=a.children,o=0,s=n.length;o<s;o++)Yc(n[o],t,i,!0)}Object.assign(Xc.prototype,{set:function(t,i){this.ray.set(t,i)},setFromCamera:function(t,i){i&&i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i&&i.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type: "+i.type)},intersectObject:function(t,i,r){var n=r||[];return Yc(t,this,n,i),n.sort(Vd),n},intersectObjects:function(t,i,r){var n=r||[];if(Array.isArray(t)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var o=0,s=t.length;o<s;o++)Yc(t[o],this,n,i);return n.sort(Vd),n}});var ny=function(){function a(i,r,n){return i===void 0&&(i=1),r===void 0&&(r=0),n===void 0&&(n=0),this.radius=i,this.phi=r,this.theta=n,this}var t=a.prototype;return t.set=function(r,n,o){return this.radius=r,this.phi=n,this.theta=o,this},t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){return this.radius=r.radius,this.phi=r.phi,this.theta=r.theta,this},t.makeSafe=function(){var r=1e-6;return this.phi=Math.max(r,Math.min(Math.PI-r,this.phi)),this},t.setFromVector3=function(r){return this.setFromCartesianCoords(r.x,r.y,r.z)},t.setFromCartesianCoords=function(r,n,o){return this.radius=Math.sqrt(r*r+n*n+o*o),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(r,o),this.phi=Math.acos(dr.clamp(n/this.radius,-1,1))),this},a}(),iy=function(){function a(i,r,n){return this.radius=i!==void 0?i:1,this.theta=r!==void 0?r:0,this.y=n!==void 0?n:0,this}var t=a.prototype;return t.set=function(r,n,o){return this.radius=r,this.theta=n,this.y=o,this},t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){return this.radius=r.radius,this.theta=r.theta,this.y=r.y,this},t.setFromVector3=function(r){return this.setFromCartesianCoords(r.x,r.y,r.z)},t.setFromCartesianCoords=function(r,n,o){return this.radius=Math.sqrt(r*r+o*o),this.theta=Math.atan2(r,o),this.y=n,this},a}(),zd=new gt,Wd=function(){function a(i,r){Object.defineProperty(this,"isBox2",{value:!0}),this.min=i!==void 0?i:new gt(1/0,1/0),this.max=r!==void 0?r:new gt(-1/0,-1/0)}var t=a.prototype;return t.set=function(r,n){return this.min.copy(r),this.max.copy(n),this},t.setFromPoints=function(r){this.makeEmpty();for(var n=0,o=r.length;n<o;n++)this.expandByPoint(r[n]);return this},t.setFromCenterAndSize=function(r,n){var o=zd.copy(n).multiplyScalar(.5);return this.min.copy(r).sub(o),this.max.copy(r).add(o),this},t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){return this.min.copy(r.min),this.max.copy(r.max),this},t.makeEmpty=function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},t.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y},t.getCenter=function(r){return r===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),r=new gt),this.isEmpty()?r.set(0,0):r.addVectors(this.min,this.max).multiplyScalar(.5)},t.getSize=function(r){return r===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),r=new gt),this.isEmpty()?r.set(0,0):r.subVectors(this.max,this.min)},t.expandByPoint=function(r){return this.min.min(r),this.max.max(r),this},t.expandByVector=function(r){return this.min.sub(r),this.max.add(r),this},t.expandByScalar=function(r){return this.min.addScalar(-r),this.max.addScalar(r),this},t.containsPoint=function(r){return!(r.x<this.min.x||r.x>this.max.x||r.y<this.min.y||r.y>this.max.y)},t.containsBox=function(r){return this.min.x<=r.min.x&&r.max.x<=this.max.x&&this.min.y<=r.min.y&&r.max.y<=this.max.y},t.getParameter=function(r,n){return n===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),n=new gt),n.set((r.x-this.min.x)/(this.max.x-this.min.x),(r.y-this.min.y)/(this.max.y-this.min.y))},t.intersectsBox=function(r){return!(r.max.x<this.min.x||r.min.x>this.max.x||r.max.y<this.min.y||r.min.y>this.max.y)},t.clampPoint=function(r,n){return n===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),n=new gt),n.copy(r).clamp(this.min,this.max)},t.distanceToPoint=function(r){var n=zd.copy(r).clamp(this.min,this.max);return n.sub(r).length()},t.intersect=function(r){return this.min.max(r.min),this.max.min(r.max),this},t.union=function(r){return this.min.min(r.min),this.max.max(r.max),this},t.translate=function(r){return this.min.add(r),this.max.add(r),this},t.equals=function(r){return r.min.equals(this.min)&&r.max.equals(this.max)},a}(),jd=new de,Eu=new de,Xd=function(){function a(i,r){this.start=i!==void 0?i:new de,this.end=r!==void 0?r:new de}var t=a.prototype;return t.set=function(r,n){return this.start.copy(r),this.end.copy(n),this},t.clone=function(){return new this.constructor().copy(this)},t.copy=function(r){return this.start.copy(r.start),this.end.copy(r.end),this},t.getCenter=function(r){return r===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),r=new de),r.addVectors(this.start,this.end).multiplyScalar(.5)},t.delta=function(r){return r===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),r=new de),r.subVectors(this.end,this.start)},t.distanceSq=function(){return this.start.distanceToSquared(this.end)},t.distance=function(){return this.start.distanceTo(this.end)},t.at=function(r,n){return n===void 0&&(console.warn("THREE.Line3: .at() target is now required"),n=new de),this.delta(n).multiplyScalar(r).add(this.start)},t.closestPointToPointParameter=function(r,n){jd.subVectors(r,this.start),Eu.subVectors(this.end,this.start);var o=Eu.dot(Eu),s=Eu.dot(jd),l=s/o;return n&&(l=dr.clamp(l,0,1)),l},t.closestPointToPoint=function(r,n,o){var s=this.closestPointToPointParameter(r,n);return o===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),o=new de),this.delta(o).multiplyScalar(s).add(this.start)},t.applyMatrix4=function(r){return this.start.applyMatrix4(r),this.end.applyMatrix4(r),this},t.equals=function(r){return r.start.equals(this.start)&&r.end.equals(this.end)},a}();function tl(a){Xt.call(this),this.material=a,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}tl.prototype=Object.create(Xt.prototype),tl.prototype.constructor=tl,tl.prototype.isImmediateRenderObject=!0;var Yd=new de,ay=function(a){Mr(t,a);function t(r,n){var o;o=a.call(this)||this,o.light=r,o.light.updateMatrixWorld(),o.matrix=r.matrixWorld,o.matrixAutoUpdate=!1,o.color=n;for(var s=new Kt,l=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],c=0,p=1,C=32;c<C;c++,p++){var S=c/C*Math.PI*2,T=p/C*Math.PI*2;l.push(Math.cos(S),Math.sin(S),1,Math.cos(T),Math.sin(T),1)}s.setAttribute("position",new It(l,3));var O=new wn({fog:!1,toneMapped:!1});return o.cone=new ci(s,O),o.add(o.cone),o.update(),o}var i=t.prototype;return i.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},i.update=function(){this.light.updateMatrixWorld();var n=this.light.distance?this.light.distance:1e3,o=n*Math.tan(this.light.angle);this.cone.scale.set(o,o,n),Yd.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Yd),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)},t}(Xt),Za=new de,wu=new Lr,Qc=new Lr,Qd=function(a){Mr(t,a);function t(r){for(var n,o=qd(r),s=new Kt,l=[],c=[],p=new Pt(0,0,1),C=new Pt(0,1,0),S=0;S<o.length;S++){var T=o[S];T.parent&&T.parent.isBone&&(l.push(0,0,0),l.push(0,0,0),c.push(p.r,p.g,p.b),c.push(C.r,C.g,C.b))}s.setAttribute("position",new It(l,3)),s.setAttribute("color",new It(c,3));var O=new wn({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return n=a.call(this,s,O)||this,n.type="SkeletonHelper",n.isSkeletonHelper=!0,n.root=r,n.bones=o,n.matrix=r.matrixWorld,n.matrixAutoUpdate=!1,n}var i=t.prototype;return i.updateMatrixWorld=function(n){var o=this.bones,s=this.geometry,l=s.getAttribute("position");Qc.copy(this.root.matrixWorld).invert();for(var c=0,p=0;c<o.length;c++){var C=o[c];C.parent&&C.parent.isBone&&(wu.multiplyMatrices(Qc,C.matrixWorld),Za.setFromMatrixPosition(wu),l.setXYZ(p,Za.x,Za.y,Za.z),wu.multiplyMatrices(Qc,C.parent.matrixWorld),Za.setFromMatrixPosition(wu),l.setXYZ(p+1,Za.x,Za.y,Za.z),p+=2)}s.getAttribute("position").needsUpdate=!0,a.prototype.updateMatrixWorld.call(this,n)},t}(ci);function qd(a){var t=[];a&&a.isBone&&t.push(a);for(var i=0;i<a.children.length;i++)t.push.apply(t,qd(a.children[i]));return t}var oy=function(a){Mr(t,a);function t(r,n,o){var s,l=new qs(n,4,2),c=new bi({wireframe:!0,fog:!1,toneMapped:!1});return s=a.call(this,l,c)||this,s.light=r,s.light.updateMatrixWorld(),s.color=o,s.type="PointLightHelper",s.matrix=s.light.matrixWorld,s.matrixAutoUpdate=!1,s.update(),s}var i=t.prototype;return i.dispose=function(){this.geometry.dispose(),this.material.dispose()},i.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)},t}(mn),sy=new de,Jd=new Pt,Zd=new Pt,ly=function(a){Mr(t,a);function t(r,n,o){var s;s=a.call(this)||this,s.light=r,s.light.updateMatrixWorld(),s.matrix=r.matrixWorld,s.matrixAutoUpdate=!1,s.color=o;var l=new Ys(n);l.rotateY(Math.PI*.5),s.material=new bi({wireframe:!0,fog:!1,toneMapped:!1}),s.color===void 0&&(s.material.vertexColors=!0);var c=l.getAttribute("position"),p=new Float32Array(c.count*3);return l.setAttribute("color",new lr(p,3)),s.add(new mn(l,s.material)),s.update(),s}var i=t.prototype;return i.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},i.update=function(){var n=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var o=n.geometry.getAttribute("color");Jd.copy(this.light.color),Zd.copy(this.light.groundColor);for(var s=0,l=o.count;s<l;s++){var c=s<l/2?Jd:Zd;o.setXYZ(s,c.r,c.g,c.b)}o.needsUpdate=!0}n.lookAt(sy.setFromMatrixPosition(this.light.matrixWorld).negate())},t}(Xt),Kd=function(a){Mr(t,a);function t(i,r,n,o){var s;i===void 0&&(i=10),r===void 0&&(r=10),n===void 0&&(n=4473924),o===void 0&&(o=8947848),n=new Pt(n),o=new Pt(o);for(var l=r/2,c=i/r,p=i/2,C=[],S=[],T=0,O=0,P=-p;T<=r;T++,P+=c){C.push(-p,0,P,p,0,P),C.push(P,0,-p,P,0,p);var k=T===l?n:o;k.toArray(S,O),O+=3,k.toArray(S,O),O+=3,k.toArray(S,O),O+=3,k.toArray(S,O),O+=3}var W=new Kt;W.setAttribute("position",new It(C,3)),W.setAttribute("color",new It(S,3));var V=new wn({vertexColors:!0,toneMapped:!1});return s=a.call(this,W,V)||this,s.type="GridHelper",s}return t}(ci),uy=function(a){Mr(t,a);function t(i,r,n,o,s,l){var c;i===void 0&&(i=10),r===void 0&&(r=16),n===void 0&&(n=8),o===void 0&&(o=64),s===void 0&&(s=4473924),l===void 0&&(l=8947848),s=new Pt(s),l=new Pt(l);for(var p=[],C=[],S=0;S<=r;S++){var T=S/r*(Math.PI*2),O=Math.sin(T)*i,P=Math.cos(T)*i;p.push(0,0,0),p.push(O,0,P);var k=S&1?s:l;C.push(k.r,k.g,k.b),C.push(k.r,k.g,k.b)}for(var W=0;W<=n;W++)for(var V=W&1?s:l,B=i-i/n*W,ee=0;ee<o;ee++){var ue=ee/o*(Math.PI*2),K=Math.sin(ue)*B,Q=Math.cos(ue)*B;p.push(K,0,Q),C.push(V.r,V.g,V.b),ue=(ee+1)/o*(Math.PI*2),K=Math.sin(ue)*B,Q=Math.cos(ue)*B,p.push(K,0,Q),C.push(V.r,V.g,V.b)}var se=new Kt;se.setAttribute("position",new It(p,3)),se.setAttribute("color",new It(C,3));var Me=new wn({vertexColors:!0,toneMapped:!1});return c=a.call(this,se,Me)||this,c.type="PolarGridHelper",c}return t}(ci),$d=new de,xu=new de,ef=new de,cy=function(a){Mr(t,a);function t(r,n,o){var s;s=a.call(this)||this,s.light=r,s.light.updateMatrixWorld(),s.matrix=r.matrixWorld,s.matrixAutoUpdate=!1,s.color=o,n===void 0&&(n=1);var l=new Kt;l.setAttribute("position",new It([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));var c=new wn({fog:!1,toneMapped:!1});return s.lightPlane=new Di(l,c),s.add(s.lightPlane),l=new Kt,l.setAttribute("position",new It([0,0,0,0,0,1],3)),s.targetLine=new Di(l,c),s.add(s.targetLine),s.update(),s}var i=t.prototype;return i.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},i.update=function(){$d.setFromMatrixPosition(this.light.matrixWorld),xu.setFromMatrixPosition(this.light.target.matrixWorld),ef.subVectors(xu,$d),this.lightPlane.lookAt(xu),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(xu),this.targetLine.scale.z=ef.length()},t}(Xt),Mu=new de,Cn=new ia,hy=function(a){Mr(t,a);function t(r){var n,o=new Kt,s=new wn({color:16777215,vertexColors:!0,toneMapped:!1}),l=[],c=[],p={},C=new Pt(16755200),S=new Pt(16711680),T=new Pt(43775),O=new Pt(16777215),P=new Pt(3355443);k("n1","n2",C),k("n2","n4",C),k("n4","n3",C),k("n3","n1",C),k("f1","f2",C),k("f2","f4",C),k("f4","f3",C),k("f3","f1",C),k("n1","f1",C),k("n2","f2",C),k("n3","f3",C),k("n4","f4",C),k("p","n1",S),k("p","n2",S),k("p","n3",S),k("p","n4",S),k("u1","u2",T),k("u2","u3",T),k("u3","u1",T),k("c","t",O),k("p","c",P),k("cn1","cn2",P),k("cn3","cn4",P),k("cf1","cf2",P),k("cf3","cf4",P);function k(V,B,ee){W(V,ee),W(B,ee)}function W(V,B){l.push(0,0,0),c.push(B.r,B.g,B.b),p[V]===void 0&&(p[V]=[]),p[V].push(l.length/3-1)}return o.setAttribute("position",new It(l,3)),o.setAttribute("color",new It(c,3)),n=a.call(this,o,s)||this,n.type="CameraHelper",n.camera=r,n.camera.updateProjectionMatrix&&n.camera.updateProjectionMatrix(),n.matrix=r.matrixWorld,n.matrixAutoUpdate=!1,n.pointMap=p,n.update(),n}var i=t.prototype;return i.update=function(){var n=this.geometry,o=this.pointMap,s=1,l=1;Cn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),On("c",o,n,Cn,0,0,-1),On("t",o,n,Cn,0,0,1),On("n1",o,n,Cn,-s,-l,-1),On("n2",o,n,Cn,s,-l,-1),On("n3",o,n,Cn,-s,l,-1),On("n4",o,n,Cn,s,l,-1),On("f1",o,n,Cn,-s,-l,1),On("f2",o,n,Cn,s,-l,1),On("f3",o,n,Cn,-s,l,1),On("f4",o,n,Cn,s,l,1),On("u1",o,n,Cn,s*.7,l*1.1,-1),On("u2",o,n,Cn,-s*.7,l*1.1,-1),On("u3",o,n,Cn,0,l*2,-1),On("cf1",o,n,Cn,-s,0,1),On("cf2",o,n,Cn,s,0,1),On("cf3",o,n,Cn,0,-l,1),On("cf4",o,n,Cn,0,l,1),On("cn1",o,n,Cn,-s,0,-1),On("cn2",o,n,Cn,s,0,-1),On("cn3",o,n,Cn,0,-l,-1),On("cn4",o,n,Cn,0,l,-1),n.getAttribute("position").needsUpdate=!0},t}(ci);function On(a,t,i,r,n,o,s){Mu.set(n,o,s).unproject(r);var l=t[a];if(l!==void 0)for(var c=i.getAttribute("position"),p=0,C=l.length;p<C;p++)c.setXYZ(l[p],Mu.x,Mu.y,Mu.z)}var Tu=new pa,tf=function(a){Mr(t,a);function t(r,n){var o;n===void 0&&(n=16776960);var s=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),l=new Float32Array(8*3),c=new Kt;return c.setIndex(new lr(s,1)),c.setAttribute("position",new lr(l,3)),o=a.call(this,c,new wn({color:n,toneMapped:!1}))||this,o.object=r,o.type="BoxHelper",o.matrixAutoUpdate=!1,o.update(),o}var i=t.prototype;return i.update=function(n){if(n!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Tu.setFromObject(this.object),!Tu.isEmpty()){var o=Tu.min,s=Tu.max,l=this.geometry.attributes.position,c=l.array;c[0]=s.x,c[1]=s.y,c[2]=s.z,c[3]=o.x,c[4]=s.y,c[5]=s.z,c[6]=o.x,c[7]=o.y,c[8]=s.z,c[9]=s.x,c[10]=o.y,c[11]=s.z,c[12]=s.x,c[13]=s.y,c[14]=o.z,c[15]=o.x,c[16]=s.y,c[17]=o.z,c[18]=o.x,c[19]=o.y,c[20]=o.z,c[21]=s.x,c[22]=o.y,c[23]=o.z,l.needsUpdate=!0,this.geometry.computeBoundingSphere()}},i.setFromObject=function(n){return this.object=n,this.update(),this},i.copy=function(n){return ci.prototype.copy.call(this,n),this.object=n.object,this},t}(ci),dy=function(a){Mr(t,a);function t(r,n){var o;n===void 0&&(n=16776960);var s=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),l=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],c=new Kt;return c.setIndex(new lr(s,1)),c.setAttribute("position",new It(l,3)),o=a.call(this,c,new wn({color:n,toneMapped:!1}))||this,o.box=r,o.type="Box3Helper",o.geometry.computeBoundingSphere(),o}var i=t.prototype;return i.updateMatrixWorld=function(n){var o=this.box;o.isEmpty()||(o.getCenter(this.position),o.getSize(this.scale),this.scale.multiplyScalar(.5),a.prototype.updateMatrixWorld.call(this,n))},t}(ci),fy=function(a){Mr(t,a);function t(r,n,o){var s;n===void 0&&(n=1),o===void 0&&(o=16776960);var l=o,c=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],p=new Kt;p.setAttribute("position",new It(c,3)),p.computeBoundingSphere(),s=a.call(this,p,new wn({color:l,toneMapped:!1}))||this,s.type="PlaneHelper",s.plane=r,s.size=n;var C=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],S=new Kt;return S.setAttribute("position",new It(C,3)),S.computeBoundingSphere(),s.add(new mn(S,new bi({color:l,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),s}var i=t.prototype;return i.updateMatrixWorld=function(n){var o=-this.plane.constant;Math.abs(o)<1e-8&&(o=1e-8),this.scale.set(.5*this.size,.5*this.size,o),this.children[0].material.side=o<0?M:L,this.lookAt(this.plane.normal),a.prototype.updateMatrixWorld.call(this,n)},t}(Di),rf=new de,Su,qc,py=function(a){Mr(t,a);function t(r,n,o,s,l,c){var p;return p=a.call(this)||this,p.type="ArrowHelper",r===void 0&&(r=new de(0,0,1)),n===void 0&&(n=new de(0,0,0)),o===void 0&&(o=1),s===void 0&&(s=16776960),l===void 0&&(l=.2*o),c===void 0&&(c=.2*l),Su===void 0&&(Su=new Kt,Su.setAttribute("position",new It([0,0,0,0,1,0],3)),qc=new $o(0,.5,1,5,1),qc.translate(0,-.5,0)),p.position.copy(n),p.line=new Di(Su,new wn({color:s,toneMapped:!1})),p.line.matrixAutoUpdate=!1,p.add(p.line),p.cone=new mn(qc,new bi({color:s,toneMapped:!1})),p.cone.matrixAutoUpdate=!1,p.add(p.cone),p.setDirection(r),p.setLength(o,l,c),p}var i=t.prototype;return i.setDirection=function(n){if(n.y>.99999)this.quaternion.set(0,0,0,1);else if(n.y<-.99999)this.quaternion.set(1,0,0,0);else{rf.set(n.z,0,-n.x).normalize();var o=Math.acos(n.y);this.quaternion.setFromAxisAngle(rf,o)}},i.setLength=function(n,o,s){o===void 0&&(o=.2*n),s===void 0&&(s=.2*o),this.line.scale.set(1,Math.max(1e-4,n-o),1),this.line.updateMatrix(),this.cone.scale.set(s,o,s),this.cone.position.y=n,this.cone.updateMatrix()},i.setColor=function(n){this.line.material.color.set(n),this.cone.material.color.set(n)},i.copy=function(n){return a.prototype.copy.call(this,n,!1),this.line.copy(n.line),this.cone.copy(n.cone),this},t}(Xt),nf=function(a){Mr(t,a);function t(i){var r;i===void 0&&(i=1);var n=[0,0,0,i,0,0,0,0,0,0,i,0,0,0,0,0,0,i],o=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],s=new Kt;s.setAttribute("position",new It(n,3)),s.setAttribute("color",new It(o,3));var l=new wn({vertexColors:!0,toneMapped:!1});return r=a.call(this,s,l)||this,r.type="AxesHelper",r}return t}(ci),af=new Float32Array(1),vy=new Int32Array(af.buffer),my={toHalfFloat:function(t){af[0]=t;var i=vy[0],r=i>>16&32768,n=i>>12&2047,o=i>>23&255;return o<103?r:o>142?(r|=31744,r|=(o==255?0:1)&&i&8388607,r):o<113?(n|=2048,r|=(n>>114-o)+(n>>113-o&1),r):(r|=o-112<<10|n>>1,r+=n&1,r)}},Ta,ss=4,Ka=8,ua=Math.pow(2,Ka),of=[.125,.215,.35,.446,.526,.582],sf=Ka-ss+1+of.length,ls=20,ca=(Ta={},Ta[li]=0,Ta[hs]=1,Ta[ol]=2,Ta[Ou]=3,Ta[Iu]=4,Ta[Bu]=5,Ta[al]=6,Ta),So=new bi({side:M,depthWrite:!1,depthTest:!1}),gy=new mn(new uo,So),Jc=new os,Zc=by(),rl=Zc._lodPlanes,lf=Zc._sizeLods,_u=Zc._sigmas,uf=new Pt,Kc=null,_o=(1+Math.sqrt(5))/2,us=1/_o,cf=[new de(1,1,1),new de(-1,1,1),new de(1,1,-1),new de(-1,1,-1),new de(0,_o,us),new de(0,_o,-us),new de(us,0,_o),new de(-us,0,_o),new de(_o,us,0),new de(-_o,us,0)];function hf(a){var t=Math.max(a.r,a.g,a.b),i=Math.min(Math.max(Math.ceil(Math.log2(t)),-128),127);a.multiplyScalar(Math.pow(2,-i));var r=(i+128)/255;return r}var yy=function(){function a(i){this._renderer=i,this._pingPongRenderTarget=null,this._blurMaterial=Ey(ls),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}var t=a.prototype;return t.fromScene=function(r,n,o,s){n===void 0&&(n=0),o===void 0&&(o=.1),s===void 0&&(s=100),Kc=this._renderer.getRenderTarget();var l=this._allocateTargets();return this._sceneToCubeUV(r,o,s,l),n>0&&this._blur(l,0,0,n),this._applyPMREM(l),this._cleanup(l),l},t.fromEquirectangular=function(r){return this._fromTexture(r)},t.fromCubemap=function(r){return this._fromTexture(r)},t.compileCubemapShader=function(){this._cubemapShader===null&&(this._cubemapShader=pf(),this._compileMaterial(this._cubemapShader))},t.compileEquirectangularShader=function(){this._equirectShader===null&&(this._equirectShader=ff(),this._compileMaterial(this._equirectShader))},t.dispose=function(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(var r=0;r<rl.length;r++)rl[r].dispose()},t._cleanup=function(r){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Kc),r.scissorTest=!1,Cu(r,0,0,r.width,r.height)},t._fromTexture=function(r){Kc=this._renderer.getRenderTarget();var n=this._allocateTargets(r);return this._textureToCubeUV(r,n),this._applyPMREM(n),this._cleanup(n),n},t._allocateTargets=function(r){var n={magFilter:ar,minFilter:ar,generateMipmaps:!1,type:ir,format:Ge,encoding:Ay(r)?r.encoding:ol,depthBuffer:!1},o=df(n);return o.depthBuffer=!r,this._pingPongRenderTarget=df(n),o},t._compileMaterial=function(r){var n=new mn(rl[0],r);this._renderer.compile(n,Jc)},t._sceneToCubeUV=function(r,n,o,s){var l=90,c=1,p=new _n(l,c,n,o),C=[1,-1,1,1,1,1],S=[1,1,1,-1,-1,-1],T=this._renderer,O=T.autoClear,P=T.outputEncoding,k=T.toneMapping;T.getClearColor(uf),T.toneMapping=at,T.outputEncoding=li,T.autoClear=!1;var W=!1,V=r.background;if(V){if(V.isColor){So.color.copy(V).convertSRGBToLinear(),r.background=null;var B=hf(So.color);So.opacity=B,W=!0}}else{So.color.copy(uf).convertSRGBToLinear();var ee=hf(So.color);So.opacity=ee,W=!0}for(var ue=0;ue<6;ue++){var K=ue%3;K==0?(p.up.set(0,C[ue],0),p.lookAt(S[ue],0,0)):K==1?(p.up.set(0,0,C[ue]),p.lookAt(0,S[ue],0)):(p.up.set(0,C[ue],0),p.lookAt(0,0,S[ue])),Cu(s,K*ua,ue>2?ua:0,ua,ua),T.setRenderTarget(s),W&&T.render(gy,p),T.render(r,p)}T.toneMapping=k,T.outputEncoding=P,T.autoClear=O},t._textureToCubeUV=function(r,n){var o=this._renderer;r.isCubeTexture?this._cubemapShader==null&&(this._cubemapShader=pf()):this._equirectShader==null&&(this._equirectShader=ff());var s=r.isCubeTexture?this._cubemapShader:this._equirectShader,l=new mn(rl[0],s),c=s.uniforms;c.envMap.value=r,r.isCubeTexture||c.texelSize.value.set(1/r.image.width,1/r.image.height),c.inputEncoding.value=ca[r.encoding],c.outputEncoding.value=ca[n.texture.encoding],Cu(n,0,0,3*ua,2*ua),o.setRenderTarget(n),o.render(l,Jc)},t._applyPMREM=function(r){var n=this._renderer,o=n.autoClear;n.autoClear=!1;for(var s=1;s<sf;s++){var l=Math.sqrt(_u[s]*_u[s]-_u[s-1]*_u[s-1]),c=cf[(s-1)%cf.length];this._blur(r,s-1,s,l,c)}n.autoClear=o},t._blur=function(r,n,o,s,l){var c=this._pingPongRenderTarget;this._halfBlur(r,c,n,o,s,"latitudinal",l),this._halfBlur(c,r,o,o,s,"longitudinal",l)},t._halfBlur=function(r,n,o,s,l,c,p){var C=this._renderer,S=this._blurMaterial;c!=="latitudinal"&&c!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");var T=3,O=new mn(rl[s],S),P=S.uniforms,k=lf[o]-1,W=isFinite(l)?Math.PI/(2*k):2*Math.PI/(2*ls-1),V=l/W,B=isFinite(l)?1+Math.floor(T*V):ls;B>ls&&console.warn("sigmaRadians, "+l+", is too large and will clip, as it requested "+B+" samples when the maximum is set to "+ls);for(var ee=[],ue=0,K=0;K<ls;++K){var Q=K/V,se=Math.exp(-Q*Q/2);ee.push(se),K==0?ue+=se:K<B&&(ue+=2*se)}for(var Me=0;Me<ee.length;Me++)ee[Me]=ee[Me]/ue;P.envMap.value=r.texture,P.samples.value=B,P.weights.value=ee,P.latitudinal.value=c==="latitudinal",p&&(P.poleAxis.value=p),P.dTheta.value=W,P.mipInt.value=Ka-o,P.inputEncoding.value=ca[r.texture.encoding],P.outputEncoding.value=ca[r.texture.encoding];var xe=lf[s],_e=3*Math.max(0,ua-2*xe),Pe=(s===0?0:2*ua)+2*xe*(s>Ka-ss?s-Ka+ss:0);Cu(n,_e,Pe,3*xe,2*xe),C.setRenderTarget(n),C.render(O,Jc)},a}();function Ay(a){return a===void 0||a.type!==ir?!1:a.encoding===li||a.encoding===hs||a.encoding===al}function by(){for(var a=[],t=[],i=[],r=Ka,n=0;n<sf;n++){var o=Math.pow(2,r);t.push(o);var s=1/o;n>Ka-ss?s=of[n-Ka+ss-1]:n==0&&(s=0),i.push(s);for(var l=1/(o-1),c=-l/2,p=1+l/2,C=[c,c,p,c,p,p,c,c,p,p,c,p],S=6,T=6,O=3,P=2,k=1,W=new Float32Array(O*T*S),V=new Float32Array(P*T*S),B=new Float32Array(k*T*S),ee=0;ee<S;ee++){var ue=ee%3*2/3-1,K=ee>2?0:-1,Q=[ue,K,0,ue+2/3,K,0,ue+2/3,K+1,0,ue,K,0,ue+2/3,K+1,0,ue,K+1,0];W.set(Q,O*T*ee),V.set(C,P*T*ee);var se=[ee,ee,ee,ee,ee,ee];B.set(se,k*T*ee)}var Me=new Kt;Me.setAttribute("position",new lr(W,O)),Me.setAttribute("uv",new lr(V,P)),Me.setAttribute("faceIndex",new lr(B,k)),a.push(Me),r>ss&&r--}return{_lodPlanes:a,_sizeLods:t,_sigmas:i}}function df(a){var t=new Pa(3*ua,3*ua,a);return t.texture.mapping=Qt,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function Cu(a,t,i,r,n){a.viewport.set(t,i,r,n),a.scissor.set(t,i,r,n)}function Ey(a){var t=new Float32Array(a),i=new de(0,1,0),r=new xa({name:"SphericalGaussianBlur",defines:{n:a},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i},inputEncoding:{value:ca[li]},outputEncoding:{value:ca[li]}},vertexShader:$c(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			`+eh()+`

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:z,depthTest:!1,depthWrite:!1});return r}function ff(){var a=new gt(1,1),t=new xa({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:a},inputEncoding:{value:ca[li]},outputEncoding:{value:ca[li]}},vertexShader:$c(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			`+eh()+`

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x += texelSize.x;
				vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.y += texelSize.y;
				vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:z,depthTest:!1,depthWrite:!1});return t}function pf(){var a=new xa({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:ca[li]},outputEncoding:{value:ca[li]}},vertexShader:$c(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			`+eh()+`

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;
				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:z,depthTest:!1,depthWrite:!1});return a}function $c(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function eh(){return`

		uniform int inputEncoding;
		uniform int outputEncoding;

		#include <encodings_pars_fragment>

		vec4 inputTexelToLinear( vec4 value ) {

			if ( inputEncoding == 0 ) {

				return value;

			} else if ( inputEncoding == 1 ) {

				return sRGBToLinear( value );

			} else if ( inputEncoding == 2 ) {

				return RGBEToLinear( value );

			} else if ( inputEncoding == 3 ) {

				return RGBMToLinear( value, 7.0 );

			} else if ( inputEncoding == 4 ) {

				return RGBMToLinear( value, 16.0 );

			} else if ( inputEncoding == 5 ) {

				return RGBDToLinear( value, 256.0 );

			} else {

				return GammaToLinear( value, 2.2 );

			}

		}

		vec4 linearToOutputTexel( vec4 value ) {

			if ( outputEncoding == 0 ) {

				return value;

			} else if ( outputEncoding == 1 ) {

				return LinearTosRGB( value );

			} else if ( outputEncoding == 2 ) {

				return LinearToRGBE( value );

			} else if ( outputEncoding == 3 ) {

				return LinearToRGBM( value, 7.0 );

			} else if ( outputEncoding == 4 ) {

				return LinearToRGBM( value, 16.0 );

			} else if ( outputEncoding == 5 ) {

				return LinearToRGBD( value, 256.0 );

			} else {

				return LinearToGamma( value, 2.2 );

			}

		}

		vec4 envMapTexelToLinear( vec4 color ) {

			return inputTexelToLinear( color );

		}
	`}function wy(a,t,i,r,n,o,s){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new $u(a,t,i,n,o,s)}var xy=0,My=1,Ty=0,Sy=1,_y=2;function Cy(a){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),a}function Ly(a){return a===void 0&&(a=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),a.isMultiMaterial=!0,a.materials=a,a.clone=function(){return a.slice()},a}function Ry(a,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Zo(a,t)}function Py(a){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Fs(a)}function Dy(a,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Zo(a,t)}function Oy(a){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Wi(a)}function Iy(a){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Wi(a)}function By(a){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Wi(a)}function Fy(a,t,i){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new de(a,t,i)}function Ny(a,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new lr(a,t).setUsage(no)}function ky(a,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new gs(a,t)}function Uy(a,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new ys(a,t)}function Hy(a,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new As(a,t)}function Gy(a,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new bs(a,t)}function Vy(a,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new so(a,t)}function zy(a,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Es(a,t)}function Wy(a,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new lo(a,t)}function jy(a,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new It(a,t)}function Xy(a,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new xs(a,t)}Yt.create=function(a,t){return console.log("THREE.Curve.create() has been deprecated"),a.prototype=Object.create(Yt.prototype),a.prototype.constructor=a,a.prototype.getPoint=t,a},Object.assign(Ji.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}});function vf(a){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),ti.call(this,a),this.type="catmullrom",this.closed=!0}vf.prototype=Object.create(ti.prototype);function mf(a){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),ti.call(this,a),this.type="catmullrom"}mf.prototype=Object.create(ti.prototype);function th(a){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),ti.call(this,a),this.type="catmullrom"}th.prototype=Object.create(ti.prototype),Object.assign(th.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}});function Yy(a){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new nf(a)}function Qy(a,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new tf(a,t)}function qy(a,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new ci(new gc(a.geometry),new wn({color:t!==void 0?t:16777215}))}Kd.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Qd.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};function Jy(a,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new ci(new bc(a.geometry),new wn({color:t!==void 0?t:16777215}))}Object.assign(an.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Dc.extractUrlBase(t)}}),an.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};function Zy(a){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Oi(a)}function Ky(a){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new su(a)}Object.assign(Wd.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(pa.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(Ia.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),Ss.prototype.setFromMatrix=function(a){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(a)},Xd.prototype.center=function(a){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(a)},Object.assign(dr,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),dr.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),dr.ceilPowerOfTwo(t)}}),Object.assign(yi.prototype,{flattenToArrayOffset:function(t,i){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,i)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},getInverse:function(t){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()}}),Object.assign(Lr.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,i){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,i)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new de().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,i,r,n,o,s){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,i,n,r,o,s)},getInverse:function(t){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()}}),ta.prototype.isIntersectionLine=function(a){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(a)},Object.assign(Yn.prototype,{multiplyVector3:function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},inverse:function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()}}),Object.assign(Oo.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(ra.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,i)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(ra,{barycoordFromPoint:function(t,i,r,n,o){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),ra.getBarycoord(t,i,r,n,o)},normal:function(t,i,r,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),ra.getNormal(t,i,r,n)}}),Object.assign(Ja.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new fo(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Qs(this,t)}}),Object.assign(gt.prototype,{fromAttribute:function(t,i,r){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,i,r)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(de.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,i){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(i,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,i,r){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,i,r)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(rn.prototype,{fromAttribute:function(t,i,r){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,i,r)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Xt.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,i){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(i,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(Xt.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(mn.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(mn.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Ra},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(Ns.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Hs.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),ks.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Yt.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),_n.prototype.setLens=function(a,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),t!==void 0&&(this.filmGauge=t),this.setFocalLength(a)},Object.defineProperties(gn.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(lr.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===no},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(no)}}}),Object.assign(lr.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(t===!0?no:ds),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Kt.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,i){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(i&&i.isBufferAttribute)&&!(i&&i.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new lr(arguments[1],arguments[2]))):t==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(i),this):this.setAttribute(t,i)},addDrawCall:function(t,i,r){r!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,i)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(Kt.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(el.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(t){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=t}}}),Object.defineProperties(Xc.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),Object.defineProperties(xi.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===no},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Object.assign(xi.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(t===!0?no:ds),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(fo.prototype,{getArrays:function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")}}),Object.assign(hc.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}}),Object.defineProperties(Gd.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(sr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Pt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===D}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(Qa.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Ya.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(t){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=t}}}),Object.defineProperties(ui.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(Ds.prototype,{clearTarget:function(t,i,r,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(i,r,n)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(Ds.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=t===!0?hs:li}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Yh.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});function $y(a,t,i){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new oc(a,i)}Object.defineProperties(Pa.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(Uc.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var i=this,r=new bu;return r.load(t,function(n){i.setBuffer(n)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),kd.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},co.prototype.updateCubeMap=function(a,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(a,t)},co.prototype.clear=function(a,t,i,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(a,t,i,r)};var eA={merge:function(t,i,r){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var n;i.isMesh&&(i.matrixAutoUpdate&&i.updateMatrix(),n=i.matrix,i=i.geometry),t.merge(i,n,r)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}};io.crossOrigin=void 0,io.loadTexture=function(a,t,i,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var n=new lu;n.setCrossOrigin(this.crossOrigin);var o=n.load(a,i,void 0,r);return t&&(o.mapping=t),o},io.loadTextureCube=function(a,t,i,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var n=new ou;n.setCrossOrigin(this.crossOrigin);var o=n.load(a,i,void 0,r);return t&&(o.mapping=t),o},io.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},io.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};function tA(){console.error("THREE.CanvasRenderer has been removed")}function rA(){console.error("THREE.JSONLoader has been removed.")}var nA={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function iA(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:E}})),typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=E),u.ACESFilmicToneMapping=U,u.AddEquation=j,u.AddOperation=Xe,u.AdditiveAnimationBlendMode=fa,u.AdditiveBlending=Y,u.AlphaFormat=Wn,u.AlwaysDepth=Nt,u.AlwaysStencilFunc=uh,u.AmbientLight=pu,u.AmbientLightProbe=kc,u.AnimationClip=Ti,u.AnimationLoader=wc,u.AnimationMixer=zc,u.AnimationObjectGroup=Hd,u.AnimationUtils=bn,u.ArcCurve=as,u.ArrayCamera=Rs,u.ArrowHelper=py,u.Audio=Uc,u.AudioAnalyser=kd,u.AudioContext=Fc,u.AudioListener=j0,u.AudioLoader=bu,u.AxesHelper=nf,u.AxisHelper=Yy,u.BackSide=M,u.BasicDepthPacking=oh,u.BasicShadowMap=b,u.BinaryTextureLoader=Ky,u.Bone=Us,u.BooleanKeyframeTrack=ru,u.BoundingBoxHelper=Qy,u.Box2=Wd,u.Box3=pa,u.Box3Helper=dy,u.BoxBufferGeometry=uo,u.BoxGeometry=uo,u.BoxHelper=tf,u.BufferAttribute=lr,u.BufferGeometry=Kt,u.BufferGeometryLoader=yu,u.ByteType=xr,u.Cache=Eo,u.Camera=ia,u.CameraHelper=hy,u.CanvasRenderer=tA,u.CanvasTexture=Vs,u.CatmullRomCurve3=ti,u.CineonToneMapping=$,u.CircleBufferGeometry=kl,u.CircleGeometry=kl,u.ClampToEdgeWrapping=Vt,u.Clock=Id,u.ClosedSplineCurve3=vf,u.Color=Pt,u.ColorKeyframeTrack=nu,u.CompressedTexture=Ko,u.CompressedTextureLoader=xc,u.ConeBufferGeometry=Ul,u.ConeGeometry=Ul,u.CubeCamera=co,u.CubeReflectionMapping=Re,u.CubeRefractionMapping=qe,u.CubeTexture=aa,u.CubeTextureLoader=ou,u.CubeUVReflectionMapping=Qt,u.CubeUVRefractionMapping=Ar,u.CubicBezierCurve=Xi,u.CubicBezierCurve3=sa,u.CubicInterpolant=eu,u.CullFaceBack=d,u.CullFaceFront=m,u.CullFaceFrontBack=f,u.CullFaceNone=v,u.Curve=Yt,u.CurvePath=qa,u.CustomBlending=le,u.CustomToneMapping=H,u.CylinderBufferGeometry=$o,u.CylinderGeometry=$o,u.Cylindrical=iy,u.DataTexture=ba,u.DataTexture2DArray=Wo,u.DataTexture3D=jo,u.DataTextureLoader=su,u.DataUtils=my,u.DecrementStencilOp=Tf,u.DecrementWrapStencilOp=_f,u.DefaultLoadingManager=Td,u.DepthFormat=et,u.DepthStencilFormat=je,u.DepthTexture=zs,u.DirectionalLight=fu,u.DirectionalLightHelper=cy,u.DiscreteInterpolant=tu,u.DodecahedronBufferGeometry=Hl,u.DodecahedronGeometry=Hl,u.DoubleSide=R,u.DstAlphaFactor=Gt,u.DstColorFactor=zt,u.DynamicBufferAttribute=Ny,u.DynamicCopyUsage=Gf,u.DynamicDrawUsage=no,u.DynamicReadUsage=kf,u.EdgesGeometry=gc,u.EdgesHelper=qy,u.EllipseCurve=Si,u.EqualDepth=ge,u.EqualStencilFunc=Pf,u.EquirectangularReflectionMapping=$e,u.EquirectangularRefractionMapping=Rt,u.Euler=vl,u.EventDispatcher=ea,u.ExtrudeBufferGeometry=fo,u.ExtrudeGeometry=fo,u.Face3=$u,u.Face4=wy,u.FaceColors=Sy,u.FileLoader=Oi,u.FlatShading=D,u.Float16BufferAttribute=ws,u.Float32Attribute=jy,u.Float32BufferAttribute=It,u.Float64Attribute=Xy,u.Float64BufferAttribute=xs,u.FloatType=Ur,u.Fog=ed,u.FogExp2=$h,u.Font=Rd,u.FontLoader=Bc,u.FrontSide=L,u.Frustum=Ss,u.GLBufferAttribute=jc,u.GLSL1=zf,u.GLSL3=Fu,u.GammaEncoding=al,u.GeometryUtils=eA,u.GreaterDepth=we,u.GreaterEqualDepth=ve,u.GreaterEqualStencilFunc=Bf,u.GreaterStencilFunc=Of,u.GridHelper=Kd,u.Group=Ea,u.HalfFloatType=on,u.HemisphereLight=cu,u.HemisphereLightHelper=ly,u.HemisphereLightProbe=Nc,u.IcosahedronBufferGeometry=Xl,u.IcosahedronGeometry=Xl,u.ImageBitmapLoader=Oc,u.ImageLoader=is,u.ImageUtils=io,u.ImmediateRenderObject=tl,u.IncrementStencilOp=Mf,u.IncrementWrapStencilOp=Sf,u.InstancedBufferAttribute=gu,u.InstancedBufferGeometry=el,u.InstancedInterleavedBuffer=Wc,u.InstancedMesh=Ol,u.Int16Attribute=Gy,u.Int16BufferAttribute=bs,u.Int32Attribute=zy,u.Int32BufferAttribute=Es,u.Int8Attribute=ky,u.Int8BufferAttribute=gs,u.IntType=Nn,u.InterleavedBuffer=xi,u.InterleavedBufferAttribute=za,u.Interpolant=Mi,u.InterpolateDiscrete=Fi,u.InterpolateLinear=Ni,u.InterpolateSmooth=Ki,u.InvertStencilOp=Cf,u.JSONLoader=rA,u.KeepStencilOp=sl,u.KeyframeTrack=Qn,u.LOD=Ns,u.LatheBufferGeometry=Yl,u.LatheGeometry=Yl,u.Layers=Wu,u.LensFlare=iA,u.LessDepth=ne,u.LessEqualDepth=ie,u.LessEqualStencilFunc=Df,u.LessStencilFunc=Rf,u.Light=gn,u.LightProbe=Ii,u.Line=Di,u.Line3=Xd,u.LineBasicMaterial=wn,u.LineCurve=fi,u.LineCurve3=Yi,u.LineDashedMaterial=bo,u.LineLoop=Bl,u.LinePieces=My,u.LineSegments=ci,u.LineStrip=xy,u.LinearEncoding=li,u.LinearFilter=nt,u.LinearInterpolant=Js,u.LinearMipMapLinearFilter=ur,u.LinearMipMapNearestFilter=Jt,u.LinearMipmapLinearFilter=tr,u.LinearMipmapNearestFilter=yt,u.LinearToneMapping=lt,u.Loader=an,u.LoaderUtils=Dc,u.LoadingManager=Ec,u.LogLuvEncoding=ah,u.LoopOnce=$n,u.LoopPingPong=La,u.LoopRepeat=Bi,u.LuminanceAlphaFormat=be,u.LuminanceFormat=oe,u.MOUSE=w,u.Material=sr,u.MaterialLoader=mu,u.Math=dr,u.MathUtils=dr,u.Matrix3=yi,u.Matrix4=Lr,u.MaxEquation=Ne,u.Mesh=mn,u.MeshBasicMaterial=bi,u.MeshDepthMaterial=Ga,u.MeshDistanceMaterial=Va,u.MeshFaceMaterial=Cy,u.MeshLambertMaterial=yo,u.MeshMatcapMaterial=Ao,u.MeshNormalMaterial=go,u.MeshPhongMaterial=Qa,u.MeshPhysicalMaterial=Ya,u.MeshStandardMaterial=oa,u.MeshToonMaterial=mo,u.MinEquation=ye,u.MirroredRepeatWrapping=jr,u.MixOperation=Fe,u.MultiMaterial=Ly,u.MultiplyBlending=J,u.MultiplyOperation=De,u.NearestFilter=ar,u.NearestMipMapLinearFilter=ot,u.NearestMipMapNearestFilter=Rn,u.NearestMipmapLinearFilter=dn,u.NearestMipmapNearestFilter=hn,u.NeverDepth=en,u.NeverStencilFunc=Lf,u.NoBlending=z,u.NoColors=Ty,u.NoToneMapping=at,u.NormalAnimationBlendMode=$i,u.NormalBlending=re,u.NotEqualDepth=Ie,u.NotEqualStencilFunc=If,u.NumberKeyframeTrack=rs,u.Object3D=Xt,u.ObjectLoader=H0,u.ObjectSpaceNormalMap=lh,u.OctahedronBufferGeometry=Ys,u.OctahedronGeometry=Ys,u.OneFactor=ke,u.OneMinusDstAlphaFactor=er,u.OneMinusDstColorFactor=wt,u.OneMinusSrcAlphaFactor=St,u.OneMinusSrcColorFactor=rt,u.OrthographicCamera=os,u.PCFShadowMap=g,u.PCFSoftShadowMap=y,u.PMREMGenerator=yy,u.ParametricBufferGeometry=po,u.ParametricGeometry=po,u.Particle=Py,u.ParticleBasicMaterial=Iy,u.ParticleSystem=Dy,u.ParticleSystemMaterial=By,u.Path=Ji,u.PerspectiveCamera=_n,u.Plane=ta,u.PlaneBufferGeometry=_s,u.PlaneGeometry=_s,u.PlaneHelper=fy,u.PointCloud=Ry,u.PointCloudMaterial=Oy,u.PointLight=du,u.PointLightHelper=oy,u.Points=Zo,u.PointsMaterial=Wi,u.PolarGridHelper=uy,u.PolyhedronBufferGeometry=ja,u.PolyhedronGeometry=ja,u.PositionalAudio=Y0,u.PropertyBinding=ri,u.PropertyMixer=Hc,u.QuadraticBezierCurve=Qi,u.QuadraticBezierCurve3=la,u.Quaternion=Yn,u.QuaternionKeyframeTrack=Zs,u.QuaternionLinearInterpolant=iu,u.REVISION=E,u.RGBADepthPacking=sh,u.RGBAFormat=jn,u.RGBAIntegerFormat=Wt,u.RGBA_ASTC_10x10_Format=dt,u.RGBA_ASTC_10x5_Format=Oe,u.RGBA_ASTC_10x6_Format=Je,u.RGBA_ASTC_10x8_Format=ft,u.RGBA_ASTC_12x10_Format=ze,u.RGBA_ASTC_12x12_Format=tt,u.RGBA_ASTC_4x4_Format=si,u.RGBA_ASTC_5x4_Format=sn,u.RGBA_ASTC_5x5_Format=pn,u.RGBA_ASTC_6x5_Format=I,u.RGBA_ASTC_6x6_Format=F,u.RGBA_ASTC_8x5_Format=X,u.RGBA_ASTC_8x6_Format=q,u.RGBA_ASTC_8x8_Format=he,u.RGBA_BPTC_Format=mt,u.RGBA_ETC2_EAC_Format=Sr,u.RGBA_PVRTC_2BPPV1_Format=Hn,u.RGBA_PVRTC_4BPPV1_Format=yn,u.RGBA_S3TC_DXT1_Format=cr,u.RGBA_S3TC_DXT3_Format=fn,u.RGBA_S3TC_DXT5_Format=Or,u.RGBDEncoding=Bu,u.RGBEEncoding=ol,u.RGBEFormat=Ge,u.RGBFormat=Ri,u.RGBIntegerFormat=ct,u.RGBM16Encoding=Iu,u.RGBM7Encoding=Ou,u.RGB_ETC1_Format=hr,u.RGB_ETC2_Format=Tr,u.RGB_PVRTC_2BPPV1_Format=Hr,u.RGB_PVRTC_4BPPV1_Format=br,u.RGB_S3TC_DXT1_Format=qt,u.RGFormat=kt,u.RGIntegerFormat=Mt,u.RawShaderMaterial=xa,u.Ray=Oo,u.Raycaster=Xc,u.RectAreaLight=vu,u.RedFormat=ht,u.RedIntegerFormat=bt,u.ReinhardToneMapping=vt,u.RepeatWrapping=Pr,u.ReplaceStencilOp=xf,u.ReverseSubtractEquation=Z,u.RingBufferGeometry=Ql,u.RingGeometry=Ql,u.SRGB8_ALPHA8_ASTC_10x10_Format=Jn,u.SRGB8_ALPHA8_ASTC_10x5_Format=Pn,u.SRGB8_ALPHA8_ASTC_10x6_Format=An,u.SRGB8_ALPHA8_ASTC_10x8_Format=Un,u.SRGB8_ALPHA8_ASTC_12x10_Format=Zn,u.SRGB8_ALPHA8_ASTC_12x12_Format=Kn,u.SRGB8_ALPHA8_ASTC_4x4_Format=Bt,u.SRGB8_ALPHA8_ASTC_5x4_Format=jt,u.SRGB8_ALPHA8_ASTC_5x5_Format=Zt,u.SRGB8_ALPHA8_ASTC_6x5_Format=Er,u.SRGB8_ALPHA8_ASTC_6x6_Format=fr,u.SRGB8_ALPHA8_ASTC_8x5_Format=or,u.SRGB8_ALPHA8_ASTC_8x6_Format=tn,u.SRGB8_ALPHA8_ASTC_8x8_Format=Mn,u.Scene=hc,u.SceneUtils=nA,u.ShaderChunk=Fr,u.ShaderLib=zi,u.ShaderMaterial=ui,u.ShadowMaterial=vo,u.Shape=Ja,u.ShapeBufferGeometry=Qs,u.ShapeGeometry=Qs,u.ShapePath=Ic,u.ShapeUtils=wa,u.ShortType=Xr,u.Skeleton=Hs,u.SkeletonHelper=Qd,u.SkinnedMesh=ks,u.SmoothShading=N,u.Sphere=Ia,u.SphereBufferGeometry=qs,u.SphereGeometry=qs,u.Spherical=ny,u.SphericalHarmonics3=_d,u.Spline=th,u.SplineCurve=qi,u.SplineCurve3=mf,u.SpotLight=hu,u.SpotLightHelper=ay,u.Sprite=Fs,u.SpriteMaterial=Wa,u.SrcAlphaFactor=At,u.SrcAlphaSaturateFactor=kr,u.SrcColorFactor=it,u.StaticCopyUsage=Hf,u.StaticDrawUsage=ds,u.StaticReadUsage=Nf,u.StereoCamera=Od,u.StreamCopyUsage=Vf,u.StreamDrawUsage=Ff,u.StreamReadUsage=Uf,u.StringKeyframeTrack=au,u.SubtractEquation=ae,u.SubtractiveBlending=te,u.TOUCH=h,u.TangentSpaceNormalMap=ro,u.TetrahedronBufferGeometry=ql,u.TetrahedronGeometry=ql,u.TextBufferGeometry=Jl,u.TextGeometry=Jl,u.Texture=ln,u.TextureLoader=lu,u.TorusBufferGeometry=Zl,u.TorusGeometry=Zl,u.TorusKnotBufferGeometry=Kl,u.TorusKnotGeometry=Kl,u.Triangle=ra,u.TriangleFanDrawMode=Dn,u.TriangleStripDrawMode=to,u.TrianglesDrawMode=Ra,u.TubeBufferGeometry=$l,u.TubeGeometry=$l,u.UVMapping=ce,u.Uint16Attribute=Vy,u.Uint16BufferAttribute=so,u.Uint32Attribute=Wy,u.Uint32BufferAttribute=lo,u.Uint8Attribute=Uy,u.Uint8BufferAttribute=ys,u.Uint8ClampedAttribute=Hy,u.Uint8ClampedBufferAttribute=As,u.Uniform=Gd,u.UniformsLib=_t,u.UniformsUtils=Th,u.UnsignedByteType=ir,u.UnsignedInt248Type=Li,u.UnsignedIntType=Yr,u.UnsignedShort4444Type=vi,u.UnsignedShort5551Type=qn,u.UnsignedShort565Type=qr,u.UnsignedShortType=Dr,u.VSMShadowMap=x,u.Vector2=gt,u.Vector3=de,u.Vector4=rn,u.VectorKeyframeTrack=ns,u.Vertex=Fy,u.VertexColors=_y,u.VideoTexture=vc,u.WebGL1Renderer=cc,u.WebGLCubeRenderTarget=oc,u.WebGLMultisampleRenderTarget=Qf,u.WebGLRenderTarget=Pa,u.WebGLRenderTargetCube=$y,u.WebGLRenderer=Ds,u.WebGLUtils=Qh,u.WireframeGeometry=bc,u.WireframeHelper=Jy,u.WrapAroundEnding=ki,u.XHRLoader=Zy,u.ZeroCurvatureEnding=mi,u.ZeroFactor=We,u.ZeroSlopeEnding=gi,u.ZeroStencilOp=wf,u.sRGBEncoding=hs,Object.defineProperty(u,"__esModule",{value:!0})})},{}],58:[function(_,G,fe){THREE.DRACOLoader=function(u){THREE.Loader.call(this,u),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}},THREE.DRACOLoader.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:THREE.DRACOLoader,setDecoderPath:function(u){return this.decoderPath=u,this},setDecoderConfig:function(u){return this.decoderConfig=u,this},setWorkerLimit:function(u){return this.workerLimit=u,this},setVerbosity:function(){console.warn("THREE.DRACOLoader: The .setVerbosity() method has been removed.")},setDrawMode:function(){console.warn("THREE.DRACOLoader: The .setDrawMode() method has been removed.")},setSkipDequantization:function(){console.warn("THREE.DRACOLoader: The .setSkipDequantization() method has been removed.")},load:function(u,A,E,w){var h=new THREE.FileLoader(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setWithCredentials(this.withCredentials),h.load(u,v=>{var d={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(v,d).then(A).catch(w)},E,w)},decodeDracoFile:function(u,A,E,w){var h={attributeIDs:E||this.defaultAttributeIDs,attributeTypes:w||this.defaultAttributeTypes,useUniqueIDs:!!E};this.decodeGeometry(u,h).then(A)},decodeGeometry:function(u,A){for(var E in A.attributeTypes){var w=A.attributeTypes[E];w.BYTES_PER_ELEMENT!==void 0&&(A.attributeTypes[E]=w.name)}var h=JSON.stringify(A);if(THREE.DRACOLoader.taskCache.has(u)){var v=THREE.DRACOLoader.taskCache.get(u);if(v.key===h)return v.promise;if(u.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var d,m=this.workerNextTaskID++,f=u.byteLength,b=this._getWorker(m,f).then(g=>(d=g,new Promise((y,x)=>{d._callbacks[m]={resolve:y,reject:x},d.postMessage({type:"decode",id:m,taskConfig:A,buffer:u},[u])}))).then(g=>this._createGeometry(g.geometry));return b.catch(()=>!0).then(()=>{d&&m&&this._releaseTask(d,m)}),THREE.DRACOLoader.taskCache.set(u,{key:h,promise:b}),b},_createGeometry:function(u){var A=new THREE.BufferGeometry;u.index&&A.setIndex(new THREE.BufferAttribute(u.index.array,1));for(var E=0;E<u.attributes.length;E++){var w=u.attributes[E],h=w.name,v=w.array,d=w.itemSize;A.setAttribute(h,new THREE.BufferAttribute(v,d))}return A},_loadLibrary:function(u,A){var E=new THREE.FileLoader(this.manager);return E.setPath(this.decoderPath),E.setResponseType(A),E.setWithCredentials(this.withCredentials),new Promise((w,h)=>{E.load(u,w,void 0,h)})},preload:function(){return this._initDecoder(),this},_initDecoder:function(){if(this.decoderPending)return this.decoderPending;var u=typeof WebAssembly!="object"||this.decoderConfig.type==="js",A=[];return u?A.push(this._loadLibrary("draco_decoder.js","text")):(A.push(this._loadLibrary("draco_wasm_wrapper.js","text")),A.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(A).then(E=>{var w=E[0];u||(this.decoderConfig.wasmBinary=E[1]);var h=THREE.DRACOLoader.DRACOWorker.toString(),v=["/* draco decoder */",w,"","/* worker */",h.substring(h.indexOf("{")+1,h.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([v]))}),this.decoderPending},_getWorker:function(u,A){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){var E=new Worker(this.workerSourceURL);E._callbacks={},E._taskCosts={},E._taskLoad=0,E.postMessage({type:"init",decoderConfig:this.decoderConfig}),E.onmessage=function(h){var v=h.data;switch(v.type){case"decode":E._callbacks[v.id].resolve(v);break;case"error":E._callbacks[v.id].reject(v);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+v.type+'"')}},this.workerPool.push(E)}else this.workerPool.sort(function(w,h){return w._taskLoad>h._taskLoad?-1:1});var E=this.workerPool[this.workerPool.length-1];return E._taskCosts[u]=A,E._taskLoad+=A,E})},_releaseTask:function(u,A){u._taskLoad-=u._taskCosts[A],delete u._callbacks[A],delete u._taskCosts[A]},debug:function(){console.log("Task load: ",this.workerPool.map(u=>u._taskLoad))},dispose:function(){for(var u=0;u<this.workerPool.length;++u)this.workerPool[u].terminate();return this.workerPool.length=0,this}}),THREE.DRACOLoader.DRACOWorker=function(){var u,A;onmessage=function(d){var m=d.data;switch(m.type){case"init":u=m.decoderConfig,A=new Promise(function(g){u.onModuleLoaded=function(y){g({draco:y})},DracoDecoderModule(u)});break;case"decode":var f=m.buffer,b=m.taskConfig;A.then(g=>{var y=g.draco,x=new y.Decoder,L=new y.DecoderBuffer;L.Init(new Int8Array(f),f.byteLength);try{var M=E(y,x,L,b),R=M.attributes.map(D=>D.array.buffer);M.index&&R.push(M.index.array.buffer),self.postMessage({type:"decode",id:m.id,geometry:M},R)}catch(D){console.error(D),self.postMessage({type:"error",id:m.id,error:D.message})}finally{y.destroy(L),y.destroy(x)}});break}};function E(d,m,f,b){var g=b.attributeIDs,y=b.attributeTypes,x,L,M=m.GetEncodedGeometryType(f);if(M===d.TRIANGULAR_MESH)x=new d.Mesh,L=m.DecodeBufferToMesh(f,x);else if(M===d.POINT_CLOUD)x=new d.PointCloud,L=m.DecodeBufferToPointCloud(f,x);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!L.ok()||x.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+L.error_msg());var R={index:null,attributes:[]};for(var D in g){var N=self[y[D]],z,re;if(b.useUniqueIDs)re=g[D],z=m.GetAttributeByUniqueId(x,re);else{if(re=m.GetAttributeId(x,d[g[D]]),re===-1)continue;z=m.GetAttribute(x,re)}R.attributes.push(h(d,m,x,D,N,z))}return M===d.TRIANGULAR_MESH&&(R.index=w(d,m,x)),d.destroy(x),R}function w(d,m,f){var b=f.num_faces(),g=b*3,y=g*4,x=d._malloc(y);m.GetTrianglesUInt32Array(f,y,x);var L=new Uint32Array(d.HEAPF32.buffer,x,g).slice();return d._free(x),{array:L,itemSize:1}}function h(d,m,f,b,g,y){var x=y.num_components(),L=f.num_points(),M=L*x,R=M*g.BYTES_PER_ELEMENT,D=v(d,g),N=d._malloc(R);m.GetAttributeDataArrayForAllPoints(f,y,D,R,N);var z=new g(d.HEAPF32.buffer,N,M).slice();return d._free(N),{name:b,array:z,itemSize:x}}function v(d,m){switch(m){case Float32Array:return d.DT_FLOAT32;case Int8Array:return d.DT_INT8;case Int16Array:return d.DT_INT16;case Int32Array:return d.DT_INT32;case Uint8Array:return d.DT_UINT8;case Uint16Array:return d.DT_UINT16;case Uint32Array:return d.DT_UINT32}}},THREE.DRACOLoader.taskCache=new WeakMap,THREE.DRACOLoader.setDecoderPath=function(){console.warn("THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.")},THREE.DRACOLoader.setDecoderConfig=function(){console.warn("THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.")},THREE.DRACOLoader.releaseDecoderModule=function(){console.warn("THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.")},THREE.DRACOLoader.getDecoderModule=function(){console.warn("THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.")}},{}],59:[function(_,G,fe){THREE.GLTFLoader=function(){function u(ne){THREE.Loader.call(this,ne),this.dracoLoader=null,this.ddsLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(ie){return new d(ie)}),this.register(function(ie){return new f(ie)}),this.register(function(ie){return new b(ie)}),this.register(function(ie){return new m(ie)}),this.register(function(ie){return new h(ie)}),this.register(function(ie){return new g(ie)})}u.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:u,load:function(ne,ie,ge,ve){var we=this,Ie;this.resourcePath!==""?Ie=this.resourcePath:this.path!==""?Ie=this.path:Ie=THREE.LoaderUtils.extractUrlBase(ne),this.manager.itemStart(ne);var De=function(Xe){ve?ve(Xe):console.error(Xe),we.manager.itemError(ne),we.manager.itemEnd(ne)},Fe=new THREE.FileLoader(this.manager);Fe.setPath(this.path),Fe.setResponseType("arraybuffer"),Fe.setRequestHeader(this.requestHeader),Fe.setWithCredentials(this.withCredentials),Fe.load(ne,function(Xe){try{we.parse(Xe,Ie,function(at){ie(at),we.manager.itemEnd(ne)},De)}catch(at){De(at)}},ge,De)},setDRACOLoader:function(ne){return this.dracoLoader=ne,this},setDDSLoader:function(ne){return this.ddsLoader=ne,this},setKTX2Loader:function(ne){return this.ktx2Loader=ne,this},setMeshoptDecoder:function(ne){return this.meshoptDecoder=ne,this},register:function(ne){return this.pluginCallbacks.indexOf(ne)===-1&&this.pluginCallbacks.push(ne),this},unregister:function(ne){return this.pluginCallbacks.indexOf(ne)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(ne),1),this},parse:function(ne,ie,ge,ve){var we,Ie={},De={};if(typeof ne=="string")we=ne;else{var Fe=THREE.LoaderUtils.decodeText(new Uint8Array(ne,0,4));if(Fe===y){try{Ie[E.KHR_BINARY_GLTF]=new M(ne)}catch(H){ve&&ve(H);return}we=Ie[E.KHR_BINARY_GLTF].content}else we=THREE.LoaderUtils.decodeText(new Uint8Array(ne))}var Xe=JSON.parse(we);if(Xe.asset===void 0||Xe.asset.version[0]<2){ve&&ve(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}var at=new wt(Xe,{path:ie||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});at.fileLoader.setRequestHeader(this.requestHeader);for(var lt=0;lt<this.pluginCallbacks.length;lt++){var vt=this.pluginCallbacks[lt](at);De[vt.name]=vt,Ie[vt.name]=!0}if(Xe.extensionsUsed)for(var lt=0;lt<Xe.extensionsUsed.length;++lt){var $=Xe.extensionsUsed[lt],U=Xe.extensionsRequired||[];switch($){case E.KHR_MATERIALS_UNLIT:Ie[$]=new v;break;case E.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:Ie[$]=new z;break;case E.KHR_DRACO_MESH_COMPRESSION:Ie[$]=new R(Xe,this.dracoLoader);break;case E.MSFT_TEXTURE_DDS:Ie[$]=new w(this.ddsLoader);break;case E.KHR_TEXTURE_TRANSFORM:Ie[$]=new D;break;case E.KHR_MESH_QUANTIZATION:Ie[$]=new re;break;default:U.indexOf($)>=0&&De[$]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+$+'".')}}at.setExtensions(Ie),at.setPlugins(De),at.parse(ge,ve)}});function A(){var ne={};return{get:function(ie){return ne[ie]},add:function(ie,ge){ne[ie]=ge},remove:function(ie){delete ne[ie]},removeAll:function(){ne={}}}}var E={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function w(ne){if(!ne)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader");this.name=E.MSFT_TEXTURE_DDS,this.ddsLoader=ne}function h(ne){this.parser=ne,this.name=E.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}h.prototype._markDefs=function(){for(var ne=this.parser,ie=this.parser.json.nodes||[],ge=0,ve=ie.length;ge<ve;ge++){var we=ie[ge];we.extensions&&we.extensions[this.name]&&we.extensions[this.name].light!==void 0&&ne._addNodeRef(this.cache,we.extensions[this.name].light)}},h.prototype._loadLight=function(ne){var ie=this.parser,ge="light:"+ne,ve=ie.cache.get(ge);if(ve)return ve;var we=ie.json,Ie=we.extensions&&we.extensions[this.name]||{},De=Ie.lights||[],Fe=De[ne],Xe,at=new THREE.Color(16777215);Fe.color!==void 0&&at.fromArray(Fe.color);var lt=Fe.range!==void 0?Fe.range:0;switch(Fe.type){case"directional":Xe=new THREE.DirectionalLight(at),Xe.target.position.set(0,0,-1),Xe.add(Xe.target);break;case"point":Xe=new THREE.PointLight(at),Xe.distance=lt;break;case"spot":Xe=new THREE.SpotLight(at),Xe.distance=lt,Fe.spot=Fe.spot||{},Fe.spot.innerConeAngle=Fe.spot.innerConeAngle!==void 0?Fe.spot.innerConeAngle:0,Fe.spot.outerConeAngle=Fe.spot.outerConeAngle!==void 0?Fe.spot.outerConeAngle:Math.PI/4,Xe.angle=Fe.spot.outerConeAngle,Xe.penumbra=1-Fe.spot.innerConeAngle/Fe.spot.outerConeAngle,Xe.target.position.set(0,0,-1),Xe.add(Xe.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+Fe.type)}return Xe.position.set(0,0,0),Xe.decay=2,Fe.intensity!==void 0&&(Xe.intensity=Fe.intensity),Xe.name=ie.createUniqueName(Fe.name||"light_"+ne),ve=Promise.resolve(Xe),ie.cache.add(ge,ve),ve},h.prototype.createNodeAttachment=function(ne){var ie=this,ge=this.parser,ve=ge.json,we=ve.nodes[ne],Ie=we.extensions&&we.extensions[this.name]||{},De=Ie.light;return De===void 0?null:this._loadLight(De).then(function(Fe){return ge._getNodeRef(ie.cache,De,Fe)})};function v(){this.name=E.KHR_MATERIALS_UNLIT}v.prototype.getMaterialType=function(){return THREE.MeshBasicMaterial},v.prototype.extendParams=function(ne,ie,ge){var ve=[];ne.color=new THREE.Color(1,1,1),ne.opacity=1;var we=ie.pbrMetallicRoughness;if(we){if(Array.isArray(we.baseColorFactor)){var Ie=we.baseColorFactor;ne.color.fromArray(Ie),ne.opacity=Ie[3]}we.baseColorTexture!==void 0&&ve.push(ge.assignTexture(ne,"map",we.baseColorTexture))}return Promise.all(ve)};function d(ne){this.parser=ne,this.name=E.KHR_MATERIALS_CLEARCOAT}d.prototype.getMaterialType=function(ne){var ie=this.parser,ge=ie.json.materials[ne];return!ge.extensions||!ge.extensions[this.name]?null:THREE.MeshPhysicalMaterial},d.prototype.extendMaterialParams=function(ne,ie){var ge=this.parser,ve=ge.json.materials[ne];if(!ve.extensions||!ve.extensions[this.name])return Promise.resolve();var we=[],Ie=ve.extensions[this.name];if(Ie.clearcoatFactor!==void 0&&(ie.clearcoat=Ie.clearcoatFactor),Ie.clearcoatTexture!==void 0&&we.push(ge.assignTexture(ie,"clearcoatMap",Ie.clearcoatTexture)),Ie.clearcoatRoughnessFactor!==void 0&&(ie.clearcoatRoughness=Ie.clearcoatRoughnessFactor),Ie.clearcoatRoughnessTexture!==void 0&&we.push(ge.assignTexture(ie,"clearcoatRoughnessMap",Ie.clearcoatRoughnessTexture)),Ie.clearcoatNormalTexture!==void 0&&(we.push(ge.assignTexture(ie,"clearcoatNormalMap",Ie.clearcoatNormalTexture)),Ie.clearcoatNormalTexture.scale!==void 0)){var De=Ie.clearcoatNormalTexture.scale;ie.clearcoatNormalScale=new THREE.Vector2(De,-De)}return Promise.all(we)};function m(ne){this.parser=ne,this.name=E.KHR_MATERIALS_TRANSMISSION}m.prototype.getMaterialType=function(ne){var ie=this.parser,ge=ie.json.materials[ne];return!ge.extensions||!ge.extensions[this.name]?null:THREE.MeshPhysicalMaterial},m.prototype.extendMaterialParams=function(ne,ie){var ge=this.parser,ve=ge.json.materials[ne];if(!ve.extensions||!ve.extensions[this.name])return Promise.resolve();var we=[],Ie=ve.extensions[this.name];return Ie.transmissionFactor!==void 0&&(ie.transmission=Ie.transmissionFactor),Ie.transmissionTexture!==void 0&&we.push(ge.assignTexture(ie,"transmissionMap",Ie.transmissionTexture)),Promise.all(we)};function f(ne){this.parser=ne,this.name=E.KHR_TEXTURE_BASISU}f.prototype.loadTexture=function(ne){var ie=this.parser,ge=ie.json,ve=ge.textures[ne];if(!ve.extensions||!ve.extensions[this.name])return null;var we=ve.extensions[this.name],Ie=ge.images[we.source],De=ie.options.ktx2Loader;if(!De){if(ge.extensionsRequired&&ge.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return ie.loadTextureImage(ne,Ie,De)};function b(ne){this.parser=ne,this.name=E.EXT_TEXTURE_WEBP,this.isSupported=null}b.prototype.loadTexture=function(ne){var ie=this.name,ge=this.parser,ve=ge.json,we=ve.textures[ne];if(!we.extensions||!we.extensions[ie])return null;var Ie=we.extensions[ie],De=ve.images[Ie.source],Fe=De.uri?ge.options.manager.getHandler(De.uri):ge.textureLoader;return this.detectSupport().then(function(Xe){if(Xe)return ge.loadTextureImage(ne,De,Fe);if(ve.extensionsRequired&&ve.extensionsRequired.indexOf(ie)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return ge.loadTexture(ne)})},b.prototype.detectSupport=function(){return this.isSupported||(this.isSupported=new Promise(function(ne){var ie=new Image;ie.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",ie.onload=ie.onerror=function(){ne(ie.height===1)}})),this.isSupported};function g(ne){this.name=E.EXT_MESHOPT_COMPRESSION,this.parser=ne}g.prototype.loadBufferView=function(ne){var ie=this.parser.json,ge=ie.bufferViews[ne];if(ge.extensions&&ge.extensions[this.name]){var ve=ge.extensions[this.name],we=this.parser.getDependency("buffer",ve.buffer),Ie=this.parser.options.meshoptDecoder;if(!Ie||!Ie.supported){if(ie.extensionsRequired&&ie.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([we,Ie.ready]).then(function(De){var Fe=ve.byteOffset||0,Xe=ve.byteLength||0,at=ve.count,lt=ve.byteStride,vt=new ArrayBuffer(at*lt),$=new Uint8Array(De[0],Fe,Xe);return Ie.decodeGltfBuffer(new Uint8Array(vt),at,lt,$,ve.mode,ve.filter),vt})}else return null};var y="glTF",x=12,L={JSON:1313821514,BIN:5130562};function M(ne){this.name=E.KHR_BINARY_GLTF,this.content=null,this.body=null;var ie=new DataView(ne,0,x);if(this.header={magic:THREE.LoaderUtils.decodeText(new Uint8Array(ne.slice(0,4))),version:ie.getUint32(4,!0),length:ie.getUint32(8,!0)},this.header.magic!==y)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var ge=this.header.length-x,ve=new DataView(ne,x),we=0;we<ge;){var Ie=ve.getUint32(we,!0);we+=4;var De=ve.getUint32(we,!0);if(we+=4,De===L.JSON){var Fe=new Uint8Array(ne,x+we,Ie);this.content=THREE.LoaderUtils.decodeText(Fe)}else if(De===L.BIN){var Xe=x+we;this.body=ne.slice(Xe,Xe+Ie)}we+=Ie}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}function R(ne,ie){if(!ie)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=E.KHR_DRACO_MESH_COMPRESSION,this.json=ne,this.dracoLoader=ie,this.dracoLoader.preload()}R.prototype.decodePrimitive=function(ne,ie){var ge=this.json,ve=this.dracoLoader,we=ne.extensions[this.name].bufferView,Ie=ne.extensions[this.name].attributes,De={},Fe={},Xe={};for(var at in Ie){var lt=Z[at]||at.toLowerCase();De[lt]=Ie[at]}for(at in ne.attributes){var lt=Z[at]||at.toLowerCase();if(Ie[at]!==void 0){var vt=ge.accessors[ne.attributes[at]],$=J[vt.componentType];Xe[lt]=$,Fe[lt]=vt.normalized===!0}}return ie.getDependency("bufferView",we).then(function(U){return new Promise(function(H){ve.decodeDracoFile(U,function(ce){for(var Re in ce.attributes){var qe=ce.attributes[Re],$e=Fe[Re];$e!==void 0&&(qe.normalized=$e)}H(ce)},De,Xe)})})};function D(){this.name=E.KHR_TEXTURE_TRANSFORM}D.prototype.extendTexture=function(ne,ie){return ne=ne.clone(),ie.offset!==void 0&&ne.offset.fromArray(ie.offset),ie.rotation!==void 0&&(ne.rotation=ie.rotation),ie.scale!==void 0&&ne.repeat.fromArray(ie.scale),ie.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),ne.needsUpdate=!0,ne};function N(ne){THREE.MeshStandardMaterial.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var ie=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),ge=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),ve=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	texelSpecular = sRGBToLinear( texelSpecular );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),we=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),Ie=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join(`
`),De={specular:{value:new THREE.Color().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=De,this.onBeforeCompile=function(Fe){for(var Xe in De)Fe.uniforms[Xe]=De[Xe];Fe.fragmentShader=Fe.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",ie).replace("#include <metalnessmap_pars_fragment>",ge).replace("#include <roughnessmap_fragment>",ve).replace("#include <metalnessmap_fragment>",we).replace("#include <lights_physical_fragment>",Ie)},Object.defineProperties(this,{specular:{get:function(){return De.specular.value},set:function(Fe){De.specular.value=Fe}},specularMap:{get:function(){return De.specularMap.value},set:function(Fe){De.specularMap.value=Fe,Fe?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return De.glossiness.value},set:function(Fe){De.glossiness.value=Fe}},glossinessMap:{get:function(){return De.glossinessMap.value},set:function(Fe){De.glossinessMap.value=Fe,Fe?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(ne)}N.prototype=Object.create(THREE.MeshStandardMaterial.prototype),N.prototype.constructor=N,N.prototype.copy=function(ne){return THREE.MeshStandardMaterial.prototype.copy.call(this,ne),this.specularMap=ne.specularMap,this.specular.copy(ne.specular),this.glossinessMap=ne.glossinessMap,this.glossiness=ne.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this};function z(){return{name:E.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return N},extendParams:function(ne,ie,ge){var ve=ie.extensions[this.name];ne.color=new THREE.Color(1,1,1),ne.opacity=1;var we=[];if(Array.isArray(ve.diffuseFactor)){var Ie=ve.diffuseFactor;ne.color.fromArray(Ie),ne.opacity=Ie[3]}if(ve.diffuseTexture!==void 0&&we.push(ge.assignTexture(ne,"map",ve.diffuseTexture)),ne.emissive=new THREE.Color(0,0,0),ne.glossiness=ve.glossinessFactor!==void 0?ve.glossinessFactor:1,ne.specular=new THREE.Color(1,1,1),Array.isArray(ve.specularFactor)&&ne.specular.fromArray(ve.specularFactor),ve.specularGlossinessTexture!==void 0){var De=ve.specularGlossinessTexture;we.push(ge.assignTexture(ne,"glossinessMap",De)),we.push(ge.assignTexture(ne,"specularMap",De))}return Promise.all(we)},createMaterial:function(ne){var ie=new N(ne);return ie.fog=!0,ie.color=ne.color,ie.map=ne.map===void 0?null:ne.map,ie.lightMap=null,ie.lightMapIntensity=1,ie.aoMap=ne.aoMap===void 0?null:ne.aoMap,ie.aoMapIntensity=1,ie.emissive=ne.emissive,ie.emissiveIntensity=1,ie.emissiveMap=ne.emissiveMap===void 0?null:ne.emissiveMap,ie.bumpMap=ne.bumpMap===void 0?null:ne.bumpMap,ie.bumpScale=1,ie.normalMap=ne.normalMap===void 0?null:ne.normalMap,ie.normalMapType=THREE.TangentSpaceNormalMap,ne.normalScale&&(ie.normalScale=ne.normalScale),ie.displacementMap=null,ie.displacementScale=1,ie.displacementBias=0,ie.specularMap=ne.specularMap===void 0?null:ne.specularMap,ie.specular=ne.specular,ie.glossinessMap=ne.glossinessMap===void 0?null:ne.glossinessMap,ie.glossiness=ne.glossiness,ie.alphaMap=null,ie.envMap=ne.envMap===void 0?null:ne.envMap,ie.envMapIntensity=1,ie.refractionRatio=.98,ie}}}function re(){this.name=E.KHR_MESH_QUANTIZATION}function Y(ne,ie,ge,ve){THREE.Interpolant.call(this,ne,ie,ge,ve)}Y.prototype=Object.create(THREE.Interpolant.prototype),Y.prototype.constructor=Y,Y.prototype.copySampleValue_=function(ne){for(var ie=this.resultBuffer,ge=this.sampleValues,ve=this.valueSize,we=ne*ve*3+ve,Ie=0;Ie!==ve;Ie++)ie[Ie]=ge[we+Ie];return ie},Y.prototype.beforeStart_=Y.prototype.copySampleValue_,Y.prototype.afterEnd_=Y.prototype.copySampleValue_,Y.prototype.interpolate_=function(ne,ie,ge,ve){for(var we=this.resultBuffer,Ie=this.sampleValues,De=this.valueSize,Fe=De*2,Xe=De*3,at=ve-ie,lt=(ge-ie)/at,vt=lt*lt,$=vt*lt,U=ne*Xe,H=U-Xe,ce=-2*$+3*vt,Re=$-vt,qe=1-ce,$e=Re-vt+lt,Rt=0;Rt!==De;Rt++){var Qt=Ie[H+Rt+De],Ar=Ie[H+Rt+Fe]*at,Pr=Ie[U+Rt+De],Vt=Ie[U+Rt]*at;we[Rt]=qe*Qt+$e*Ar+ce*Pr+Re*Vt}return we};var te={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},J={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},le={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipmapNearestFilter,9985:THREE.LinearMipmapNearestFilter,9986:THREE.NearestMipmapLinearFilter,9987:THREE.LinearMipmapLinearFilter},j={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping},ae={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Z={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ye={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Ne={CUBICSPLINE:void 0,LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete},We={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function ke(ne,ie){return typeof ne!="string"||ne===""?"":(/^https?:\/\//i.test(ie)&&/^\//.test(ne)&&(ie=ie.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(ne)||/^data:.*,.*$/i.test(ne)||/^blob:.*$/i.test(ne)?ne:ie+ne)}function it(ne){return ne.DefaultMaterial===void 0&&(ne.DefaultMaterial=new THREE.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:THREE.FrontSide})),ne.DefaultMaterial}function rt(ne,ie,ge){for(var ve in ge.extensions)ne[ve]===void 0&&(ie.userData.gltfExtensions=ie.userData.gltfExtensions||{},ie.userData.gltfExtensions[ve]=ge.extensions[ve])}function At(ne,ie){ie.extras!==void 0&&(typeof ie.extras=="object"?Object.assign(ne.userData,ie.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+ie.extras))}function St(ne,ie,ge){for(var ve=!1,we=!1,Ie=0,De=ie.length;Ie<De;Ie++){var Fe=ie[Ie];if(Fe.POSITION!==void 0&&(ve=!0),Fe.NORMAL!==void 0&&(we=!0),ve&&we)break}if(!ve&&!we)return Promise.resolve(ne);for(var Xe=[],at=[],Ie=0,De=ie.length;Ie<De;Ie++){var Fe=ie[Ie];if(ve){var lt=Fe.POSITION!==void 0?ge.getDependency("accessor",Fe.POSITION):ne.attributes.position;Xe.push(lt)}if(we){var lt=Fe.NORMAL!==void 0?ge.getDependency("accessor",Fe.NORMAL):ne.attributes.normal;at.push(lt)}}return Promise.all([Promise.all(Xe),Promise.all(at)]).then(function(vt){var $=vt[0],U=vt[1];return ve&&(ne.morphAttributes.position=$),we&&(ne.morphAttributes.normal=U),ne.morphTargetsRelative=!0,ne})}function Gt(ne,ie){if(ne.updateMorphTargets(),ie.weights!==void 0)for(var ge=0,ve=ie.weights.length;ge<ve;ge++)ne.morphTargetInfluences[ge]=ie.weights[ge];if(ie.extras&&Array.isArray(ie.extras.targetNames)){var we=ie.extras.targetNames;if(ne.morphTargetInfluences.length===we.length){ne.morphTargetDictionary={};for(var ge=0,ve=we.length;ge<ve;ge++)ne.morphTargetDictionary[we[ge]]=ge}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function er(ne){var ie=ne.extensions&&ne.extensions[E.KHR_DRACO_MESH_COMPRESSION],ge;return ie?ge="draco:"+ie.bufferView+":"+ie.indices+":"+zt(ie.attributes):ge=ne.indices+":"+zt(ne.attributes)+":"+ne.mode,ge}function zt(ne){for(var ie="",ge=Object.keys(ne).sort(),ve=0,we=ge.length;ve<we;ve++)ie+=ge[ve]+":"+ne[ge[ve]]+";";return ie}function wt(ne,ie){this.json=ne||{},this.extensions={},this.plugins={},this.options=ie||{},this.cache=new A,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},typeof createImageBitmap!="undefined"&&/Firefox/.test(navigator.userAgent)===!1?this.textureLoader=new THREE.ImageBitmapLoader(this.options.manager):this.textureLoader=new THREE.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new THREE.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}wt.prototype.setExtensions=function(ne){this.extensions=ne},wt.prototype.setPlugins=function(ne){this.plugins=ne},wt.prototype.parse=function(ne,ie){var ge=this,ve=this.json,we=this.extensions;this.cache.removeAll(),this._invokeAll(function(Ie){return Ie._markDefs&&Ie._markDefs()}),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(Ie){var De={scene:Ie[0][ve.scene||0],scenes:Ie[0],animations:Ie[1],cameras:Ie[2],asset:ve.asset,parser:ge,userData:{}};rt(we,De,ve),At(De,ve),ne(De)}).catch(ie)},wt.prototype._markDefs=function(){for(var ne=this.json.nodes||[],ie=this.json.skins||[],ge=this.json.meshes||[],ve=0,we=ie.length;ve<we;ve++)for(var Ie=ie[ve].joints,De=0,Fe=Ie.length;De<Fe;De++)ne[Ie[De]].isBone=!0;for(var Xe=0,at=ne.length;Xe<at;Xe++){var lt=ne[Xe];lt.mesh!==void 0&&(this._addNodeRef(this.meshCache,lt.mesh),lt.skin!==void 0&&(ge[lt.mesh].isSkinnedMesh=!0)),lt.camera!==void 0&&this._addNodeRef(this.cameraCache,lt.camera)}},wt.prototype._addNodeRef=function(ne,ie){ie!==void 0&&(ne.refs[ie]===void 0&&(ne.refs[ie]=ne.uses[ie]=0),ne.refs[ie]++)},wt.prototype._getNodeRef=function(ne,ie,ge){if(ne.refs[ie]<=1)return ge;var ve=ge.clone();return ve.name+="_instance_"+ne.uses[ie]++,ve},wt.prototype._invokeOne=function(ne){var ie=Object.values(this.plugins);ie.push(this);for(var ge=0;ge<ie.length;ge++){var ve=ne(ie[ge]);if(ve)return ve}},wt.prototype._invokeAll=function(ne){var ie=Object.values(this.plugins);ie.unshift(this);for(var ge=[],ve=0;ve<ie.length;ve++){var we=ne(ie[ve]);we&&ge.push(we)}return ge},wt.prototype.getDependency=function(ne,ie){var ge=ne+":"+ie,ve=this.cache.get(ge);if(!ve){switch(ne){case"scene":ve=this.loadScene(ie);break;case"node":ve=this.loadNode(ie);break;case"mesh":ve=this._invokeOne(function(we){return we.loadMesh&&we.loadMesh(ie)});break;case"accessor":ve=this.loadAccessor(ie);break;case"bufferView":ve=this._invokeOne(function(we){return we.loadBufferView&&we.loadBufferView(ie)});break;case"buffer":ve=this.loadBuffer(ie);break;case"material":ve=this._invokeOne(function(we){return we.loadMaterial&&we.loadMaterial(ie)});break;case"texture":ve=this._invokeOne(function(we){return we.loadTexture&&we.loadTexture(ie)});break;case"skin":ve=this.loadSkin(ie);break;case"animation":ve=this.loadAnimation(ie);break;case"camera":ve=this.loadCamera(ie);break;default:throw new Error("Unknown type: "+ne)}this.cache.add(ge,ve)}return ve},wt.prototype.getDependencies=function(ne){var ie=this.cache.get(ne);if(!ie){var ge=this,ve=this.json[ne+(ne==="mesh"?"es":"s")]||[];ie=Promise.all(ve.map(function(we,Ie){return ge.getDependency(ne,Ie)})),this.cache.add(ne,ie)}return ie},wt.prototype.loadBuffer=function(ne){var ie=this.json.buffers[ne],ge=this.fileLoader;if(ie.type&&ie.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+ie.type+" buffer type is not supported.");if(ie.uri===void 0&&ne===0)return Promise.resolve(this.extensions[E.KHR_BINARY_GLTF].body);var ve=this.options;return new Promise(function(we,Ie){ge.load(ke(ie.uri,ve.path),we,void 0,function(){Ie(new Error('THREE.GLTFLoader: Failed to load buffer "'+ie.uri+'".'))})})},wt.prototype.loadBufferView=function(ne){var ie=this.json.bufferViews[ne];return this.getDependency("buffer",ie.buffer).then(function(ge){var ve=ie.byteLength||0,we=ie.byteOffset||0;return ge.slice(we,we+ve)})},wt.prototype.loadAccessor=function(ne){var ie=this,ge=this.json,ve=this.json.accessors[ne];if(ve.bufferView===void 0&&ve.sparse===void 0)return Promise.resolve(null);var we=[];return ve.bufferView!==void 0?we.push(this.getDependency("bufferView",ve.bufferView)):we.push(null),ve.sparse!==void 0&&(we.push(this.getDependency("bufferView",ve.sparse.indices.bufferView)),we.push(this.getDependency("bufferView",ve.sparse.values.bufferView))),Promise.all(we).then(function(Ie){var De=Ie[0],Fe=ae[ve.type],Xe=J[ve.componentType],at=Xe.BYTES_PER_ELEMENT,lt=at*Fe,vt=ve.byteOffset||0,$=ve.bufferView!==void 0?ge.bufferViews[ve.bufferView].byteStride:void 0,U=ve.normalized===!0,H,ce;if($&&$!==lt){var Re=Math.floor(vt/$),qe="InterleavedBuffer:"+ve.bufferView+":"+ve.componentType+":"+Re+":"+ve.count,$e=ie.cache.get(qe);$e||(H=new Xe(De,Re*$,ve.count*$/at),$e=new THREE.InterleavedBuffer(H,$/at),ie.cache.add(qe,$e)),ce=new THREE.InterleavedBufferAttribute($e,Fe,vt%$/at,U)}else De===null?H=new Xe(ve.count*Fe):H=new Xe(De,vt,ve.count*Fe),ce=new THREE.BufferAttribute(H,Fe,U);if(ve.sparse!==void 0){var Rt=ae.SCALAR,Qt=J[ve.sparse.indices.componentType],Ar=ve.sparse.indices.byteOffset||0,Pr=ve.sparse.values.byteOffset||0,Vt=new Qt(Ie[1],Ar,ve.sparse.count*Rt),jr=new Xe(Ie[2],Pr,ve.sparse.count*Fe);De!==null&&(ce=new THREE.BufferAttribute(ce.array.slice(),ce.itemSize,ce.normalized));for(var ar=0,hn=Vt.length;ar<hn;ar++){var Rn=Vt[ar];if(ce.setX(Rn,jr[ar*Fe]),Fe>=2&&ce.setY(Rn,jr[ar*Fe+1]),Fe>=3&&ce.setZ(Rn,jr[ar*Fe+2]),Fe>=4&&ce.setW(Rn,jr[ar*Fe+3]),Fe>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return ce})},wt.prototype.loadTexture=function(ne){var ie=this,ge=this.json,ve=this.options,we=ge.textures[ne],Ie=we.extensions||{},De;Ie[E.MSFT_TEXTURE_DDS]?De=ge.images[Ie[E.MSFT_TEXTURE_DDS].source]:De=ge.images[we.source];var Fe;return De.uri&&(Fe=ve.manager.getHandler(De.uri)),Fe||(Fe=Ie[E.MSFT_TEXTURE_DDS]?ie.extensions[E.MSFT_TEXTURE_DDS].ddsLoader:this.textureLoader),this.loadTextureImage(ne,De,Fe)},wt.prototype.loadTextureImage=function(ne,ie,ge){var ve=this,we=this.json,Ie=this.options,De=we.textures[ne],Fe=self.URL||self.webkitURL,Xe=ie.uri,at=!1,lt=!0;return ie.mimeType==="image/jpeg"&&(lt=!1),ie.bufferView!==void 0&&(Xe=ve.getDependency("bufferView",ie.bufferView).then(function(vt){if(ie.mimeType==="image/png"){var $=new DataView(vt,25,1).getUint8(0,!1);lt=$===6||$===4||$===3}at=!0;var U=new Blob([vt],{type:ie.mimeType});return Xe=Fe.createObjectURL(U),Xe})),Promise.resolve(Xe).then(function(vt){return new Promise(function($,U){var H=$;ge.isImageBitmapLoader===!0&&(H=function(ce){$(new THREE.CanvasTexture(ce))}),ge.load(ke(vt,Ie.path),H,void 0,U)})}).then(function(vt){at===!0&&Fe.revokeObjectURL(Xe),vt.flipY=!1,De.name&&(vt.name=De.name),lt||(vt.format=THREE.RGBFormat);var $=we.samplers||{},U=$[De.sampler]||{};return vt.magFilter=le[U.magFilter]||THREE.LinearFilter,vt.minFilter=le[U.minFilter]||THREE.LinearMipmapLinearFilter,vt.wrapS=j[U.wrapS]||THREE.RepeatWrapping,vt.wrapT=j[U.wrapT]||THREE.RepeatWrapping,ve.associations.set(vt,{type:"textures",index:ne}),vt})},wt.prototype.assignTexture=function(ne,ie,ge){var ve=this;return this.getDependency("texture",ge.index).then(function(we){if(ge.texCoord!==void 0&&ge.texCoord!=0&&!(ie==="aoMap"&&ge.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+ge.texCoord+" for texture "+ie+" not yet supported."),ve.extensions[E.KHR_TEXTURE_TRANSFORM]){var Ie=ge.extensions!==void 0?ge.extensions[E.KHR_TEXTURE_TRANSFORM]:void 0;if(Ie){var De=ve.associations.get(we);we=ve.extensions[E.KHR_TEXTURE_TRANSFORM].extendTexture(we,Ie),ve.associations.set(we,De)}}ne[ie]=we})},wt.prototype.assignFinalMaterial=function(ne){var ie=ne.geometry,ge=ne.material,ve=ie.attributes.tangent!==void 0,we=ie.attributes.color!==void 0,Ie=ie.attributes.normal===void 0,De=ne.isSkinnedMesh===!0,Fe=Object.keys(ie.morphAttributes).length>0,Xe=Fe&&ie.morphAttributes.normal!==void 0;if(ne.isPoints){var at="PointsMaterial:"+ge.uuid,lt=this.cache.get(at);lt||(lt=new THREE.PointsMaterial,THREE.Material.prototype.copy.call(lt,ge),lt.color.copy(ge.color),lt.map=ge.map,lt.sizeAttenuation=!1,this.cache.add(at,lt)),ge=lt}else if(ne.isLine){var at="LineBasicMaterial:"+ge.uuid,vt=this.cache.get(at);vt||(vt=new THREE.LineBasicMaterial,THREE.Material.prototype.copy.call(vt,ge),vt.color.copy(ge.color),this.cache.add(at,vt)),ge=vt}if(ve||we||Ie||De||Fe){var at="ClonedMaterial:"+ge.uuid+":";ge.isGLTFSpecularGlossinessMaterial&&(at+="specular-glossiness:"),De&&(at+="skinning:"),ve&&(at+="vertex-tangents:"),we&&(at+="vertex-colors:"),Ie&&(at+="flat-shading:"),Fe&&(at+="morph-targets:"),Xe&&(at+="morph-normals:");var $=this.cache.get(at);$||($=ge.clone(),De&&($.skinning=!0),we&&($.vertexColors=!0),Ie&&($.flatShading=!0),Fe&&($.morphTargets=!0),Xe&&($.morphNormals=!0),ve&&($.vertexTangents=!0,ge.normalScale&&(ge.normalScale.y*=-1),ge.clearcoatNormalScale&&(ge.clearcoatNormalScale.y*=-1)),this.cache.add(at,$),this.associations.set($,this.associations.get(ge))),ge=$}ge.aoMap&&ie.attributes.uv2===void 0&&ie.attributes.uv!==void 0&&ie.setAttribute("uv2",ie.attributes.uv),ne.material=ge},wt.prototype.getMaterialType=function(){return THREE.MeshStandardMaterial},wt.prototype.loadMaterial=function(ne){var ie=this,ge=this.json,ve=this.extensions,we=ge.materials[ne],Ie,De={},Fe=we.extensions||{},Xe=[];if(Fe[E.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var at=ve[E.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];Ie=at.getMaterialType(),Xe.push(at.extendParams(De,we,ie))}else if(Fe[E.KHR_MATERIALS_UNLIT]){var lt=ve[E.KHR_MATERIALS_UNLIT];Ie=lt.getMaterialType(),Xe.push(lt.extendParams(De,we,ie))}else{var vt=we.pbrMetallicRoughness||{};if(De.color=new THREE.Color(1,1,1),De.opacity=1,Array.isArray(vt.baseColorFactor)){var $=vt.baseColorFactor;De.color.fromArray($),De.opacity=$[3]}vt.baseColorTexture!==void 0&&Xe.push(ie.assignTexture(De,"map",vt.baseColorTexture)),De.metalness=vt.metallicFactor!==void 0?vt.metallicFactor:1,De.roughness=vt.roughnessFactor!==void 0?vt.roughnessFactor:1,vt.metallicRoughnessTexture!==void 0&&(Xe.push(ie.assignTexture(De,"metalnessMap",vt.metallicRoughnessTexture)),Xe.push(ie.assignTexture(De,"roughnessMap",vt.metallicRoughnessTexture))),Ie=this._invokeOne(function(H){return H.getMaterialType&&H.getMaterialType(ne)}),Xe.push(Promise.all(this._invokeAll(function(H){return H.extendMaterialParams&&H.extendMaterialParams(ne,De)})))}we.doubleSided===!0&&(De.side=THREE.DoubleSide);var U=we.alphaMode||We.OPAQUE;return U===We.BLEND?(De.transparent=!0,De.depthWrite=!1):(De.transparent=!1,U===We.MASK&&(De.alphaTest=we.alphaCutoff!==void 0?we.alphaCutoff:.5)),we.normalTexture!==void 0&&Ie!==THREE.MeshBasicMaterial&&(Xe.push(ie.assignTexture(De,"normalMap",we.normalTexture)),De.normalScale=new THREE.Vector2(1,-1),we.normalTexture.scale!==void 0&&De.normalScale.set(we.normalTexture.scale,-we.normalTexture.scale)),we.occlusionTexture!==void 0&&Ie!==THREE.MeshBasicMaterial&&(Xe.push(ie.assignTexture(De,"aoMap",we.occlusionTexture)),we.occlusionTexture.strength!==void 0&&(De.aoMapIntensity=we.occlusionTexture.strength)),we.emissiveFactor!==void 0&&Ie!==THREE.MeshBasicMaterial&&(De.emissive=new THREE.Color().fromArray(we.emissiveFactor)),we.emissiveTexture!==void 0&&Ie!==THREE.MeshBasicMaterial&&Xe.push(ie.assignTexture(De,"emissiveMap",we.emissiveTexture)),Promise.all(Xe).then(function(){var H;return Ie===N?H=ve[E.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(De):H=new Ie(De),we.name&&(H.name=we.name),H.map&&(H.map.encoding=THREE.sRGBEncoding),H.emissiveMap&&(H.emissiveMap.encoding=THREE.sRGBEncoding),At(H,we),ie.associations.set(H,{type:"materials",index:ne}),we.extensions&&rt(ve,H,we),H})},wt.prototype.createUniqueName=function(ne){for(var ie=THREE.PropertyBinding.sanitizeNodeName(ne||""),ge=ie,ve=1;this.nodeNamesUsed[ge];++ve)ge=ie+"_"+ve;return this.nodeNamesUsed[ge]=!0,ge};function kr(ne,ie,ge){var ve=ie.attributes,we=new THREE.Box3;if(ve.POSITION!==void 0){var Ie=ge.json.accessors[ve.POSITION],De=Ie.min,Fe=Ie.max;if(De!==void 0&&Fe!==void 0)we.set(new THREE.Vector3(De[0],De[1],De[2]),new THREE.Vector3(Fe[0],Fe[1],Fe[2]));else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;var Xe=ie.targets;if(Xe!==void 0){for(var at=new THREE.Vector3,lt=new THREE.Vector3,vt=0,$=Xe.length;vt<$;vt++){var U=Xe[vt];if(U.POSITION!==void 0){var Ie=ge.json.accessors[U.POSITION],De=Ie.min,Fe=Ie.max;De!==void 0&&Fe!==void 0?(lt.setX(Math.max(Math.abs(De[0]),Math.abs(Fe[0]))),lt.setY(Math.max(Math.abs(De[1]),Math.abs(Fe[1]))),lt.setZ(Math.max(Math.abs(De[2]),Math.abs(Fe[2]))),at.max(lt)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}we.expandByVector(at)}ne.boundingBox=we;var H=new THREE.Sphere;we.getCenter(H.center),H.radius=we.min.distanceTo(we.max)/2,ne.boundingSphere=H}function en(ne,ie,ge){var ve=ie.attributes,we=[];function Ie(at,lt){return ge.getDependency("accessor",at).then(function(vt){ne.setAttribute(lt,vt)})}for(var De in ve){var Fe=Z[De]||De.toLowerCase();Fe in ne.attributes||we.push(Ie(ve[De],Fe))}if(ie.indices!==void 0&&!ne.index){var Xe=ge.getDependency("accessor",ie.indices).then(function(at){ne.setIndex(at)});we.push(Xe)}return At(ne,ie),kr(ne,ie,ge),Promise.all(we).then(function(){return ie.targets!==void 0?St(ne,ie.targets,ge):ne})}function Nt(ne,ie){var ge=ne.getIndex();if(ge===null){var ve=[],we=ne.getAttribute("position");if(we!==void 0){for(var Ie=0;Ie<we.count;Ie++)ve.push(Ie);ne.setIndex(ve),ge=ne.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),ne}var De=ge.count-2,Fe=[];if(ie===THREE.TriangleFanDrawMode)for(var Ie=1;Ie<=De;Ie++)Fe.push(ge.getX(0)),Fe.push(ge.getX(Ie)),Fe.push(ge.getX(Ie+1));else for(var Ie=0;Ie<De;Ie++)Ie%2==0?(Fe.push(ge.getX(Ie)),Fe.push(ge.getX(Ie+1)),Fe.push(ge.getX(Ie+2))):(Fe.push(ge.getX(Ie+2)),Fe.push(ge.getX(Ie+1)),Fe.push(ge.getX(Ie)));Fe.length/3!==De&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var Xe=ne.clone();return Xe.setIndex(Fe),Xe}return wt.prototype.loadGeometries=function(ne){var ie=this,ge=this.extensions,ve=this.primitiveCache;function we($){return ge[E.KHR_DRACO_MESH_COMPRESSION].decodePrimitive($,ie).then(function(U){return en(U,$,ie)})}for(var Ie=[],De=0,Fe=ne.length;De<Fe;De++){var Xe=ne[De],at=er(Xe),lt=ve[at];if(lt)Ie.push(lt.promise);else{var vt;Xe.extensions&&Xe.extensions[E.KHR_DRACO_MESH_COMPRESSION]?vt=we(Xe):vt=en(new THREE.BufferGeometry,Xe,ie),ve[at]={primitive:Xe,promise:vt},Ie.push(vt)}}return Promise.all(Ie)},wt.prototype.loadMesh=function(ne){for(var ie=this,ge=this.json,ve=this.extensions,we=ge.meshes[ne],Ie=we.primitives,De=[],Fe=0,Xe=Ie.length;Fe<Xe;Fe++){var at=Ie[Fe].material===void 0?it(this.cache):this.getDependency("material",Ie[Fe].material);De.push(at)}return De.push(ie.loadGeometries(Ie)),Promise.all(De).then(function(lt){for(var vt=lt.slice(0,lt.length-1),$=lt[lt.length-1],U=[],H=0,ce=$.length;H<ce;H++){var Re=$[H],qe=Ie[H],$e,Rt=vt[H];if(qe.mode===te.TRIANGLES||qe.mode===te.TRIANGLE_STRIP||qe.mode===te.TRIANGLE_FAN||qe.mode===void 0)$e=we.isSkinnedMesh===!0?new THREE.SkinnedMesh(Re,Rt):new THREE.Mesh(Re,Rt),Rt.isMeshStandardMaterial===!0&&Rt.side===THREE.DoubleSide&&Re.getIndex()!==null&&Re.hasAttribute("position")===!0&&Re.hasAttribute("normal")===!0&&Re.hasAttribute("uv")===!0&&Re.hasAttribute("tangent")===!1&&(Re.computeTangents(),Rt.vertexTangents=!0),$e.isSkinnedMesh===!0&&!$e.geometry.attributes.skinWeight.normalized&&$e.normalizeSkinWeights(),qe.mode===te.TRIANGLE_STRIP?$e.geometry=Nt($e.geometry,THREE.TriangleStripDrawMode):qe.mode===te.TRIANGLE_FAN&&($e.geometry=Nt($e.geometry,THREE.TriangleFanDrawMode));else if(qe.mode===te.LINES)$e=new THREE.LineSegments(Re,Rt);else if(qe.mode===te.LINE_STRIP)$e=new THREE.Line(Re,Rt);else if(qe.mode===te.LINE_LOOP)$e=new THREE.LineLoop(Re,Rt);else if(qe.mode===te.POINTS)$e=new THREE.Points(Re,Rt);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+qe.mode);Object.keys($e.geometry.morphAttributes).length>0&&Gt($e,we),$e.name=ie.createUniqueName(we.name||"mesh_"+ne),At($e,we),qe.extensions&&rt(ve,$e,qe),ie.assignFinalMaterial($e),U.push($e)}if(U.length===1)return U[0];for(var Qt=new THREE.Group,H=0,ce=U.length;H<ce;H++)Qt.add(U[H]);return Qt})},wt.prototype.loadCamera=function(ne){var ie,ge=this.json.cameras[ne],ve=ge[ge.type];if(!ve){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return ge.type==="perspective"?ie=new THREE.PerspectiveCamera(THREE.MathUtils.radToDeg(ve.yfov),ve.aspectRatio||1,ve.znear||1,ve.zfar||2e6):ge.type==="orthographic"&&(ie=new THREE.OrthographicCamera(-ve.xmag,ve.xmag,ve.ymag,-ve.ymag,ve.znear,ve.zfar)),ge.name&&(ie.name=this.createUniqueName(ge.name)),At(ie,ge),Promise.resolve(ie)},wt.prototype.loadSkin=function(ne){var ie=this.json.skins[ne],ge={joints:ie.joints};return ie.inverseBindMatrices===void 0?Promise.resolve(ge):this.getDependency("accessor",ie.inverseBindMatrices).then(function(ve){return ge.inverseBindMatrices=ve,ge})},wt.prototype.loadAnimation=function(ne){for(var ie=this.json,ge=ie.animations[ne],ve=[],we=[],Ie=[],De=[],Fe=[],Xe=0,at=ge.channels.length;Xe<at;Xe++){var lt=ge.channels[Xe],vt=ge.samplers[lt.sampler],$=lt.target,U=$.node!==void 0?$.node:$.id,H=ge.parameters!==void 0?ge.parameters[vt.input]:vt.input,ce=ge.parameters!==void 0?ge.parameters[vt.output]:vt.output;ve.push(this.getDependency("node",U)),we.push(this.getDependency("accessor",H)),Ie.push(this.getDependency("accessor",ce)),De.push(vt),Fe.push($)}return Promise.all([Promise.all(ve),Promise.all(we),Promise.all(Ie),Promise.all(De),Promise.all(Fe)]).then(function(Re){for(var qe=Re[0],$e=Re[1],Rt=Re[2],Qt=Re[3],Ar=Re[4],Pr=[],Vt=0,jr=qe.length;Vt<jr;Vt++){var ar=qe[Vt],hn=$e[Vt],Rn=Rt[Vt],dn=Qt[Vt],ot=Ar[Vt];if(ar!==void 0){ar.updateMatrix(),ar.matrixAutoUpdate=!0;var nt;switch(ye[ot.path]){case ye.weights:nt=THREE.NumberKeyframeTrack;break;case ye.rotation:nt=THREE.QuaternionKeyframeTrack;break;case ye.position:case ye.scale:default:nt=THREE.VectorKeyframeTrack;break}var yt=ar.name?ar.name:ar.uuid,Jt=dn.interpolation!==void 0?Ne[dn.interpolation]:THREE.InterpolateLinear,tr=[];ye[ot.path]===ye.weights?ar.traverse(function(Ur){Ur.isMesh===!0&&Ur.morphTargetInfluences&&tr.push(Ur.name?Ur.name:Ur.uuid)}):tr.push(yt);var ur=Rn.array;if(Rn.normalized){var ir;if(ur.constructor===Int8Array)ir=1/127;else if(ur.constructor===Uint8Array)ir=1/255;else if(ur.constructor==Int16Array)ir=1/32767;else if(ur.constructor===Uint16Array)ir=1/65535;else throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");for(var xr=new Float32Array(ur.length),Xr=0,Dr=ur.length;Xr<Dr;Xr++)xr[Xr]=ur[Xr]*ir;ur=xr}for(var Xr=0,Dr=tr.length;Xr<Dr;Xr++){var Nn=new nt(tr[Xr]+"."+ye[ot.path],hn.array,ur,Jt);dn.interpolation==="CUBICSPLINE"&&(Nn.createInterpolant=function(qn){return new Y(this.times,this.values,this.getValueSize()/3,qn)},Nn.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),Pr.push(Nn)}}}var Yr=ge.name?ge.name:"animation_"+ne;return new THREE.AnimationClip(Yr,void 0,Pr)})},wt.prototype.loadNode=function(ne){var ie=this.json,ge=this.extensions,ve=this,we=ie.nodes[ne],Ie=we.name?ve.createUniqueName(we.name):"";return function(){var De=[];return we.mesh!==void 0&&De.push(ve.getDependency("mesh",we.mesh).then(function(Fe){var Xe=ve._getNodeRef(ve.meshCache,we.mesh,Fe);return we.weights!==void 0&&Xe.traverse(function(at){if(!!at.isMesh)for(var lt=0,vt=we.weights.length;lt<vt;lt++)at.morphTargetInfluences[lt]=we.weights[lt]}),Xe})),we.camera!==void 0&&De.push(ve.getDependency("camera",we.camera).then(function(Fe){return ve._getNodeRef(ve.cameraCache,we.camera,Fe)})),ve._invokeAll(function(Fe){return Fe.createNodeAttachment&&Fe.createNodeAttachment(ne)}).forEach(function(Fe){De.push(Fe)}),Promise.all(De)}().then(function(De){var Fe;if(we.isBone===!0?Fe=new THREE.Bone:De.length>1?Fe=new THREE.Group:De.length===1?Fe=De[0]:Fe=new THREE.Object3D,Fe!==De[0])for(var Xe=0,at=De.length;Xe<at;Xe++)Fe.add(De[Xe]);if(we.name&&(Fe.userData.name=we.name,Fe.name=Ie),At(Fe,we),we.extensions&&rt(ge,Fe,we),we.matrix!==void 0){var lt=new THREE.Matrix4;lt.fromArray(we.matrix),Fe.applyMatrix4(lt)}else we.translation!==void 0&&Fe.position.fromArray(we.translation),we.rotation!==void 0&&Fe.quaternion.fromArray(we.rotation),we.scale!==void 0&&Fe.scale.fromArray(we.scale);return ve.associations.set(Fe,{type:"nodes",index:ne}),Fe})},wt.prototype.loadScene=function(){function ne(ie,ge,ve,we){var Ie=ve.nodes[ie];return we.getDependency("node",ie).then(function(De){if(Ie.skin===void 0)return De;var Fe;return we.getDependency("skin",Ie.skin).then(function(Xe){Fe=Xe;for(var at=[],lt=0,vt=Fe.joints.length;lt<vt;lt++)at.push(we.getDependency("node",Fe.joints[lt]));return Promise.all(at)}).then(function(Xe){return De.traverse(function(at){if(!!at.isMesh){for(var lt=[],vt=[],$=0,U=Xe.length;$<U;$++){var H=Xe[$];if(H){lt.push(H);var ce=new THREE.Matrix4;Fe.inverseBindMatrices!==void 0&&ce.fromArray(Fe.inverseBindMatrices.array,$*16),vt.push(ce)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',Fe.joints[$])}at.bind(new THREE.Skeleton(lt,vt),at.matrixWorld)}}),De})}).then(function(De){ge.add(De);var Fe=[];if(Ie.children)for(var Xe=Ie.children,at=0,lt=Xe.length;at<lt;at++){var vt=Xe[at];Fe.push(ne(vt,De,ve,we))}return Promise.all(Fe)})}return function(ge){var ve=this.json,we=this.extensions,Ie=this.json.scenes[ge],De=this,Fe=new THREE.Group;Ie.name&&(Fe.name=De.createUniqueName(Ie.name)),At(Fe,Ie),Ie.extensions&&rt(we,Fe,Ie);for(var Xe=Ie.nodes||[],at=[],lt=0,vt=Xe.length;lt<vt;lt++)at.push(ne(Xe[lt],Fe,ve,De));return Promise.all(at).then(function(){return Fe})}}(),u}()},{}],60:[function(_,G,fe){THREE.MTLLoader=function(u){THREE.Loader.call(this,u)},THREE.MTLLoader.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:THREE.MTLLoader,load:function(u,A,E,w){var h=this,v=this.path===""?THREE.LoaderUtils.extractUrlBase(u):this.path,d=new THREE.FileLoader(this.manager);d.setPath(this.path),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(u,function(m){try{A(h.parse(m,v))}catch(f){w?w(f):console.error(f),h.manager.itemError(u)}},E,w)},setMaterialOptions:function(u){return this.materialOptions=u,this},parse:function(u,A){for(var E=u.split(`
`),w={},h=/\s+/,v={},d=0;d<E.length;d++){var m=E[d];if(m=m.trim(),!(m.length===0||m.charAt(0)==="#")){var f=m.indexOf(" "),b=f>=0?m.substring(0,f):m;b=b.toLowerCase();var g=f>=0?m.substring(f+1):"";if(g=g.trim(),b==="newmtl")w={name:g},v[g]=w;else if(b==="ka"||b==="kd"||b==="ks"||b==="ke"){var y=g.split(h,3);w[b]=[parseFloat(y[0]),parseFloat(y[1]),parseFloat(y[2])]}else w[b]=g}}var x=new THREE.MTLLoader.MaterialCreator(this.resourcePath||A,this.materialOptions);return x.setCrossOrigin(this.crossOrigin),x.setManager(this.manager),x.setMaterials(v),x}}),THREE.MTLLoader.MaterialCreator=function(u,A){this.baseUrl=u||"",this.options=A,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping},THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(u){return this.crossOrigin=u,this},setManager:function(u){this.manager=u},setMaterials:function(u){this.materialsInfo=this.convert(u),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(u){if(!this.options)return u;var A={};for(var E in u){var w=u[E],h={};A[E]=h;for(var v in w){var d=!0,m=w[v],f=v.toLowerCase();switch(f){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(m=[m[0]/255,m[1]/255,m[2]/255]),this.options&&this.options.ignoreZeroRGBs&&m[0]===0&&m[1]===0&&m[2]===0&&(d=!1);break}d&&(h[f]=m)}}return A},preload:function(){for(var u in this.materialsInfo)this.create(u)},getIndex:function(u){return this.nameLookup[u]},getAsArray:function(){var u=0;for(var A in this.materialsInfo)this.materialsArray[u]=this.create(A),this.nameLookup[A]=u,u++;return this.materialsArray},create:function(u){return this.materials[u]===void 0&&this.createMaterial_(u),this.materials[u]},createMaterial_:function(u){var A=this,E=this.materialsInfo[u],w={name:u,side:this.side};function h(b,g){return typeof g!="string"||g===""?"":/^https?:\/\//i.test(g)?g:b+g}function v(b,g){if(!w[b]){var y=A.getTextureParams(g,w),x=A.loadTexture(h(A.baseUrl,y.url));x.repeat.copy(y.scale),x.offset.copy(y.offset),x.wrapS=A.wrap,x.wrapT=A.wrap,w[b]=x}}for(var d in E){var m=E[d],f;if(m!=="")switch(d.toLowerCase()){case"kd":w.color=new THREE.Color().fromArray(m);break;case"ks":w.specular=new THREE.Color().fromArray(m);break;case"ke":w.emissive=new THREE.Color().fromArray(m);break;case"map_kd":v("map",m);break;case"map_ks":v("specularMap",m);break;case"map_ke":v("emissiveMap",m);break;case"norm":v("normalMap",m);break;case"map_bump":case"bump":v("bumpMap",m);break;case"map_d":v("alphaMap",m),w.transparent=!0;break;case"ns":w.shininess=parseFloat(m);break;case"d":f=parseFloat(m),f<1&&(w.opacity=f,w.transparent=!0);break;case"tr":f=parseFloat(m),this.options&&this.options.invertTrProperty&&(f=1-f),f>0&&(w.opacity=1-f,w.transparent=!0);break}}return this.materials[u]=new THREE.MeshPhongMaterial(w),this.materials[u]},getTextureParams:function(u,A){var E={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)},w=u.split(/\s+/),h;return h=w.indexOf("-bm"),h>=0&&(A.bumpScale=parseFloat(w[h+1]),w.splice(h,2)),h=w.indexOf("-s"),h>=0&&(E.scale.set(parseFloat(w[h+1]),parseFloat(w[h+2])),w.splice(h,4)),h=w.indexOf("-o"),h>=0&&(E.offset.set(parseFloat(w[h+1]),parseFloat(w[h+2])),w.splice(h,4)),E.url=w.join(" ").trim(),E},loadTexture:function(u,A,E,w,h){var v,d=this.manager!==void 0?this.manager:THREE.DefaultLoadingManager,m=d.getHandler(u);return m===null&&(m=new THREE.TextureLoader(d)),m.setCrossOrigin&&m.setCrossOrigin(this.crossOrigin),v=m.load(u,E,w,h),A!==void 0&&(v.mapping=A),v}}},{}],61:[function(_,G,fe){THREE.OBJLoader=function(){var u=/^[og]\s*(.+)?/,A=/^mtllib /,E=/^usemtl /,w=/^usemap /,h=new THREE.Vector3,v=new THREE.Vector3,d=new THREE.Vector3,m=new THREE.Vector3,f=new THREE.Vector3;function b(){var y={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(x,L){if(this.object&&this.object.fromDeclaration===!1){this.object.name=x,this.object.fromDeclaration=L!==!1;return}var M=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:x||"",fromDeclaration:L!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(D,N){var z=this._finalize(!1);z&&(z.inherited||z.groupCount<=0)&&this.materials.splice(z.index,1);var re={index:this.materials.length,name:D||"",mtllib:Array.isArray(N)&&N.length>0?N[N.length-1]:"",smooth:z!==void 0?z.smooth:this.smooth,groupStart:z!==void 0?z.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(Y){var te={index:typeof Y=="number"?Y:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return te.clone=this.clone.bind(te),te}};return this.materials.push(re),re},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(D){var N=this.currentMaterial();if(N&&N.groupEnd===-1&&(N.groupEnd=this.geometry.vertices.length/3,N.groupCount=N.groupEnd-N.groupStart,N.inherited=!1),D&&this.materials.length>1)for(var z=this.materials.length-1;z>=0;z--)this.materials[z].groupCount<=0&&this.materials.splice(z,1);return D&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),N}},M&&M.name&&typeof M.clone=="function"){var R=M.clone(0);R.inherited=!0,this.object.materials.push(R)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(x,L){var M=parseInt(x,10);return(M>=0?M-1:M+L/3)*3},parseNormalIndex:function(x,L){var M=parseInt(x,10);return(M>=0?M-1:M+L/3)*3},parseUVIndex:function(x,L){var M=parseInt(x,10);return(M>=0?M-1:M+L/2)*2},addVertex:function(x,L,M){var R=this.vertices,D=this.object.geometry.vertices;D.push(R[x+0],R[x+1],R[x+2]),D.push(R[L+0],R[L+1],R[L+2]),D.push(R[M+0],R[M+1],R[M+2])},addVertexPoint:function(x){var L=this.vertices,M=this.object.geometry.vertices;M.push(L[x+0],L[x+1],L[x+2])},addVertexLine:function(x){var L=this.vertices,M=this.object.geometry.vertices;M.push(L[x+0],L[x+1],L[x+2])},addNormal:function(x,L,M){var R=this.normals,D=this.object.geometry.normals;D.push(R[x+0],R[x+1],R[x+2]),D.push(R[L+0],R[L+1],R[L+2]),D.push(R[M+0],R[M+1],R[M+2])},addFaceNormal:function(x,L,M){var R=this.vertices,D=this.object.geometry.normals;h.fromArray(R,x),v.fromArray(R,L),d.fromArray(R,M),f.subVectors(d,v),m.subVectors(h,v),f.cross(m),f.normalize(),D.push(f.x,f.y,f.z),D.push(f.x,f.y,f.z),D.push(f.x,f.y,f.z)},addColor:function(x,L,M){var R=this.colors,D=this.object.geometry.colors;R[x]!==void 0&&D.push(R[x+0],R[x+1],R[x+2]),R[L]!==void 0&&D.push(R[L+0],R[L+1],R[L+2]),R[M]!==void 0&&D.push(R[M+0],R[M+1],R[M+2])},addUV:function(x,L,M){var R=this.uvs,D=this.object.geometry.uvs;D.push(R[x+0],R[x+1]),D.push(R[L+0],R[L+1]),D.push(R[M+0],R[M+1])},addDefaultUV:function(){var x=this.object.geometry.uvs;x.push(0,0),x.push(0,0),x.push(0,0)},addUVLine:function(x){var L=this.uvs,M=this.object.geometry.uvs;M.push(L[x+0],L[x+1])},addFace:function(x,L,M,R,D,N,z,re,Y){var te=this.vertices.length,J=this.parseVertexIndex(x,te),le=this.parseVertexIndex(L,te),j=this.parseVertexIndex(M,te);if(this.addVertex(J,le,j),this.addColor(J,le,j),z!==void 0&&z!==""){var ae=this.normals.length;J=this.parseNormalIndex(z,ae),le=this.parseNormalIndex(re,ae),j=this.parseNormalIndex(Y,ae),this.addNormal(J,le,j)}else this.addFaceNormal(J,le,j);if(R!==void 0&&R!==""){var Z=this.uvs.length;J=this.parseUVIndex(R,Z),le=this.parseUVIndex(D,Z),j=this.parseUVIndex(N,Z),this.addUV(J,le,j),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(x){this.object.geometry.type="Points";for(var L=this.vertices.length,M=0,R=x.length;M<R;M++){var D=this.parseVertexIndex(x[M],L);this.addVertexPoint(D),this.addColor(D)}},addLineGeometry:function(x,L){this.object.geometry.type="Line";for(var M=this.vertices.length,R=this.uvs.length,D=0,N=x.length;D<N;D++)this.addVertexLine(this.parseVertexIndex(x[D],M));for(var z=0,N=L.length;z<N;z++)this.addUVLine(this.parseUVIndex(L[z],R))}};return y.startObject("",!1),y}function g(y){THREE.Loader.call(this,y),this.materials=null}return g.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:g,load:function(y,x,L,M){var R=this,D=new THREE.FileLoader(this.manager);D.setPath(this.path),D.setRequestHeader(this.requestHeader),D.setWithCredentials(this.withCredentials),D.load(y,function(N){try{x(R.parse(N))}catch(z){M?M(z):console.error(z),R.manager.itemError(y)}},L,M)},setMaterials:function(y){return this.materials=y,this},parse:function(y){var x=new b;y.indexOf(`\r
`)!==-1&&(y=y.replace(/\r\n/g,`
`)),y.indexOf(`\\
`)!==-1&&(y=y.replace(/\\\n/g,""));for(var L=y.split(`
`),M="",R="",D=0,N=[],z=typeof"".trimLeft=="function",re=0,Y=L.length;re<Y;re++)if(M=L[re],M=z?M.trimLeft():M.trim(),D=M.length,D!==0&&(R=M.charAt(0),R!=="#"))if(R==="v"){var te=M.split(/\s+/);switch(te[0]){case"v":x.vertices.push(parseFloat(te[1]),parseFloat(te[2]),parseFloat(te[3])),te.length>=7?x.colors.push(parseFloat(te[4]),parseFloat(te[5]),parseFloat(te[6])):x.colors.push(void 0,void 0,void 0);break;case"vn":x.normals.push(parseFloat(te[1]),parseFloat(te[2]),parseFloat(te[3]));break;case"vt":x.uvs.push(parseFloat(te[1]),parseFloat(te[2]));break}}else if(R==="f"){for(var J=M.substr(1).trim(),le=J.split(/\s+/),j=[],ae=0,Z=le.length;ae<Z;ae++){var ye=le[ae];if(ye.length>0){var Ne=ye.split("/");j.push(Ne)}}for(var We=j[0],ae=1,Z=j.length-1;ae<Z;ae++){var ke=j[ae],it=j[ae+1];x.addFace(We[0],ke[0],it[0],We[1],ke[1],it[1],We[2],ke[2],it[2])}}else if(R==="l"){var rt=M.substring(1).trim().split(" "),At=[],St=[];if(M.indexOf("/")===-1)At=rt;else for(var Gt=0,er=rt.length;Gt<er;Gt++){var zt=rt[Gt].split("/");zt[0]!==""&&At.push(zt[0]),zt[1]!==""&&St.push(zt[1])}x.addLineGeometry(At,St)}else if(R==="p"){var J=M.substr(1).trim(),wt=J.split(" ");x.addPointGeometry(wt)}else if((N=u.exec(M))!==null){var kr=(" "+N[0].substr(1).trim()).substr(1);x.startObject(kr)}else if(E.test(M))x.object.startMaterial(M.substring(7).trim(),x.materialLibraries);else if(A.test(M))x.materialLibraries.push(M.substring(7).trim());else if(w.test(M))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(R==="s"){if(N=M.split(" "),N.length>1){var en=N[1].trim().toLowerCase();x.object.smooth=en!=="0"&&en!=="off"}else x.object.smooth=!0;var Nt=x.object.currentMaterial();Nt&&(Nt.smooth=x.object.smooth)}else{if(M==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+M+'"')}x.finalize();var ne=new THREE.Group;ne.materialLibraries=[].concat(x.materialLibraries);var ie=!(x.objects.length===1&&x.objects[0].geometry.vertices.length===0);if(ie===!0)for(var re=0,Y=x.objects.length;re<Y;re++){var ge=x.objects[re],ve=ge.geometry,we=ge.materials,Ie=ve.type==="Line",De=ve.type==="Points",Fe=!1;if(ve.vertices.length!==0){var Xe=new THREE.BufferGeometry;Xe.setAttribute("position",new THREE.Float32BufferAttribute(ve.vertices,3)),ve.normals.length>0&&Xe.setAttribute("normal",new THREE.Float32BufferAttribute(ve.normals,3)),ve.colors.length>0&&(Fe=!0,Xe.setAttribute("color",new THREE.Float32BufferAttribute(ve.colors,3))),ve.hasUVIndices===!0&&Xe.setAttribute("uv",new THREE.Float32BufferAttribute(ve.uvs,2));for(var at=[],lt=0,vt=we.length;lt<vt;lt++){var $=we[lt],U=$.name+"_"+$.smooth+"_"+Fe,Nt=x.materials[U];if(this.materials!==null){if(Nt=this.materials.create($.name),Ie&&Nt&&!(Nt instanceof THREE.LineBasicMaterial)){var H=new THREE.LineBasicMaterial;THREE.Material.prototype.copy.call(H,Nt),H.color.copy(Nt.color),Nt=H}else if(De&&Nt&&!(Nt instanceof THREE.PointsMaterial)){var ce=new THREE.PointsMaterial({size:10,sizeAttenuation:!1});THREE.Material.prototype.copy.call(ce,Nt),ce.color.copy(Nt.color),ce.map=Nt.map,Nt=ce}}Nt===void 0&&(Ie?Nt=new THREE.LineBasicMaterial:De?Nt=new THREE.PointsMaterial({size:1,sizeAttenuation:!1}):Nt=new THREE.MeshPhongMaterial,Nt.name=$.name,Nt.flatShading=!$.smooth,Nt.vertexColors=Fe,x.materials[U]=Nt),at.push(Nt)}var Re;if(at.length>1){for(var lt=0,vt=we.length;lt<vt;lt++){var $=we[lt];Xe.addGroup($.groupStart,$.groupCount,lt)}Ie?Re=new THREE.LineSegments(Xe,at):De?Re=new THREE.Points(Xe,at):Re=new THREE.Mesh(Xe,at)}else Ie?Re=new THREE.LineSegments(Xe,at[0]):De?Re=new THREE.Points(Xe,at[0]):Re=new THREE.Mesh(Xe,at[0]);Re.name=ge.name,ne.add(Re)}}else if(x.vertices.length>0){var Nt=new THREE.PointsMaterial({size:1,sizeAttenuation:!1}),Xe=new THREE.BufferGeometry;Xe.setAttribute("position",new THREE.Float32BufferAttribute(x.vertices,3)),x.colors.length>0&&x.colors[0]!==void 0&&(Xe.setAttribute("color",new THREE.Float32BufferAttribute(x.colors,3)),Nt.vertexColors=!0);var qe=new THREE.Points(Xe,Nt);ne.add(qe)}return ne}}),g}()},{}],62:[function(_,G,fe){THREE.BufferGeometryUtils={computeTangents:function(u){u.computeTangents(),console.warn("THREE.BufferGeometryUtils: .computeTangents() has been removed. Use BufferGeometry.computeTangents() instead.")},mergeBufferGeometries:function(u,A){for(var E=u[0].index!==null,w=new Set(Object.keys(u[0].attributes)),h=new Set(Object.keys(u[0].morphAttributes)),v={},d={},m=u[0].morphTargetsRelative,f=new THREE.BufferGeometry,b=0,g=0;g<u.length;++g){var y=u[g],x=0;if(E!==(y.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+g+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(var L in y.attributes){if(!w.has(L))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+g+'. All geometries must have compatible attributes; make sure "'+L+'" attribute exists among all geometries, or in none of them.'),null;v[L]===void 0&&(v[L]=[]),v[L].push(y.attributes[L]),x++}if(x!==w.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+g+". Make sure all geometries have the same number of attributes."),null;if(m!==y.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+g+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(var L in y.morphAttributes){if(!h.has(L))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+g+".  .morphAttributes must be consistent throughout all geometries."),null;d[L]===void 0&&(d[L]=[]),d[L].push(y.morphAttributes[L])}if(f.userData.mergedUserData=f.userData.mergedUserData||[],f.userData.mergedUserData.push(y.userData),A){var M;if(E)M=y.index.count;else if(y.attributes.position!==void 0)M=y.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+g+". The geometry must have either an index or a position attribute"),null;f.addGroup(b,M,g),b+=M}}if(E){for(var R=0,D=[],g=0;g<u.length;++g){for(var N=u[g].index,z=0;z<N.count;++z)D.push(N.getX(z)+R);R+=u[g].attributes.position.count}f.setIndex(D)}for(var L in v){var re=this.mergeBufferAttributes(v[L]);if(!re)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+L+" attribute."),null;f.setAttribute(L,re)}for(var L in d){var Y=d[L][0].length;if(Y===0)break;f.morphAttributes=f.morphAttributes||{},f.morphAttributes[L]=[];for(var g=0;g<Y;++g){for(var te=[],z=0;z<d[L].length;++z)te.push(d[L][z][g]);var J=this.mergeBufferAttributes(te);if(!J)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+L+" morphAttribute."),null;f.morphAttributes[L].push(J)}}return f},mergeBufferAttributes:function(u){for(var A,E,w,h=0,v=0;v<u.length;++v){var d=u[v];if(d.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(A===void 0&&(A=d.array.constructor),A!==d.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(E===void 0&&(E=d.itemSize),E!==d.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(w===void 0&&(w=d.normalized),w!==d.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;h+=d.array.length}for(var m=new A(h),f=0,v=0;v<u.length;++v)m.set(u[v].array,f),f+=u[v].array.length;return new THREE.BufferAttribute(m,E,w)},interleaveAttributes:function(u){for(var A,E=0,w=0,h=0,v=u.length;h<v;++h){var d=u[h];if(A===void 0&&(A=d.array.constructor),A!==d.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;E+=d.array.length,w+=d.itemSize}for(var m=new THREE.InterleavedBuffer(new A(E),w),f=0,b=[],g=["getX","getY","getZ","getW"],y=["setX","setY","setZ","setW"],x=0,v=u.length;x<v;x++){var d=u[x],L=d.itemSize,M=d.count,R=new THREE.InterleavedBufferAttribute(m,L,f,d.normalized);b.push(R),f+=L;for(var D=0;D<M;D++)for(var N=0;N<L;N++)R[y[N]](D,d[g[N]](D))}return b},estimateBytesUsed:function(u){var A=0;for(var E in u.attributes){var w=u.getAttribute(E);A+=w.count*w.itemSize*w.array.BYTES_PER_ELEMENT}var h=u.getIndex();return A+=h?h.count*h.itemSize*h.array.BYTES_PER_ELEMENT:0,A},mergeVertices:function(u,A=1e-4){A=Math.max(A,Number.EPSILON);for(var E={},w=u.getIndex(),h=u.getAttribute("position"),v=w?w.count:h.count,d=0,m=Object.keys(u.attributes),f={},b={},g=[],y=["getX","getY","getZ","getW"],x=0,L=m.length;x<L;x++){var M=m[x];f[M]=[];var R=u.morphAttributes[M];R&&(b[M]=new Array(R.length).fill().map(()=>[]))}for(var D=Math.log10(1/A),N=Math.pow(10,D),x=0;x<v;x++){for(var z=w?w.getX(x):x,re="",Y=0,L=m.length;Y<L;Y++)for(var M=m[Y],te=u.getAttribute(M),J=te.itemSize,le=0;le<J;le++)re+=`${~~(te[y[le]](z)*N)},`;if(re in E)g.push(E[re]);else{for(var Y=0,L=m.length;Y<L;Y++)for(var M=m[Y],te=u.getAttribute(M),R=u.morphAttributes[M],J=te.itemSize,j=f[M],ae=b[M],le=0;le<J;le++){var Z=y[le];if(j.push(te[Z](z)),R)for(var ye=0,Ne=R.length;ye<Ne;ye++)ae[ye].push(R[ye][Z](z))}E[re]=d,g.push(d),d++}}const We=u.clone();for(var x=0,L=m.length;x<L;x++){var M=m[x],ke=u.getAttribute(M),it=new ke.array.constructor(f[M]),te=new THREE.BufferAttribute(it,ke.itemSize,ke.normalized);if(We.setAttribute(M,te),M in b)for(var Y=0;Y<b[M].length;Y++){var rt=u.morphAttributes[M][Y],it=new rt.array.constructor(b[M][Y]),At=new THREE.BufferAttribute(it,rt.itemSize,rt.normalized);We.morphAttributes[M][Y]=At}}return We.setIndex(g),We},toTrianglesDrawMode:function(u,A){if(A===THREE.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),u;if(A===THREE.TriangleFanDrawMode||A===THREE.TriangleStripDrawMode){var E=u.getIndex();if(E===null){var w=[],h=u.getAttribute("position");if(h!==void 0){for(var v=0;v<h.count;v++)w.push(v);u.setIndex(w),E=u.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),u}var d=E.count-2,m=[];if(A===THREE.TriangleFanDrawMode)for(var v=1;v<=d;v++)m.push(E.getX(0)),m.push(E.getX(v)),m.push(E.getX(v+1));else for(var v=0;v<d;v++)v%2==0?(m.push(E.getX(v)),m.push(E.getX(v+1)),m.push(E.getX(v+2))):(m.push(E.getX(v+2)),m.push(E.getX(v+1)),m.push(E.getX(v)));m.length/3!==d&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var f=u.clone();return f.setIndex(m),f.clearGroups(),f}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",A),u},computeMorphedAttributes:function(u){if(u.geometry.isBufferGeometry!==!0)return console.error("THREE.BufferGeometryUtils: Geometry is not of type THREE.BufferGeometry."),null;var A=new THREE.Vector3,E=new THREE.Vector3,w=new THREE.Vector3,h=new THREE.Vector3,v=new THREE.Vector3,d=new THREE.Vector3,m=new THREE.Vector3,f=new THREE.Vector3,b=new THREE.Vector3;function g(er,zt,wt,kr,en,Nt,ne,ie,ge){A.fromBufferAttribute(wt,Nt),E.fromBufferAttribute(wt,ne),w.fromBufferAttribute(wt,ie);var ve=er.morphTargetInfluences;if(zt.morphTargets&&kr&&ve){m.set(0,0,0),f.set(0,0,0),b.set(0,0,0);for(var we=0,Ie=kr.length;we<Ie;we++){var De=ve[we],kr=kr[we];De!==0&&(h.fromBufferAttribute(kr,Nt),v.fromBufferAttribute(kr,ne),d.fromBufferAttribute(kr,ie),en?(m.addScaledVector(h,De),f.addScaledVector(v,De),b.addScaledVector(d,De)):(m.addScaledVector(h.sub(A),De),f.addScaledVector(v.sub(E),De),b.addScaledVector(d.sub(w),De)))}A.add(m),E.add(f),w.add(b)}er.isSkinnedMesh&&(er.boneTransform(Nt,A),er.boneTransform(ne,E),er.boneTransform(ie,w)),ge[Nt*3+0]=A.x,ge[Nt*3+1]=A.y,ge[Nt*3+2]=A.z,ge[ne*3+0]=E.x,ge[ne*3+1]=E.y,ge[ne*3+2]=E.z,ge[ie*3+0]=w.x,ge[ie*3+1]=w.y,ge[ie*3+2]=w.z}var y=u.geometry,x=u.material,L,M,R,D=y.index,N=y.attributes.position,z=y.morphAttributes.position,re=y.morphTargetsRelative,Y=y.attributes.normal,te=y.morphAttributes.position,J=y.groups,le=y.drawRange,j,ae,Z,ye,Ne,We,ke,it,rt=new Float32Array(N.count*N.itemSize),At=new Float32Array(Y.count*Y.itemSize);if(D!==null)if(Array.isArray(x))for(j=0,Z=J.length;j<Z;j++)for(Ne=J[j],We=x[Ne.materialIndex],ke=Math.max(Ne.start,le.start),it=Math.min(Ne.start+Ne.count,le.start+le.count),ae=ke,ye=it;ae<ye;ae+=3)L=D.getX(ae),M=D.getX(ae+1),R=D.getX(ae+2),g(u,We,N,z,re,L,M,R,rt),g(u,We,Y,te,re,L,M,R,At);else for(ke=Math.max(0,le.start),it=Math.min(D.count,le.start+le.count),j=ke,Z=it;j<Z;j+=3)L=D.getX(j),M=D.getX(j+1),R=D.getX(j+2),g(u,x,N,z,re,L,M,R,rt),g(u,x,Y,te,re,L,M,R,At);else if(N!==void 0)if(Array.isArray(x))for(j=0,Z=J.length;j<Z;j++)for(Ne=J[j],We=x[Ne.materialIndex],ke=Math.max(Ne.start,le.start),it=Math.min(Ne.start+Ne.count,le.start+le.count),ae=ke,ye=it;ae<ye;ae+=3)L=ae,M=ae+1,R=ae+2,g(u,We,N,z,re,L,M,R,rt),g(u,We,Y,te,re,L,M,R,At);else for(ke=Math.max(0,le.start),it=Math.min(N.count,le.start+le.count),j=ke,Z=it;j<Z;j+=3)L=j,M=j+1,R=j+2,g(u,x,N,z,re,L,M,R,rt),g(u,x,Y,te,re,L,M,R,At);var St=new THREE.Float32BufferAttribute(rt,3),Gt=new THREE.Float32BufferAttribute(At,3);return{positionAttribute:N,normalAttribute:Y,morphedPositionAttribute:St,morphedNormalAttribute:Gt}}}},{}],63:[function(_,G,fe){var u=_("layout-bmfont-text"),A=_("inherits"),E=_("quad-indices"),w=_("three-buffer-vertex-data"),h=_("object-assign"),v=_("./lib/vertices"),d=_("./lib/utils"),m=THREE.BufferGeometry;G.exports=function(g){return new f(g)};function f(b){m.call(this),typeof b=="string"&&(b={text:b}),this._opt=h({},b),b&&this.update(b)}A(f,m),f.prototype.update=function(b){if(typeof b=="string"&&(b={text:b}),b=h({},this._opt,b),!b.font)throw new TypeError("must specify a { font } in options");this.layout=u(b);var g=b.flipY!==!1,y=b.font,x=y.common.scaleW,L=y.common.scaleH,M=this.layout.glyphs.filter(function(re){var Y=re.data;return Y.width*Y.height>0});this.visibleGlyphs=M;var R=v.positions(M),D=v.uvs(M,x,L,g),N=E({clockwise:!0,type:"uint16",count:M.length});if(w.index(this,N,1,"uint16"),w.attr(this,"position",R,2),w.attr(this,"uv",D,2),!b.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(b.multipage){var z=v.pages(M);w.attr(this,"page",z,1)}},f.prototype.computeBoundingSphere=function(){this.boundingSphere===null&&(this.boundingSphere=new THREE.Sphere);var b=this.attributes.position.array,g=this.attributes.position.itemSize;if(!b||!g||b.length<2){this.boundingSphere.radius=0,this.boundingSphere.center.set(0,0,0);return}d.computeSphere(b,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')},f.prototype.computeBoundingBox=function(){this.boundingBox===null&&(this.boundingBox=new THREE.Box3);var b=this.boundingBox,g=this.attributes.position.array,y=this.attributes.position.itemSize;if(!g||!y||g.length<2){b.makeEmpty();return}d.computeBox(g,b)}},{"./lib/utils":64,"./lib/vertices":65,inherits:30,"layout-bmfont-text":36,"object-assign":39,"quad-indices":51,"three-buffer-vertex-data":66}],64:[function(_,G,fe){var u=2,A={min:[0,0],max:[0,0]};function E(w){var h=w.length/u;A.min[0]=w[0],A.min[1]=w[1],A.max[0]=w[0],A.max[1]=w[1];for(var v=0;v<h;v++){var d=w[v*u+0],m=w[v*u+1];A.min[0]=Math.min(d,A.min[0]),A.min[1]=Math.min(m,A.min[1]),A.max[0]=Math.max(d,A.max[0]),A.max[1]=Math.max(m,A.max[1])}}G.exports.computeBox=function(w,h){E(w),h.min.set(A.min[0],A.min[1],0),h.max.set(A.max[0],A.max[1],0)},G.exports.computeSphere=function(w,h){E(w);var v=A.min[0],d=A.min[1],m=A.max[0],f=A.max[1],b=m-v,g=f-d,y=Math.sqrt(b*b+g*g);h.center.set(v+b/2,d+g/2,0),h.radius=y/2}},{}],65:[function(_,G,fe){G.exports.pages=function(A){var E=new Float32Array(A.length*4*1),w=0;return A.forEach(function(h){var v=h.data.page||0;E[w++]=v,E[w++]=v,E[w++]=v,E[w++]=v}),E},G.exports.uvs=function(A,E,w,h){var v=new Float32Array(A.length*4*2),d=0;return A.forEach(function(m){var f=m.data,b=f.x+f.width,g=f.y+f.height,y=f.x/E,x=f.y/w,L=b/E,M=g/w;h&&(x=(w-f.y)/w,M=(w-g)/w),v[d++]=y,v[d++]=x,v[d++]=y,v[d++]=M,v[d++]=L,v[d++]=M,v[d++]=L,v[d++]=x}),v},G.exports.positions=function(A){var E=new Float32Array(A.length*4*2),w=0;return A.forEach(function(h){var v=h.data,d=h.position[0]+v.xoffset,m=h.position[1]+v.yoffset,f=v.width,b=v.height;E[w++]=d,E[w++]=m,E[w++]=d,E[w++]=m+b,E[w++]=d+f,E[w++]=m+b,E[w++]=d+f,E[w++]=m}),E}},{}],66:[function(_,G,fe){var u=_("flatten-vertex-data");G.exports.attr=E,G.exports.index=A;function A(h,v,d,m){typeof d!="number"&&(d=1),typeof m!="string"&&(m="uint16");var f=!h.index&&typeof h.setIndex!="function",b=f?h.getAttribute("index"):h.index,g=w(b,v,d,m);g&&(f?h.addAttribute("index",g):h.index=g)}function E(h,v,d,m,f){if(typeof m!="number"&&(m=3),typeof f!="string"&&(f="float32"),Array.isArray(d)&&Array.isArray(d[0])&&d[0].length!==m)throw new Error("Nested vertex array has unexpected size; expected "+m+" but found "+d[0].length);var b=h.getAttribute(v),g=w(b,d,m,f);h.setAttribute(v,g)}function w(h,v,d,m){return v=v||[],v=u(v,m),h=new THREE.BufferAttribute(v,d),h.itemSize=d,h.needsUpdate=!0,h}},{"flatten-vertex-data":23}],67:[function(_,G,fe){(function(u,A){var E=_("process/browser.js").nextTick,w=Function.prototype.apply,h=Array.prototype.slice,v={},d=0;fe.setTimeout=function(){return new m(w.call(setTimeout,window,arguments),clearTimeout)},fe.setInterval=function(){return new m(w.call(setInterval,window,arguments),clearInterval)},fe.clearTimeout=fe.clearInterval=function(f){f.close()};function m(f,b){this._id=f,this._clearFn=b}m.prototype.unref=m.prototype.ref=function(){},m.prototype.close=function(){this._clearFn.call(window,this._id)},fe.enroll=function(f,b){clearTimeout(f._idleTimeoutId),f._idleTimeout=b},fe.unenroll=function(f){clearTimeout(f._idleTimeoutId),f._idleTimeout=-1},fe._unrefActive=fe.active=function(f){clearTimeout(f._idleTimeoutId);var b=f._idleTimeout;b>=0&&(f._idleTimeoutId=setTimeout(function(){f._onTimeout&&f._onTimeout()},b))},fe.setImmediate=typeof u=="function"?u:function(f){var b=d++,g=arguments.length<2?!1:h.call(arguments,1);return v[b]=!0,E(function(){v[b]&&(g?f.apply(null,g):f.call(null),fe.clearImmediate(b))}),b},fe.clearImmediate=typeof A=="function"?A:function(f){delete v[f]}}).call(this,_("timers").setImmediate,_("timers").clearImmediate)},{"process/browser.js":49,timers:67}],68:[function(_,G,fe){(function(u){/**
 * @license
 * webvr-polyfill
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * webvr-polyfill-dpdb 
 * Copyright (c) 2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * wglu-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(A,E){typeof fe=="object"&&typeof G!="undefined"?G.exports=E():A.WebVRPolyfill=E()})(this,function(){var A=typeof window!="undefined"?window:typeof u!="undefined"?u:typeof self!="undefined"?self:{};function E(R){return R&&R.__esModule&&Object.prototype.hasOwnProperty.call(R,"default")?R.default:R}function w(R,D){return D={exports:{}},R(D,D.exports),D.exports}var h=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},v=function(D,N){for(var z=0,re=D.length;z<re;z++)N[z]=D[z]},d=function(D,N){for(var z in N)N.hasOwnProperty(z)&&(D[z]=N[z]);return D},m=w(function(R,D){/**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * gl-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * webvr-polyfill-dpdb
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(N,z){R.exports=z()})(A,function(){var N=function(I,F){if(!(I instanceof F))throw new TypeError("Cannot call a class as a function")},z=function(){function I(F,X){for(var q=0;q<X.length;q++){var he=X[q];he.enumerable=he.enumerable||!1,he.configurable=!0,"value"in he&&(he.writable=!0),Object.defineProperty(F,he.key,he)}}return function(F,X,q){return X&&I(F.prototype,X),q&&I(F,q),F}}(),re=function(){function I(F,X){var q=[],he=!0,Oe=!1,Je=void 0;try{for(var ft=F[Symbol.iterator](),dt;!(he=(dt=ft.next()).done)&&(q.push(dt.value),!(X&&q.length===X));he=!0);}catch(ze){Oe=!0,Je=ze}finally{try{!he&&ft.return&&ft.return()}finally{if(Oe)throw Je}}return q}return function(F,X){if(Array.isArray(F))return F;if(Symbol.iterator in Object(F))return I(F,X);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Y=.001,te=1,J=function(F,X){return"data:"+F+","+encodeURIComponent(X)},le=function(F,X,q){return F+(X-F)*q},j=function(){var I=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return I}}(),ae=function(){var I=navigator.userAgent.indexOf("Version")!==-1&&navigator.userAgent.indexOf("Android")!==-1&&navigator.userAgent.indexOf("Chrome")!==-1;return function(){return I}}(),Z=function(){var I=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return I}}(),ye=function(){var I=navigator.userAgent.indexOf("Firefox")!==-1&&navigator.userAgent.indexOf("Android")!==-1;return function(){return I}}(),Ne=function(){var I=navigator.userAgent.match(/.*Chrome\/([0-9]+)/),F=I?parseInt(I[1],10):null;return function(){return F}}(),We=function(){var I=!1;return I=j()&&Z()&&navigator.userAgent.indexOf("13_4")!==-1,function(){return I}}(),ke=function(){var I=!1;if(Ne()===65){var F=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(F){var X=F[1].split("."),q=re(X,4);q[0],q[1];var he=q[2],Oe=q[3];I=parseInt(he,10)===3325&&parseInt(Oe,10)<148}}return function(){return I}}(),it=function(){var I=navigator.userAgent.indexOf("R7 Build")!==-1;return function(){return I}}(),rt=function(){var F=window.orientation==90||window.orientation==-90;return it()?!F:F},At=function(F){return!(isNaN(F)||F<=Y||F>te)},St=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},Gt=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},er=function(F){if(ae())return!1;if(F.requestFullscreen)F.requestFullscreen();else if(F.webkitRequestFullscreen)F.webkitRequestFullscreen();else if(F.mozRequestFullScreen)F.mozRequestFullScreen();else if(F.msRequestFullscreen)F.msRequestFullscreen();else return!1;return!0},zt=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else return!1;return!0},wt=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},kr=function(F,X,q,he){var Oe=F.createShader(F.VERTEX_SHADER);F.shaderSource(Oe,X),F.compileShader(Oe);var Je=F.createShader(F.FRAGMENT_SHADER);F.shaderSource(Je,q),F.compileShader(Je);var ft=F.createProgram();F.attachShader(ft,Oe),F.attachShader(ft,Je);for(var dt in he)F.bindAttribLocation(ft,he[dt],dt);return F.linkProgram(ft),F.deleteShader(Oe),F.deleteShader(Je),ft},en=function(F,X){for(var q={},he=F.getProgramParameter(X,F.ACTIVE_UNIFORMS),Oe="",Je=0;Je<he;Je++){var ft=F.getActiveUniform(X,Je);Oe=ft.name.replace("[0]",""),q[Oe]=F.getUniformLocation(X,Oe)}return q},Nt=function(F,X,q,he,Oe,Je,ft){var dt=1/(X-q),ze=1/(he-Oe),tt=1/(Je-ft);return F[0]=-2*dt,F[1]=0,F[2]=0,F[3]=0,F[4]=0,F[5]=-2*ze,F[6]=0,F[7]=0,F[8]=0,F[9]=0,F[10]=2*tt,F[11]=0,F[12]=(X+q)*dt,F[13]=(Oe+he)*ze,F[14]=(ft+Je)*tt,F[15]=1,F},ne=function(){var F=!1;return function(X){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(X)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(X.substr(0,4)))&&(F=!0)}(navigator.userAgent||navigator.vendor||window.opera),F},ie=function(F,X){for(var q in X)X.hasOwnProperty(q)&&(F[q]=X[q]);return F},ge=function(F){if(j()){var X=F.style.width,q=F.style.height;F.style.width=parseInt(X)+1+"px",F.style.height=parseInt(q)+"px",setTimeout(function(){F.style.width=X,F.style.height=q},100)}window.canvas=F},ve=function(){var I=Math.PI/180,F=Math.PI*.25;function X(ze,tt,mt,Bt){var jt=Math.tan(tt?tt.upDegrees*I:F),Zt=Math.tan(tt?tt.downDegrees*I:F),Er=Math.tan(tt?tt.leftDegrees*I:F),fr=Math.tan(tt?tt.rightDegrees*I:F),or=2/(Er+fr),tn=2/(jt+Zt);return ze[0]=or,ze[1]=0,ze[2]=0,ze[3]=0,ze[4]=0,ze[5]=tn,ze[6]=0,ze[7]=0,ze[8]=-((Er-fr)*or*.5),ze[9]=(jt-Zt)*tn*.5,ze[10]=Bt/(mt-Bt),ze[11]=-1,ze[12]=0,ze[13]=0,ze[14]=Bt*mt/(mt-Bt),ze[15]=0,ze}function q(ze,tt,mt){var Bt=tt[0],jt=tt[1],Zt=tt[2],Er=tt[3],fr=Bt+Bt,or=jt+jt,tn=Zt+Zt,Mn=Bt*fr,Pn=Bt*or,An=Bt*tn,Un=jt*or,Jn=jt*tn,Zn=Zt*tn,Kn=Er*fr,$n=Er*or,Bi=Er*tn;return ze[0]=1-(Un+Zn),ze[1]=Pn+Bi,ze[2]=An-$n,ze[3]=0,ze[4]=Pn-Bi,ze[5]=1-(Mn+Zn),ze[6]=Jn+Kn,ze[7]=0,ze[8]=An+$n,ze[9]=Jn-Kn,ze[10]=1-(Mn+Un),ze[11]=0,ze[12]=mt[0],ze[13]=mt[1],ze[14]=mt[2],ze[15]=1,ze}function he(ze,tt,mt){var Bt=mt[0],jt=mt[1],Zt=mt[2],Er,fr,or,tn,Mn,Pn,An,Un,Jn,Zn,Kn,$n;return tt===ze?(ze[12]=tt[0]*Bt+tt[4]*jt+tt[8]*Zt+tt[12],ze[13]=tt[1]*Bt+tt[5]*jt+tt[9]*Zt+tt[13],ze[14]=tt[2]*Bt+tt[6]*jt+tt[10]*Zt+tt[14],ze[15]=tt[3]*Bt+tt[7]*jt+tt[11]*Zt+tt[15]):(Er=tt[0],fr=tt[1],or=tt[2],tn=tt[3],Mn=tt[4],Pn=tt[5],An=tt[6],Un=tt[7],Jn=tt[8],Zn=tt[9],Kn=tt[10],$n=tt[11],ze[0]=Er,ze[1]=fr,ze[2]=or,ze[3]=tn,ze[4]=Mn,ze[5]=Pn,ze[6]=An,ze[7]=Un,ze[8]=Jn,ze[9]=Zn,ze[10]=Kn,ze[11]=$n,ze[12]=Er*Bt+Mn*jt+Jn*Zt+tt[12],ze[13]=fr*Bt+Pn*jt+Zn*Zt+tt[13],ze[14]=or*Bt+An*jt+Kn*Zt+tt[14],ze[15]=tn*Bt+Un*jt+$n*Zt+tt[15]),ze}function Oe(ze,tt){var mt=tt[0],Bt=tt[1],jt=tt[2],Zt=tt[3],Er=tt[4],fr=tt[5],or=tt[6],tn=tt[7],Mn=tt[8],Pn=tt[9],An=tt[10],Un=tt[11],Jn=tt[12],Zn=tt[13],Kn=tt[14],$n=tt[15],Bi=mt*fr-Bt*Er,La=mt*or-jt*Er,Fi=mt*tn-Zt*Er,Ni=Bt*or-jt*fr,Ki=Bt*tn-Zt*fr,mi=jt*tn-Zt*or,gi=Mn*Zn-Pn*Jn,ki=Mn*Kn-An*Jn,$i=Mn*$n-Un*Jn,fa=Pn*Kn-An*Zn,Ra=Pn*$n-Un*Zn,to=An*$n-Un*Kn,Dn=Bi*to-La*Ra+Fi*fa+Ni*$i-Ki*ki+mi*gi;return Dn?(Dn=1/Dn,ze[0]=(fr*to-or*Ra+tn*fa)*Dn,ze[1]=(jt*Ra-Bt*to-Zt*fa)*Dn,ze[2]=(Zn*mi-Kn*Ki+$n*Ni)*Dn,ze[3]=(An*Ki-Pn*mi-Un*Ni)*Dn,ze[4]=(or*$i-Er*to-tn*ki)*Dn,ze[5]=(mt*to-jt*$i+Zt*ki)*Dn,ze[6]=(Kn*Fi-Jn*mi-$n*La)*Dn,ze[7]=(Mn*mi-An*Fi+Un*La)*Dn,ze[8]=(Er*Ra-fr*$i+tn*gi)*Dn,ze[9]=(Bt*$i-mt*Ra-Zt*gi)*Dn,ze[10]=(Jn*Ki-Zn*Fi+$n*Bi)*Dn,ze[11]=(Pn*Fi-Mn*Ki-Un*Bi)*Dn,ze[12]=(fr*ki-Er*fa-or*gi)*Dn,ze[13]=(mt*fa-Bt*ki+jt*gi)*Dn,ze[14]=(Zn*La-Jn*Ni-Kn*Bi)*Dn,ze[15]=(Mn*Ni-Pn*La+An*Bi)*Dn,ze):null}var Je=new Float32Array([0,0,0,1]),ft=new Float32Array([0,0,0]);function dt(ze,tt,mt,Bt,jt,Zt){X(ze,Bt||null,Zt.depthNear,Zt.depthFar);var Er=mt.orientation||Je,fr=mt.position||ft;q(tt,Er,fr),jt&&he(tt,tt,jt),Oe(tt,tt)}return function(ze,tt,mt){return!ze||!tt?!1:(ze.pose=tt,ze.timestamp=tt.timestamp,dt(ze.leftProjectionMatrix,ze.leftViewMatrix,tt,mt._getFieldOfView("left"),mt._getEyeOffset("left"),mt),dt(ze.rightProjectionMatrix,ze.rightViewMatrix,tt,mt._getFieldOfView("right"),mt._getEyeOffset("right"),mt),!0)}}(),we=function(){var F=window.self!==window.top,X=Ie(document.referrer),q=Ie(window.location.href);return F&&X!==q},Ie=function(F){var X,q=F.indexOf("://");q!==-1?X=q+3:X=0;var he=F.indexOf("/",X);return he===-1&&(he=F.length),F.substring(0,he)},De=function(F){if(F.w>1)return console.warn("getQuaternionAngle: w > 1"),0;var X=2*Math.acos(F.w);return X},Fe=function(){var I={};return function(F,X){I[F]===void 0&&(console.warn("webvr-polyfill: "+X),I[F]=!0)}}(),Xe=function(F,X){var q=X?"Please use "+X+" instead.":"";Fe(F,F+" has been deprecated. This may not work on native WebVR displays. "+q)};function at(I,F,X){if(!F){X(I);return}for(var q=[],he=null,Oe=0;Oe<F.length;++Oe){var Je=F[Oe];switch(Je){case I.TEXTURE_BINDING_2D:case I.TEXTURE_BINDING_CUBE_MAP:var ft=F[++Oe];if(ft<I.TEXTURE0||ft>I.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),q.push(null,null);break}he||(he=I.getParameter(I.ACTIVE_TEXTURE)),I.activeTexture(ft),q.push(I.getParameter(Je),null);break;case I.ACTIVE_TEXTURE:he=I.getParameter(I.ACTIVE_TEXTURE),q.push(null);break;default:q.push(I.getParameter(Je));break}}X(I);for(var Oe=0;Oe<F.length;++Oe){var Je=F[Oe],dt=q[Oe];switch(Je){case I.ACTIVE_TEXTURE:break;case I.ARRAY_BUFFER_BINDING:I.bindBuffer(I.ARRAY_BUFFER,dt);break;case I.COLOR_CLEAR_VALUE:I.clearColor(dt[0],dt[1],dt[2],dt[3]);break;case I.COLOR_WRITEMASK:I.colorMask(dt[0],dt[1],dt[2],dt[3]);break;case I.CURRENT_PROGRAM:I.useProgram(dt);break;case I.ELEMENT_ARRAY_BUFFER_BINDING:I.bindBuffer(I.ELEMENT_ARRAY_BUFFER,dt);break;case I.FRAMEBUFFER_BINDING:I.bindFramebuffer(I.FRAMEBUFFER,dt);break;case I.RENDERBUFFER_BINDING:I.bindRenderbuffer(I.RENDERBUFFER,dt);break;case I.TEXTURE_BINDING_2D:var ft=F[++Oe];if(ft<I.TEXTURE0||ft>I.TEXTURE31)break;I.activeTexture(ft),I.bindTexture(I.TEXTURE_2D,dt);break;case I.TEXTURE_BINDING_CUBE_MAP:var ft=F[++Oe];if(ft<I.TEXTURE0||ft>I.TEXTURE31)break;I.activeTexture(ft),I.bindTexture(I.TEXTURE_CUBE_MAP,dt);break;case I.VIEWPORT:I.viewport(dt[0],dt[1],dt[2],dt[3]);break;case I.BLEND:case I.CULL_FACE:case I.DEPTH_TEST:case I.SCISSOR_TEST:case I.STENCIL_TEST:dt?I.enable(Je):I.disable(Je);break;default:console.log("No GL restore behavior for 0x"+Je.toString(16));break}he&&I.activeTexture(he)}}var lt=at,vt=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join(`
`),$=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join(`
`);function U(I,F,X,q){this.gl=I,this.cardboardUI=F,this.bufferScale=X,this.dirtySubmitFrameBindings=q,this.ctxAttribs=I.getContextAttributes(),this.instanceExt=I.getExtension("ANGLE_instanced_arrays"),this.meshWidth=20,this.meshHeight=20,this.bufferWidth=I.drawingBufferWidth,this.bufferHeight=I.drawingBufferHeight,this.realBindFramebuffer=I.bindFramebuffer,this.realEnable=I.enable,this.realDisable=I.disable,this.realColorMask=I.colorMask,this.realClearColor=I.clearColor,this.realViewport=I.viewport,j()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(I.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(I.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=kr(I,vt,$,this.attribs),this.uniforms=en(I,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=I.createBuffer(),this.indexBuffer=I.createBuffer(),this.indexCount=0,this.renderTarget=I.createTexture(),this.framebuffer=I.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=I.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=I.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=I.createRenderbuffer()),this.patch(),this.onResize()}U.prototype.destroy=function(){var I=this.gl;this.unpatch(),I.deleteProgram(this.program),I.deleteBuffer(this.vertexBuffer),I.deleteBuffer(this.indexBuffer),I.deleteTexture(this.renderTarget),I.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&I.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&I.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&I.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},U.prototype.onResize=function(){var I=this.gl,F=this,X=[I.RENDERBUFFER_BINDING,I.TEXTURE_BINDING_2D,I.TEXTURE0];lt(I,X,function(q){F.realBindFramebuffer.call(q,q.FRAMEBUFFER,null),F.scissorTest&&F.realDisable.call(q,q.SCISSOR_TEST),F.realColorMask.call(q,!0,!0,!0,!0),F.realViewport.call(q,0,0,q.drawingBufferWidth,q.drawingBufferHeight),F.realClearColor.call(q,0,0,0,1),q.clear(q.COLOR_BUFFER_BIT),F.realBindFramebuffer.call(q,q.FRAMEBUFFER,F.framebuffer),q.bindTexture(q.TEXTURE_2D,F.renderTarget),q.texImage2D(q.TEXTURE_2D,0,F.ctxAttribs.alpha?q.RGBA:q.RGB,F.bufferWidth,F.bufferHeight,0,F.ctxAttribs.alpha?q.RGBA:q.RGB,q.UNSIGNED_BYTE,null),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,q.LINEAR),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MIN_FILTER,q.LINEAR),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE),q.framebufferTexture2D(q.FRAMEBUFFER,q.COLOR_ATTACHMENT0,q.TEXTURE_2D,F.renderTarget,0),F.ctxAttribs.depth&&F.ctxAttribs.stencil?(q.bindRenderbuffer(q.RENDERBUFFER,F.depthStencilBuffer),q.renderbufferStorage(q.RENDERBUFFER,q.DEPTH_STENCIL,F.bufferWidth,F.bufferHeight),q.framebufferRenderbuffer(q.FRAMEBUFFER,q.DEPTH_STENCIL_ATTACHMENT,q.RENDERBUFFER,F.depthStencilBuffer)):F.ctxAttribs.depth?(q.bindRenderbuffer(q.RENDERBUFFER,F.depthBuffer),q.renderbufferStorage(q.RENDERBUFFER,q.DEPTH_COMPONENT16,F.bufferWidth,F.bufferHeight),q.framebufferRenderbuffer(q.FRAMEBUFFER,q.DEPTH_ATTACHMENT,q.RENDERBUFFER,F.depthBuffer)):F.ctxAttribs.stencil&&(q.bindRenderbuffer(q.RENDERBUFFER,F.stencilBuffer),q.renderbufferStorage(q.RENDERBUFFER,q.STENCIL_INDEX8,F.bufferWidth,F.bufferHeight),q.framebufferRenderbuffer(q.FRAMEBUFFER,q.STENCIL_ATTACHMENT,q.RENDERBUFFER,F.stencilBuffer)),!q.checkFramebufferStatus(q.FRAMEBUFFER)===q.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),F.realBindFramebuffer.call(q,q.FRAMEBUFFER,F.lastBoundFramebuffer),F.scissorTest&&F.realEnable.call(q,q.SCISSOR_TEST),F.realColorMask.apply(q,F.colorMask),F.realViewport.apply(q,F.viewport),F.realClearColor.apply(q,F.clearColor)}),this.cardboardUI&&this.cardboardUI.onResize()},U.prototype.patch=function(){if(!this.isPatched){var I=this,F=this.gl.canvas,X=this.gl;j()||(F.width=St()*this.bufferScale,F.height=Gt()*this.bufferScale,Object.defineProperty(F,"width",{configurable:!0,enumerable:!0,get:function(){return I.bufferWidth},set:function(he){I.bufferWidth=he,I.realCanvasWidth.set.call(F,he),I.onResize()}}),Object.defineProperty(F,"height",{configurable:!0,enumerable:!0,get:function(){return I.bufferHeight},set:function(he){I.bufferHeight=he,I.realCanvasHeight.set.call(F,he),I.onResize()}})),this.lastBoundFramebuffer=X.getParameter(X.FRAMEBUFFER_BINDING),this.lastBoundFramebuffer==null&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(X.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(q,he){I.lastBoundFramebuffer=he||I.framebuffer,I.realBindFramebuffer.call(X,q,I.lastBoundFramebuffer)},this.cullFace=X.getParameter(X.CULL_FACE),this.depthTest=X.getParameter(X.DEPTH_TEST),this.blend=X.getParameter(X.BLEND),this.scissorTest=X.getParameter(X.SCISSOR_TEST),this.stencilTest=X.getParameter(X.STENCIL_TEST),X.enable=function(q){switch(q){case X.CULL_FACE:I.cullFace=!0;break;case X.DEPTH_TEST:I.depthTest=!0;break;case X.BLEND:I.blend=!0;break;case X.SCISSOR_TEST:I.scissorTest=!0;break;case X.STENCIL_TEST:I.stencilTest=!0;break}I.realEnable.call(X,q)},X.disable=function(q){switch(q){case X.CULL_FACE:I.cullFace=!1;break;case X.DEPTH_TEST:I.depthTest=!1;break;case X.BLEND:I.blend=!1;break;case X.SCISSOR_TEST:I.scissorTest=!1;break;case X.STENCIL_TEST:I.stencilTest=!1;break}I.realDisable.call(X,q)},this.colorMask=X.getParameter(X.COLOR_WRITEMASK),X.colorMask=function(q,he,Oe,Je){I.colorMask[0]=q,I.colorMask[1]=he,I.colorMask[2]=Oe,I.colorMask[3]=Je,I.realColorMask.call(X,q,he,Oe,Je)},this.clearColor=X.getParameter(X.COLOR_CLEAR_VALUE),X.clearColor=function(q,he,Oe,Je){I.clearColor[0]=q,I.clearColor[1]=he,I.clearColor[2]=Oe,I.clearColor[3]=Je,I.realClearColor.call(X,q,he,Oe,Je)},this.viewport=X.getParameter(X.VIEWPORT),X.viewport=function(q,he,Oe,Je){I.viewport[0]=q,I.viewport[1]=he,I.viewport[2]=Oe,I.viewport[3]=Je,I.realViewport.call(X,q,he,Oe,Je)},this.isPatched=!0,ge(F)}},U.prototype.unpatch=function(){if(!!this.isPatched){var I=this.gl,F=this.gl.canvas;j()||(Object.defineProperty(F,"width",this.realCanvasWidth),Object.defineProperty(F,"height",this.realCanvasHeight)),F.width=this.bufferWidth,F.height=this.bufferHeight,I.bindFramebuffer=this.realBindFramebuffer,I.enable=this.realEnable,I.disable=this.realDisable,I.colorMask=this.realColorMask,I.clearColor=this.realClearColor,I.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&I.bindFramebuffer(I.FRAMEBUFFER,null),this.isPatched=!1,setTimeout(function(){ge(F)},1)}},U.prototype.setTextureBounds=function(I,F){I||(I=[0,0,.5,1]),F||(F=[.5,0,.5,1]),this.viewportOffsetScale[0]=I[0],this.viewportOffsetScale[1]=I[1],this.viewportOffsetScale[2]=I[2],this.viewportOffsetScale[3]=I[3],this.viewportOffsetScale[4]=F[0],this.viewportOffsetScale[5]=F[1],this.viewportOffsetScale[6]=F[2],this.viewportOffsetScale[7]=F[3]},U.prototype.submitFrame=function(){var I=this.gl,F=this,X=[];if(this.dirtySubmitFrameBindings||X.push(I.CURRENT_PROGRAM,I.ARRAY_BUFFER_BINDING,I.ELEMENT_ARRAY_BUFFER_BINDING,I.TEXTURE_BINDING_2D,I.TEXTURE0),lt(I,X,function(he){F.realBindFramebuffer.call(he,he.FRAMEBUFFER,null);var Oe=0,Je=0;F.instanceExt&&(Oe=he.getVertexAttrib(F.attribs.position,F.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE),Je=he.getVertexAttrib(F.attribs.texCoord,F.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE)),F.cullFace&&F.realDisable.call(he,he.CULL_FACE),F.depthTest&&F.realDisable.call(he,he.DEPTH_TEST),F.blend&&F.realDisable.call(he,he.BLEND),F.scissorTest&&F.realDisable.call(he,he.SCISSOR_TEST),F.stencilTest&&F.realDisable.call(he,he.STENCIL_TEST),F.realColorMask.call(he,!0,!0,!0,!0),F.realViewport.call(he,0,0,he.drawingBufferWidth,he.drawingBufferHeight),(F.ctxAttribs.alpha||j())&&(F.realClearColor.call(he,0,0,0,1),he.clear(he.COLOR_BUFFER_BIT)),he.useProgram(F.program),he.bindBuffer(he.ELEMENT_ARRAY_BUFFER,F.indexBuffer),he.bindBuffer(he.ARRAY_BUFFER,F.vertexBuffer),he.enableVertexAttribArray(F.attribs.position),he.enableVertexAttribArray(F.attribs.texCoord),he.vertexAttribPointer(F.attribs.position,2,he.FLOAT,!1,20,0),he.vertexAttribPointer(F.attribs.texCoord,3,he.FLOAT,!1,20,8),F.instanceExt&&(Oe!=0&&F.instanceExt.vertexAttribDivisorANGLE(F.attribs.position,0),Je!=0&&F.instanceExt.vertexAttribDivisorANGLE(F.attribs.texCoord,0)),he.activeTexture(he.TEXTURE0),he.uniform1i(F.uniforms.diffuse,0),he.bindTexture(he.TEXTURE_2D,F.renderTarget),he.uniform4fv(F.uniforms.viewportOffsetScale,F.viewportOffsetScale),he.drawElements(he.TRIANGLES,F.indexCount,he.UNSIGNED_SHORT,0),F.cardboardUI&&F.cardboardUI.renderNoState(),F.realBindFramebuffer.call(F.gl,he.FRAMEBUFFER,F.framebuffer),F.ctxAttribs.preserveDrawingBuffer||(F.realClearColor.call(he,0,0,0,0),he.clear(he.COLOR_BUFFER_BIT)),F.dirtySubmitFrameBindings||F.realBindFramebuffer.call(he,he.FRAMEBUFFER,F.lastBoundFramebuffer),F.cullFace&&F.realEnable.call(he,he.CULL_FACE),F.depthTest&&F.realEnable.call(he,he.DEPTH_TEST),F.blend&&F.realEnable.call(he,he.BLEND),F.scissorTest&&F.realEnable.call(he,he.SCISSOR_TEST),F.stencilTest&&F.realEnable.call(he,he.STENCIL_TEST),F.realColorMask.apply(he,F.colorMask),F.realViewport.apply(he,F.viewport),(F.ctxAttribs.alpha||!F.ctxAttribs.preserveDrawingBuffer)&&F.realClearColor.apply(he,F.clearColor),F.instanceExt&&(Oe!=0&&F.instanceExt.vertexAttribDivisorANGLE(F.attribs.position,Oe),Je!=0&&F.instanceExt.vertexAttribDivisorANGLE(F.attribs.texCoord,Je))}),j()){var q=I.canvas;(q.width!=F.bufferWidth||q.height!=F.bufferHeight)&&(F.bufferWidth=q.width,F.bufferHeight=q.height,F.onResize())}},U.prototype.updateDeviceInfo=function(I){var F=this.gl,X=this,q=[F.ARRAY_BUFFER_BINDING,F.ELEMENT_ARRAY_BUFFER_BINDING];lt(F,q,function(he){var Oe=X.computeMeshVertices_(X.meshWidth,X.meshHeight,I);if(he.bindBuffer(he.ARRAY_BUFFER,X.vertexBuffer),he.bufferData(he.ARRAY_BUFFER,Oe,he.STATIC_DRAW),!X.indexCount){var Je=X.computeMeshIndices_(X.meshWidth,X.meshHeight);he.bindBuffer(he.ELEMENT_ARRAY_BUFFER,X.indexBuffer),he.bufferData(he.ELEMENT_ARRAY_BUFFER,Je,he.STATIC_DRAW),X.indexCount=Je.length}})},U.prototype.computeMeshVertices_=function(I,F,X){for(var q=new Float32Array(2*I*F*5),he=X.getLeftEyeVisibleTanAngles(),Oe=X.getLeftEyeNoLensTanAngles(),Je=X.getLeftEyeVisibleScreenRect(Oe),ft=0,dt=0;dt<2;dt++){for(var ze=0;ze<F;ze++)for(var tt=0;tt<I;tt++,ft++){var mt=tt/(I-1),Bt=ze/(F-1),jt=mt,Zt=Bt,Er=le(he[0],he[2],mt),fr=le(he[3],he[1],Bt),or=Math.sqrt(Er*Er+fr*fr),tn=X.distortion.distortInverse(or),Mn=Er*tn/or,Pn=fr*tn/or;mt=(Mn-Oe[0])/(Oe[2]-Oe[0]),Bt=(Pn-Oe[3])/(Oe[1]-Oe[3]),mt=(Je.x+mt*Je.width-.5)*2,Bt=(Je.y+Bt*Je.height-.5)*2,q[ft*5+0]=mt,q[ft*5+1]=Bt,q[ft*5+2]=jt,q[ft*5+3]=Zt,q[ft*5+4]=dt}var An=he[2]-he[0];he[0]=-(An+he[0]),he[2]=An-he[2],An=Oe[2]-Oe[0],Oe[0]=-(An+Oe[0]),Oe[2]=An-Oe[2],Je.x=1-(Je.x+Je.width)}return q},U.prototype.computeMeshIndices_=function(I,F){for(var X=new Uint16Array(2*(I-1)*(F-1)*6),q=I/2,he=F/2,Oe=0,Je=0,ft=0;ft<2;ft++)for(var dt=0;dt<F;dt++)for(var ze=0;ze<I;ze++,Oe++)ze==0||dt==0||(ze<=q==dt<=he?(X[Je++]=Oe,X[Je++]=Oe-I-1,X[Je++]=Oe-I,X[Je++]=Oe-I-1,X[Je++]=Oe,X[Je++]=Oe-1):(X[Je++]=Oe-1,X[Je++]=Oe-I,X[Je++]=Oe,X[Je++]=Oe-I,X[Je++]=Oe-1,X[Je++]=Oe-I-1));return X},U.prototype.getOwnPropertyDescriptor_=function(I,F){var X=Object.getOwnPropertyDescriptor(I,F);return(X.get===void 0||X.set===void 0)&&(X.configurable=!0,X.enumerable=!0,X.get=function(){return this.getAttribute(F)},X.set=function(q){this.setAttribute(F,q)}),X};var H=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join(`
`),ce=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join(`
`),Re=Math.PI/180,qe=60,$e=12,Rt=20,Qt=1,Ar=.75,Pr=.3125,Vt=4,jr=28,ar=1.5;function hn(I){this.gl=I,this.attribs={position:0},this.program=kr(I,H,ce,this.attribs),this.uniforms=en(I,this.program),this.vertexBuffer=I.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}hn.prototype.destroy=function(){var I=this.gl;this.listener&&I.canvas.removeEventListener("click",this.listener,!1),I.deleteProgram(this.program),I.deleteBuffer(this.vertexBuffer)},hn.prototype.listen=function(I,F){var X=this.gl.canvas;this.listener=function(q){var he=X.clientWidth/2,Oe=jr*ar;q.clientX>he-Oe&&q.clientX<he+Oe&&q.clientY>X.clientHeight-Oe?I(q):q.clientX<Oe&&q.clientY<Oe&&F(q)},X.addEventListener("click",this.listener,!1)},hn.prototype.onResize=function(){var I=this.gl,F=this,X=[I.ARRAY_BUFFER_BINDING];lt(I,X,function(q){var he=[],Oe=q.drawingBufferWidth/2,Je=Math.max(screen.width,screen.height)*window.devicePixelRatio,ft=q.drawingBufferWidth/Je,dt=ft*window.devicePixelRatio,ze=Vt*dt/2,tt=jr*ar*dt,mt=jr*dt/2,Bt=(jr*ar-jr)*dt;he.push(Oe-ze,tt),he.push(Oe-ze,q.drawingBufferHeight),he.push(Oe+ze,tt),he.push(Oe+ze,q.drawingBufferHeight),F.gearOffset=he.length/2;function jt(tn,Mn){var Pn=(90-tn)*Re,An=Math.cos(Pn),Un=Math.sin(Pn);he.push(Pr*An*mt+Oe,Pr*Un*mt+mt),he.push(Mn*An*mt+Oe,Mn*Un*mt+mt)}for(var Zt=0;Zt<=6;Zt++){var Er=Zt*qe;jt(Er,Qt),jt(Er+$e,Qt),jt(Er+Rt,Ar),jt(Er+(qe-Rt),Ar),jt(Er+(qe-$e),Qt)}F.gearVertexCount=he.length/2-F.gearOffset,F.arrowOffset=he.length/2;function fr(tn,Mn){he.push(Bt+tn,q.drawingBufferHeight-Bt-Mn)}var or=ze/Math.sin(45*Re);fr(0,mt),fr(mt,0),fr(mt+or,or),fr(or,mt+or),fr(or,mt-or),fr(0,mt),fr(mt,mt*2),fr(mt+or,mt*2-or),fr(or,mt-or),fr(0,mt),fr(or,mt-ze),fr(jr*dt,mt-ze),fr(or,mt+ze),fr(jr*dt,mt+ze),F.arrowVertexCount=he.length/2-F.arrowOffset,q.bindBuffer(q.ARRAY_BUFFER,F.vertexBuffer),q.bufferData(q.ARRAY_BUFFER,new Float32Array(he),q.STATIC_DRAW)})},hn.prototype.render=function(){var I=this.gl,F=this,X=[I.CULL_FACE,I.DEPTH_TEST,I.BLEND,I.SCISSOR_TEST,I.STENCIL_TEST,I.COLOR_WRITEMASK,I.VIEWPORT,I.CURRENT_PROGRAM,I.ARRAY_BUFFER_BINDING];lt(I,X,function(q){q.disable(q.CULL_FACE),q.disable(q.DEPTH_TEST),q.disable(q.BLEND),q.disable(q.SCISSOR_TEST),q.disable(q.STENCIL_TEST),q.colorMask(!0,!0,!0,!0),q.viewport(0,0,q.drawingBufferWidth,q.drawingBufferHeight),F.renderNoState()})},hn.prototype.renderNoState=function(){var I=this.gl;I.useProgram(this.program),I.bindBuffer(I.ARRAY_BUFFER,this.vertexBuffer),I.enableVertexAttribArray(this.attribs.position),I.vertexAttribPointer(this.attribs.position,2,I.FLOAT,!1,8,0),I.uniform4f(this.uniforms.color,1,1,1,1),Nt(this.projMat,0,I.drawingBufferWidth,0,I.drawingBufferHeight,.1,1024),I.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),I.drawArrays(I.TRIANGLE_STRIP,0,4),I.drawArrays(I.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),I.drawArrays(I.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)};function Rn(I){this.coefficients=I}Rn.prototype.distortInverse=function(I){for(var F=0,X=1,q=I-this.distort(F);Math.abs(X-F)>1e-4;){var he=I-this.distort(X),Oe=X-he*((X-F)/(he-q));F=X,X=Oe,q=he}return X},Rn.prototype.distort=function(I){for(var F=I*I,X=0,q=0;q<this.coefficients.length;q++)X=F*(X+this.coefficients[q]);return(X+1)*I};var dn=Math.PI/180,ot=180/Math.PI,nt=function(F,X,q){this.x=F||0,this.y=X||0,this.z=q||0};nt.prototype={constructor:nt,set:function(F,X,q){return this.x=F,this.y=X,this.z=q,this},copy:function(F){return this.x=F.x,this.y=F.y,this.z=F.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var F=this.length();if(F!==0){var X=1/F;this.multiplyScalar(X)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(F){this.x*=F,this.y*=F,this.z*=F},applyQuaternion:function(F){var X=this.x,q=this.y,he=this.z,Oe=F.x,Je=F.y,ft=F.z,dt=F.w,ze=dt*X+Je*he-ft*q,tt=dt*q+ft*X-Oe*he,mt=dt*he+Oe*q-Je*X,Bt=-Oe*X-Je*q-ft*he;return this.x=ze*dt+Bt*-Oe+tt*-ft-mt*-Je,this.y=tt*dt+Bt*-Je+mt*-Oe-ze*-ft,this.z=mt*dt+Bt*-ft+ze*-Je-tt*-Oe,this},dot:function(F){return this.x*F.x+this.y*F.y+this.z*F.z},crossVectors:function(F,X){var q=F.x,he=F.y,Oe=F.z,Je=X.x,ft=X.y,dt=X.z;return this.x=he*dt-Oe*ft,this.y=Oe*Je-q*dt,this.z=q*ft-he*Je,this}};var yt=function(F,X,q,he){this.x=F||0,this.y=X||0,this.z=q||0,this.w=he!==void 0?he:1};yt.prototype={constructor:yt,set:function(F,X,q,he){return this.x=F,this.y=X,this.z=q,this.w=he,this},copy:function(F){return this.x=F.x,this.y=F.y,this.z=F.z,this.w=F.w,this},setFromEulerXYZ:function(F,X,q){var he=Math.cos(F/2),Oe=Math.cos(X/2),Je=Math.cos(q/2),ft=Math.sin(F/2),dt=Math.sin(X/2),ze=Math.sin(q/2);return this.x=ft*Oe*Je+he*dt*ze,this.y=he*dt*Je-ft*Oe*ze,this.z=he*Oe*ze+ft*dt*Je,this.w=he*Oe*Je-ft*dt*ze,this},setFromEulerYXZ:function(F,X,q){var he=Math.cos(F/2),Oe=Math.cos(X/2),Je=Math.cos(q/2),ft=Math.sin(F/2),dt=Math.sin(X/2),ze=Math.sin(q/2);return this.x=ft*Oe*Je+he*dt*ze,this.y=he*dt*Je-ft*Oe*ze,this.z=he*Oe*ze-ft*dt*Je,this.w=he*Oe*Je+ft*dt*ze,this},setFromAxisAngle:function(F,X){var q=X/2,he=Math.sin(q);return this.x=F.x*he,this.y=F.y*he,this.z=F.z*he,this.w=Math.cos(q),this},multiply:function(F){return this.multiplyQuaternions(this,F)},multiplyQuaternions:function(F,X){var q=F.x,he=F.y,Oe=F.z,Je=F.w,ft=X.x,dt=X.y,ze=X.z,tt=X.w;return this.x=q*tt+Je*ft+he*ze-Oe*dt,this.y=he*tt+Je*dt+Oe*ft-q*ze,this.z=Oe*tt+Je*ze+q*dt-he*ft,this.w=Je*tt-q*ft-he*dt-Oe*ze,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var F=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return F===0?(this.x=0,this.y=0,this.z=0,this.w=1):(F=1/F,this.x=this.x*F,this.y=this.y*F,this.z=this.z*F,this.w=this.w*F),this},slerp:function(F,X){if(X===0)return this;if(X===1)return this.copy(F);var q=this.x,he=this.y,Oe=this.z,Je=this.w,ft=Je*F.w+q*F.x+he*F.y+Oe*F.z;if(ft<0?(this.w=-F.w,this.x=-F.x,this.y=-F.y,this.z=-F.z,ft=-ft):this.copy(F),ft>=1)return this.w=Je,this.x=q,this.y=he,this.z=Oe,this;var dt=Math.acos(ft),ze=Math.sqrt(1-ft*ft);if(Math.abs(ze)<.001)return this.w=.5*(Je+this.w),this.x=.5*(q+this.x),this.y=.5*(he+this.y),this.z=.5*(Oe+this.z),this;var tt=Math.sin((1-X)*dt)/ze,mt=Math.sin(X*dt)/ze;return this.w=Je*tt+this.w*mt,this.x=q*tt+this.x*mt,this.y=he*tt+this.y*mt,this.z=Oe*tt+this.z*mt,this},setFromUnitVectors:function(){var I,F,X=1e-6;return function(q,he){return I===void 0&&(I=new nt),F=q.dot(he)+1,F<X?(F=0,Math.abs(q.x)>Math.abs(q.z)?I.set(-q.y,q.x,0):I.set(0,-q.z,q.y)):I.crossVectors(q,he),this.x=I.x,this.y=I.y,this.z=I.z,this.w=F,this.normalize(),this}}()};function Jt(I){this.width=I.width||St(),this.height=I.height||Gt(),this.widthMeters=I.widthMeters,this.heightMeters=I.heightMeters,this.bevelMeters=I.bevelMeters}var tr=new Jt({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),ur=new Jt({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),ir={CardboardV1:new Xr({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new Xr({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function xr(I,F){this.viewer=ir.CardboardV2,this.updateDeviceParams(I),this.distortion=new Rn(this.viewer.distortionCoefficients);for(var X=0;X<F.length;X++){var q=F[X];ir[q.id]=new Xr(q)}}xr.prototype.updateDeviceParams=function(I){this.device=this.determineDevice_(I)||this.device},xr.prototype.getDevice=function(){return this.device},xr.prototype.setViewer=function(I){this.viewer=I,this.distortion=new Rn(this.viewer.distortionCoefficients)},xr.prototype.determineDevice_=function(I){if(!I)return j()?(console.warn("Using fallback iOS device measurements."),ur):(console.warn("Using fallback Android device measurements."),tr);var F=.0254,X=F/I.xdpi,q=F/I.ydpi,he=St(),Oe=Gt();return new Jt({widthMeters:X*he,heightMeters:q*Oe,bevelMeters:I.bevelMm*.001})},xr.prototype.getDistortedFieldOfViewLeftEye=function(){var I=this.viewer,F=this.device,X=this.distortion,q=I.screenLensDistance,he=(F.widthMeters-I.interLensDistance)/2,Oe=I.interLensDistance/2,Je=I.baselineLensDistance-F.bevelMeters,ft=F.heightMeters-Je,dt=ot*Math.atan(X.distort(he/q)),ze=ot*Math.atan(X.distort(Oe/q)),tt=ot*Math.atan(X.distort(Je/q)),mt=ot*Math.atan(X.distort(ft/q));return{leftDegrees:Math.min(dt,I.fov),rightDegrees:Math.min(ze,I.fov),downDegrees:Math.min(tt,I.fov),upDegrees:Math.min(mt,I.fov)}},xr.prototype.getLeftEyeVisibleTanAngles=function(){var I=this.viewer,F=this.device,X=this.distortion,q=Math.tan(-dn*I.fov),he=Math.tan(dn*I.fov),Oe=Math.tan(dn*I.fov),Je=Math.tan(-dn*I.fov),ft=F.widthMeters/4,dt=F.heightMeters/2,ze=I.baselineLensDistance-F.bevelMeters-dt,tt=I.interLensDistance/2-ft,mt=-ze,Bt=I.screenLensDistance,jt=X.distort((tt-ft)/Bt),Zt=X.distort((mt+dt)/Bt),Er=X.distort((tt+ft)/Bt),fr=X.distort((mt-dt)/Bt),or=new Float32Array(4);return or[0]=Math.max(q,jt),or[1]=Math.min(he,Zt),or[2]=Math.min(Oe,Er),or[3]=Math.max(Je,fr),or},xr.prototype.getLeftEyeNoLensTanAngles=function(){var I=this.viewer,F=this.device,X=this.distortion,q=new Float32Array(4),he=X.distortInverse(Math.tan(-dn*I.fov)),Oe=X.distortInverse(Math.tan(dn*I.fov)),Je=X.distortInverse(Math.tan(dn*I.fov)),ft=X.distortInverse(Math.tan(-dn*I.fov)),dt=F.widthMeters/4,ze=F.heightMeters/2,tt=I.baselineLensDistance-F.bevelMeters-ze,mt=I.interLensDistance/2-dt,Bt=-tt,jt=I.screenLensDistance,Zt=(mt-dt)/jt,Er=(Bt+ze)/jt,fr=(mt+dt)/jt,or=(Bt-ze)/jt;return q[0]=Math.max(he,Zt),q[1]=Math.min(Oe,Er),q[2]=Math.min(Je,fr),q[3]=Math.max(ft,or),q},xr.prototype.getLeftEyeVisibleScreenRect=function(I){var F=this.viewer,X=this.device,q=F.screenLensDistance,he=(X.widthMeters-F.interLensDistance)/2,Oe=F.baselineLensDistance-X.bevelMeters,Je=(I[0]*q+he)/X.widthMeters,ft=(I[1]*q+Oe)/X.heightMeters,dt=(I[2]*q+he)/X.widthMeters,ze=(I[3]*q+Oe)/X.heightMeters;return{x:Je,y:ze,width:dt-Je,height:ft-ze}},xr.prototype.getFieldOfViewLeftEye=function(I){return I?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},xr.prototype.getFieldOfViewRightEye=function(I){var F=this.getFieldOfViewLeftEye(I);return{leftDegrees:F.rightDegrees,rightDegrees:F.leftDegrees,upDegrees:F.upDegrees,downDegrees:F.downDegrees}},xr.prototype.getUndistortedFieldOfViewLeftEye=function(){var I=this.getUndistortedParams_();return{leftDegrees:ot*Math.atan(I.outerDist),rightDegrees:ot*Math.atan(I.innerDist),downDegrees:ot*Math.atan(I.bottomDist),upDegrees:ot*Math.atan(I.topDist)}},xr.prototype.getUndistortedViewportLeftEye=function(){var I=this.getUndistortedParams_(),F=this.viewer,X=this.device,q=F.screenLensDistance,he=X.widthMeters/q,Oe=X.heightMeters/q,Je=X.width/he,ft=X.height/Oe,dt=Math.round((I.eyePosX-I.outerDist)*Je),ze=Math.round((I.eyePosY-I.bottomDist)*ft);return{x:dt,y:ze,width:Math.round((I.eyePosX+I.innerDist)*Je)-dt,height:Math.round((I.eyePosY+I.topDist)*ft)-ze}},xr.prototype.getUndistortedParams_=function(){var I=this.viewer,F=this.device,X=this.distortion,q=I.screenLensDistance,he=I.interLensDistance/2/q,Oe=F.widthMeters/q,Je=F.heightMeters/q,ft=Oe/2-he,dt=(I.baselineLensDistance-F.bevelMeters)/q,ze=I.fov,tt=X.distortInverse(Math.tan(dn*ze)),mt=Math.min(ft,tt),Bt=Math.min(he,tt),jt=Math.min(dt,tt),Zt=Math.min(Je-dt,tt);return{outerDist:mt,innerDist:Bt,topDist:Zt,bottomDist:jt,eyePosX:ft,eyePosY:dt}};function Xr(I){this.id=I.id,this.label=I.label,this.fov=I.fov,this.interLensDistance=I.interLensDistance,this.baselineLensDistance=I.baselineLensDistance,this.screenLensDistance=I.screenLensDistance,this.distortionCoefficients=I.distortionCoefficients,this.inverseCoefficients=I.inverseCoefficients}xr.Viewers=ir;var Dr=1,Nn="2019-11-09T17:36:14Z",Yr=[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}],Ur={format:Dr,last_updated:Nn,devices:Yr};function on(I,F){if(this.dpdb=Ur,this.recalculateDeviceParams_(),I){this.onDeviceParamsUpdated=F;var X=new XMLHttpRequest,q=this;X.open("GET",I,!0),X.addEventListener("load",function(){q.loading=!1,X.status>=200&&X.status<=299?(q.dpdb=JSON.parse(X.response),q.recalculateDeviceParams_()):console.error("Error loading online DPDB!")}),X.send()}}on.prototype.getDeviceParams=function(){return this.deviceParams},on.prototype.recalculateDeviceParams_=function(){var I=this.calcDeviceParams_();I?(this.deviceParams=I,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},on.prototype.calcDeviceParams_=function(){var I=this.dpdb;if(!I)return console.error("DPDB not available."),null;if(I.format!=1)return console.error("DPDB has unexpected format version."),null;if(!I.devices||!I.devices.length)return console.error("DPDB does not have a devices section."),null;var F=navigator.userAgent||navigator.vendor||window.opera,X=St(),q=Gt();if(!I.devices)return console.error("DPDB has no devices section."),null;for(var he=0;he<I.devices.length;he++){var Oe=I.devices[he];if(!Oe.rules){console.warn("Device["+he+"] has no rules section.");continue}if(Oe.type!="ios"&&Oe.type!="android"){console.warn("Device["+he+"] has invalid type.");continue}if(j()==(Oe.type=="ios")){for(var Je=!1,ft=0;ft<Oe.rules.length;ft++){var dt=Oe.rules[ft];if(this.ruleMatches_(dt,F,X,q)){Je=!0;break}}if(!!Je){var ze=Oe.dpi[0]||Oe.dpi,tt=Oe.dpi[1]||Oe.dpi;return new vi({xdpi:ze,ydpi:tt,bevelMm:Oe.bw})}}}return console.warn("No DPDB device match."),null},on.prototype.ruleMatches_=function(I,F,X,q){if(!I.ua&&!I.res||(I.ua&&I.ua.substring(0,2)==="SM"&&(I.ua=I.ua.substring(0,7)),I.ua&&F.indexOf(I.ua)<0))return!1;if(I.res){if(!I.res[0]||!I.res[1])return!1;var he=I.res[0],Oe=I.res[1];if(Math.min(X,q)!=Math.min(he,Oe)||Math.max(X,q)!=Math.max(he,Oe))return!1}return!0};function vi(I){this.xdpi=I.xdpi,this.ydpi=I.ydpi,this.bevelMm=I.bevelMm}function qn(I,F){this.set(I,F)}qn.prototype.set=function(I,F){this.sample=I,this.timestampS=F},qn.prototype.copy=function(I){this.set(I.sample,I.timestampS)};function qr(I,F){this.kFilter=I,this.isDebug=F,this.currentAccelMeasurement=new qn,this.currentGyroMeasurement=new qn,this.previousGyroMeasurement=new qn,j()?this.filterQ=new yt(-1,0,0,1):this.filterQ=new yt(1,0,0,1),this.previousFilterQ=new yt,this.previousFilterQ.copy(this.filterQ),this.accelQ=new yt,this.isOrientationInitialized=!1,this.estimatedGravity=new nt,this.measuredGravity=new nt,this.gyroIntegralQ=new yt}qr.prototype.addAccelMeasurement=function(I,F){this.currentAccelMeasurement.set(I,F)},qr.prototype.addGyroMeasurement=function(I,F){this.currentGyroMeasurement.set(I,F);var X=F-this.previousGyroMeasurement.timestampS;At(X)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},qr.prototype.run_=function(){if(!this.isOrientationInitialized){this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),this.isOrientationInitialized=!0;return}var I=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,F=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,I);this.gyroIntegralQ.multiply(F),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(F);var X=new yt;X.copy(this.filterQ),X.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(X),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var q=new yt;q.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),q.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",ot*De(q),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var he=new yt;he.copy(this.filterQ),he.multiply(q),this.filterQ.slerp(he,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},qr.prototype.getOrientation=function(){return this.filterQ},qr.prototype.accelToQuaternion_=function(I){var F=new nt;F.copy(I),F.normalize();var X=new yt;return X.setFromUnitVectors(new nt(0,0,-1),F),X.inverse(),X},qr.prototype.gyroToQuaternionDelta_=function(I,F){var X=new yt,q=new nt;return q.copy(I),q.normalize(),X.setFromAxisAngle(q,I.length()*F),X};function Li(I,F){this.predictionTimeS=I,this.isDebug=F,this.previousQ=new yt,this.previousTimestampS=null,this.deltaQ=new yt,this.outQ=new yt}Li.prototype.getPrediction=function(I,F,X){if(!this.previousTimestampS)return this.previousQ.copy(I),this.previousTimestampS=X,I;var q=new nt;q.copy(F),q.normalize();var he=F.length();if(he<dn*20)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(ot*he).toFixed(1)),this.outQ.copy(I),this.previousQ.copy(I),this.outQ;var Oe=he*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(q,Oe),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(I),this.previousTimestampS=X,this.outQ};function Wn(I,F,X,q){this.yawOnly=X,this.accelerometer=new nt,this.gyroscope=new nt,this.filter=new qr(I,q),this.posePredictor=new Li(F,q),this.isFirefoxAndroid=ye(),this.isIOS=j();var he=Ne();this.isDeviceMotionInRadians=!this.isIOS&&he&&he<66,this.isWithoutDeviceMotion=ke()||We(),this.filterToWorldQ=new yt,j()?this.filterToWorldQ.setFromAxisAngle(new nt(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new nt(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new yt,this.worldToScreenQ=new yt,this.originalPoseAdjustQ=new yt,this.originalPoseAdjustQ.setFromAxisAngle(new nt(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),rt()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new yt,this.orientationOut_=new Float32Array(4),this.start()}Wn.prototype.getPosition=function(){return null},Wn.prototype.getOrientation=function(){var I=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||function(){var he=new yt().setFromAxisAngle(new nt(0,0,-1),0),Oe=new yt;return window.orientation===-90?Oe.setFromAxisAngle(new nt(0,1,0),Math.PI/-2):Oe.setFromAxisAngle(new nt(0,1,0),Math.PI/2),he.multiply(Oe)}(),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||function(){var he=new yt;return he.setFromAxisAngle(new nt(1,0,0),-Math.PI/2),he}(),I=this._deviceOrientationQ;var X=new yt;return X.copy(I),X.multiply(this.deviceOrientationFilterToWorldQ),X.multiply(this.resetQ),X.multiply(this.worldToScreenQ),X.multiplyQuaternions(this.deviceOrientationFixQ,X),this.yawOnly&&(X.x=0,X.z=0,X.normalize()),this.orientationOut_[0]=X.x,this.orientationOut_[1]=X.y,this.orientationOut_[2]=X.z,this.orientationOut_[3]=X.w,this.orientationOut_}else{var F=this.filter.getOrientation();I=this.posePredictor.getPrediction(F,this.gyroscope,this.previousTimestampS)}var X=new yt;return X.copy(this.filterToWorldQ),X.multiply(this.resetQ),X.multiply(I),X.multiply(this.worldToScreenQ),this.yawOnly&&(X.x=0,X.z=0,X.normalize()),this.orientationOut_[0]=X.x,this.orientationOut_[1]=X.y,this.orientationOut_[2]=X.z,this.orientationOut_[3]=X.w,this.orientationOut_},Wn.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),rt()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},Wn.prototype.onDeviceOrientation_=function(I){this._deviceOrientationQ=this._deviceOrientationQ||new yt;var F=I.alpha,X=I.beta,q=I.gamma;F=(F||0)*Math.PI/180,X=(X||0)*Math.PI/180,q=(q||0)*Math.PI/180,this._deviceOrientationQ.setFromEulerYXZ(X,F,-q)},Wn.prototype.onDeviceMotion_=function(I){this.updateDeviceMotion_(I)},Wn.prototype.updateDeviceMotion_=function(I){var F=I.accelerationIncludingGravity,X=I.rotationRate,q=I.timeStamp/1e3,he=q-this.previousTimestampS;if(he<0){Fe("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"),this.previousTimestampS=q;return}else if(he<=Y||he>te){Fe("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."),this.previousTimestampS=q;return}this.accelerometer.set(-F.x,-F.y,-F.z),X&&(it()?this.gyroscope.set(-X.beta,X.alpha,X.gamma):this.gyroscope.set(X.alpha,X.beta,X.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addGyroMeasurement(this.gyroscope,q)),this.filter.addAccelMeasurement(this.accelerometer,q),this.previousTimestampS=q},Wn.prototype.onOrientationChange_=function(I){this.setScreenTransform_()},Wn.prototype.onMessage_=function(I){var F=I.data;if(!(!F||!F.type)){var X=F.type.toLowerCase();X==="devicemotion"&&this.updateDeviceMotion_(F.deviceMotionEvent)}},Wn.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new nt(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new nt(0,0,1),Math.PI/2);break}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},Wn.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this),j()&&we()&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},Wn.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)};var Ri=60,jn=new nt(1,0,0),oe=new nt(0,0,1),be=new yt;be.setFromAxisAngle(jn,-Math.PI/2),be.multiply(new yt().setFromAxisAngle(oe,Math.PI/2));var Ge=function(){function I(F){N(this,I),this.config=F,this.sensor=null,this.fusionSensor=null,this._out=new Float32Array(4),this.api=null,this.errors=[],this._sensorQ=new yt,this._outQ=new yt,this._onSensorRead=this._onSensorRead.bind(this),this._onSensorError=this._onSensorError.bind(this),this.init()}return z(I,[{key:"init",value:function(){var X=null;try{X=new RelativeOrientationSensor({frequency:Ri,referenceFrame:"screen"}),X.addEventListener("error",this._onSensorError)}catch(q){this.errors.push(q),q.name==="SecurityError"?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):q.name==="ReferenceError"?this.useDeviceMotion():console.error(q)}X&&(this.api="sensor",this.sensor=X,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion",this.fusionSensor=new Wn(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG),this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var X=this.sensor.quaternion;this._sensorQ.set(X[0],X[1],X[2],X[3]);var q=this._outQ;return q.copy(be),q.multiply(this._sensorQ),this.config.YAW_ONLY&&(q.x=q.z=0,q.normalize()),this._out[0]=q.x,this._out[1]=q.y,this._out[2]=q.z,this._out[3]=q.w,this._out}},{key:"_onSensorError",value:function(X){this.errors.push(X.error),X.error.name==="NotAllowedError"?console.error("Permission to access sensor was denied"):X.error.name==="NotReadableError"?console.error("Sensor could not be read"):console.error(X.error),this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]),I}(),et="<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>";function je(){this.loadIcon_();var I=document.createElement("div"),F=I.style;F.position="fixed",F.top=0,F.right=0,F.bottom=0,F.left=0,F.backgroundColor="gray",F.fontFamily="sans-serif",F.zIndex=1e6;var X=document.createElement("img");X.src=this.icon;var F=X.style;F.marginLeft="25%",F.marginTop="25%",F.width="50%",I.appendChild(X);var q=document.createElement("div"),F=q.style;F.textAlign="center",F.fontSize="16px",F.lineHeight="24px",F.margin="24px 25%",F.width="50%",q.innerHTML="Place your phone into your Cardboard viewer.",I.appendChild(q);var he=document.createElement("div"),F=he.style;F.backgroundColor="#CFD8DC",F.position="fixed",F.bottom=0,F.width="100%",F.height="48px",F.padding="14px 24px",F.boxSizing="border-box",F.color="#656A6B",I.appendChild(he);var Oe=document.createElement("div");Oe.style.float="left",Oe.innerHTML="No Cardboard viewer?";var Je=document.createElement("a");Je.href="https://www.google.com/get/cardboard/get-cardboard/",Je.innerHTML="get one",Je.target="_blank";var F=Je.style;F.float="right",F.fontWeight=600,F.textTransform="uppercase",F.borderLeft="1px solid gray",F.paddingLeft="24px",F.textDecoration="none",F.color="#656A6B",he.appendChild(Oe),he.appendChild(Je),this.overlay=I,this.text=q,this.hide()}je.prototype.show=function(I){!I&&!this.overlay.parentElement?document.body.appendChild(this.overlay):I&&(this.overlay.parentElement&&this.overlay.parentElement!=I&&this.overlay.parentElement.removeChild(this.overlay),I.appendChild(this.overlay)),this.overlay.style.display="block";var F=this.overlay.querySelector("img"),X=F.style;rt()?(X.width="20%",X.marginLeft="40%",X.marginTop="3%"):(X.width="50%",X.marginLeft="25%",X.marginTop="25%")},je.prototype.hide=function(){this.overlay.style.display="none"},je.prototype.showTemporarily=function(I,F){this.show(F),this.timer=setTimeout(this.hide.bind(this),I)},je.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},je.prototype.update=function(){this.disableShowTemporarily(),!rt()&&ne()?this.show():this.hide()},je.prototype.loadIcon_=function(){this.icon=J("image/svg+xml",et)};var ht="CardboardV1",bt="WEBVR_CARDBOARD_VIEWER",kt="webvr-polyfill-viewer-selector";function Mt(I){try{this.selectedKey=localStorage.getItem(bt)}catch(F){console.error("Failed to load viewer profile: %s",F)}this.selectedKey||(this.selectedKey=I||ht),this.dialog=this.createDialog_(xr.Viewers),this.root=null,this.onChangeCallbacks_=[]}Mt.prototype.show=function(I){this.root=I,I.appendChild(this.dialog);var F=this.dialog.querySelector("#"+this.selectedKey);F.checked=!0,this.dialog.style.display="block"},Mt.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},Mt.prototype.getCurrentViewer=function(){return xr.Viewers[this.selectedKey]},Mt.prototype.getSelectedKey_=function(){var I=this.dialog.querySelector("input[name=field]:checked");return I?I.id:null},Mt.prototype.onChange=function(I){this.onChangeCallbacks_.push(I)},Mt.prototype.fireOnChange_=function(I){for(var F=0;F<this.onChangeCallbacks_.length;F++)this.onChangeCallbacks_[F](I)},Mt.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),!this.selectedKey||!xr.Viewers[this.selectedKey]){console.error("ViewerSelector.onSave_: this should never happen!");return}this.fireOnChange_(xr.Viewers[this.selectedKey]);try{localStorage.setItem(bt,this.selectedKey)}catch(I){console.error("Failed to save viewer profile: %s",I)}this.hide()},Mt.prototype.createDialog_=function(I){var F=document.createElement("div");F.classList.add(kt),F.style.display="none";var X=document.createElement("div"),q=X.style;q.position="fixed",q.left=0,q.top=0,q.width="100%",q.height="100%",q.background="rgba(0, 0, 0, 0.3)",X.addEventListener("click",this.hide.bind(this));var he=280,Oe=document.createElement("div"),q=Oe.style;q.boxSizing="border-box",q.position="fixed",q.top="24px",q.left="50%",q.marginLeft=-he/2+"px",q.width=he+"px",q.padding="24px",q.overflow="hidden",q.background="#fafafa",q.fontFamily="'Roboto', sans-serif",q.boxShadow="0px 5px 20px #666",Oe.appendChild(this.createH1_("Select your viewer"));for(var Je in I)Oe.appendChild(this.createChoice_(Je,I[Je].label));return Oe.appendChild(this.createButton_("Save",this.onSave_.bind(this))),F.appendChild(X),F.appendChild(Oe),F},Mt.prototype.createH1_=function(I){var F=document.createElement("h1"),X=F.style;return X.color="black",X.fontSize="20px",X.fontWeight="bold",X.marginTop=0,X.marginBottom="24px",F.innerHTML=I,F},Mt.prototype.createChoice_=function(I,F){var X=document.createElement("div");X.style.marginTop="8px",X.style.color="black";var q=document.createElement("input");q.style.fontSize="30px",q.setAttribute("id",I),q.setAttribute("type","radio"),q.setAttribute("value",I),q.setAttribute("name","field");var he=document.createElement("label");return he.style.marginLeft="4px",he.setAttribute("for",I),he.innerHTML=F,X.appendChild(q),X.appendChild(he),X},Mt.prototype.createButton_=function(I,F){var X=document.createElement("button");X.innerHTML=I;var q=X.style;return q.float="right",q.textTransform="uppercase",q.color="#1094f7",q.fontSize="14px",q.letterSpacing=0,q.border=0,q.background="none",q.marginTop="16px",X.addEventListener("click",F),X};var ct=typeof window!="undefined"?window:typeof A!="undefined"?A:typeof self!="undefined"?self:{};function Wt(I){return I&&I.__esModule&&Object.prototype.hasOwnProperty.call(I,"default")?I.default:I}function qt(I,F){return F={exports:{}},I(F,F.exports),F.exports}var cr=qt(function(I,F){(function(q,he){I.exports=he()})(ct,function(){return function(X){var q={};function he(Oe){if(q[Oe])return q[Oe].exports;var Je=q[Oe]={i:Oe,l:!1,exports:{}};return X[Oe].call(Je.exports,Je,Je.exports,he),Je.l=!0,Je.exports}return he.m=X,he.c=q,he.d=function(Oe,Je,ft){he.o(Oe,Je)||Object.defineProperty(Oe,Je,{configurable:!1,enumerable:!0,get:ft})},he.n=function(Oe){var Je=Oe&&Oe.__esModule?function(){return Oe.default}:function(){return Oe};return he.d(Je,"a",Je),Je},he.o=function(Oe,Je){return Object.prototype.hasOwnProperty.call(Oe,Je)},he.p="",he(he.s=0)}([function(X,q,he){var Oe=function(){function tt(mt,Bt){for(var jt=0;jt<Bt.length;jt++){var Zt=Bt[jt];Zt.enumerable=Zt.enumerable||!1,Zt.configurable=!0,"value"in Zt&&(Zt.writable=!0),Object.defineProperty(mt,Zt.key,Zt)}}return function(mt,Bt,jt){return Bt&&tt(mt.prototype,Bt),jt&&tt(mt,jt),mt}}();function Je(tt,mt){if(!(tt instanceof mt))throw new TypeError("Cannot call a class as a function")}var ft=he(1),dt=typeof navigator!="undefined"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,ze=function(){function tt(){Je(this,tt),dt?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",ft),this.noSleepVideo.addEventListener("timeupdate",function(mt){this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}.bind(this)))}return Oe(tt,[{key:"enable",value:function(){dt?(this.disable(),this.noSleepTimer=window.setInterval(function(){window.location.href="/",window.setTimeout(window.stop,0)},15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){dt?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),tt}();X.exports=ze},function(X,q,he){X.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])})}),fn=Wt(cr),Or=1e3,br=[0,0,.5,1],Hr=[.5,0,.5,1],yn=window.requestAnimationFrame,Hn=window.cancelAnimationFrame;function hr(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null}function Tr(I){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:I.hasPosition},hasExternalDisplay:{writable:!1,enumerable:!0,value:I.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:I.canPresent},maxLayers:{writable:!1,enumerable:!0,value:I.maxLayers},hasOrientation:{enumerable:!0,get:function(){return Xe("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData"),I.hasOrientation}}})}function Sr(I){I=I||{};var F="wakelock"in I?I.wakelock:!0;this.isPolyfilled=!0,this.displayId=Or++,this.displayName="",this.depthNear=.01,this.depthFar=1e4,this.isPresenting=!1,Object.defineProperty(this,"isConnected",{get:function(){return Xe("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay"),!1}}),this.capabilities=new Tr({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1}),this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.originalParent_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,F&&ne()&&(this.wakelock_=new fn)}Sr.prototype.getFrameData=function(I){return ve(I,this._getPose(),this)},Sr.prototype.getPose=function(){return Xe("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData"),this._getPose()},Sr.prototype.resetPose=function(){return Xe("VRDisplay.prototype.resetPose"),this._resetPose()},Sr.prototype.getImmediatePose=function(){return Xe("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData"),this._getPose()},Sr.prototype.requestAnimationFrame=function(I){return yn(I)},Sr.prototype.cancelAnimationFrame=function(I){return Hn(I)},Sr.prototype.wrapForFullscreen=function(I){if(j())return I;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var F=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",F.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==I)return this.fullscreenWrapper_;if(this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)),this.fullscreenElement_=I,this.originalParent_=I.parentElement,this.originalParent_||document.body.appendChild(I),!this.fullscreenWrapper_.parentElement){var X=this.fullscreenElement_.parentElement;X.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),X.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var q=this;function he(){if(!!q.fullscreenElement_){var Oe=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];q.fullscreenElement_.setAttribute("style",Oe.join("; ")+";")}}return he(),this.fullscreenWrapper_},Sr.prototype.removeFullscreenWrapper=function(){if(!!this.fullscreenElement_){var I=this.fullscreenElement_;this.fullscreenElementCachedStyle_?I.setAttribute("style",this.fullscreenElementCachedStyle_):I.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var F=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(I),this.originalParent_===F?F.insertBefore(I,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(I),F.removeChild(this.fullscreenWrapper_),I}},Sr.prototype.requestPresent=function(I){var F=this.isPresenting,X=this;return I instanceof Array||(Xe("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument"),I=[I]),new Promise(function(q,he){if(!X.capabilities.canPresent){he(new Error("VRDisplay is not capable of presenting."));return}if(I.length==0||I.length>X.capabilities.maxLayers){he(new Error("Invalid number of layers."));return}var Oe=I[0];if(!Oe.source){q();return}var Je=Oe.leftBounds||br,ft=Oe.rightBounds||Hr;if(F){var dt=X.layer_;dt.source!==Oe.source&&(dt.source=Oe.source);for(var ze=0;ze<4;ze++)dt.leftBounds[ze]=Je[ze],dt.rightBounds[ze]=ft[ze];X.wrapForFullscreen(X.layer_.source),X.updatePresent_(),q();return}if(X.layer_={predistorted:Oe.predistorted,source:Oe.source,leftBounds:Je.slice(0),rightBounds:ft.slice(0)},X.waitingForPresent_=!1,X.layer_&&X.layer_.source){var tt=X.wrapForFullscreen(X.layer_.source),mt=function(){var Zt=wt();X.isPresenting=tt===Zt,X.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(Er){console.error("screen.orientation.lock() failed due to",Er.message)}),X.waitingForPresent_=!1,X.beginPresent_(),q()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),X.removeFullscreenWrapper(),X.disableWakeLock(),X.endPresent_(),X.removeFullscreenListeners_()),X.fireVRDisplayPresentChange_()},Bt=function(){!X.waitingForPresent_||(X.removeFullscreenWrapper(),X.removeFullscreenListeners_(),X.disableWakeLock(),X.waitingForPresent_=!1,X.isPresenting=!1,he(new Error("Unable to present.")))};X.addFullscreenListeners_(tt,mt,Bt),er(tt)?(X.enableWakeLock(),X.waitingForPresent_=!0):(j()||ae())&&(X.enableWakeLock(),X.isPresenting=!0,X.beginPresent_(),X.fireVRDisplayPresentChange_(),q())}!X.waitingForPresent_&&!j()&&(zt(),he(new Error("Unable to present.")))})},Sr.prototype.exitPresent=function(){var I=this.isPresenting,F=this;return this.isPresenting=!1,this.layer_=null,this.disableWakeLock(),new Promise(function(X,q){I?(!zt()&&j()&&(F.endPresent_(),F.fireVRDisplayPresentChange_()),ae()&&(F.removeFullscreenWrapper(),F.removeFullscreenListeners_(),F.endPresent_(),F.fireVRDisplayPresentChange_()),X()):q(new Error("Was not presenting to VRDisplay."))})},Sr.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},Sr.prototype.fireVRDisplayPresentChange_=function(){var I=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(I)},Sr.prototype.fireVRDisplayConnect_=function(){var I=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(I)},Sr.prototype.addFullscreenListeners_=function(I,F,X){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=I,this.fullscreenChangeHandler_=F,this.fullscreenErrorHandler_=X,F&&(document.fullscreenEnabled?I.addEventListener("fullscreenchange",F,!1):document.webkitFullscreenEnabled?I.addEventListener("webkitfullscreenchange",F,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",F,!1):document.msFullscreenEnabled&&I.addEventListener("msfullscreenchange",F,!1)),X&&(document.fullscreenEnabled?I.addEventListener("fullscreenerror",X,!1):document.webkitFullscreenEnabled?I.addEventListener("webkitfullscreenerror",X,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",X,!1):document.msFullscreenEnabled&&I.addEventListener("msfullscreenerror",X,!1))},Sr.prototype.removeFullscreenListeners_=function(){if(!!this.fullscreenEventTarget_){var I=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var F=this.fullscreenChangeHandler_;I.removeEventListener("fullscreenchange",F,!1),I.removeEventListener("webkitfullscreenchange",F,!1),document.removeEventListener("mozfullscreenchange",F,!1),I.removeEventListener("msfullscreenchange",F,!1)}if(this.fullscreenErrorHandler_){var X=this.fullscreenErrorHandler_;I.removeEventListener("fullscreenerror",X,!1),I.removeEventListener("webkitfullscreenerror",X,!1),document.removeEventListener("mozfullscreenerror",X,!1),I.removeEventListener("msfullscreenerror",X,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},Sr.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()},Sr.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()},Sr.prototype.beginPresent_=function(){},Sr.prototype.endPresent_=function(){},Sr.prototype.submitFrame=function(I){},Sr.prototype.getEyeParameters=function(I){return null};var si={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},sn={LEFT:"left",RIGHT:"right"};function pn(I){var F=ie({},si);I=ie(F,I||{}),Sr.call(this,{wakelock:I.MOBILE_WAKE_LOCK}),this.config=I,this.displayName="Cardboard VRDisplay",this.capabilities=new Tr({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,canPresent:!0,maxLayers:1}),this.stageParameters=null,this.bufferScale_=this.config.BUFFER_SCALE,this.poseSensor_=new Ge(this.config),this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new on(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new xr(this.dpdb_.getDeviceParams(),I.ADDITIONAL_VIEWERS),this.viewerSelector_=new Mt(I.DEFAULT_VIEWER),this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new je),j()&&window.addEventListener("resize",this.onResize_.bind(this))}return pn.prototype=Object.create(Sr.prototype),pn.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},pn.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()},pn.prototype._getFieldOfView=function(I){var F;if(I==sn.LEFT)F=this.deviceInfo_.getFieldOfViewLeftEye();else if(I==sn.RIGHT)F=this.deviceInfo_.getFieldOfViewRightEye();else return console.error("Invalid eye provided: %s",I),null;return F},pn.prototype._getEyeOffset=function(I){var F;if(I==sn.LEFT)F=[-this.deviceInfo_.viewer.interLensDistance*.5,0,0];else if(I==sn.RIGHT)F=[this.deviceInfo_.viewer.interLensDistance*.5,0,0];else return console.error("Invalid eye provided: %s",I),null;return F},pn.prototype.getEyeParameters=function(I){var F=this._getEyeOffset(I),X=this._getFieldOfView(I),q={offset:F,renderWidth:this.deviceInfo_.device.width*.5*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};return Object.defineProperty(q,"fieldOfView",{enumerable:!0,get:function(){return Xe("VRFieldOfView","VRFrameData's projection matrices"),X}}),q},pn.prototype.onDeviceParamsUpdated_=function(I){this.config.DEBUG&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(I),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},pn.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},pn.prototype.beginPresent_=function(){var I=this.layer_.source.getContext("webgl");I||(I=this.layer_.source.getContext("experimental-webgl")),I||(I=this.layer_.source.getContext("webgl2")),!!I&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(I.canvas.width=St()*this.bufferScale_,I.canvas.height=Gt()*this.bufferScale_,this.cardboardUI_=new hn(I)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new hn(I)),this.distorter_=new U(I,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen(function(F){this.viewerSelector_.show(this.layer_.source.parentElement),F.stopPropagation(),F.preventDefault()}.bind(this),function(F){this.exitPresent(),F.stopPropagation(),F.preventDefault()}.bind(this)),this.rotateInstructions_&&(rt()&&ne()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},pn.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},pn.prototype.updatePresent_=function(){this.endPresent_(),this.beginPresent_()},pn.prototype.submitFrame=function(I){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var F=this.layer_.source.getContext("webgl");F||(F=this.layer_.source.getContext("experimental-webgl")),F||(F=this.layer_.source.getContext("webgl2"));var X=F.canvas;(X.width!=this.lastWidth||X.height!=this.lastHeight)&&this.cardboardUI_.onResize(),this.lastWidth=X.width,this.lastHeight=X.height,this.cardboardUI_.render()}},pn.prototype.onOrientationChange_=function(I){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},pn.prototype.onResize_=function(I){if(this.layer_){var F=this.layer_.source.getContext("webgl");F||(F=this.layer_.source.getContext("experimental-webgl")),F||(F=this.layer_.source.getContext("webgl2"));var X=["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"];F.canvas.setAttribute("style",X.join("; ")+";"),ge(F.canvas)}},pn.prototype.onViewerChanged_=function(I){this.deviceInfo_.setViewer(I),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},pn.prototype.fireVRDisplayDeviceParamsChange_=function(){var I=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(I)},pn.VRFrameData=hr,pn.VRDisplay=Sr,pn})}),f=E(m),b="0.10.12",g={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",PROVIDE_MOBILE_VRDISPLAY:!0,MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1};function y(R){this.config=d(d({},g),R),this.polyfillDisplays=[],this.enabled=!1,this.hasNative="getVRDisplays"in navigator,this.native={},this.native.getVRDisplays=navigator.getVRDisplays,this.native.VRFrameData=window.VRFrameData,this.native.VRDisplay=window.VRDisplay,(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&h())&&(this.enable(),this.getVRDisplays().then(function(D){D&&D[0]&&D[0].fireVRDisplayConnect_&&D[0].fireVRDisplayConnect_()}))}y.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated)return this.polyfillDisplays;if(h()){var R=new f({ADDITIONAL_VIEWERS:this.config.ADDITIONAL_VIEWERS,DEFAULT_VIEWER:this.config.DEFAULT_VIEWER,MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push(R)}return this._polyfillDisplaysPopulated=!0,this.polyfillDisplays},y.prototype.enable=function(){if(this.enabled=!0,this.hasNative&&this.native.VRFrameData){var R=this.native.VRFrameData,D=new this.native.VRFrameData,N=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(z){if(z instanceof R){N.call(this,z);return}N.call(this,D),z.pose=D.pose,v(D.leftProjectionMatrix,z.leftProjectionMatrix),v(D.rightProjectionMatrix,z.rightProjectionMatrix),v(D.leftViewMatrix,z.leftViewMatrix),v(D.rightViewMatrix,z.rightViewMatrix)}}navigator.getVRDisplays=this.getVRDisplays.bind(this),window.VRDisplay=f.VRDisplay,window.VRFrameData=f.VRFrameData},y.prototype.getVRDisplays=function(){var R=this;return this.config,this.hasNative?this.native.getVRDisplays.call(navigator).then(function(D){return D.length>0?D:R.getPolyfillDisplays()}):Promise.resolve(this.getPolyfillDisplays())},y.version=b,y.VRFrameData=f.VRFrameData,y.VRDisplay=f.VRDisplay;var x=Object.freeze({default:y}),L=x&&y||x;typeof A!="undefined"&&A.window&&(A.document||(A.document=A.window.document),A.navigator||(A.navigator=A.window.navigator));var M=L;return M})}).call(this,typeof da!="undefined"?da:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],69:[function(_,G,fe){var u=/\n/,A=`
`,E=/\s/;G.exports=function(f,b){var g=G.exports.lines(f,b);return g.map(function(y){return f.substring(y.start,y.end)}).join(`
`)},G.exports.lines=function(b,g){if(g=g||{},g.width===0&&g.mode!=="nowrap")return[];b=b||"";var y=typeof g.width=="number"?g.width:Number.MAX_VALUE,x=Math.max(0,g.start||0),L=typeof g.end=="number"?g.end:b.length,M=g.mode,R=g.measure||m;return M==="pre"?v(R,b,x,L,y):d(R,b,x,L,y,M)};function w(f,b,g,y){var x=f.indexOf(b,g);return x===-1||x>y?y:x}function h(f){return E.test(f)}function v(f,b,g,y,x){for(var L=[],M=g,R=g;R<y&&R<b.length;R++){var D=b.charAt(R),N=u.test(D);if(N||R===y-1){var z=N?R:R+1,re=f(b,M,z,x);L.push(re),M=R+1}}return L}function d(f,b,g,y,x,L){var M=[],R=x;for(L==="nowrap"&&(R=Number.MAX_VALUE);g<y&&g<b.length;){for(var D=w(b,A,g,y);g<D&&h(b.charAt(g));)g++;var N=f(b,g,D,R),z=g+(N.end-N.start),re=z+A.length;if(z<D){for(;z>g&&!h(b.charAt(z));)z--;if(z===g)re>g+A.length&&re--,z=re;else for(re=z;z>g&&h(b.charAt(z-A.length));)z--}if(z>=g){var Y=f(b,g,z,R);M.push(Y)}g=re}return M}function m(f,b,g,y){var x=Math.min(y,g-b);return{start:b,end:b+x}}},{}],70:[function(_,G,fe){var u=_("global/window"),A=_("is-function"),E=_("parse-headers"),w=_("xtend");G.exports=m,G.exports.default=m,m.XMLHttpRequest=u.XMLHttpRequest||g,m.XDomainRequest="withCredentials"in new m.XMLHttpRequest?m.XMLHttpRequest:u.XDomainRequest,h(["get","put","post","patch","head","delete"],function(y){m[y==="delete"?"del":y]=function(x,L,M){return L=d(x,L,M),L.method=y.toUpperCase(),f(L)}});function h(y,x){for(var L=0;L<y.length;L++)x(y[L])}function v(y){for(var x in y)if(y.hasOwnProperty(x))return!1;return!0}function d(y,x,L){var M=y;return A(x)?(L=x,typeof y=="string"&&(M={uri:y})):M=w(x,{uri:y}),M.callback=L,M}function m(y,x,L){return x=d(y,x,L),f(x)}function f(y){if(typeof y.callback=="undefined")throw new Error("callback argument missing");var x=!1,L=function(ke,it,rt){x||(x=!0,y.callback(ke,it,rt))};function M(){z.readyState===4&&setTimeout(N,0)}function R(){var We=void 0;if(z.response?We=z.response:We=z.responseText||b(z),Z)try{We=JSON.parse(We)}catch{}return We}function D(We){return clearTimeout(ye),We instanceof Error||(We=new Error(""+(We||"Unknown XMLHttpRequest Error"))),We.statusCode=0,L(We,Ne)}function N(){if(!Y){var We;clearTimeout(ye),y.useXDR&&z.status===void 0?We=200:We=z.status===1223?204:z.status;var ke=Ne,it=null;return We!==0?(ke={body:R(),statusCode:We,method:J,headers:{},url:te,rawRequest:z},z.getAllResponseHeaders&&(ke.headers=E(z.getAllResponseHeaders()))):it=new Error("Internal XMLHttpRequest Error"),L(it,ke,ke.body)}}var z=y.xhr||null;z||(y.cors||y.useXDR?z=new m.XDomainRequest:z=new m.XMLHttpRequest);var re,Y,te=z.url=y.uri||y.url,J=z.method=y.method||"GET",le=y.body||y.data,j=z.headers=y.headers||{},ae=!!y.sync,Z=!1,ye,Ne={body:void 0,headers:{},statusCode:0,method:J,url:te,rawRequest:z};if("json"in y&&y.json!==!1&&(Z=!0,j.accept||j.Accept||(j.Accept="application/json"),J!=="GET"&&J!=="HEAD"&&(j["content-type"]||j["Content-Type"]||(j["Content-Type"]="application/json"),le=JSON.stringify(y.json===!0?le:y.json))),z.onreadystatechange=M,z.onload=N,z.onerror=D,z.onprogress=function(){},z.onabort=function(){Y=!0},z.ontimeout=D,z.open(J,te,!ae,y.username,y.password),ae||(z.withCredentials=!!y.withCredentials),!ae&&y.timeout>0&&(ye=setTimeout(function(){if(!Y){Y=!0,z.abort("timeout");var We=new Error("XMLHttpRequest timeout");We.code="ETIMEDOUT",D(We)}},y.timeout)),z.setRequestHeader)for(re in j)j.hasOwnProperty(re)&&z.setRequestHeader(re,j[re]);else if(y.headers&&!v(y.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in y&&(z.responseType=y.responseType),"beforeSend"in y&&typeof y.beforeSend=="function"&&y.beforeSend(z),z.send(le||null),z}function b(y){try{if(y.responseType==="document")return y.responseXML;var x=y.responseXML&&y.responseXML.documentElement.nodeName==="parsererror";if(y.responseType===""&&!x)return y.responseXML}catch{}return null}function g(){}},{"global/window":27,"is-function":33,"parse-headers":47,xtend:72}],71:[function(_,G,fe){G.exports=function(){return typeof self.DOMParser!="undefined"?function(A){var E=new self.DOMParser;return E.parseFromString(A,"application/xml")}:typeof self.ActiveXObject!="undefined"&&new self.ActiveXObject("Microsoft.XMLDOM")?function(A){var E=new self.ActiveXObject("Microsoft.XMLDOM");return E.async="false",E.loadXML(A),E}:function(A){var E=document.createElement("div");return E.innerHTML=A,E}}()},{}],72:[function(_,G,fe){G.exports=A;var u=Object.prototype.hasOwnProperty;function A(){for(var E={},w=0;w<arguments.length;w++){var h=arguments[w];for(var v in h)u.call(h,v)&&(E[v]=h[v])}return E}},{}],73:[function(_,G,fe){G.exports={name:"aframe",version:"1.2.0",description:"A web framework for building virtual reality experiences.",homepage:"https://aframe.io/",main:"dist/aframe-master.js",scripts:{browserify:"browserify src/index.js -s 'AFRAME' -p browserify-derequire",build:"shx mkdir -p build/ && npm run browserify -- --debug -t [ envify --INSPECTOR_VERSION dev ] -o build/aframe.js",codecov:"codecov",dev:"npm run build && cross-env INSPECTOR_VERSION=dev node ./scripts/budo -t envify",dist:"node scripts/updateVersionLog.js && npm run dist:min && npm run dist:max","dist:max":"npm run browserify -s -- --debug | exorcist dist/aframe-master.js.map > dist/aframe-master.js","dist:min":"npm run browserify -s -- --debug -p [ minifyify --map aframe-master.min.js.map --output dist/aframe-master.min.js.map ] -o dist/aframe-master.min.js",docs:"markserv --dir docs --port 9001",preghpages:"node ./scripts/preghpages.js",ghpages:"ghpages -p gh-pages/",lint:"semistandard -v | snazzy","lint:fix":"semistandard --fix",precommit:"npm run lint",prepush:"node scripts/testOnlyCheck.js",prerelease:"node scripts/release.js 1.0.4 1.1.0",start:"npm run dev","start:https":"cross-env SSL=true npm run dev",test:"karma start ./tests/karma.conf.js","test:docs":"node scripts/docsLint.js","test:firefox":"npm test -- --browsers Firefox","test:chrome":"npm test -- --browsers Chrome","test:nobrowser":"NO_BROWSER=true npm test","test:node":"mocha --ui tdd tests/node"},repository:"aframevr/aframe",license:"MIT",files:["dist/*","docs/**/*","src/**/*","vendor/**/*"],dependencies:{"custom-event-polyfill":"^1.0.6",debug:"ngokevin/debug#noTimestamp","deep-assign":"^2.0.0","document-register-element":"dmarcos/document-register-element#8ccc532b7f3744be954574caf3072a5fd260ca90","load-bmfont":"^1.2.3","object-assign":"^4.0.1",present:"0.0.6","promise-polyfill":"^3.1.0","super-animejs":"^3.1.0","super-three":"^0.125.1","three-bmfont-text":"dmarcos/three-bmfont-text#1babdf8507c731a18f8af3b807292e2b9740955e","webvr-polyfill":"^0.10.12"},devDependencies:{browserify:"^13.1.0","browserify-css":"^0.8.4","browserify-derequire":"^0.9.4","browserify-istanbul":"^2.0.0",budo:"^9.2.0",chai:"^3.5.0","chai-shallow-deep-equal":"^1.4.0",chalk:"^1.1.3",codecov:"^1.0.1","cross-env":"^5.0.1",envify:"^3.4.1",exorcist:"^0.4.0",ghpages:"0.0.8","git-rev":"^0.2.1",glob:"^7.1.1",husky:"^0.11.7",istanbul:"^0.4.5",jsdom:"^9.11.0",karma:"1.4.1","karma-browserify":"^5.1.0","karma-chai-shallow-deep-equal":"0.0.4","karma-chrome-launcher":"^2.0.0","karma-coverage":"^1.1.1","karma-env-preprocessor":"^0.1.1","karma-firefox-launcher":"^1.2.0","karma-mocha":"^1.1.1","karma-mocha-reporter":"^2.1.0","karma-sinon-chai":"1.2.4",lolex:"^1.5.1",markserv:"github:sukima/markserv#feature/fix-broken-websoketio-link",minifyify:"^7.3.3",mocha:"^3.0.2","mozilla-download":"^1.1.1","replace-in-file":"^2.5.3",semistandard:"^9.0.0",shelljs:"^0.7.7",shx:"^0.2.2",sinon:"^1.17.5","sinon-chai":"2.8.0",snazzy:"^5.0.0","too-wordy":"ngokevin/too-wordy",uglifyjs:"^2.4.10","write-good":"^0.9.1"},link:!0,browserify:{transform:["browserify-css","envify"]},semistandard:{ignore:["build/**","dist/**","examples/**/shaders/*.js","**/vendor/**"]},keywords:["3d","aframe","cardboard","components","oculus","three","three.js","rift","vive","vr","web-components","webvr"],"browserify-css":{minify:!0},engines:{node:">= 4.6.0",npm:"^2.15.9"}}},{}],74:[function(_,G,fe){var u=_("super-animejs"),A=_("../core/component").components,E=_("../core/component").registerComponent,w=_("../lib/three"),h=_("../utils"),v=new w.Color,d=new w.Color,m=h.entity.getComponentProperty,f=h.entity.setComponentProperty,b={},g="color",y="position",x="rotation",L="scale",M="components",R="object3D";G.exports.Component=E("animation",{schema:{autoplay:{default:!0},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:!0},from:{default:""},loop:{default:0,parse:function(j){return j===!0||j==="true"?!0:j===!1||j==="false"?!1:parseInt(j,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:!1},to:{default:""},type:{default:""},isRawProperty:{default:!1}},multiple:!0,init:function(){var j=this;this.eventDetail={name:this.attrName},this.time=0,this.animation=null,this.animationIsPlaying=!1,this.onStartEvent=this.onStartEvent.bind(this),this.beginAnimation=this.beginAnimation.bind(this),this.pauseAnimation=this.pauseAnimation.bind(this),this.resumeAnimation=this.resumeAnimation.bind(this),this.fromColor={},this.toColor={},this.targets={},this.targetsArray=[],this.updateConfigForDefault=this.updateConfigForDefault.bind(this),this.updateConfigForRawColor=this.updateConfigForRawColor.bind(this),this.config={complete:function(){j.animationIsPlaying=!1,j.el.emit("animationcomplete",j.eventDetail,!1),j.id&&j.el.emit("animationcomplete__"+j.id,j.eventDetail,!1)}}},update:function(j){var ae=this.config,Z=this.data;this.animationIsPlaying=!1,!!this.data.enabled&&(!Z.property||(ae.autoplay=!1,ae.direction=Z.dir,ae.duration=Z.dur,ae.easing=Z.easing,ae.elasticity=Z.elasticity,ae.loop=Z.loop,ae.round=Z.round,this.createAndStartAnimation()))},tick:function(j,ae){!this.animationIsPlaying||(this.time+=ae,this.animation.tick(this.time))},remove:function(){this.pauseAnimation(),this.removeEventListeners()},pause:function(){this.paused=!0,this.pausedWasPlaying=this.animationIsPlaying,this.pauseAnimation(),this.removeEventListeners()},play:function(){!this.paused||(this.paused=!1,this.addEventListeners(),this.pausedWasPlaying&&(this.resumeAnimation(),this.pausedWasPlaying=!1))},createAndStartAnimation:function(){var j=this.data;if(this.updateConfig(),this.animationIsPlaying=!1,this.animation=u(this.config),this.animation.began=!0,this.removeEventListeners(),this.addEventListeners(),!(!j.autoplay||j.startEvents&&j.startEvents.length)){if(j.delay){setTimeout(this.beginAnimation,j.delay);return}this.beginAnimation()}},beginAnimation:function(){this.updateConfig(),this.animation.began=!0,this.time=0,this.animationIsPlaying=!0,this.stopRelatedAnimations(),this.el.emit("animationbegin",this.eventDetail,!1)},pauseAnimation:function(){this.animationIsPlaying=!1},resumeAnimation:function(){this.animationIsPlaying=!0},onStartEvent:function(){if(!!this.data.enabled){if(this.updateConfig(),this.animation&&this.animation.pause(),this.animation=u(this.config),this.data.delay){setTimeout(this.beginAnimation,this.data.delay);return}this.beginAnimation()}},updateConfigForRawColor:function(){var j=this.config,ae=this.data,Z=this.el,ye,Ne,We;if(!this.waitComponentInitRawProperty(this.updateConfigForRawColor)){ye=ae.from===""?Y(Z,ae.property):ae.from,We=ae.to,this.setColorConfig(ye,We),ye=this.fromColor,We=this.toColor,this.targetsArray.length=0,this.targetsArray.push(ye),j.targets=this.targetsArray;for(Ne in We)j[Ne]=We[Ne];j.update=function(){var ke={};return function(it){var rt;rt=it.animatables[0].target,!(rt.r===ke.r&&rt.g===ke.g&&rt.b===ke.b)&&te(Z,ae.property,rt,ae.type)}}()}},updateConfigForDefault:function(){var j=this.config,ae=this.data,Z=this.el,ye,Ne,We,ke;this.waitComponentInitRawProperty(this.updateConfigForDefault)||(ae.from===""?ye=le(ae)?Y(Z,ae.property):m(Z,ae.property):ye=ae.from,ke=ae.to,We=!isNaN(ye||ke),We?(ye=parseFloat(ye),ke=parseFloat(ke)):(ye=ye&&ye.toString(),ke=ke&&ke.toString()),Ne=ae.to==="true"||ae.to==="false"||ae.to===!0||ae.to===!1,Ne&&(ye=ae.from==="true"||ae.from===!0?1:0,ke=ae.to==="true"||ae.to===!0?1:0),this.targets.aframeProperty=ye,j.targets=this.targets,j.aframeProperty=ke,j.update=function(){var it;return function(rt){var At;At=rt.animatables[0].target.aframeProperty,At!==it&&(it=At,Ne&&(At=At>=1),le(ae)?te(Z,ae.property,At,ae.type):f(Z,ae.property,At))}}())},updateConfigForVector:function(){var j=this.config,ae=this.data,Z=this.el,ye,Ne,We;Ne=ae.from!==""?h.coordinates.parse(ae.from):m(Z,ae.property),We=h.coordinates.parse(ae.to),ae.property===x&&(N(Ne),N(We)),this.targetsArray.length=0,this.targetsArray.push(Ne),j.targets=this.targetsArray;for(ye in We)j[ye]=We[ye];if(ae.property===y||ae.property===x||ae.property===L){j.update=function(){var ke={};return function(it){var rt=it.animatables[0].target;ae.property===L&&(rt.x=Math.max(1e-4,rt.x),rt.y=Math.max(1e-4,rt.y),rt.z=Math.max(1e-4,rt.z)),!(rt.x===ke.x&&rt.y===ke.y&&rt.z===ke.z)&&(ke.x=rt.x,ke.y=rt.y,ke.z=rt.z,Z.object3D[ae.property].set(rt.x,rt.y,rt.z))}}();return}j.update=function(){var ke={};return function(it){var rt=it.animatables[0].target;rt.x===ke.x&&rt.y===ke.y&&rt.z===ke.z||(ke.x=rt.x,ke.y=rt.y,ke.z=rt.z,f(Z,ae.property,rt))}}()},updateConfig:function(){var j;j=D(this.el,this.data.property),le(this.data)&&this.data.type===g?this.updateConfigForRawColor():j==="vec2"||j==="vec3"||j==="vec4"?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(j){var ae,Z=this.data,ye=this.el,Ne=this;return Z.from!==""||!Z.property.startsWith(M)||(ae=J(Z.property)[1],ye.components[ae])?!1:(ye.addEventListener("componentinitialized",function We(ke){ke.detail.name===ae&&(j(),Ne.animation=u(Ne.config),ye.removeEventListener("componentinitialized",We))}),!0)},stopRelatedAnimations:function(){var j,ae;for(ae in this.el.components)j=this.el.components[ae],ae!==this.attrName&&j.name==="animation"&&(!j.animationIsPlaying||j.data.property===this.data.property&&(j.animationIsPlaying=!1))},addEventListeners:function(){var j=this.data,ae=this.el;z(ae,j.startEvents,this.onStartEvent),z(ae,j.pauseEvents,this.pauseAnimation),z(ae,j.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){var j=this.data,ae=this.el;re(ae,j.startEvents,this.onStartEvent),re(ae,j.pauseEvents,this.pauseAnimation),re(ae,j.resumeEvents,this.resumeAnimation)},setColorConfig:function(j,ae){v.set(j),d.set(ae),j=this.fromColor,ae=this.toColor,j.r=v.r,j.g=v.g,j.b=v.b,ae.r=d.r,ae.g=d.g,ae.b=d.b}});function D(j,ae){var Z,ye,Ne,We;return Ne=ae.split("."),ye=Ne[0],We=Ne[1],Z=j.components[ye]||A[ye],!Z||We&&!Z.schema[We]?null:We?Z.schema[We].type:Z.schema.type}function N(j){j.x=w.Math.degToRad(j.x),j.y=w.Math.degToRad(j.y),j.z=w.Math.degToRad(j.z)}function z(j,ae,Z){var ye;for(ye=0;ye<ae.length;ye++)j.addEventListener(ae[ye],Z)}function re(j,ae,Z){var ye;for(ye=0;ye<ae.length;ye++)j.removeEventListener(ae[ye],Z)}function Y(j,ae){var Z,ye,Ne;for(ye=J(ae),Ne=j,Z=0;Z<ye.length;Z++)Ne=Ne[ye[Z]];if(Ne===void 0)throw console.log(j),new Error("[animation] property ("+ae+") could not be found");return Ne}function te(j,ae,Z,ye){var Ne,We,ke,it;for(ae.startsWith("object3D.rotation")&&(Z=w.Math.degToRad(Z)),We=J(ae),it=j,Ne=0;Ne<We.length-1;Ne++)it=it[We[Ne]];if(ke=We[We.length-1],ye===g){"r"in it[ke]?(it[ke].r=Z.r,it[ke].g=Z.g,it[ke].b=Z.b):(it[ke].x=Z.r,it[ke].y=Z.g,it[ke].z=Z.b);return}it[ke]=Z}function J(j){return j in b||(b[j]=j.split(".")),b[j]}function le(j){return j.isRawProperty||j.property.startsWith(M)||j.property.startsWith(R)}},{"../core/component":131,"../lib/three":179,"../utils":205,"super-animejs":56}],75:[function(_,G,fe){var u=_("../core/component").registerComponent,A=_("../lib/three");G.exports.Component=u("camera",{schema:{active:{default:!0},far:{default:1e4},fov:{default:80,min:0},near:{default:.005,min:0},spectator:{default:!1},zoom:{default:1,min:0}},init:function(){var E,w=this.el;E=this.camera=new A.PerspectiveCamera,w.setObject3D("camera",E)},update:function(E){var w=this.data,h=this.camera;h.aspect=w.aspect||window.innerWidth/window.innerHeight,h.far=w.far,h.fov=w.fov,h.near=w.near,h.zoom=w.zoom,h.updateProjectionMatrix(),this.updateActiveCamera(E),this.updateSpectatorCamera(E)},updateActiveCamera:function(E){var w=this.data,h=this.el,v=this.system;E&&E.active===w.active||w.spectator||(w.active&&v.activeCameraEl!==h?v.setActiveCamera(h):!w.active&&v.activeCameraEl===h&&v.disableActiveCamera())},updateSpectatorCamera:function(E){var w=this.data,h=this.el,v=this.system;E&&E.spectator===w.spectator||(w.spectator&&v.spectatorCameraEl!==h?v.setSpectatorCamera(h):!w.spectator&&v.spectatorCameraEl===h&&v.disableSpectatorCamera())},remove:function(){this.el.removeObject3D("camera")}})},{"../core/component":131,"../lib/three":179}],76:[function(_,G,fe){var u=_("../core/component").registerComponent,A=_("../utils/"),E=A.bind,w={CLICK:"click",FUSING:"fusing",MOUSEENTER:"mouseenter",MOUSEDOWN:"mousedown",MOUSELEAVE:"mouseleave",MOUSEUP:"mouseup"},h={FUSING:"cursor-fusing",HOVERING:"cursor-hovering",HOVERED:"cursor-hovered"},v={DOWN:["mousedown","touchstart"],UP:["mouseup","touchend"]},d={DOWN:["selectstart"],UP:["selectend"]},m="a-mouse-cursor-hover";G.exports.Component=u("cursor",{dependencies:["raycaster"],schema:{downEvents:{default:[]},fuse:{default:A.device.isMobile()},fuseTimeout:{default:1500,min:0},mouseCursorStylesEnabled:{default:!0},upEvents:{default:[]},rayOrigin:{default:"entity",oneOf:["mouse","entity"]}},init:function(){var f=this;this.fuseTimeout=void 0,this.cursorDownEl=null,this.intersectedEl=null,this.canvasBounds=document.body.getBoundingClientRect(),this.isCursorDown=!1,this.updateCanvasBounds=A.debounce(function(){f.canvasBounds=f.el.sceneEl.canvas.getBoundingClientRect()},500),this.eventDetail={},this.intersectedEventDetail={cursorEl:this.el},this.onCursorDown=E(this.onCursorDown,this),this.onCursorUp=E(this.onCursorUp,this),this.onIntersection=E(this.onIntersection,this),this.onIntersectionCleared=E(this.onIntersectionCleared,this),this.onMouseMove=E(this.onMouseMove,this),this.onEnterVR=E(this.onEnterVR,this)},update:function(f){this.data.rayOrigin!==f.rayOrigin&&this.updateMouseEventListeners()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){var f=this.el;f.removeState(h.HOVERING),f.removeState(h.FUSING),clearTimeout(this.fuseTimeout),this.intersectedEl&&this.intersectedEl.removeState(h.HOVERED),this.removeEventListeners()},addEventListeners:function(){var f,b=this.data,g=this.el,y=this;function x(){f=g.sceneEl.canvas,!(b.downEvents.length||b.upEvents.length)&&(v.DOWN.forEach(function(L){f.addEventListener(L,y.onCursorDown)}),v.UP.forEach(function(L){f.addEventListener(L,y.onCursorUp)}))}f=g.sceneEl.canvas,f?x():g.sceneEl.addEventListener("render-target-loaded",x),b.downEvents.forEach(function(L){g.addEventListener(L,y.onCursorDown)}),b.upEvents.forEach(function(L){g.addEventListener(L,y.onCursorUp)}),g.addEventListener("raycaster-intersection",this.onIntersection),g.addEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),g.sceneEl.addEventListener("rendererresize",this.updateCanvasBounds),g.sceneEl.addEventListener("enter-vr",this.onEnterVR),window.addEventListener("resize",this.updateCanvasBounds),window.addEventListener("scroll",this.updateCanvasBounds),this.updateMouseEventListeners()},removeEventListeners:function(){var f,b=this.data,g=this.el,y=this;f=g.sceneEl.canvas,f&&!b.downEvents.length&&!b.upEvents.length&&(v.DOWN.forEach(function(x){f.removeEventListener(x,y.onCursorDown)}),v.UP.forEach(function(x){f.removeEventListener(x,y.onCursorUp)})),b.downEvents.forEach(function(x){g.removeEventListener(x,y.onCursorDown)}),b.upEvents.forEach(function(x){g.removeEventListener(x,y.onCursorUp)}),g.removeEventListener("raycaster-intersection",this.onIntersection),g.removeEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),f.removeEventListener("mousemove",this.onMouseMove),f.removeEventListener("touchstart",this.onMouseMove),f.removeEventListener("touchmove",this.onMouseMove),g.sceneEl.removeEventListener("rendererresize",this.updateCanvasBounds),g.sceneEl.removeEventListener("enter-vr",this.onEnterVR),window.removeEventListener("resize",this.updateCanvasBounds),window.removeEventListener("scroll",this.updateCanvasBounds)},updateMouseEventListeners:function(){var f,b=this.el;f=b.sceneEl.canvas,f.removeEventListener("mousemove",this.onMouseMove),f.removeEventListener("touchmove",this.onMouseMove),b.setAttribute("raycaster","useWorldCoordinates",!1),this.data.rayOrigin==="mouse"&&(f.addEventListener("mousemove",this.onMouseMove,!1),f.addEventListener("touchmove",this.onMouseMove,!1),b.setAttribute("raycaster","useWorldCoordinates",!0),this.updateCanvasBounds())},onMouseMove:function(){var f=new THREE.Vector3,b=new THREE.Vector2,g=new THREE.Vector3,y={origin:g,direction:f};return function(x){var L=this.canvasBounds,M=this.el.sceneEl.camera,R,D,N;M.parent.updateMatrixWorld(),x.type==="touchmove"||x.type==="touchstart"?D=x.touches.item(0):D=x,R=D.clientX-L.left,N=D.clientY-L.top,b.x=R/L.width*2-1,b.y=-(N/L.height)*2+1,g.setFromMatrixPosition(M.matrixWorld),f.set(b.x,b.y,.5).unproject(M).sub(g).normalize(),this.el.setAttribute("raycaster",y),x.type==="touchmove"&&x.preventDefault()}}(),onCursorDown:function(f){this.isCursorDown=!0,this.data.rayOrigin==="mouse"&&f.type==="touchstart"&&(this.onMouseMove(f),this.el.components.raycaster.checkIntersections(),f.preventDefault()),this.twoWayEmit(w.MOUSEDOWN),this.cursorDownEl=this.intersectedEl},onCursorUp:function(f){if(!!this.isCursorDown){this.isCursorDown=!1;var b=this.data;this.twoWayEmit(w.MOUSEUP),this.cursorDownEl&&this.cursorDownEl!==this.intersectedEl&&(this.intersectedEventDetail.intersection=null,this.cursorDownEl.emit(w.MOUSEUP,this.intersectedEventDetail)),(!b.fuse||b.rayOrigin==="mouse")&&this.intersectedEl&&this.cursorDownEl===this.intersectedEl&&this.twoWayEmit(w.CLICK),this.cursorDownEl=null,f.type==="touchend"&&f.preventDefault()}},onIntersection:function(f){var b,g=this.el,y,x,L;y=f.detail.els[0]===g?1:0,L=f.detail.intersections[y],x=f.detail.els[y],!!x&&this.intersectedEl!==x&&(this.intersectedEl&&(b=this.el.components.raycaster.getIntersection(this.intersectedEl),b&&b.distance<=L.distance)||(this.clearCurrentIntersection(!0),this.setIntersection(x,L)))},onIntersectionCleared:function(f){var b=f.detail.clearedEls;b.indexOf(this.intersectedEl)!==-1&&this.clearCurrentIntersection()},onEnterVR:function(){this.clearCurrentIntersection(!0);var f=this.el.sceneEl.xrSession,b=this;!f||this.data.rayOrigin!=="mouse"&&(d.DOWN.forEach(function(g){f.addEventListener(g,b.onCursorDown)}),d.UP.forEach(function(g){f.addEventListener(g,b.onCursorUp)}))},setIntersection:function(f,b){var g=this.el,y=this.data,x=this;this.intersectedEl!==f&&(this.intersectedEl=f,g.addState(h.HOVERING),f.addState(h.HOVERED),this.twoWayEmit(w.MOUSEENTER),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.add(m),!(y.fuseTimeout===0||!y.fuse)&&(g.addState(h.FUSING),this.twoWayEmit(w.FUSING),this.fuseTimeout=setTimeout(function(){g.removeState(h.FUSING),x.twoWayEmit(w.CLICK)},y.fuseTimeout)))},clearCurrentIntersection:function(f){var b,g,y,x=this.el;!this.intersectedEl||(this.intersectedEl.removeState(h.HOVERED),x.removeState(h.HOVERING),x.removeState(h.FUSING),this.twoWayEmit(w.MOUSELEAVE),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.remove(m),this.intersectedEl=null,clearTimeout(this.fuseTimeout),f!==!0&&(y=this.el.components.raycaster.intersections,y.length!==0&&(b=y[0].object.el===x?1:0,g=y[b],!!g&&this.setIntersection(g.object.el,g))))},twoWayEmit:function(f){var b=this.el,g=this.intersectedEl,y;y=this.el.components.raycaster.getIntersection(g),this.eventDetail.intersectedEl=g,this.eventDetail.intersection=y,b.emit(f,this.eventDetail),!!g&&(this.intersectedEventDetail.intersection=y,g.emit(f,this.intersectedEventDetail))}})},{"../core/component":131,"../utils/":205}],77:[function(_,G,fe){var u=_("../core/component").registerComponent,A=_("../utils/bind"),E=_("../utils/tracked-controls"),w=E.checkControllerPresentAndSetup,h=E.emitIfAxesChanged,v=E.onButtonEvent,d="https://cdn.aframe.io/controllers/google/",m=d+"vr_controller_daydream.obj",f=d+"vr_controller_daydream.mtl",b=_("../utils/").device.isWebXRAvailable,g="google-daydream",y="Daydream Controller",x=b?g:y,L={axes:{trackpad:[0,1]},buttons:["trackpad","menu","system"]},M={axes:{touchpad:[0,1]},buttons:["none","none","touchpad","menu","system"]},R=b?M:L;G.exports.Component=u("daydream-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#000000"},buttonTouchedColor:{type:"color",default:"#777777"},buttonHighlightColor:{type:"color",default:"#FFFFFF"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:R,bindMethods:function(){this.onModelLoaded=A(this.onModelLoaded,this),this.onControllersUpdate=A(this.onControllersUpdate,this),this.checkIfControllerPresent=A(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=A(this.removeControllersUpdateListener,this),this.onAxisMoved=A(this.onAxisMoved,this)},init:function(){var D=this;this.onButtonChanged=A(this.onButtonChanged,this),this.onButtonDown=function(N){v(N.detail.id,"down",D)},this.onButtonUp=function(N){v(N.detail.id,"up",D)},this.onButtonTouchStart=function(N){v(N.detail.id,"touchstart",D)},this.onButtonTouchEnd=function(N){v(N.detail.id,"touchend",D)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var D=this.el;D.addEventListener("buttonchanged",this.onButtonChanged),D.addEventListener("buttondown",this.onButtonDown),D.addEventListener("buttonup",this.onButtonUp),D.addEventListener("touchstart",this.onButtonTouchStart),D.addEventListener("touchend",this.onButtonTouchEnd),D.addEventListener("model-loaded",this.onModelLoaded),D.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var D=this.el;D.removeEventListener("buttonchanged",this.onButtonChanged),D.removeEventListener("buttondown",this.onButtonDown),D.removeEventListener("buttonup",this.onButtonUp),D.removeEventListener("touchstart",this.onButtonTouchStart),D.removeEventListener("touchend",this.onButtonTouchEnd),D.removeEventListener("model-loaded",this.onModelLoaded),D.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){w(this,x,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var D=this.el,N=this.data;D.setAttribute("tracked-controls",{armModel:N.armModel,hand:N.hand,idPrefix:x,id:x,orientationOffset:N.orientationOffset}),!!this.data.model&&this.el.setAttribute("obj-model",{obj:m,mtl:f})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(D){var N=D.detail.model,z;!this.data.model||(z=this.buttonMeshes={},z.menu=N.getObjectByName("AppButton_AppButton_Cylinder.004"),z.system=N.getObjectByName("HomeButton_HomeButton_Cylinder.005"),z.trackpad=N.getObjectByName("TouchPad_TouchPad_Cylinder.003"),z.touchpad=N.getObjectByName("TouchPad_TouchPad_Cylinder.003"),N.position.set(0,0,-.04))},onAxisMoved:function(D){h(this,this.mapping.axes,D)},onButtonChanged:function(D){var N=this.mapping.buttons[D.detail.id];!N||this.el.emit(N+"changed",D.detail.state)},updateModel:function(D,N){!this.data.model||this.updateButtonModel(D,N)},updateButtonModel:function(D,N){var z=this.buttonMeshes;if(!(!z||!z[D])){var re;switch(N){case"down":re=this.data.buttonHighlightColor;break;case"touchstart":re=this.data.buttonTouchedColor;break;default:re=this.data.buttonColor}z[D].material.color.set(re)}}})},{"../core/component":131,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],78:[function(_,G,fe){var u=_("../core/component").registerComponent,A=_("../utils/bind"),E=_("../utils/tracked-controls"),w=E.checkControllerPresentAndSetup,h=E.emitIfAxesChanged,v=E.onButtonEvent,d=_("../utils/").device.isWebXRAvailable,m="https://cdn.aframe.io/controllers/samsung/",f=m+"gear_vr_controller.obj",b=m+"gear_vr_controller.mtl",g="samsung-gearvr",y="Gear VR",x=d?g:y,L={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},M={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad","none","menu"]},R=d?M:L;G.exports.Component=u("gearvr-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#000000"},buttonTouchedColor:{type:"color",default:"#777777"},buttonHighlightColor:{type:"color",default:"#FFFFFF"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:R,bindMethods:function(){this.onModelLoaded=A(this.onModelLoaded,this),this.onControllersUpdate=A(this.onControllersUpdate,this),this.checkIfControllerPresent=A(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=A(this.removeControllersUpdateListener,this),this.onAxisMoved=A(this.onAxisMoved,this)},init:function(){var D=this;this.onButtonChanged=A(this.onButtonChanged,this),this.onButtonDown=function(N){v(N.detail.id,"down",D)},this.onButtonUp=function(N){v(N.detail.id,"up",D)},this.onButtonTouchStart=function(N){v(N.detail.id,"touchstart",D)},this.onButtonTouchEnd=function(N){v(N.detail.id,"touchend",D)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var D=this.el;D.addEventListener("buttonchanged",this.onButtonChanged),D.addEventListener("buttondown",this.onButtonDown),D.addEventListener("buttonup",this.onButtonUp),D.addEventListener("touchstart",this.onButtonTouchStart),D.addEventListener("touchend",this.onButtonTouchEnd),D.addEventListener("model-loaded",this.onModelLoaded),D.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var D=this.el;D.removeEventListener("buttonchanged",this.onButtonChanged),D.removeEventListener("buttondown",this.onButtonDown),D.removeEventListener("buttonup",this.onButtonUp),D.removeEventListener("touchstart",this.onButtonTouchStart),D.removeEventListener("touchend",this.onButtonTouchEnd),D.removeEventListener("model-loaded",this.onModelLoaded),D.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){w(this,x,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var D=this.el,N=this.data;D.setAttribute("tracked-controls",{armModel:N.armModel,hand:N.hand,idPrefix:x,id:x,orientationOffset:N.orientationOffset}),!!this.data.model&&this.el.setAttribute("obj-model",{obj:f,mtl:b})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(D){var N=D.detail.model,z;!this.data.model||(z=this.buttonMeshes={},z.trigger=N.children[2],z.trackpad=N.children[1],z.touchpad=N.children[1])},onButtonChanged:function(D){var N=this.mapping.buttons[D.detail.id];!N||this.el.emit(N+"changed",D.detail.state)},onAxisMoved:function(D){h(this,this.mapping.axes,D)},updateModel:function(D,N){!this.data.model||this.updateButtonModel(D,N)},updateButtonModel:function(D,N){var z=this.buttonMeshes;if(!(!z||!z[D])){var re;switch(N){case"down":re=this.data.buttonHighlightColor;break;case"touchstart":re=this.data.buttonTouchedColor;break;default:re=this.data.buttonColor}z[D].material.color.set(re)}}})},{"../core/component":131,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],79:[function(_,G,fe){var u=_("../core/component").registerComponent,A=_("../utils/bind"),E=_("../utils/tracked-controls"),w=E.checkControllerPresentAndSetup,h=E.emitIfAxesChanged,v=E.onButtonEvent,d="generic",m={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick"]};G.exports.Component=u("generic-tracked-controller-controls",{schema:{hand:{default:""},defaultModel:{default:!0},defaultModelColor:{default:"gray"},orientationOffset:{type:"vec3"},disabled:{default:!1}},mapping:m,bindMethods:function(){this.onControllersUpdate=A(this.onControllersUpdate,this),this.checkIfControllerPresent=A(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=A(this.removeControllersUpdateListener,this),this.onAxisMoved=A(this.onAxisMoved,this)},init:function(){var f=this;this.onButtonChanged=A(this.onButtonChanged,this),this.onButtonDown=function(b){v(b.detail.id,"down",f)},this.onButtonUp=function(b){v(b.detail.id,"up",f)},this.onButtonTouchStart=function(b){v(b.detail.id,"touchstart",f)},this.onButtonTouchEnd=function(b){v(b.detail.id,"touchend",f)},this.controllerPresent=!1,this.wasControllerConnected=!1,this.lastControllerCheck=0,this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods(),this.el.addEventListener("controllerconnected",function(b){b.detail.name!==f.name&&(f.wasControllerConnected=!0,f.removeEventListeners(),f.removeControllersUpdateListener())})},addEventListeners:function(){var f=this.el;f.addEventListener("buttonchanged",this.onButtonChanged),f.addEventListener("buttondown",this.onButtonDown),f.addEventListener("buttonup",this.onButtonUp),f.addEventListener("touchstart",this.onButtonTouchStart),f.addEventListener("touchend",this.onButtonTouchEnd),f.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var f=this.el;f.removeEventListener("buttonchanged",this.onButtonChanged),f.removeEventListener("buttondown",this.onButtonDown),f.removeEventListener("buttonup",this.onButtonUp),f.removeEventListener("touchstart",this.onButtonTouchStart),f.removeEventListener("touchend",this.onButtonTouchEnd),f.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var f=this.data,b=f.hand?f.hand:void 0;w(this,d,{hand:b,iterateControllerProfiles:!0})},play:function(){this.wasControllerConnected||(this.checkIfControllerPresent(),this.addControllersUpdateListener())},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var f=this.el,b=this.data;if(this.el.components["tracked-controls"]){this.removeEventListeners();return}f.setAttribute("tracked-controls",{hand:b.hand,idPrefix:d,orientationOffset:b.orientationOffset,iterateControllerProfiles:!0}),!!this.data.defaultModel&&this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(f){var b=this.mapping.buttons[f.detail.id];!b||this.el.emit(b+"changed",f.detail.state)},onAxisMoved:function(f){h(this,this.mapping.axes,f)},initDefaultModel:function(){var f=this.modelEl=document.createElement("a-entity");f.setAttribute("geometry",{primitive:"sphere",radius:.03}),f.setAttribute("material",{color:this.data.color}),this.el.appendChild(f)}})},{"../core/component":131,"../utils/bind":199,"../utils/tracked-controls":214}],80:[function(_,G,fe){var u=_("../core/geometry").geometries,A=_("../core/geometry").geometryNames,E=_("../core/component").registerComponent,w=_("../lib/three"),h=new w.BufferGeometry;G.exports.Component=E("geometry",{schema:{buffer:{default:!0},primitive:{default:"box",oneOf:A,schemaChange:!0},skipCache:{default:!1}},init:function(){this.geometry=null},update:function(v){var d=this.data,m=this.el,f,b=this.system;this.geometry&&(b.unuseGeometry(v),this.geometry=null),this.geometry=b.getOrCreateGeometry(d),f=m.getObject3D("mesh"),f?f.geometry=this.geometry:(f=new w.Mesh,f.geometry=this.geometry,this.el.getAttribute("material")||(f.material=new w.MeshStandardMaterial({color:Math.random()*16777215,metalness:0,roughness:.5})),m.setObject3D("mesh",f))},remove:function(){this.system.unuseGeometry(this.data),this.el.getObject3D("mesh").geometry=h,this.geometry=null},updateSchema:function(v){var d=this.oldData&&this.oldData.primitive,m=v.primitive,f=u[m]&&u[m].schema;if(!f)throw new Error("Unknown geometry schema `"+m+"`");d&&d===m||this.extendSchema(f)}})},{"../core/component":131,"../core/geometry":132,"../lib/three":179}],81:[function(_,G,fe){var u=_("../core/component").registerComponent,A=_("../lib/three"),E=_("../utils/"),w=E.debug("components:gltf-model:warn");G.exports.Component=u("gltf-model",{schema:{type:"model"},init:function(){var h=this.system.getDRACOLoader();this.model=null,this.loader=new A.GLTFLoader,h&&this.loader.setDRACOLoader(h)},update:function(){var h=this,v=this.el,d=this.data;!d||(this.remove(),this.loader.load(d,function(f){h.model=f.scene||f.scenes[0],h.model.animations=f.animations,v.setObject3D("mesh",h.model),v.emit("model-loaded",{format:"gltf",model:h.model})},void 0,function(f){var b=f&&f.message?f.message:"Failed to load glTF model";w(b),v.emit("model-error",{format:"gltf",src:d})}))},remove:function(){!this.model||this.el.removeObject3D("mesh")}})},{"../core/component":131,"../lib/three":179,"../utils/":205}],82:[function(_,G,fe){var u=_("../core/component").registerComponent,A={toonLeft:"https://cdn.aframe.io/controllers/hands/leftHand.glb",toonRight:"https://cdn.aframe.io/controllers/hands/rightHand.glb",lowPolyLeft:"https://cdn.aframe.io/controllers/hands/leftHandLow.glb",lowPolyRight:"https://cdn.aframe.io/controllers/hands/rightHandLow.glb",highPolyLeft:"https://cdn.aframe.io/controllers/hands/leftHandHigh.glb",highPolyRight:"https://cdn.aframe.io/controllers/hands/rightHandHigh.glb"},E={open:"Open",point:"Point",pointThumb:"Point + Thumb",fist:"Fist",hold:"Hold",thumbUp:"Thumb Up"},w={};w[E.fist]="grip",w[E.thumbUp]="pistol",w[E.point]="pointing",G.exports.Component=u("hand-controls",{schema:{color:{default:"white",type:"color"},hand:{default:"left"},handModelStyle:{default:"lowPoly",oneOf:["lowPoly","highPoly","toon"]}},init:function(){var d=this,m=this.el;this.gesture=E.open,this.pressedButtons={},this.touchedButtons={},this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("anonymous"),this.onGripDown=function(){d.handleButton("grip","down")},this.onGripUp=function(){d.handleButton("grip","up")},this.onTrackpadDown=function(){d.handleButton("trackpad","down")},this.onTrackpadUp=function(){d.handleButton("trackpad","up")},this.onTrackpadTouchStart=function(){d.handleButton("trackpad","touchstart")},this.onTrackpadTouchEnd=function(){d.handleButton("trackpad","touchend")},this.onTriggerDown=function(){d.handleButton("trigger","down")},this.onTriggerUp=function(){d.handleButton("trigger","up")},this.onTriggerTouchStart=function(){d.handleButton("trigger","touchstart")},this.onTriggerTouchEnd=function(){d.handleButton("trigger","touchend")},this.onGripTouchStart=function(){d.handleButton("grip","touchstart")},this.onGripTouchEnd=function(){d.handleButton("grip","touchend")},this.onThumbstickDown=function(){d.handleButton("thumbstick","down")},this.onThumbstickUp=function(){d.handleButton("thumbstick","up")},this.onAorXTouchStart=function(){d.handleButton("AorX","touchstart")},this.onAorXTouchEnd=function(){d.handleButton("AorX","touchend")},this.onBorYTouchStart=function(){d.handleButton("BorY","touchstart")},this.onBorYTouchEnd=function(){d.handleButton("BorY","touchend")},this.onSurfaceTouchStart=function(){d.handleButton("surface","touchstart")},this.onSurfaceTouchEnd=function(){d.handleButton("surface","touchend")},this.onControllerConnected=this.onControllerConnected.bind(this),this.onControllerDisconnected=this.onControllerDisconnected.bind(this),m.addEventListener("controllerconnected",this.onControllerConnected),m.addEventListener("controllerdisconnected",this.onControllerDisconnected),m.object3D.visible=!1},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},tick:function(d,m){var f=this.el.getObject3D("mesh");!f||!f.mixer||f.mixer.update(m/1e3)},onControllerConnected:function(){this.el.object3D.visible=!0},onControllerDisconnected:function(){this.el.object3D.visible=!1},addEventListeners:function(){var d=this.el;d.addEventListener("gripdown",this.onGripDown),d.addEventListener("gripup",this.onGripUp),d.addEventListener("trackpaddown",this.onTrackpadDown),d.addEventListener("trackpadup",this.onTrackpadUp),d.addEventListener("trackpadtouchstart",this.onTrackpadTouchStart),d.addEventListener("trackpadtouchend",this.onTrackpadTouchEnd),d.addEventListener("triggerdown",this.onTriggerDown),d.addEventListener("triggerup",this.onTriggerUp),d.addEventListener("triggertouchstart",this.onTriggerTouchStart),d.addEventListener("triggertouchend",this.onTriggerTouchEnd),d.addEventListener("griptouchstart",this.onGripTouchStart),d.addEventListener("griptouchend",this.onGripTouchEnd),d.addEventListener("thumbstickdown",this.onThumbstickDown),d.addEventListener("thumbstickup",this.onThumbstickUp),d.addEventListener("abuttontouchstart",this.onAorXTouchStart),d.addEventListener("abuttontouchend",this.onAorXTouchEnd),d.addEventListener("bbuttontouchstart",this.onBorYTouchStart),d.addEventListener("bbuttontouchend",this.onBorYTouchEnd),d.addEventListener("xbuttontouchstart",this.onAorXTouchStart),d.addEventListener("xbuttontouchend",this.onAorXTouchEnd),d.addEventListener("ybuttontouchstart",this.onBorYTouchStart),d.addEventListener("ybuttontouchend",this.onBorYTouchEnd),d.addEventListener("surfacetouchstart",this.onSurfaceTouchStart),d.addEventListener("surfacetouchend",this.onSurfaceTouchEnd)},removeEventListeners:function(){var d=this.el;d.removeEventListener("gripdown",this.onGripDown),d.removeEventListener("gripup",this.onGripUp),d.removeEventListener("trackpaddown",this.onTrackpadDown),d.removeEventListener("trackpadup",this.onTrackpadUp),d.removeEventListener("trackpadtouchstart",this.onTrackpadTouchStart),d.removeEventListener("trackpadtouchend",this.onTrackpadTouchEnd),d.removeEventListener("triggerdown",this.onTriggerDown),d.removeEventListener("triggerup",this.onTriggerUp),d.removeEventListener("triggertouchstart",this.onTriggerTouchStart),d.removeEventListener("triggertouchend",this.onTriggerTouchEnd),d.removeEventListener("griptouchstart",this.onGripTouchStart),d.removeEventListener("griptouchend",this.onGripTouchEnd),d.removeEventListener("thumbstickdown",this.onThumbstickDown),d.removeEventListener("thumbstickup",this.onThumbstickUp),d.removeEventListener("abuttontouchstart",this.onAorXTouchStart),d.removeEventListener("abuttontouchend",this.onAorXTouchEnd),d.removeEventListener("bbuttontouchstart",this.onBorYTouchStart),d.removeEventListener("bbuttontouchend",this.onBorYTouchEnd),d.removeEventListener("xbuttontouchstart",this.onAorXTouchStart),d.removeEventListener("xbuttontouchend",this.onAorXTouchEnd),d.removeEventListener("ybuttontouchstart",this.onBorYTouchStart),d.removeEventListener("ybuttontouchend",this.onBorYTouchEnd),d.removeEventListener("surfacetouchstart",this.onSurfaceTouchStart),d.removeEventListener("surfacetouchend",this.onSurfaceTouchEnd)},update:function(d){var m,f=this.el,b=this.data.hand,g=this.data.handModelStyle,y=this.data.color,x=this;if(m={hand:b,model:!1},b!==d){var L=A[g+b.charAt(0).toUpperCase()+b.slice(1)];this.loader.load(L,function(M){var R=M.scene.children[0],D=b==="left"?Math.PI/2:-Math.PI/2;R.mixer=new THREE.AnimationMixer(R),x.clips=M.animations,f.setObject3D("mesh",R);var N=R.children[1].material;N.color=new THREE.Color(y),R.position.set(0,0,0),R.rotation.set(0,0,D),f.setAttribute("magicleap-controls",m),f.setAttribute("vive-controls",m),f.setAttribute("oculus-touch-controls",m),f.setAttribute("windows-motion-controls",m)})}},remove:function(){this.el.removeObject3D("mesh")},handleButton:function(d,m){var f,b=m==="down",g=m==="touchstart";if(m.indexOf("touch")===0){if(g===this.touchedButtons[d])return;this.touchedButtons[d]=g}else{if(b===this.pressedButtons[d])return;this.pressedButtons[d]=b}f=this.gesture,this.gesture=this.determineGesture(),this.gesture!==f&&(this.animateGesture(this.gesture,f),this.emitGestureEvents(this.gesture,f))},determineGesture:function(){var d,m=this.pressedButtons.grip,f=this.pressedButtons.surface||this.touchedButtons.surface,b=this.pressedButtons.trackpad||this.touchedButtons.trackpad,g=this.pressedButtons.trigger||this.touchedButtons.trigger,y=this.touchedButtons.AorX||this.touchedButtons.BorY,x=v(this.el.components["tracked-controls"]);return x?m||g?d=E.fist:b&&(d=E.point):m?f||y||b?d=g?E.fist:E.point:d=g?E.thumbUp:E.pointThumb:g&&(d=E.hold),d},getClip:function(d){var m,f;for(f=0;f<this.clips.length;f++)if(m=this.clips[f],m.name===d)return m},animateGesture:function(d,m){if(d){this.playAnimation(d||E.open,m,!1);return}this.playAnimation(m,m,!0)},emitGestureEvents:function(d,m){var f=this.el,b;m!==d&&(b=h(m,!1),b&&f.emit(b),b=h(d,!0),b&&f.emit(b))},playAnimation:function(d,m,f){var b,g,y=this.el.getObject3D("mesh"),x;if(!!y){if(y.mixer.stopAllAction(),b=this.getClip(d),x=y.mixer.clipAction(b),x.clampWhenFinished=!0,x.loop=THREE.LoopRepeat,x.repetitions=0,x.timeScale=f?-1:1,x.time=f?b.duration:0,x.weight=1,!m||d===m){y.mixer.stopAllAction(),x.play();return}b=this.getClip(m),g=y.mixer.clipAction(b),g.weight=.15,g.play(),x.play(),g.crossFadeTo(x,.15,!0)}}});function h(d,m){var f;if(!!d){if(f=w[d],f==="grip")return f+(m?"close":"open");if(f==="point")return f+(m?"up":"down");if(f==="pointing"||f==="pistol")return f+(m?"start":"end")}}function v(d){var m=d&&d.controller,f=m&&(m.id&&m.id.indexOf("OpenVR ")===0||m.profiles&&m.profiles[0]&&m.profiles[0]==="htc-vive-controller-mv");return f}},{"../core/component":131}],83:[function(_,G,fe){var u=_("../core/component").registerComponent,A=_("../utils/bind"),E=_("../utils/tracked-controls"),w=E.checkControllerPresentAndSetup,h="https://cdn.aframe.io/controllers/oculus-hands/unity/left.glb",v="https://cdn.aframe.io/controllers/oculus-hands/unity/right.glb",d={left:"b_l_",right:"b_r_"},m=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],f={wrist:"wrist","thumb-metacarpal":"thumb1","thumb-phalanx-proximal":"thumb2","thumb-phalanx-distal":"thumb3","thumb-tip":"thumb_null","index-finger-phalanx-proximal":"index1","index-finger-phalanx-intermediate":"index2","index-finger-phalanx-distal":"index3","index-finger-tip":"index_null","middle-finger-phalanx-proximal":"middle1","middle-finger-phalanx-intermediate":"middle2","middle-finger-phalanx-distal":"middle3","middle-finger-tip":"middle_null","ring-finger-phalanx-proximal":"ring1","ring-finger-phalanx-intermediate":"ring2","ring-finger-phalanx-distal":"ring3","ring-finger-tip":"ring_null","pinky-finger-metacarpal":"pinky0","pinky-finger-phalanx-proximal":"pinky1","pinky-finger-phalanx-intermediate":"pinky2","pinky-finger-phalanx-distal":"pinky3","pinky-finger-tip":"pinky_null"},b=.015,g=.03,y=.5;G.exports.Component=u("hand-tracking-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},modelStyle:{default:"mesh",oneOf:["dots","mesh"]},modelColor:{default:"white"}},bindMethods:function(){this.onControllersUpdate=A(this.onControllersUpdate,this),this.checkIfControllerPresent=A(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=A(this.removeControllersUpdateListener,this)},addEventListeners:function(){this.el.addEventListener("model-loaded",this.onModelLoaded);for(var x=0;x<this.jointEls.length;++x)this.jointEls[x].object3D.visible=!0},removeEventListeners:function(){this.el.removeEventListener("model-loaded",this.onModelLoaded);for(var x=0;x<this.jointEls.length;++x)this.jointEls[x].object3D.visible=!1},init:function(){var x=this.el.sceneEl,L=x.getAttribute("webxr").optionalFeatures;L.push("hand-tracking"),x.setAttribute("webxr",{optionalFeatures:L}),this.onModelLoaded=this.onModelLoaded.bind(this),this.jointEls=[],this.controllerPresent=!1,this.isPinched=!1,this.pinchEventDetail={position:new THREE.Vector3},this.indexTipPosition=new THREE.Vector3,this.bindMethods(),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.updateReferenceSpace),this.el.sceneEl.addEventListener("exit-vr",this.updateReferenceSpace)},updateReferenceSpace:function(){var x=this,L=this.el.sceneEl.xrSession;if(this.referenceSpace=void 0,!!L){var M=x.el.sceneEl.systems.webxr.sessionReferenceSpaceType;L.requestReferenceSpace(M).then(function(R){x.referenceSpace=R.getOffsetReferenceSpace(new XRRigidTransform({x:0,y:1.5,z:0}))}).catch(function(R){throw x.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(M,"tracked-controls-webxr uses reference space "+M),R})}},checkIfControllerPresent:function(){var x=this.data,L=x.hand?x.hand:void 0;w(this,"",{hand:L,iterateControllerProfiles:!0,handTracking:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},tick:function(){var x=this.el.sceneEl,L=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,M=x.frame,R=this.el.components["tracked-controls-webxr"];!L||!M||!R||L.hand&&(this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),M.getJointPose&&this.updateHandModel(),this.detectGesture())},updateHandModel:function(){this.data.modelStyle==="dots"&&this.updateHandDotsModel(),this.data.modelStyle==="mesh"&&this.updateHandMeshModel()},getBone:function(x){for(var L=this.bones,M=0;M<L.length;M++)if(L[M].name===x)return L[M];return null},updateHandMeshModel:function(){var x=this.el.sceneEl.frame,L=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,M=this.referenceSpace;if(!(!L||!this.mesh||!M)){this.mesh.visible=!1;for(var R of L.hand.values()){var D,N,z;N=x.getJointPose(R,M),!!f[R.jointName]&&(D=this.getBone(d[this.data.hand]+f[R.jointName]),D!=null&&N&&(z=N.transform,this.mesh.visible=!0,D.position.copy(z.position).multiplyScalar(100),D.quaternion.set(z.orientation.x,z.orientation.y,z.orientation.z,z.orientation.w)))}}},updateHandDotsModel:function(){var x=this.el.sceneEl.frame,L=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,M=this.el.components["tracked-controls-webxr"],R=M.system.referenceSpace,D,N,z,re=0;for(var Y of L.hand.values())D=this.jointEls[re++],N=D.object3D,z=x.getJointPose(Y,R),D.object3D.visible=!!z,!!z&&(N.matrix.elements=z.transform.matrix,N.matrix.decompose(N.position,N.rotation,N.scale),D.setAttribute("scale",{x:z.radius,y:z.radius,z:z.radius}))},detectGesture:function(){this.detectPinch()},detectPinch:function(){var x=new THREE.Vector3;return function(){var L=this.el.sceneEl.frame,M=this.indexTipPosition,R=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,D=this.el.components["tracked-controls-webxr"],N=this.referenceSpace||D.system.referenceSpace,z=R.hand.get("index-finger-tip"),re=R.hand.get("thumb-tip");if(!(!z||!re)){var Y=L.getJointPose(z,N),te=L.getJointPose(re,N);if(!(!Y||!te)){x.copy(te.transform.position),M.copy(Y.transform.position);var J=M.distanceTo(x);J<b&&this.isPinched===!1&&(this.isPinched=!0,this.pinchEventDetail.position.copy(M).lerp(x,y),this.pinchEventDetail.position.y+=1.5,this.el.emit("pinchstarted",this.pinchEventDetail)),J>g&&this.isPinched===!0&&(this.isPinched=!1,this.pinchEventDetail.position.copy(M).lerp(x,y),this.pinchEventDetail.position.y+=1.5,this.el.emit("pinchended",this.pinchEventDetail)),this.isPinched&&(this.pinchEventDetail.position.copy(M).lerp(x,y),this.pinchEventDetail.position.y+=1.5,this.el.emit("pinchmoved",this.pinchEventDetail)),M.y+=1.5}}}}(),pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var x=this.el,L=this.data;x.setAttribute("tracked-controls",{hand:L.hand,iterateControllerProfiles:!0,handTrackingEnabled:!0}),this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){var x;this.checkIfControllerPresent(),x=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,!!this.el.getObject3D("mesh")&&(!x||!x.hand||!x.hand[0])&&(this.el.getObject3D("mesh").visible=!1)},initDefaultModel:function(){this.el.getObject3D("mesh")||(this.data.modelStyle==="dots"&&this.initDotsModel(),this.data.modelStyle==="mesh"&&this.initMeshHandModel())},initDotsModel:function(){if(this.jointEls.length===0)for(var x=0;x<m.length;++x){var L=this.jointEl=document.createElement("a-entity");L.setAttribute("geometry",{primitive:"sphere",radius:1}),L.setAttribute("material",{color:this.data.modelColor}),L.object3D.visible=!1,this.el.appendChild(L),this.jointEls.push(L)}},initMeshHandModel:function(){var x=this.data.hand==="left"?h:v;this.el.setAttribute("gltf-model",x)},onModelLoaded:function(){var x=this.mesh=this.el.getObject3D("mesh").children[0],L=this.skinnedMesh=x.children[24];!this.skinnedMesh||(this.bones=L.skeleton.bones,this.el.removeObject3D("mesh"),x.position.set(0,1.5,0),x.rotation.set(0,0,0),L.frustumCulled=!1,L.material=new THREE.MeshStandardMaterial({skinning:!0,color:this.data.modelColor}),this.el.setObject3D("mesh",x))}})},{"../core/component":131,"../utils/bind":199,"../utils/tracked-controls":214}],84:[function(_,G,fe){_("./animation"),_("./camera"),_("./cursor"),_("./daydream-controls"),_("./gearvr-controls"),_("./geometry"),_("./generic-tracked-controller-controls"),_("./gltf-model"),_("./hand-tracking-controls"),_("./hand-controls"),_("./layer"),_("./laser-controls"),_("./light"),_("./line"),_("./link"),_("./look-controls"),_("./magicleap-controls"),_("./material"),_("./obj-model"),_("./oculus-go-controls"),_("./oculus-touch-controls"),_("./position"),_("./raycaster"),_("./rotation"),_("./scale"),_("./shadow"),_("./sound"),_("./text"),_("./tracked-controls"),_("./tracked-controls-webvr"),_("./tracked-controls-webxr"),_("./visible"),_("./valve-index-controls"),_("./vive-controls"),_("./vive-focus-controls"),_("./wasd-controls"),_("./windows-motion-controls"),_("./scene/background"),_("./scene/debug"),_("./scene/device-orientation-permission-ui"),_("./scene/embedded"),_("./scene/inspector"),_("./scene/fog"),_("./scene/keyboard-shortcuts"),_("./scene/pool"),_("./scene/screenshot"),_("./scene/stats"),_("./scene/vr-mode-ui")},{"./animation":74,"./camera":75,"./cursor":76,"./daydream-controls":77,"./gearvr-controls":78,"./generic-tracked-controller-controls":79,"./geometry":80,"./gltf-model":81,"./hand-controls":82,"./hand-tracking-controls":83,"./laser-controls":85,"./layer":86,"./light":87,"./line":88,"./link":89,"./look-controls":90,"./magicleap-controls":91,"./material":92,"./obj-model":93,"./oculus-go-controls":94,"./oculus-touch-controls":95,"./position":96,"./raycaster":97,"./rotation":98,"./scale":99,"./scene/background":100,"./scene/debug":101,"./scene/device-orientation-permission-ui":102,"./scene/embedded":103,"./scene/fog":104,"./scene/inspector":105,"./scene/keyboard-shortcuts":106,"./scene/pool":107,"./scene/screenshot":108,"./scene/stats":109,"./scene/vr-mode-ui":110,"./shadow":111,"./sound":112,"./text":113,"./tracked-controls":116,"./tracked-controls-webvr":114,"./tracked-controls-webxr":115,"./valve-index-controls":117,"./visible":118,"./vive-controls":119,"./vive-focus-controls":120,"./wasd-controls":121,"./windows-motion-controls":122}],85:[function(_,G,fe){var u=_("../core/component").registerComponent,A=_("../utils/");u("laser-controls",{schema:{hand:{default:"right"},model:{default:!0},defaultModelColor:{type:"color",default:"grey"}},init:function(){var E=this.config,w=this.data,h=this.el,v=this,d={hand:w.hand,model:w.model};h.setAttribute("daydream-controls",d),h.setAttribute("gearvr-controls",d),h.setAttribute("magicleap-controls",d),h.setAttribute("oculus-go-controls",d),h.setAttribute("oculus-touch-controls",d),h.setAttribute("valve-index-controls",d),h.setAttribute("vive-controls",d),h.setAttribute("vive-focus-controls",d),h.setAttribute("windows-motion-controls",d),h.setAttribute("generic-tracked-controller-controls",d),h.addEventListener("controllerconnected",m),h.addEventListener("controllerdisconnected",f),h.addEventListener("controllermodelready",function(b){m(b),v.modelReady=!0});function m(b){var g=E[b.detail.name];if(!!g){var y=A.extend({showLine:!0},g.raycaster||{});b.detail.rayOrigin&&(y.origin=b.detail.rayOrigin.origin,y.direction=b.detail.rayOrigin.direction,y.showLine=!0),b.detail.rayOrigin||!v.modelReady?h.setAttribute("raycaster",y):h.setAttribute("raycaster","showLine",!0),h.setAttribute("cursor",A.extend({fuse:!1},g.cursor))}}function f(){h.setAttribute("raycaster","showLine",!1)}},config:{"daydream-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"gearvr-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:.001,z:0}}},"generic-tracked-controller-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"magicleap-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"oculus-go-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"oculus-touch-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"valve-index-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-focus-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"windows-motion-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{showLine:!1}}}})},{"../core/component":131,"../utils/":205}],86:[function(_,G,fe){var u=_("../core/component").registerComponent,A=_("../utils/"),E=A.debug("components:layer:warn");G.exports.Component=u("layer",{schema:{type:{default:"quad",oneOf:["quad","monocubemap","stereocubemap"]},src:{type:"map"},rotateCubemap:{default:!1},width:{default:0},height:{default:0}},init:function(){var h=this.el.sceneEl.renderer.getContext();this.quaternion=new THREE.Quaternion,this.position=new THREE.Vector3,this.bindMethods(),this.needsRedraw=!1,this.frameBuffer=h.createFramebuffer();var v=this.el.sceneEl.getAttribute("webxr").requiredFeatures;v.push("layers"),this.el.sceneEl.getAttribute("webxr","requiredFeatures",v),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR),this.el.sceneEl.addEventListener("exit-vr",this.onExitVR)},bindMethods:function(){this.onRequestedReferenceSpace=this.onRequestedReferenceSpace.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this)},update:function(h){this.data.src!==h.src&&this.updateSrc()},updateSrc:function(){var h=this.data.type;if(this.texture=void 0,h==="quad"){this.loadQuadImage();return}if(h==="monocubemap"||h==="stereocubemap"){this.loadCubeMapImages();return}},loadCubeMapImages:function(){var h=this.data.type,v,d=this.xrGLFactory,m=this.el.sceneEl.frame,f=this.data.src;this.visibilityChanged=!1,!!this.layer&&(f.complete?this.pendingCubeMapUpdate=!1:this.pendingCubeMapUpdate=!0,this.loadingScreen?this.loadingScreen=!1:this.loadingScreen=!0,h==="monocubemap"?(v=d.getSubImage(this.layer,m),this.loadCubeMapImage(v.colorTexture,f,0)):(v=d.getSubImage(this.layer,m,"left"),this.loadCubeMapImage(v.colorTexture,f,0),v=d.getSubImage(this.layer,m,"right"),this.loadCubeMapImage(v.colorTexture,f,6)))},loadQuadImage:function(){var h=this.data.src,v=this;this.el.sceneEl.systems.material.loadTexture(h,{src:h},function(m){v.el.sceneEl.renderer.initTexture(m),v.texture=m,h.tagName==="VIDEO"&&setTimeout(function(){v.textureIsVideo=!0},1e3),v.layer&&(v.layer.height=v.data.height/2||v.texture.image.height/1e3,v.layer.width=v.data.width/2||v.texture.image.width/1e3,v.needsRedraw=!0),v.updateQuadPanel()})},preGenerateCubeMapTextures:function(h,v){this.data.type==="monocubemap"?this.generateCubeMapTextures(h,0,v):(this.generateCubeMapTextures(h,0,v),this.generateCubeMapTextures(h,6,v))},generateCubeMapTextures:function(h,v,d){for(var m=this.data,f=this.cubeFaceSize,b=Math.min(h.width,h.height),g=[],y,x,L=0;L<6;L++){var M=document.createElement("CANVAS");M.width=M.height=f;var R=M.getContext("2d");m.rotateCubemap&&(L===2||L===3)&&(R.save(),R.translate(f,f),R.rotate(Math.PI)),R.drawImage(h,(L+v)*b,0,b,b,0,0,f,f),R.restore(),d&&d(),g.push(M)}return m.rotateCubemap&&(y=g[0],x=g[1],g[0]=x,g[1]=y,y=g[4],x=g[5],g[4]=x,g[5]=y),d&&d(),g},loadCubeMapImage:function(h,v,d){var m=this.el.sceneEl.renderer.getContext(),f;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,!1),m.bindTexture(m.TEXTURE_CUBE_MAP,h),!v.complete||this.loadingScreen?f=this.loadingScreenImages:f=this.generateCubeMapTextures(v,d);var b=0;f.forEach(function(g,y){m.texSubImage2D(m.TEXTURE_CUBE_MAP_POSITIVE_X+y,0,0,0,m.RGBA,m.UNSIGNED_BYTE,g),b=m.getError()}),b!==0&&console.log("renderingError, WebGL Error Code: "+b),m.bindTexture(m.TEXTURE_CUBE_MAP,null)},tick:function(){!this.el.sceneEl.xrSession||(!this.layer&&this.el.sceneEl.is("vr-mode")&&this.initLayer(),this.updateTransform(),this.data.src.complete&&(this.pendingCubeMapUpdate||this.loadingScreen||this.visibilityChanged)&&this.loadCubeMapImages(),!(!this.needsRedraw&&!this.layer.needsRedraw&&!this.textureIsVideo)&&(this.data.type==="quad"&&this.draw(),this.needsRedraw=!1))},initLayer:function(){var h=this,v=this.data.type;if(this.el.sceneEl.xrSession.onvisibilitychange=function(d){h.visibilityChanged=d.session.visibilityState!=="hidden"},v==="quad"){this.initQuadLayer();return}if(v==="monocubemap"||v==="stereocubemap"){this.initCubeMapLayer();return}},initQuadLayer:function(){var h=this.el.sceneEl,v=h.renderer.getContext(),d=this.xrGLFactory=new XRWebGLBinding(h.xrSession,v);!this.texture||(this.layer=d.createQuadLayer({space:this.referenceSpace,viewPixelHeight:2048,viewPixelWidth:2048,height:this.data.height/2||this.texture.image.height/1e3,width:this.data.width/2||this.texture.image.width/1e3}),h.renderer.xr.addLayer(this.layer))},initCubeMapLayer:function(){var h=this.data.src,v=this.el.sceneEl,d=v.renderer.getContext(),m=d.getParameter(d.MAX_CUBE_MAP_TEXTURE_SIZE),f=this.cubeFaceSize=Math.min(m,Math.min(h.width,h.height)),b=this.xrGLFactory=new XRWebGLBinding(v.xrSession,d);this.layer=b.createCubeLayer({space:this.referenceSpace,viewPixelWidth:f,viewPixelHeight:f,layout:this.data.type==="monocubemap"?"mono":"stereo",isStatic:!1}),this.initLoadingScreenImages(),this.loadCubeMapImages(),v.renderer.xr.addLayer(this.layer)},initLoadingScreenImages:function(){for(var h=this.cubeFaceSize,v=this.loadingScreenImages=[],d=0;d<6;d++){var m=document.createElement("CANVAS");m.width=m.height=h;var f=m.getContext("2d");m.width=m.height=h,f.fillStyle="black",f.fillRect(0,0,h,h),d!==2&&d!==3&&(f.translate(h,0),f.scale(-1,1),f.fillStyle="white",f.font="30px Arial",f.fillText("Loading",h/2,h/2)),v.push(m)}},destroyLayer:function(){!this.layer||(this.el.sceneEl.renderer.xr.removeLayer(this.layer),this.layer.destroy(),this.layer=void 0)},toggleCompositorLayer:function(){this.enableCompositorLayer(!this.layerEnabled)},enableCompositorLayer:function(h){this.layerEnabled=h,this.quadPanelEl.object3D.visible=!this.layerEnabled},updateQuadPanel:function(){var h=this.quadPanelEl;this.quadPanelEl||(h=this.quadPanelEl=document.createElement("a-entity"),this.el.appendChild(h)),h.setAttribute("material",{shader:"flat",src:this.data.src,transparent:!0}),h.setAttribute("geometry",{primitive:"plane",height:this.data.height||this.texture.image.height/1e3,width:this.data.width||this.texture.image.height/1e3})},draw:function(){var h=this.el.sceneEl,v=this.el.sceneEl.renderer.getContext(),d=this.xrGLFactory.getSubImage(this.layer,h.frame),m=h.renderer.properties.get(this.texture).__webglTexture,f=v.getParameter(v.FRAMEBUFFER_BINDING);v.viewport(d.viewport.x,d.viewport.y,d.viewport.width,d.viewport.height),v.bindFramebuffer(v.FRAMEBUFFER,this.frameBuffer),v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.TEXTURE_2D,d.colorTexture,0),w(v,m,d,this.data.src),v.bindFramebuffer(v.FRAMEBUFFER,f)},updateTransform:function(){var h=this.el,v=this.position,d=this.quaternion;h.object3D.updateMatrixWorld(),v.setFromMatrixPosition(h.object3D.matrixWorld),d.setFromRotationMatrix(h.object3D.matrixWorld),this.layerEnabled||v.set(0,0,1e8),this.layer.transform=new XRRigidTransform(v,d)},onEnterVR:function(){var h=this.el.sceneEl,v=h.xrSession;if(!h.hasWebXR||!XRWebGLBinding||!v){E("The layer component requires WebXR and the layers API enabled");return}v.requestReferenceSpace("local").then(this.onRequestedReferenceSpace),this.needsRedraw=!0,this.layerEnabled=!0,this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!1),this.data.src.play&&this.data.src.play()},onExitVR:function(){this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!0),this.destroyLayer()},onRequestedReferenceSpace:function(h){this.referenceSpace=h}});function w(h,v,d,m){var f=h.createFramebuffer();let b=d.viewport.x,g=d.viewport.y,y=d.viewport.x+d.viewport.width,x=d.viewport.y+d.viewport.height;m.tagName==="VIDEO"&&(h.bindTexture(h.TEXTURE_2D,v),h.texSubImage2D(h.TEXTURE_2D,0,0,0,m.width,m.height,h.RGB,h.UNSIGNED_BYTE,m)),h.bindFramebuffer(h.READ_FRAMEBUFFER,f),h.framebufferTexture2D(h.READ_FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,v,0),h.readBuffer(h.COLOR_ATTACHMENT0),h.blitFramebuffer(0,0,m.width,m.height,b,g,y,x,h.COLOR_BUFFER_BIT,h.NEAREST),h.bindFramebuffer(h.READ_FRAMEBUFFER,null),h.deleteFramebuffer(f)}},{"../core/component":131,"../utils/":205}],87:[function(_,G,fe){var u=_("../utils/bind"),A=_("../utils").diff,E=_("../utils/debug"),w=_("../core/component").registerComponent,h=_("../lib/three"),v=h.Math.degToRad,d=E("components:light:warn");G.exports.Component=w("light",{schema:{angle:{default:60,if:{type:["spot"]}},color:{type:"color"},groundColor:{type:"color",if:{type:["hemisphere"]}},decay:{default:1,if:{type:["point","spot"]}},distance:{default:0,min:0,if:{type:["point","spot"]}},intensity:{default:1,min:0,if:{type:["ambient","directional","hemisphere","point","spot"]}},penumbra:{default:0,min:0,max:1,if:{type:["spot"]}},type:{default:"directional",oneOf:["ambient","directional","hemisphere","point","spot"],schemaChange:!0},target:{type:"selector",if:{type:["spot","directional"]}},castShadow:{default:!1,if:{type:["point","spot","directional"]}},shadowBias:{default:0,if:{castShadow:!0}},shadowCameraFar:{default:500,if:{castShadow:!0}},shadowCameraFov:{default:90,if:{castShadow:!0}},shadowCameraNear:{default:.5,if:{castShadow:!0}},shadowCameraTop:{default:5,if:{castShadow:!0}},shadowCameraRight:{default:5,if:{castShadow:!0}},shadowCameraBottom:{default:-5,if:{castShadow:!0}},shadowCameraLeft:{default:-5,if:{castShadow:!0}},shadowCameraVisible:{default:!1,if:{castShadow:!0}},shadowMapHeight:{default:512,if:{castShadow:!0}},shadowMapWidth:{default:512,if:{castShadow:!0}},shadowRadius:{default:1,if:{castShadow:!0}}},init:function(){var m=this.el;this.light=null,this.defaultTarget=null,this.rendererSystem=this.el.sceneEl.systems.renderer,this.system.registerLight(m)},update:function(m){var f=this.data,b=A(f,m),g=this.light,y=this.rendererSystem,x=this;if(g&&!("type"in b)){var L=!1;Object.keys(b).forEach(function(M){var R=f[M];switch(M){case"color":{g.color.set(R),y.applyColorCorrection(g.color);break}case"groundColor":{g.groundColor.set(R),y.applyColorCorrection(g.groundColor);break}case"angle":{g.angle=v(R);break}case"target":{R===null?(f.type==="spot"||f.type==="directional")&&(g.target=x.defaultTarget):R.hasLoaded?x.onSetTarget(R,g):R.addEventListener("loaded",u(x.onSetTarget,x,R,g));break}case"castShadow":case"shadowBias":case"shadowCameraFar":case"shadowCameraFov":case"shadowCameraNear":case"shadowCameraTop":case"shadowCameraRight":case"shadowCameraBottom":case"shadowCameraLeft":case"shadowCameraVisible":case"shadowMapHeight":case"shadowMapWidth":case"shadowRadius":L||(x.updateShadow(),L=!0);break;default:g[M]=R}});return}this.setLight(this.data),this.updateShadow()},setLight:function(m){var f=this.el,b=this.getLight(m);b&&(this.light&&f.removeObject3D("light"),this.light=b,this.light.el=f,f.setObject3D("light",this.light),(m.type==="spot"||m.type==="directional"||m.type==="hemisphere")&&f.getObject3D("light").translateY(-1),m.type==="spot"&&(f.setObject3D("light-target",this.defaultTarget),f.getObject3D("light-target").position.set(0,0,-1)))},updateShadow:function(){var m=this.el,f=this.data,b=this.light;b.castShadow=f.castShadow;var g=m.getObject3D("cameraHelper");if(f.shadowCameraVisible&&!g?m.setObject3D("cameraHelper",new h.CameraHelper(b.shadow.camera)):!f.shadowCameraVisible&&g&&m.removeObject3D("cameraHelper"),!f.castShadow)return b;b.shadow.bias=f.shadowBias,b.shadow.radius=f.shadowRadius,b.shadow.mapSize.height=f.shadowMapHeight,b.shadow.mapSize.width=f.shadowMapWidth,b.shadow.camera.near=f.shadowCameraNear,b.shadow.camera.far=f.shadowCameraFar,b.shadow.camera instanceof h.OrthographicCamera?(b.shadow.camera.top=f.shadowCameraTop,b.shadow.camera.right=f.shadowCameraRight,b.shadow.camera.bottom=f.shadowCameraBottom,b.shadow.camera.left=f.shadowCameraLeft):b.shadow.camera.fov=f.shadowCameraFov,b.shadow.camera.updateProjectionMatrix(),g&&g.update()},getLight:function(m){var f=m.angle,b=new h.Color(m.color);this.rendererSystem.applyColorCorrection(b),b=b.getHex();var g=m.decay,y=m.distance,x=new h.Color(m.groundColor);this.rendererSystem.applyColorCorrection(x),x=x.getHex();var L=m.intensity,M=m.type,R=m.target,D=null;switch(M.toLowerCase()){case"ambient":return new h.AmbientLight(b,L);case"directional":return D=new h.DirectionalLight(b,L),this.defaultTarget=D.target,R&&(R.hasLoaded?this.onSetTarget(R,D):R.addEventListener("loaded",u(this.onSetTarget,this,R,D))),D;case"hemisphere":return new h.HemisphereLight(b,x,L);case"point":return new h.PointLight(b,L,y,g);case"spot":return D=new h.SpotLight(b,L,y,v(f),m.penumbra,g),this.defaultTarget=D.target,R&&(R.hasLoaded?this.onSetTarget(R,D):R.addEventListener("loaded",u(this.onSetTarget,this,R,D))),D;default:d("%s is not a valid light type. Choose from ambient, directional, hemisphere, point, spot.",M)}},onSetTarget:function(m,f){f.target=m.object3D},remove:function(){var m=this.el;m.removeObject3D("light"),m.getObject3D("cameraHelper")&&m.removeObject3D("cameraHelper")}})},{"../core/component":131,"../lib/three":179,"../utils":205,"../utils/bind":199,"../utils/debug":201}],88:[function(_,G,fe){var u=_("../core/component").registerComponent;G.exports.Component=u("line",{schema:{start:{type:"vec3",default:{x:0,y:0,z:0}},end:{type:"vec3",default:{x:0,y:0,z:0}},color:{type:"color",default:"#74BEC1"},opacity:{type:"number",default:1},visible:{default:!0}},multiple:!0,init:function(){var E=this.data,w,h;this.rendererSystem=this.el.sceneEl.systems.renderer,h=this.material=new THREE.LineBasicMaterial({color:E.color,opacity:E.opacity,transparent:E.opacity<1,visible:E.visible}),w=this.geometry=new THREE.BufferGeometry,w.setAttribute("position",new THREE.BufferAttribute(new Float32Array(2*3),3)),this.rendererSystem.applyColorCorrection(h.color),this.line=new THREE.Line(w,h),this.el.setObject3D(this.attrName,this.line)},update:function(E){var w=this.data,h=this.geometry,v=!1,d=this.material,m=h.attributes.position.array;A(w.start,E.start)||(m[0]=w.start.x,m[1]=w.start.y,m[2]=w.start.z,v=!0),A(w.end,E.end)||(m[3]=w.end.x,m[4]=w.end.y,m[5]=w.end.z,v=!0),v&&(h.attributes.position.needsUpdate=!0,h.computeBoundingSphere()),d.color.setStyle(w.color),this.rendererSystem.applyColorCorrection(d.color),d.opacity=w.opacity,d.transparent=w.opacity<1,d.visible=w.visible},remove:function(){this.el.removeObject3D("line",this.line)}});function A(E,w){return!E||!w?!1:E.x===w.x&&E.y===w.y&&E.z===w.z}},{"../core/component":131}],89:[function(_,G,fe){var u=_("../core/component").registerComponent,A=_("../core/shader").registerShader,E=_("../lib/three");G.exports.Component=u("link",{schema:{backgroundColor:{default:"red",type:"color"},borderColor:{default:"white",type:"color"},highlighted:{default:!1},highlightedColor:{default:"#24CAFF",type:"color"},href:{default:""},image:{type:"asset"},on:{default:"click"},peekMode:{default:!1},title:{default:""},titleColor:{default:"white",type:"color"},visualAspectEnabled:{default:!1}},init:function(){this.navigate=this.navigate.bind(this),this.previousQuaternion=void 0,this.quaternionClone=new E.Quaternion,this.hiddenEls=[]},update:function(w){var h=this.data,v=this.el,d,m;!h.visualAspectEnabled||(this.initVisualAspect(),d=h.highlighted?h.highlightedColor:h.backgroundColor,m=h.highlighted?h.highlightedColor:h.borderColor,v.setAttribute("material","backgroundColor",d),v.setAttribute("material","strokeColor",m),h.on!==w.on&&this.updateEventListener(),w.peekMode!==void 0&&h.peekMode!==w.peekMode&&this.updatePeekMode(),!(!h.image||w.image===h.image)&&v.setAttribute("material","pano",typeof h.image=="string"?h.image:h.image.src))},updatePeekMode:function(){var w=this.el,h=this.sphereEl;this.data.peekMode?(this.hideAll(),w.getObject3D("mesh").visible=!1,h.setAttribute("visible",!0)):(this.showAll(),w.getObject3D("mesh").visible=!0,h.setAttribute("visible",!1))},play:function(){this.updateEventListener()},pause:function(){this.removeEventListener()},updateEventListener:function(){var w=this.el;!w.isPlaying||(this.removeEventListener(),w.addEventListener(this.data.on,this.navigate))},removeEventListener:function(){var w=this.data.on;!w||this.el.removeEventListener(w,this.navigate)},initVisualAspect:function(){var w=this.el,h,v,d;!this.data.visualAspectEnabled||this.visualAspectInitialized||(d=this.textEl=this.textEl||document.createElement("a-entity"),v=this.sphereEl=this.sphereEl||document.createElement("a-entity"),h=this.semiSphereEl=this.semiSphereEl||document.createElement("a-entity"),w.setAttribute("geometry",{primitive:"circle",radius:1,segments:64}),w.setAttribute("material",{shader:"portal",pano:this.data.image,side:"double"}),d.setAttribute("text",{color:this.data.titleColor,align:"center",font:"kelsonsans",value:this.data.title||this.data.href,width:4}),d.setAttribute("position","0 1.5 0"),w.appendChild(d),h.setAttribute("geometry",{primitive:"sphere",radius:1,phiStart:0,segmentsWidth:64,segmentsHeight:64,phiLength:180,thetaStart:0,thetaLength:360}),h.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),h.setAttribute("rotation","0 180 0"),h.setAttribute("position","0 0 0"),h.setAttribute("visible",!1),w.appendChild(h),v.setAttribute("geometry",{primitive:"sphere",radius:10,segmentsWidth:64,segmentsHeight:64}),v.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),v.setAttribute("visible",!1),w.appendChild(v),this.visualAspectInitialized=!0)},navigate:function(){window.location=this.data.href},tick:function(){var w=new E.Vector3,h=new E.Vector3,v=new E.Quaternion,d=new E.Vector3;return function(){var m=this.el,f=m.object3D,b=m.sceneEl.camera,g,y,x=this.textEl;if(!!this.data.visualAspectEnabled)if(f.updateMatrixWorld(),b.parent.updateMatrixWorld(),b.updateMatrixWorld(),f.matrix.decompose(h,v,d),h.setFromMatrixPosition(f.matrixWorld),w.setFromMatrixPosition(b.matrixWorld),y=h.distanceTo(w),y>20)this.previousQuaternion||(this.quaternionClone.copy(v),this.previousQuaternion=this.quaternionClone),f.lookAt(w);else{if(g=this.calculateCameraPortalOrientation(),y<.5){if(this.semiSphereEl.getAttribute("visible")===!0)return;x.setAttribute("text","width",1.5),g<=0?(x.setAttribute("position","0 0 0.75"),x.setAttribute("rotation","0 180 0"),this.semiSphereEl.setAttribute("rotation","0 0 0")):(x.setAttribute("position","0 0 -0.75"),x.setAttribute("rotation","0 0 0"),this.semiSphereEl.setAttribute("rotation","0 180 0")),m.getObject3D("mesh").visible=!1,this.semiSphereEl.setAttribute("visible",!0),this.peekCameraPortalOrientation=g}else g<=0?x.setAttribute("rotation","0 180 0"):x.setAttribute("rotation","0 0 0"),x.setAttribute("text","width",5),x.setAttribute("position","0 1.5 0"),m.getObject3D("mesh").visible=!0,this.semiSphereEl.setAttribute("visible",!1),this.peekCameraPortalOrientation=void 0;this.previousQuaternion&&(f.quaternion.copy(this.previousQuaternion),this.previousQuaternion=void 0)}}}(),hideAll:function(){var w=this.el,h=this.hiddenEls,v=this;h.length>0||w.sceneEl.object3D.traverse(function(d){d&&d.el&&d.el.hasAttribute("link-controls")||!d.el||d===w.sceneEl.object3D||d.el===w||d.el===v.sphereEl||d.el===w.sceneEl.cameraEl||d.el.getAttribute("visible")===!1||d.el===v.textEl||d.el===v.semiSphereEl||(d.el.setAttribute("visible",!1),h.push(d.el))})},showAll:function(){this.hiddenEls.forEach(function(w){w.setAttribute("visible",!0)}),this.hiddenEls=[]},calculateCameraPortalOrientation:function(){var w=new E.Matrix4,h=new E.Vector3,v=new E.Vector3(0,0,1),d=new E.Vector3(0,0,0);return function(){var m=this.el,f=m.sceneEl.camera;return h.set(0,0,0),v.set(0,0,1),d.set(0,0,0),m.object3D.matrixWorld.extractRotation(w),v.applyMatrix4(w),m.object3D.updateMatrixWorld(),m.object3D.localToWorld(d),f.parent.parent.updateMatrixWorld(),f.parent.updateMatrixWorld(),f.updateMatrixWorld(),f.localToWorld(h),h.sub(d).normalize(),v.normalize(),Math.sign(v.dot(h))}}(),remove:function(){this.removeEventListener()}}),A("portal",{schema:{borderEnabled:{default:1,type:"int",is:"uniform"},backgroundColor:{default:"red",type:"color",is:"uniform"},pano:{type:"map",is:"uniform"},strokeColor:{default:"white",type:"color",is:"uniform"}},vertexShader:["vec3 portalPosition;","varying vec3 vWorldPosition;","varying float vDistanceToCenter;","varying float vDistance;","void main() {","vDistanceToCenter = clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);","portalPosition = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;","vDistance = length(portalPosition - cameraPosition);","vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join(`
`),fragmentShader:["#define RECIPROCAL_PI2 0.15915494","uniform sampler2D pano;","uniform vec3 strokeColor;","uniform vec3 backgroundColor;","uniform float borderEnabled;","varying float vDistanceToCenter;","varying float vDistance;","varying vec3 vWorldPosition;","void main() {","vec3 direction = normalize(vWorldPosition - cameraPosition);","vec2 sampleUV;","float borderThickness = clamp(exp(-vDistance / 50.0), 0.6, 0.95);","sampleUV.y = clamp(direction.y * 0.5  + 0.5, 0.0, 1.0);","sampleUV.x = atan(direction.z, -direction.x) * -RECIPROCAL_PI2 + 0.5;","if (vDistanceToCenter > borderThickness && borderEnabled == 1.0) {","gl_FragColor = vec4(strokeColor, 1.0);","} else {","gl_FragColor = mix(texture2D(pano, sampleUV), vec4(backgroundColor, 1.0), clamp(pow((vDistance / 15.0), 2.0), 0.0, 1.0));","}","}"].join(`
`)})},{"../core/component":131,"../core/shader":141,"../lib/three":179}],90:[function(_,G,fe){var u=_("../core/component").registerComponent,A=_("../lib/three"),E=_("../utils/"),w=E.bind,h=Math.PI/2;G.exports.Component=u("look-controls",{dependencies:["position","rotation"],schema:{enabled:{default:!0},magicWindowTrackingEnabled:{default:!0},pointerLockEnabled:{default:!1},reverseMouseDrag:{default:!1},reverseTouchDrag:{default:!1},touchEnabled:{default:!0},mouseEnabled:{default:!0}},init:function(){this.deltaYaw=0,this.previousHMDPosition=new A.Vector3,this.hmdQuaternion=new A.Quaternion,this.magicWindowAbsoluteEuler=new A.Euler,this.magicWindowDeltaEuler=new A.Euler,this.position=new A.Vector3,this.magicWindowObject=new A.Object3D,this.rotation={},this.deltaRotation={},this.savedPose=null,this.pointerLocked=!1,this.setupMouseControls(),this.bindMethods(),this.previousMouseEvent={},this.setupMagicWindowControls(),this.savedPose={position:new A.Vector3,rotation:new A.Euler},this.el.sceneEl.is("vr-mode")&&this.onEnterVR()},setupMagicWindowControls:function(){var v,d=this.data;E.device.isMobile()&&(v=this.magicWindowControls=new A.DeviceOrientationControls(this.magicWindowObject),typeof DeviceOrientationEvent!="undefined"&&DeviceOrientationEvent.requestPermission&&(v.enabled=!1,this.el.sceneEl.components["device-orientation-permission-ui"].permissionGranted?v.enabled=d.magicWindowTrackingEnabled:this.el.sceneEl.addEventListener("deviceorientationpermissiongranted",function(){v.enabled=d.magicWindowTrackingEnabled})))},update:function(v){var d=this.data;d.enabled!==v.enabled&&this.updateGrabCursor(d.enabled),v&&!d.magicWindowTrackingEnabled&&v.magicWindowTrackingEnabled&&(this.magicWindowAbsoluteEuler.set(0,0,0),this.magicWindowDeltaEuler.set(0,0,0)),this.magicWindowControls&&(this.magicWindowControls.enabled=d.magicWindowTrackingEnabled),v&&!d.pointerLockEnabled!==v.pointerLockEnabled&&(this.removeEventListeners(),this.addEventListeners(),this.pointerLocked&&this.exitPointerLock())},tick:function(v){var d=this.data;!d.enabled||this.updateOrientation()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},remove:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},bindMethods:function(){this.onMouseDown=w(this.onMouseDown,this),this.onMouseMove=w(this.onMouseMove,this),this.onMouseUp=w(this.onMouseUp,this),this.onTouchStart=w(this.onTouchStart,this),this.onTouchMove=w(this.onTouchMove,this),this.onTouchEnd=w(this.onTouchEnd,this),this.onEnterVR=w(this.onEnterVR,this),this.onExitVR=w(this.onExitVR,this),this.onPointerLockChange=w(this.onPointerLockChange,this),this.onPointerLockError=w(this.onPointerLockError,this)},setupMouseControls:function(){this.mouseDown=!1,this.pitchObject=new A.Object3D,this.yawObject=new A.Object3D,this.yawObject.position.y=10,this.yawObject.add(this.pitchObject)},addEventListeners:function(){var v=this.el.sceneEl,d=v.canvas;if(!d){v.addEventListener("render-target-loaded",w(this.addEventListeners,this));return}d.addEventListener("mousedown",this.onMouseDown,!1),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("mouseup",this.onMouseUp,!1),d.addEventListener("touchstart",this.onTouchStart),window.addEventListener("touchmove",this.onTouchMove),window.addEventListener("touchend",this.onTouchEnd),v.addEventListener("enter-vr",this.onEnterVR),v.addEventListener("exit-vr",this.onExitVR),this.data.pointerLockEnabled&&(document.addEventListener("pointerlockchange",this.onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.addEventListener("pointerlockerror",this.onPointerLockError,!1))},removeEventListeners:function(){var v=this.el.sceneEl,d=v&&v.canvas;!d||(d.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),d.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),v.removeEventListener("enter-vr",this.onEnterVR),v.removeEventListener("exit-vr",this.onExitVR),document.removeEventListener("pointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("pointerlockerror",this.onPointerLockError,!1))},updateOrientation:function(){var v=new A.Matrix4;return function(){var d=this.el.object3D,m=this.pitchObject,f=this.yawObject,b,g=this.el.sceneEl;if(g.is("vr-mode")&&g.checkHeadsetConnected()){g.hasWebXR&&(b=g.renderer.xr.getCameraPose(),b&&(v.elements=b.transform.matrix,v.decompose(d.position,d.rotation,d.scale)));return}this.updateMagicWindowOrientation(),d.rotation.x=this.magicWindowDeltaEuler.x+m.rotation.x,d.rotation.y=this.magicWindowDeltaEuler.y+f.rotation.y,d.rotation.z=this.magicWindowDeltaEuler.z}}(),updateMagicWindowOrientation:function(){var v=this.magicWindowAbsoluteEuler,d=this.magicWindowDeltaEuler;this.magicWindowControls&&this.magicWindowControls.enabled&&(this.magicWindowControls.update(),v.setFromQuaternion(this.magicWindowObject.quaternion,"YXZ"),!this.previousMagicWindowYaw&&v.y!==0&&(this.previousMagicWindowYaw=v.y),this.previousMagicWindowYaw&&(d.x=v.x,d.y+=v.y-this.previousMagicWindowYaw,d.z=v.z,this.previousMagicWindowYaw=v.y))},onMouseMove:function(v){var d,m,f,b=this.pitchObject,g=this.previousMouseEvent,y=this.yawObject;!this.data.enabled||!this.mouseDown&&!this.pointerLocked||(this.pointerLocked?(m=v.movementX||v.mozMovementX||0,f=v.movementY||v.mozMovementY||0):(m=v.screenX-g.screenX,f=v.screenY-g.screenY),this.previousMouseEvent.screenX=v.screenX,this.previousMouseEvent.screenY=v.screenY,d=this.data.reverseMouseDrag?1:-1,y.rotation.y+=m*.002*d,b.rotation.x+=f*.002*d,b.rotation.x=Math.max(-h,Math.min(h,b.rotation.x)))},onMouseDown:function(v){var d=this.el.sceneEl;if(!(!this.data.enabled||!this.data.mouseEnabled||d.is("vr-mode")&&d.checkHeadsetConnected())&&v.button===0){var m=d&&d.canvas;this.mouseDown=!0,this.previousMouseEvent.screenX=v.screenX,this.previousMouseEvent.screenY=v.screenY,this.showGrabbingCursor(),this.data.pointerLockEnabled&&!this.pointerLocked&&(m.requestPointerLock?m.requestPointerLock():m.mozRequestPointerLock&&m.mozRequestPointerLock())}},showGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor="grabbing"},hideGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor=""},onMouseUp:function(){this.mouseDown=!1,this.hideGrabbingCursor()},onTouchStart:function(v){v.touches.length!==1||!this.data.touchEnabled||this.el.sceneEl.is("vr-mode")||(this.touchStart={x:v.touches[0].pageX,y:v.touches[0].pageY},this.touchStarted=!0)},onTouchMove:function(v){var d,m=this.el.sceneEl.canvas,f,b=this.yawObject;!this.touchStarted||!this.data.touchEnabled||(f=2*Math.PI*(v.touches[0].pageX-this.touchStart.x)/m.clientWidth,d=this.data.reverseTouchDrag?1:-1,b.rotation.y-=f*.5*d,this.touchStart={x:v.touches[0].pageX,y:v.touches[0].pageY})},onTouchEnd:function(){this.touchStarted=!1},onEnterVR:function(){var v=this.el.sceneEl;!v.checkHeadsetConnected()||(this.saveCameraPose(),this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),v.hasWebXR&&(this.el.object3D.matrixAutoUpdate=!1,this.el.object3D.updateMatrix()))},onExitVR:function(){!this.el.sceneEl.checkHeadsetConnected()||(this.restoreCameraPose(),this.previousHMDPosition.set(0,0,0),this.el.object3D.matrixAutoUpdate=!0)},onPointerLockChange:function(){this.pointerLocked=!!(document.pointerLockElement||document.mozPointerLockElement)},onPointerLockError:function(){this.pointerLocked=!1},exitPointerLock:function(){document.exitPointerLock(),this.pointerLocked=!1},updateGrabCursor:function(v){var d=this.el.sceneEl;function m(){d.canvas.classList.add("a-grab-cursor")}function f(){d.canvas.classList.remove("a-grab-cursor")}if(!d.canvas){v?d.addEventListener("render-target-loaded",m):d.addEventListener("render-target-loaded",f);return}if(v){m();return}f()},saveCameraPose:function(){var v=this.el;this.savedPose.position.copy(v.object3D.position),this.savedPose.rotation.copy(v.object3D.rotation),this.hasSavedPose=!0},restoreCameraPose:function(){var v=this.el,d=this.savedPose;!this.hasSavedPose||(v.object3D.position.copy(d.position),v.object3D.rotation.copy(d.rotation),this.hasSavedPose=!1)}})},{"../core/component":131,"../lib/three":179,"../utils/":205}],91:[function(_,G,fe){var u=_("../utils/bind"),A=_("../core/component").registerComponent,E=_("../utils/tracked-controls"),w=E.checkControllerPresentAndSetup,h=E.emitIfAxesChanged,v=E.onButtonEvent,d="magicleap",m="-one",f=d+m,b="https://cdn.aframe.io/controllers/magicleap/magicleap-one-controller.glb",g={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","menu"]};G.exports.Component=A("magicleap-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:g,init:function(){var y=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(x){v(x.detail.id,"down",y)},this.onButtonUp=function(x){v(x.detail.id,"up",y)},this.onButtonTouchEnd=function(x){v(x.detail.id,"touchend",y)},this.onButtonTouchStart=function(x){v(x.detail.id,"touchstart",y)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},update:function(){var y=this.data;this.controllerIndex=y.hand==="right"?0:y.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this),this.onAxisMoved=u(this.onAxisMoved,this)},addEventListeners:function(){var y=this.el;y.addEventListener("buttonchanged",this.onButtonChanged),y.addEventListener("buttondown",this.onButtonDown),y.addEventListener("buttonup",this.onButtonUp),y.addEventListener("touchstart",this.onButtonTouchStart),y.addEventListener("touchend",this.onButtonTouchEnd),y.addEventListener("axismove",this.onAxisMoved),y.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var y=this.el;y.removeEventListener("buttonchanged",this.onButtonChanged),y.removeEventListener("buttondown",this.onButtonDown),y.removeEventListener("buttonup",this.onButtonUp),y.removeEventListener("touchstart",this.onButtonTouchStart),y.removeEventListener("touchend",this.onButtonTouchEnd),y.removeEventListener("axismove",this.onAxisMoved),y.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var y=this.data;w(this,f,{index:this.controllerIndex,hand:y.hand})},injectTrackedControls:function(){var y=this.el,x=this.data;y.setAttribute("tracked-controls",{idPrefix:f,hand:x.hand,controller:this.controllerIndex,orientationOffset:x.orientationOffset}),!!this.data.model&&this.el.setAttribute("gltf-model",b)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(y){var x=this.mapping.buttons[y.detail.id],L;!x||(x==="trigger"&&(L=y.detail.state.value,console.log("analog value of trigger press: "+L)),this.el.emit(x+"changed",y.detail.state))},onModelLoaded:function(y){var x=y.detail.model;x.scale.set(.01,.01,.01)},onAxisMoved:function(y){h(this,this.mapping.axes,y)},updateModel:function(y,x){},setButtonColor:function(y,x){}})},{"../core/component":131,"../utils/bind":199,"../utils/tracked-controls":214}],92:[function(_,G,fe){var u=_("../utils/"),A=_("../core/component"),E=_("../lib/three"),w=_("../core/shader"),h=u.debug("components:material:error"),v=A.registerComponent,d=w.shaders,m=w.shaderNames;G.exports.Component=v("material",{schema:{alphaTest:{default:0,min:0,max:1},depthTest:{default:!0},depthWrite:{default:!0},flatShading:{default:!1},npot:{default:!1},offset:{type:"vec2",default:{x:0,y:0}},opacity:{default:1,min:0,max:1},repeat:{type:"vec2",default:{x:1,y:1}},shader:{default:"standard",oneOf:m,schemaChange:!0},side:{default:"front",oneOf:["front","back","double"]},transparent:{default:!1},vertexColors:{type:"string",default:"none",oneOf:["face","vertex"]},visible:{default:!0},blending:{default:"normal",oneOf:["none","normal","additive","subtractive","multiply"]},dithering:{default:!0}},init:function(){this.material=null},update:function(x){var L=this.data;(!this.shader||L.shader!==x.shader)&&this.updateShader(L.shader),this.shader.update(this.data),this.updateMaterial(x)},updateSchema:function(x){var L,M,R,D;M=x&&x.shader,L=this.oldData&&this.oldData.shader,D=M||L,R=d[D]&&d[D].schema,R||h("Unknown shader schema "+D),!(L&&M===L)&&(this.extendSchema(R),this.updateBehavior())},updateBehavior:function(){var x,L=this.el.sceneEl,M=this.schema,R=this,D;function N(z,re){var Y;for(Y in D)D[Y]=z;R.shader.update(D)}this.tick=void 0,D={};for(x in M)M[x].type==="time"&&(this.tick=N,D[x]=!0);!L||(this.tick?L.addBehavior(this):L.removeBehavior(this))},updateShader:function(x){var L=this.data,M=d[x]&&d[x].Shader,R;if(!M)throw new Error("Unknown shader "+x);R=this.shader=new M,R.el=this.el,R.init(L),this.setMaterial(R.material),this.updateSchema(L)},updateMaterial:function(x){var L=this.data,M=this.material,R;M.alphaTest=L.alphaTest,M.depthTest=L.depthTest!==!1,M.depthWrite=L.depthWrite!==!1,M.opacity=L.opacity,M.flatShading=L.flatShading,M.side=f(L.side),M.transparent=L.transparent!==!1||L.opacity<1,M.vertexColors=b(L.vertexColors),M.visible=L.visible,M.blending=g(L.blending),M.dithering=L.dithering;for(R in x)break;R&&(x.alphaTest!==L.alphaTest||x.side!==L.side||x.vertexColors!==L.vertexColors)&&(M.needsUpdate=!0)},remove:function(){var x=new E.MeshBasicMaterial,L=this.material,M=this.el.getObject3D("mesh");M&&(M.material=x),y(L,this.system)},setMaterial:function(x){var L=this.el,M,R=this.system;this.material&&y(this.material,R),this.material=x,R.registerMaterial(x),M=L.getObject3D("mesh"),M?M.material=x:L.addEventListener("object3dset",function D(N){N.detail.type!=="mesh"||N.target!==L||(L.getObject3D("mesh").material=x,L.removeEventListener("object3dset",D))})}});function f(x){switch(x){case"back":return E.BackSide;case"double":return E.DoubleSide;default:return E.FrontSide}}function b(x){switch(x){case"face":return E.FaceColors;case"vertex":return E.VertexColors;default:return E.NoColors}}function g(x){switch(x){case"none":return E.NoBlending;case"additive":return E.AdditiveBlending;case"subtractive":return E.SubtractiveBlending;case"multiply":return E.MultiplyBlending;default:return E.NormalBlending}}function y(x,L){x.dispose(),L.unregisterMaterial(x)}},{"../core/component":131,"../core/shader":141,"../lib/three":179,"../utils/":205}],93:[function(_,G,fe){var u=_("../utils/debug"),A=_("../core/component").registerComponent,E=_("../lib/three"),w=u("components:obj-model:warn");G.exports.Component=A("obj-model",{schema:{mtl:{type:"model"},obj:{type:"model"}},init:function(){var h=this;this.model=null,this.objLoader=new E.OBJLoader,this.mtlLoader=new E.MTLLoader(this.objLoader.manager),this.mtlLoader.crossOrigin="",this.el.addEventListener("componentinitialized",function(v){!h.model||v.detail.name==="material"&&h.applyMaterial()})},update:function(){var h=this.data;!h.obj||(this.resetMesh(),this.loadObj(h.obj,h.mtl))},remove:function(){!this.model||this.resetMesh()},resetMesh:function(){this.el.removeObject3D("mesh")},loadObj:function(h,v){var d=this,m=this.el,f=this.mtlLoader,b=this.objLoader,g=this.el.sceneEl.systems.renderer,y=v.substr(0,v.lastIndexOf("/")+1);if(v){m.hasAttribute("material")&&w("Material component properties are ignored when a .MTL is provided"),f.setResourcePath(y),f.load(v,function(x){x.preload(),b.setMaterials(x),b.load(h,function(L){d.model=L,d.model.traverse(function(M){if(M.isMesh){var R=M.material;R.color&&g.applyColorCorrection(R.color),R.map&&g.applyColorCorrection(R.map),R.emissive&&g.applyColorCorrection(R.emissive),R.emissiveMap&&g.applyColorCorrection(R.emissiveMap)}}),m.setObject3D("mesh",L),m.emit("model-loaded",{format:"obj",model:L})})});return}b.load(h,function(L){d.model=L,d.applyMaterial(),m.setObject3D("mesh",L),m.emit("model-loaded",{format:"obj",model:L})})},applyMaterial:function(){var h=this.el.components.material;!h||this.model.traverse(function(v){v instanceof E.Mesh&&(v.material=h.material)})}})},{"../core/component":131,"../lib/three":179,"../utils/debug":201}],94:[function(_,G,fe){var u=_("../core/component").registerComponent,A=_("../utils/bind"),E=_("../utils/tracked-controls"),w=E.checkControllerPresentAndSetup,h=E.emitIfAxesChanged,v=E.onButtonEvent,d=_("../utils/").device.isWebXRAvailable,m="oculus-go",f="Oculus Go",b="https://cdn.aframe.io/controllers/oculus/go/oculus-go-controller.gltf",g=d?m:f,y={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},x={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad"]},L=d?x:y;G.exports.Component=u("oculus-go-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#FFFFFF"},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:L,bindMethods:function(){this.onModelLoaded=A(this.onModelLoaded,this),this.onControllersUpdate=A(this.onControllersUpdate,this),this.checkIfControllerPresent=A(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=A(this.removeControllersUpdateListener,this),this.onAxisMoved=A(this.onAxisMoved,this)},init:function(){var M=this;this.onButtonChanged=A(this.onButtonChanged,this),this.onButtonDown=function(R){v(R.detail.id,"down",M)},this.onButtonUp=function(R){v(R.detail.id,"up",M)},this.onButtonTouchStart=function(R){v(R.detail.id,"touchstart",M)},this.onButtonTouchEnd=function(R){v(R.detail.id,"touchend",M)},this.controllerPresent=!1,this.lastControllerCheck=0,this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},addEventListeners:function(){var M=this.el;M.addEventListener("buttonchanged",this.onButtonChanged),M.addEventListener("buttondown",this.onButtonDown),M.addEventListener("buttonup",this.onButtonUp),M.addEventListener("touchstart",this.onButtonTouchStart),M.addEventListener("touchend",this.onButtonTouchEnd),M.addEventListener("model-loaded",this.onModelLoaded),M.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var M=this.el;M.removeEventListener("buttonchanged",this.onButtonChanged),M.removeEventListener("buttondown",this.onButtonDown),M.removeEventListener("buttonup",this.onButtonUp),M.removeEventListener("touchstart",this.onButtonTouchStart),M.removeEventListener("touchend",this.onButtonTouchEnd),M.removeEventListener("model-loaded",this.onModelLoaded),M.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){w(this,g,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var M=this.el,R=this.data;M.setAttribute("tracked-controls",{armModel:R.armModel,hand:R.hand,idPrefix:g,orientationOffset:R.orientationOffset}),!!this.data.model&&this.el.setAttribute("gltf-model",b)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(M){var R=M.detail.model,D;!this.data.model||(D=this.buttonMeshes={},D.trigger=R.getObjectByName("oculus_go_button_trigger"),D.trackpad=R.getObjectByName("oculus_go_touchpad"),D.touchpad=R.getObjectByName("oculus_go_touchpad"))},onButtonChanged:function(M){var R=this.mapping.buttons[M.detail.id];!R||this.el.emit(R+"changed",M.detail.state)},onAxisMoved:function(M){h(this,this.mapping.axes,M)},updateModel:function(M,R){!this.data.model||this.updateButtonModel(M,R)},updateButtonModel:function(M,R){var D=this.buttonMeshes;if(!(!D||!D[M])){var N,z;switch(R){case"down":N=this.data.buttonHighlightColor;break;case"touchstart":N=this.data.buttonTouchedColor;break;default:N=this.data.buttonColor}z=D[M],z.material.color.set(N),this.rendererSystem.applyColorCorrection(z.material.color)}}})},{"../core/component":131,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],95:[function(_,G,fe){var u=_("../utils/bind"),A=_("../core/component").registerComponent,E=_("../lib/three"),w=_("../utils/tracked-controls"),h=w.checkControllerPresentAndSetup,v=w.emitIfAxesChanged,d=w.onButtonEvent,m=_("../utils/").device.isWebXRAvailable,f="oculus-touch",b="Oculus Touch",g=m?f:b,y="https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-",x={left:{modelUrl:y+"left.gltf",rayOrigin:{origin:{x:.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new E.Vector3(-.005,.003,-.055),modelPivotRotation:new E.Euler(0,0,0)},right:{modelUrl:y+"right.gltf",rayOrigin:{origin:{x:-.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new E.Vector3(.005,.003,-.055),modelPivotRotation:new E.Euler(0,0,0)}},L={left:{modelUrl:y+"left.gltf",rayOrigin:{origin:{x:.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new E.Vector3(-.005,.036,-.037),modelPivotRotation:new E.Euler(Math.PI/4.5,0,0)},right:{modelUrl:y+"right.gltf",rayOrigin:{origin:{x:-.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new E.Vector3(.005,.036,-.037),modelPivotRotation:new E.Euler(Math.PI/4.5,0,0)}},M=m?L:x,R="oculus-touch",D={"oculus-touch":M,"oculus-touch-v2":{left:{modelUrl:y+"gen2-left.gltf",rayOrigin:{origin:{x:-.01,y:0,z:-.02},direction:{x:0,y:-.5,z:-1}},modelPivotOffset:new E.Vector3(0,0,0),modelPivotRotation:new E.Euler(0,0,0)},right:{modelUrl:y+"gen2-right.gltf",rayOrigin:{origin:{x:.01,y:0,z:-.02},direction:{x:0,y:-.5,z:-1}},modelPivotOffset:new E.Vector3(0,0,0),modelPivotRotation:new E.Euler(0,0,0)}},"oculus-touch-v3":{left:{modelUrl:y+"v3-left.glb",rayOrigin:{origin:{x:.015,y:.005,z:0},direction:{x:0,y:0,z:-1}},modelPivotOffset:new E.Vector3(.01,-.01,.05),modelPivotRotation:new E.Euler(Math.PI/4,0,0)},right:{modelUrl:y+"v3-right.glb",rayOrigin:{origin:{x:-.015,y:.005,z:0},direction:{x:0,y:0,z:-1}},modelPivotOffset:new E.Vector3(-.01,-.01,.05),modelPivotRotation:new E.Euler(Math.PI/4,0,0)}}},N={left:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","abutton","bbutton","surface"]}},z={left:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton","surface"]}},re=m?z:N;G.exports.Component=A("oculus-touch-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#999"},buttonTouchColor:{type:"color",default:"#8AB"},buttonHighlightColor:{type:"color",default:"#2DF"},model:{default:!0},controllerType:{default:"auto",oneOf:["auto","oculus-touch","oculus-touch-v2","oculus-touch-v3"]},orientationOffset:{type:"vec3",default:{x:43,y:0,z:0}}},mapping:re,bindMethods:function(){this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.onAxisMoved=u(this.onAxisMoved,this)},init:function(){var Y=this;this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(te){d(te.detail.id,"down",Y,Y.data.hand)},this.onButtonUp=function(te){d(te.detail.id,"up",Y,Y.data.hand)},this.onButtonTouchStart=function(te){d(te.detail.id,"touchstart",Y,Y.data.hand)},this.onButtonTouchEnd=function(te){d(te.detail.id,"touchend",Y,Y.data.hand)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},addEventListeners:function(){var Y=this.el;Y.addEventListener("buttonchanged",this.onButtonChanged),Y.addEventListener("buttondown",this.onButtonDown),Y.addEventListener("buttonup",this.onButtonUp),Y.addEventListener("touchstart",this.onButtonTouchStart),Y.addEventListener("touchend",this.onButtonTouchEnd),Y.addEventListener("axismove",this.onAxisMoved),Y.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var Y=this.el;Y.removeEventListener("buttonchanged",this.onButtonChanged),Y.removeEventListener("buttondown",this.onButtonDown),Y.removeEventListener("buttonup",this.onButtonUp),Y.removeEventListener("touchstart",this.onButtonTouchStart),Y.removeEventListener("touchend",this.onButtonTouchEnd),Y.removeEventListener("axismove",this.onAxisMoved),Y.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){h(this,g,{hand:this.data.hand})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},loadModel:function(Y){var te=this.data,J;if(!!te.model){if(this.displayModel=D[te.controllerType]||D[R],te.controllerType==="auto"){var le=this.el.sceneEl.systems["tracked-controls-webvr"];if(le&&le.vrDisplay){var j=le.vrDisplay.displayName;/^Oculus Quest$/.test(j)&&(this.displayModel=D["oculus-touch-v2"])}else J=R,J=Y.profiles.indexOf("oculus-touch-v2")!==-1?"oculus-touch-v2":J,J=Y.profiles.indexOf("oculus-touch-v3")!==-1?"oculus-touch-v3":J,this.displayModel=D[J]}var ae=this.displayModel[te.hand].modelUrl;this.el.setAttribute("gltf-model",ae)}},injectTrackedControls:function(Y){var te=this.data,J=f,le=te.hand==="right"?"Oculus Touch (Right)":"Oculus Touch (Left)",j=m?J:le;this.el.setAttribute("tracked-controls",{id:j,hand:te.hand,orientationOffset:te.orientationOffset,handTrackingEnabled:!1}),this.loadModel(Y)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(Y){var te=this.mapping[this.data.hand].buttons[Y.detail.id],J=this.buttonMeshes,le;!te||((te==="trigger"||te==="grip")&&(le=Y.detail.state.value),J&&(te==="trigger"&&J.trigger&&(J.trigger.rotation.x=this.originalXRotationTrigger-le*(Math.PI/26)),te==="grip"&&J.grip&&(J.grip.position.x=this.originalXPositionGrip+(this.data.hand==="left"?-1:1)*le*.004)),this.el.emit(te+"changed",Y.detail.state))},onModelLoaded:function(Y){var te=this.controllerObject3D=Y.detail.model,J;!this.data.model||(J=this.buttonMeshes={},J.grip=te.getObjectByName("buttonHand"),this.originalXPositionGrip=J.grip&&J.grip.position.x,J.thumbstick=te.getObjectByName("stick"),J.trigger=te.getObjectByName("buttonTrigger"),this.originalXRotationTrigger=J.trigger&&J.trigger.rotation.x,J.xbutton=te.getObjectByName("buttonX"),J.abutton=te.getObjectByName("buttonA"),J.ybutton=te.getObjectByName("buttonY"),J.bbutton=te.getObjectByName("buttonB"),te.position.copy(this.displayModel[this.data.hand].modelPivotOffset),te.rotation.copy(this.displayModel[this.data.hand].modelPivotRotation),this.el.emit("controllermodelready",{name:"oculus-touch-controls",model:this.data.model,rayOrigin:this.displayModel[this.data.hand].rayOrigin}))},onAxisMoved:function(Y){v(this,this.mapping[this.data.hand].axes,Y)},updateModel:function(Y,te){!this.data.model||this.updateButtonModel(Y,te)},updateButtonModel:function(Y,te){var J,le=te==="up"||te==="touchend"?this.data.buttonColor:te==="touchstart"?this.data.buttonTouchColor:this.data.buttonHighlightColor,j=this.buttonMeshes;!this.data.model||j&&j[Y]&&(J=j[Y],J.material.color.set(le),this.rendererSystem.applyColorCorrection(J.material.color))}})},{"../core/component":131,"../lib/three":179,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],96:[function(_,G,fe){var u=_("../core/component").registerComponent;G.exports.Component=u("position",{schema:{type:"vec3"},update:function(){var A=this.el.object3D,E=this.data;A.position.set(E.x,E.y,E.z)},remove:function(){this.el.object3D.position.set(0,0,0)}})},{"../core/component":131}],97:[function(_,G,fe){var u=_("../core/component").registerComponent,A=_("../lib/three"),E=_("../utils/"),w=E.debug("components:raycaster:warn"),h=/^[\w\s-.,[\]#]*$/,v={childList:!0,attributes:!0,subtree:!0},d={INTERSECT:"raycaster-intersected",INTERSECTION:"raycaster-intersection",INTERSECT_CLEAR:"raycaster-intersected-cleared",INTERSECTION_CLEAR:"raycaster-intersection-cleared"};G.exports.Component=u("raycaster",{schema:{autoRefresh:{default:!0},direction:{type:"vec3",default:{x:0,y:0,z:-1}},enabled:{default:!0},far:{default:1e3},interval:{default:0},near:{default:0},objects:{default:""},origin:{type:"vec3"},showLine:{default:!1},lineColor:{default:"white"},lineOpacity:{default:1},useWorldCoordinates:{default:!1}},multiple:!0,init:function(){this.clearedIntersectedEls=[],this.unitLineEndVec3=new A.Vector3,this.intersectedEls=[],this.intersections=[],this.newIntersectedEls=[],this.newIntersections=[],this.objects=[],this.prevCheckTime=void 0,this.prevIntersectedEls=[],this.rawIntersections=[],this.raycaster=new A.Raycaster,this.updateOriginDirection(),this.setDirty=this.setDirty.bind(this),this.updateLine=this.updateLine.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.lineEndVec3=new A.Vector3,this.otherLineEndVec3=new A.Vector3,this.lineData={end:this.lineEndVec3},this.getIntersection=this.getIntersection.bind(this),this.intersectedDetail={el:this.el,getIntersection:this.getIntersection},this.intersectedClearedDetail={el:this.el},this.intersectionClearedDetail={clearedEls:this.clearedIntersectedEls},this.intersectionDetail={}},update:function(f){var b=this.data,g=this.el,y=this.raycaster;y.far=b.far,y.near=b.near,b.showLine&&(b.far!==f.far||b.origin!==f.origin||b.direction!==f.direction||!f.showLine)&&(this.unitLineEndVec3.copy(b.origin).add(b.direction).normalize(),this.drawLine()),!b.showLine&&f.showLine&&g.removeAttribute("line"),b.objects!==f.objects&&!h.test(b.objects)&&w('[raycaster] Selector "'+b.objects+'" may not update automatically with DOM changes.'),b.objects||w('[raycaster] For performance, please define raycaster.objects when using raycaster or cursor components to whitelist which entities to intersect with. e.g., raycaster="objects: [data-raycastable]".'),b.autoRefresh!==f.autoRefresh&&g.isPlaying&&(b.autoRefresh?this.addEventListeners():this.removeEventListeners()),f.enabled&&!b.enabled&&this.clearAllIntersections(),this.setDirty()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.data.showLine&&this.el.removeAttribute("line"),this.clearAllIntersections()},addEventListeners:function(){!this.data.autoRefresh||(this.observer.observe(this.el.sceneEl,v),this.el.sceneEl.addEventListener("object3dset",this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty))},removeEventListeners:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener("object3dset",this.setDirty),this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},setDirty:function(){this.dirty=!0},refreshObjects:function(){var f=this.data,b;b=f.objects?this.el.sceneEl.querySelectorAll(f.objects):this.el.sceneEl.querySelectorAll("*"),this.objects=this.flattenObject3DMaps(b),this.dirty=!1},tock:function(f){var b=this.data,g=this.prevCheckTime;!b.enabled||g&&f-g<b.interval||(this.prevCheckTime=f,this.checkIntersections())},checkIntersections:function(){var f=this.clearedIntersectedEls,b=this.el,g=this.data,y,x=this.intersectedEls,L,M=this.intersections,R=this.newIntersectedEls,D=this.newIntersections,N=this.prevIntersectedEls,z=this.rawIntersections;for(this.dirty&&this.refreshObjects(),m(this.prevIntersectedEls,this.intersectedEls),this.updateOriginDirection(),z.length=0,this.raycaster.intersectObjects(this.objects,!0,z),M.length=0,x.length=0,y=0;y<z.length;y++)L=z[y],!(g.showLine&&L.object===b.getObject3D("line"))&&L.object.el&&(M.push(L),x.push(L.object.el));for(D.length=0,R.length=0,y=0;y<M.length;y++)N.indexOf(M[y].object.el)===-1&&(D.push(M[y]),R.push(M[y].object.el));for(f.length=0,y=0;y<N.length;y++)x.indexOf(N[y])===-1&&(N[y].emit(d.INTERSECT_CLEAR,this.intersectedClearedDetail),f.push(N[y]));for(f.length&&b.emit(d.INTERSECTION_CLEAR,this.intersectionClearedDetail),y=0;y<R.length;y++)R[y].emit(d.INTERSECT,this.intersectedDetail);D.length&&(this.intersectionDetail.els=R,this.intersectionDetail.intersections=D,b.emit(d.INTERSECTION,this.intersectionDetail)),g.showLine&&setTimeout(this.updateLine)},updateLine:function(){var f=this.el,b=this.intersections,g;b.length&&(b[0].object.el===f&&b[1]?g=b[1].distance:g=b[0].distance),this.drawLine(g)},getIntersection:function(f){var b,g;for(b=0;b<this.intersections.length;b++)if(g=this.intersections[b],g.object.el===f)return g;return null},updateOriginDirection:function(){var f=new A.Vector3,b=new A.Vector3;return function(){var y=this.el,x=this.data;if(x.useWorldCoordinates){this.raycaster.set(x.origin,x.direction);return}y.object3D.updateMatrixWorld(),b.setFromMatrixPosition(y.object3D.matrixWorld),(x.origin.x!==0||x.origin.y!==0||x.origin.z!==0)&&(b=y.object3D.localToWorld(b.copy(x.origin))),f.copy(x.direction).transformDirection(y.object3D.matrixWorld).normalize(),this.raycaster.set(b,f)}}(),drawLine:function(f){var b=this.data,g=this.el,y;y=this.lineData.end===this.lineEndVec3?this.otherLineEndVec3:this.lineEndVec3,f===void 0&&(f=b.far===1/0?1e3:b.far),this.lineData.start=b.origin,this.lineData.end=y.copy(this.unitLineEndVec3).multiplyScalar(f),this.lineData.color=b.lineColor,this.lineData.opacity=b.lineOpacity,g.setAttribute("line",this.lineData)},flattenObject3DMaps:function(f){var b,g,y=this.objects;for(y.length=0,g=0;g<f.length;g++)if(f[g].isEntity&&f[g].object3D)for(b in f[g].object3DMap)y.push(f[g].getObject3D(b));return y},clearAllIntersections:function(){var f;for(f=0;f<this.intersectedEls.length;f++)this.intersectedEls[f].emit(d.INTERSECT_CLEAR,this.intersectedClearedDetail);m(this.clearedIntersectedEls,this.intersectedEls),this.intersectedEls.length=0,this.intersections.length=0,this.el.emit(d.INTERSECTION_CLEAR,this.intersectionClearedDetail)}});function m(f,b){var g;for(f.length=b.length,g=0;g<b.length;g++)f[g]=b[g]}},{"../core/component":131,"../lib/three":179,"../utils/":205}],98:[function(_,G,fe){var u=_("../lib/three").Math.degToRad,A=_("../core/component").registerComponent;G.exports.Component=A("rotation",{schema:{type:"vec3"},update:function(){var E=this.data,w=this.el.object3D;w.rotation.set(u(E.x),u(E.y),u(E.z)),w.rotation.order="YXZ"},remove:function(){this.el.object3D.rotation.set(0,0,0)}})},{"../core/component":131,"../lib/three":179}],99:[function(_,G,fe){var u=_("../core/component").registerComponent,A=1e-5;G.exports.Component=u("scale",{schema:{type:"vec3",default:{x:1,y:1,z:1}},update:function(){var E=this.data,w=this.el.object3D,h=E.x===0?A:E.x,v=E.y===0?A:E.y,d=E.z===0?A:E.z;w.scale.set(h,v,d)},remove:function(){this.el.object3D.scale.set(1,1,1)}})},{"../core/component":131}],100:[function(_,G,fe){var u=_("../../core/component").registerComponent,A=_("../../core/component").components;G.exports.Component=u("background",{schema:{color:{type:"color",default:"black"},transparent:{default:!1}},update:function(){var E=this.data,w=this.el.object3D;if(E.transparent){w.background=null;return}w.background=new THREE.Color(E.color)},remove:function(){var E=this.data,w=this.el.object3D;if(E.transparent){w.background=null;return}w.background=A[this.name].schema.color.default}})},{"../../core/component":131}],101:[function(_,G,fe){var u=_("../../core/component").registerComponent;G.exports.Component=u("debug",{schema:{default:!0}})},{"../../core/component":131}],102:[function(_,G,fe){var u=_("../../core/component").registerComponent,A=_("../../utils/"),E=A.bind,w=_("../../constants/"),h="a-modal",v="a-dialog",d="a-dialog-text",m="a-dialog-text-container",f="a-dialog-buttons-container",b="a-dialog-button",g="a-dialog-allow-button",y="a-dialog-deny-button",x="a-dialog-ok-button";G.exports.Component=u("device-orientation-permission-ui",{schema:{enabled:{default:!0},deviceMotionMessage:{default:"This immersive website requires access to your device motion sensors."},mobileDesktopMessage:{default:"Set your browser to request the mobile version of the site and reload the page to enjoy immersive mode."},httpsMessage:{default:"Access this site over HTTPS to enter VR mode and grant access to the device sensors."},denyButtonText:{default:"Deny"},allowButtonText:{default:"Allow"},cancelButtonText:{default:"Cancel"}},init:function(){var D=this;if(!!this.data.enabled){if(location.hostname!=="localhost"&&location.hostname!=="127.0.0.1"&&location.protocol==="http:"&&this.showHTTPAlert(),A.device.isMobileDeviceRequestingDesktopSite()){this.showMobileDesktopModeAlert();return}if(typeof DeviceOrientationEvent=="undefined"||!DeviceOrientationEvent.requestPermission){this.permissionGranted=!0;return}this.onDeviceMotionDialogAllowClicked=E(this.onDeviceMotionDialogAllowClicked,this),this.onDeviceMotionDialogDenyClicked=E(this.onDeviceMotionDialogDenyClicked,this),DeviceOrientationEvent.requestPermission().catch(function(){D.devicePermissionDialogEl=L(D.data.denyButtonText,D.data.allowButtonText,D.data.deviceMotionMessage,D.onDeviceMotionDialogAllowClicked,D.onDeviceMotionDialogDenyClicked),D.el.appendChild(D.devicePermissionDialogEl)}).then(function(){D.el.emit("deviceorientationpermissiongranted"),D.permissionGranted=!0})}},remove:function(){this.devicePermissionDialogEl&&this.el.removeChild(this.devicePermissionDialogEl)},onDeviceMotionDialogDenyClicked:function(){this.remove()},showMobileDesktopModeAlert:function(){var D=this,N=M(D.data.cancelButtonText,D.data.mobileDesktopMessage,function(){D.el.removeChild(N)});this.el.appendChild(N)},showHTTPAlert:function(){var D=this,N=M(D.data.cancelButtonText,D.data.httpsMessage,function(){D.el.removeChild(N)});this.el.appendChild(N)},onDeviceMotionDialogAllowClicked:function(){var D=this;this.el.emit("deviceorientationpermissionrequested"),DeviceOrientationEvent.requestPermission().then(function(N){N==="granted"?(D.el.emit("deviceorientationpermissiongranted"),D.permissionGranted=!0):D.el.emit("deviceorientationpermissionrejected"),D.remove()}).catch(console.error)}});function L(D,N,z,re,Y){var te,J,le;return te=document.createElement("div"),te.classList.add(f),J=document.createElement("button"),J.classList.add(b,y),J.setAttribute(w.AFRAME_INJECTED,""),J.innerHTML=D,te.appendChild(J),le=document.createElement("button"),le.classList.add(b,g),le.setAttribute(w.AFRAME_INJECTED,""),le.innerHTML=N,te.appendChild(le),le.addEventListener("click",function(j){j.stopPropagation(),re()}),J.addEventListener("click",function(j){j.stopPropagation(),Y()}),R(z,te)}function M(D,N,z){var re,Y;return re=document.createElement("div"),re.classList.add(f),Y=document.createElement("button"),Y.classList.add(b,x),Y.setAttribute(w.AFRAME_INJECTED,""),Y.innerHTML=D,re.appendChild(Y),Y.addEventListener("click",function(te){te.stopPropagation(),z()}),R(N,re)}function R(D,N){var z,re,Y,te;return z=document.createElement("div"),z.classList.add(h),z.setAttribute(w.AFRAME_INJECTED,""),re=document.createElement("div"),re.className=v,re.setAttribute(w.AFRAME_INJECTED,""),z.appendChild(re),Y=document.createElement("div"),Y.classList.add(m),re.appendChild(Y),te=document.createElement("div"),te.classList.add(d),te.innerHTML=D,Y.appendChild(te),re.appendChild(N),z}},{"../../constants/":123,"../../core/component":131,"../../utils/":205}],103:[function(_,G,fe){var u=_("../../core/component").registerComponent;G.exports.Component=u("embedded",{dependencies:["vr-mode-ui"],schema:{default:!0},update:function(){var A=this.el,E=A.querySelector(".a-enter-vr");this.data===!0?(E&&E.classList.add("embedded"),A.removeFullScreenStyles()):(E&&E.classList.remove("embedded"),A.addFullScreenStyles())}})},{"../../core/component":131}],104:[function(_,G,fe){var u=_("../../core/component").registerComponent,A=_("../../lib/three"),E=_("../../utils/debug"),w=E("components:fog:warn");G.exports.Component=u("fog",{schema:{color:{type:"color",default:"#000"},density:{default:25e-5},far:{default:1e3,min:0},near:{default:1,min:0},type:{default:"linear",oneOf:["linear","exponential"]}},update:function(){var v=this.data,d=this.el,m=this.el.object3D.fog;if(!d.isScene){w("Fog component can only be applied to <a-scene>");return}if(!m||v.type!==m.name){d.object3D.fog=h(v),d.systems.material.updateMaterials();return}Object.keys(this.schema).forEach(function(f){var b=v[f];f==="color"&&(b=new A.Color(b)),m[f]=b})},remove:function(){var v=this.el.object3D.fog;!v||(v.far=0,v.near=.1)}});function h(v){var d;return v.type==="exponential"?d=new A.FogExp2(v.color,v.density):d=new A.Fog(v.color,v.near,v.far),d.name=v.type,d}},{"../../core/component":131,"../../lib/three":179,"../../utils/debug":201}],105:[function(_,G,fe){(function(u){var A=_("../../constants").AFRAME_INJECTED,E=_("../../../package"),w=_("../../core/component").registerComponent,h=_("../../utils/");function v(g){var y=g.split(".");return y[2]="x",y.join(".")}var d="https://unpkg.com/aframe-inspector@"+v(E.version)+"/dist/aframe-inspector.min.js",m=d,f="Loading Inspector",b="Error loading Inspector";G.exports.Component=w("inspector",{schema:{url:{default:m}},init:function(){this.firstPlay=!0,this.onKeydown=this.onKeydown.bind(this),this.onMessage=this.onMessage.bind(this),this.initOverlay(),window.addEventListener("keydown",this.onKeydown),window.addEventListener("message",this.onMessage)},play:function(){var g;!this.firstPlay||(g=h.getUrlParameter("inspector"),g!=="false"&&!!g&&(this.openInspector(),this.firstPlay=!1))},initOverlay:function(){var g='<span class="dots"><span>.</span><span>.</span><span>.</span></span>';this.loadingMessageEl=document.createElement("div"),this.loadingMessageEl.classList.add("a-inspector-loader"),this.loadingMessageEl.innerHTML=f+g},remove:function(){this.removeEventListeners()},onKeydown:function(g){var y=g.keyCode===73&&(g.ctrlKey&&g.altKey||g.getModifierState("AltGraph"));!y||this.openInspector()},showLoader:function(){document.body.appendChild(this.loadingMessageEl)},hideLoader:function(){document.body.removeChild(this.loadingMessageEl)},onMessage:function(g){g.data==="INJECT_AFRAME_INSPECTOR"&&this.openInspector()},openInspector:function(g){var y=this,x;if(AFRAME.INSPECTOR||AFRAME.inspectorInjected){AFRAME.INSPECTOR.open(g);return}this.showLoader(),x=document.createElement("script"),x.src=this.data.url,x.setAttribute("data-name","aframe-inspector"),x.setAttribute(A,""),x.onload=function(){AFRAME.INSPECTOR.open(g),y.hideLoader(),y.removeEventListeners()},x.onerror=function(){y.loadingMessageEl.innerHTML=b},document.head.appendChild(x),AFRAME.inspectorInjected=!0},removeEventListeners:function(){window.removeEventListener("keydown",this.onKeydown),window.removeEventListener("message",this.onMessage)}})}).call(this,_("_process"))},{"../../../package":73,"../../constants":123,"../../core/component":131,"../../utils/":205,_process:49}],106:[function(_,G,fe){var u=_("../../core/component").registerComponent,A=_("../../utils/").shouldCaptureKeyEvent;G.exports.Component=u("keyboard-shortcuts",{schema:{enterVR:{default:!0},exitVR:{default:!0}},init:function(){this.onKeyup=this.onKeyup.bind(this)},update:function(E){var w=this.data;this.enterVREnabled=w.enterVR},play:function(){window.addEventListener("keyup",this.onKeyup,!1)},pause:function(){window.removeEventListener("keyup",this.onKeyup)},onKeyup:function(E){var w=this.el;!A(E)||(this.enterVREnabled&&E.keyCode===70&&w.enterVR(),this.enterVREnabled&&E.keyCode===27&&w.exitVR())}})},{"../../core/component":131,"../../utils/":205}],107:[function(_,G,fe){var u=_("../../utils/debug"),A=_("../../core/component").registerComponent,E=u("components:pool:warn");G.exports.Component=A("pool",{schema:{container:{default:""},mixin:{default:""},size:{default:0},dynamic:{default:!1}},multiple:!0,initPool:function(){var w;for(this.availableEls=[],this.usedEls=[],this.data.mixin||E("No mixin provided for pool component."),this.data.container&&(this.container=document.querySelector(this.data.container),this.container||E("Container "+this.data.container+" not found.")),this.container=this.container||this.el,w=0;w<this.data.size;++w)this.createEntity()},update:function(w){var h=this.data;(w.mixin!==h.mixin||w.size!==h.size)&&this.initPool()},createEntity:function(){var w;w=document.createElement("a-entity"),w.play=this.wrapPlay(w.play),w.setAttribute("mixin",this.data.mixin),w.object3D.visible=!1,w.pause(),this.container.appendChild(w),this.availableEls.push(w)},wrapPlay:function(w){var h=this.usedEls;return function(){h.indexOf(this)!==-1&&w.call(this)}},requestEntity:function(){var w;if(this.availableEls.length===0){if(this.data.dynamic===!1){E("Requested entity from empty pool: "+this.attrName);return}else E("Requested entity from empty pool. This pool is dynamic and will resize automatically. You might want to increase its initial size: "+this.attrName);this.createEntity()}return w=this.availableEls.shift(),this.usedEls.push(w),w.object3D.visible=!0,w},returnEntity:function(w){var h=this.usedEls.indexOf(w);if(h===-1){E("The returned entity was not previously pooled from "+this.attrName);return}return this.usedEls.splice(h,1),this.availableEls.push(w),w.object3D.visible=!1,w.pause(),w}})},{"../../core/component":131,"../../utils/debug":201}],108:[function(_,G,fe){var u=_("../../core/component").registerComponent,A=_("../../lib/three"),E=["attribute vec3 position;","attribute vec2 uv;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main()  {","  vUv = vec2( 1.- uv.x, uv.y );","  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),w=["precision mediump float;","uniform samplerCube map;","varying vec2 vUv;","#define M_PI 3.141592653589793238462643383279","void main() {","  vec2 uv = vUv;","  float longitude = uv.x * 2. * M_PI - M_PI + M_PI / 2.;","  float latitude = uv.y * M_PI;","  vec3 dir = vec3(","    - sin( longitude ) * sin( latitude ),","    cos( latitude ),","    - cos( longitude ) * sin( latitude )","  );","  normalize( dir );","  gl_FragColor = vec4( textureCube( map, dir ).rgb, 1.0 );","}"].join(`
`);G.exports.Component=u("screenshot",{schema:{width:{default:4096},height:{default:2048},camera:{type:"selector"}},init:function(){var h=this.el,v=this;h.renderer?d():h.addEventListener("render-target-loaded",d);function d(){var m=h.renderer.getContext();!m||(v.cubeMapSize=m.getParameter(m.MAX_CUBE_MAP_TEXTURE_SIZE),v.material=new A.RawShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:E,fragmentShader:w,side:A.DoubleSide}),v.quad=new A.Mesh(new A.PlaneBufferGeometry(1,1),v.material),v.quad.visible=!1,v.camera=new A.OrthographicCamera(-1/2,1/2,1/2,-1/2,-1e4,1e4),v.canvas=document.createElement("canvas"),v.ctx=v.canvas.getContext("2d"),h.object3D.add(v.quad),v.onKeyDown=v.onKeyDown.bind(v))}},getRenderTarget:function(h,v){return new A.WebGLRenderTarget(h,v,{minFilter:A.LinearFilter,magFilter:A.LinearFilter,wrapS:A.ClampToEdgeWrapping,wrapT:A.ClampToEdgeWrapping,format:A.RGBAFormat,type:A.UnsignedByteType})},resize:function(h,v){this.quad.scale.set(h,v,1),this.camera.left=-1*h/2,this.camera.right=h/2,this.camera.top=v/2,this.camera.bottom=-1*v/2,this.camera.updateProjectionMatrix(),this.canvas.width=h,this.canvas.height=v},play:function(){window.addEventListener("keydown",this.onKeyDown)},onKeyDown:function(h){var v=h.keyCode===83&&h.ctrlKey&&h.altKey;if(!(!this.data||!v)){var d=h.shiftKey?"equirectangular":"perspective";this.capture(d)}},setCapture:function(h){var v=this.el,d,m,f,b;return h==="perspective"?(this.quad.visible=!1,m=this.data.camera&&this.data.camera.components.camera.camera||v.camera,d={width:this.data.width,height:this.data.height}):(m=this.camera,b=new A.WebGLCubeRenderTarget(Math.min(this.cubeMapSize,2048),{format:A.RGBFormat,generateMipmaps:!0,minFilter:A.LinearMipmapLinearFilter,encoding:A.sRGBEncoding}),f=new A.CubeCamera(v.camera.near,v.camera.far,b),v.camera.getWorldPosition(f.position),v.camera.getWorldQuaternion(f.quaternion),f.update(v.renderer,v.object3D),this.quad.material.uniforms.map.value=f.renderTarget.texture,d={width:this.data.width,height:this.data.height},this.quad.visible=!0),{camera:m,size:d,projection:h}},capture:function(h){var v=this.el.renderer.xr.enabled,d=this.el.renderer,m;d.xr.enabled=!1,m=this.setCapture(h),this.renderCapture(m.camera,m.size,m.projection),this.saveCapture(),d.xr.enabled=v},getCanvas:function(h){var v=this.el.renderer.xr.enabled,d=this.el.renderer,m=this.setCapture(h);return d.xr.enabled=!1,this.renderCapture(m.camera,m.size,m.projection),d.xr.enabled=v,this.canvas},renderCapture:function(h,v,d){var m=this.el.renderer.autoClear,f=this.el,b,g,y,x=f.renderer;g=this.getRenderTarget(v.width,v.height),y=new Uint8Array(4*v.width*v.height),this.resize(v.width,v.height),x.autoClear=!0,x.clear(),x.setRenderTarget(g),x.render(f.object3D,h),x.autoClear=m,x.readRenderTargetPixels(g,0,0,v.width,v.height,y),x.setRenderTarget(null),d==="perspective"&&(y=this.flipPixelsVertically(y,v.width,v.height)),b=new ImageData(new Uint8ClampedArray(y),v.width,v.height),this.quad.visible=!1,this.ctx.putImageData(b,0,0)},flipPixelsVertically:function(h,v,d){for(var m=h.slice(0),f=0;f<v;++f)for(var b=0;b<d;++b)m[f*4+b*v*4]=h[f*4+(d-b)*v*4],m[f*4+1+b*v*4]=h[f*4+1+(d-b)*v*4],m[f*4+2+b*v*4]=h[f*4+2+(d-b)*v*4],m[f*4+3+b*v*4]=h[f*4+3+(d-b)*v*4];return m},saveCapture:function(){this.canvas.toBlob(function(h){var v="screenshot-"+document.title.toLowerCase()+"-"+Date.now()+".png",d=document.createElement("a"),m=URL.createObjectURL(h);d.href=m,d.setAttribute("download",v),d.innerHTML="downloading...",d.style.display="none",document.body.appendChild(d),setTimeout(function(){d.click(),document.body.removeChild(d)},1)},"image/png")}})},{"../../core/component":131,"../../lib/three":179}],109:[function(_,G,fe){var u=_("../../core/component").registerComponent,A=_("../../../vendor/rStats"),E=_("../../utils");_("../../../vendor/rStats.extras"),_("../../lib/rStatsAframe");var w=window.aframeStats,h=E.bind,v="a-hidden",d=window.threeStats;G.exports.Component=u("stats",{schema:{default:!0},init:function(){var f=this.el;E.getUrlParameter("stats")!=="false"&&(this.stats=m(f),this.statsEl=document.querySelector(".rs-base"),this.hideBound=h(this.hide,this),this.showBound=h(this.show,this),f.addEventListener("enter-vr",this.hideBound),f.addEventListener("exit-vr",this.showBound))},update:function(){if(!!this.stats)return this.data?this.show():this.hide()},remove:function(){this.el.removeEventListener("enter-vr",this.hideBound),this.el.removeEventListener("exit-vr",this.showBound),!!this.statsEl&&this.statsEl.parentNode.removeChild(this.statsEl)},tick:function(){var f=this.stats;!f||(f("rAF").tick(),f("FPS").frame(),f().update())},hide:function(){this.statsEl.classList.add(v)},show:function(){this.statsEl.classList.remove(v)}});function m(f){var b=new d(f.renderer),g=new w(f),y=f.isMobile?[]:[b,g];return new A({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:y})}},{"../../../vendor/rStats":217,"../../../vendor/rStats.extras":216,"../../core/component":131,"../../lib/rStatsAframe":178,"../../utils":205}],110:[function(_,G,fe){var u=_("../../core/component").registerComponent,A=_("../../constants/"),E=_("../../utils/"),w=E.bind,h="a-enter-vr",v="a-enter-ar",d="a-enter-vr-button",m="a-enter-ar-button",f="a-hidden",b="a-orientation-modal";G.exports.Component=u("vr-mode-ui",{dependencies:["canvas"],schema:{enabled:{default:!0},enterVRButton:{default:""},enterARButton:{default:""}},init:function(){var M=this,R=this.el;E.getUrlParameter("ui")!=="false"&&(this.insideLoader=!1,this.enterVREl=null,this.enterAREl=null,this.orientationModalEl=null,this.bindMethods(),R.addEventListener("enter-vr",this.updateEnterInterfaces),R.addEventListener("exit-vr",this.updateEnterInterfaces),R.addEventListener("update-vr-devices",this.updateEnterInterfaces),window.addEventListener("message",function(D){D.data.type==="loaderReady"&&(M.insideLoader=!0,M.remove())}),window.addEventListener("orientationchange",this.toggleOrientationModalIfNeeded))},bindMethods:function(){this.onEnterVRButtonClick=w(this.onEnterVRButtonClick,this),this.onEnterARButtonClick=w(this.onEnterARButtonClick,this),this.onModalClick=w(this.onModalClick,this),this.toggleOrientationModalIfNeeded=w(this.toggleOrientationModalIfNeeded,this),this.updateEnterInterfaces=w(this.updateEnterInterfaces,this)},onModalClick:function(){this.el.exitVR()},onEnterVRButtonClick:function(){this.el.enterVR()},onEnterARButtonClick:function(){this.el.enterAR()},update:function(){var M=this.data,R=this.el;if(!M.enabled||this.insideLoader||E.getUrlParameter("ui")==="false")return this.remove();this.enterVREl||this.enterAREl||this.orientationModalEl||(M.enterVRButton?(this.enterVREl=document.querySelector(M.enterVRButton),this.enterVREl.addEventListener("click",this.onEnterVRButtonClick)):(this.enterVREl=g(this.onEnterVRButtonClick),R.appendChild(this.enterVREl)),M.enterARButton?(this.enterAREl=document.querySelector(M.enterARButton),this.enterAREl.addEventListener("click",this.onEnterARButtonClick)):(this.enterAREl=y(this.onEnterARButtonClick),R.appendChild(this.enterAREl)),this.orientationModalEl=x(this.onModalClick),R.appendChild(this.orientationModalEl),this.updateEnterInterfaces())},remove:function(){[this.enterVREl,this.enterAREl,this.orientationModalEl].forEach(function(M){M&&M.parentNode&&M.parentNode.removeChild(M)}),this.enterVREl=void 0,this.enterAREl=void 0,this.orientationModalEl=void 0},updateEnterInterfaces:function(){this.toggleEnterVRButtonIfNeeded(),this.toggleEnterARButtonIfNeeded(),this.toggleOrientationModalIfNeeded()},toggleEnterVRButtonIfNeeded:function(){var M=this.el;!this.enterVREl||(M.is("vr-mode")?this.enterVREl.classList.add(f):this.enterVREl.classList.remove(f))},toggleEnterARButtonIfNeeded:function(){var M=this.el;!this.enterAREl||(M.is("vr-mode")||!E.device.checkARSupport()?this.enterAREl.classList.add(f):this.enterAREl.classList.remove(f))},toggleOrientationModalIfNeeded:function(){var M=this.el,R=this.orientationModalEl;!R||!M.isMobile||(!E.device.isLandscape()&&M.is("vr-mode")?R.classList.remove(f):R.classList.add(f))}});function g(M){var R,D;return D=document.createElement("div"),D.classList.add(h),D.setAttribute(A.AFRAME_INJECTED,""),R=document.createElement("button"),R.className=d,R.setAttribute("title","Enter VR mode with a headset or fullscreen mode on a desktop. Visit https://webvr.rocks or https://webvr.info for more information."),R.setAttribute(A.AFRAME_INJECTED,""),E.device.isMobile()&&L(R),D.appendChild(R),R.addEventListener("click",function(N){M(),N.stopPropagation()}),D}function y(M){var R,D;return D=document.createElement("div"),D.classList.add(v),D.setAttribute(A.AFRAME_INJECTED,""),R=document.createElement("button"),R.className=m,R.setAttribute("title","Enter AR mode with a headset or handheld device. Visit https://webvr.rocks or https://webvr.info for more information."),R.setAttribute(A.AFRAME_INJECTED,""),E.device.isMobile()&&L(R),D.appendChild(R),R.addEventListener("click",function(N){M(),N.stopPropagation()}),D}function x(M){var R=document.createElement("div");R.className=b,R.classList.add(f),R.setAttribute(A.AFRAME_INJECTED,"");var D=document.createElement("button");return D.setAttribute(A.AFRAME_INJECTED,""),D.innerHTML="Exit VR",D.addEventListener("click",M),R.appendChild(D),R}function L(M){M.addEventListener("touchstart",function(){M.classList.remove("resethover")}),M.addEventListener("touchend",function(){M.classList.add("resethover")})}},{"../../constants/":123,"../../core/component":131,"../../utils/":205}],111:[function(_,G,fe){var u=_("../core/component"),A=_("../lib/three"),E=_("../utils/bind"),w=u.registerComponent;G.exports.Component=w("shadow",{schema:{cast:{default:!0},receive:{default:!0}},init:function(){this.onMeshChanged=E(this.update,this),this.el.addEventListener("object3dset",this.onMeshChanged),this.system.setShadowMapEnabled(!0)},update:function(){var h=this.data;this.updateDescendants(h.cast,h.receive)},remove:function(){var h=this.el;h.removeEventListener("object3dset",this.onMeshChanged),this.updateDescendants(!1,!1)},updateDescendants:function(h,v){var d=this.el.sceneEl;this.el.object3D.traverse(function(m){if(m instanceof A.Mesh&&(m.castShadow=h,m.receiveShadow=v,d.hasLoaded&&m.material))for(var f=Array.isArray(m.material)?m.material:[m.material],b=0;b<f.length;b++)f[b].needsUpdate=!0})}})},{"../core/component":131,"../lib/three":179,"../utils/bind":199}],112:[function(_,G,fe){var u=_("../core/component").registerComponent,A=_("../utils/debug"),E=_("../lib/three"),w=A("components:sound:warn");G.exports.Component=u("sound",{schema:{autoplay:{default:!1},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:!1},maxDistance:{default:1e4},on:{default:""},poolSize:{default:1},positional:{default:!0},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:!0,init:function(){var h=this;this.listener=null,this.audioLoader=new E.AudioLoader,this.pool=new E.Group,this.loaded=!1,this.mustPlay=!1,this.playSoundBound=function(){h.playSound()}},update:function(h){var v=this.data,d,m,f=v.src!==h.src;if(f){if(!v.src)return;this.setupSound()}for(d=0;d<this.pool.children.length;d++)m=this.pool.children[d],v.positional&&(m.setDistanceModel(v.distanceModel),m.setMaxDistance(v.maxDistance),m.setRefDistance(v.refDistance),m.setRolloffFactor(v.rolloffFactor)),m.setLoop(v.loop),m.setVolume(v.volume),m.isPaused=!1;if(v.on!==h.on&&this.updateEventListener(h.on),f){var b=this;this.loaded=!1,this.audioLoader.load(v.src,function(g){for(d=0;d<b.pool.children.length;d++)m=b.pool.children[d],m.setBuffer(g);b.loaded=!0,E.Cache.remove(v.src),(b.data.autoplay||b.mustPlay)&&b.playSound(),b.el.emit("sound-loaded",b.evtDetail,!1)})}},pause:function(){this.stopSound(),this.removeEventListener()},play:function(){this.data.autoplay&&this.playSound(),this.updateEventListener()},remove:function(){var h,v;this.removeEventListener(),this.el.getObject3D(this.attrName)&&this.el.removeObject3D(this.attrName);try{for(h=0;h<this.pool.children.length;h++)v=this.pool.children[h],v.disconnect()}catch{w("Audio source not properly disconnected")}},updateEventListener:function(h){var v=this.el;h&&v.removeEventListener(h,this.playSoundBound),v.addEventListener(this.data.on,this.playSoundBound)},removeEventListener:function(){this.el.removeEventListener(this.data.on,this.playSoundBound)},setupSound:function(){var h=this.el,v,d=h.sceneEl,m=this,f;this.pool.children.length>0&&(this.stopSound(),h.removeObject3D("sound"));var b=this.listener=d.audioListener||new E.AudioListener;for(d.audioListener=b,d.camera&&d.camera.add(b),d.addEventListener("camera-set-active",function(g){g.detail.cameraEl.getObject3D("camera").add(b)}),this.pool=new E.Group,v=0;v<this.data.poolSize;v++)f=this.data.positional?new E.PositionalAudio(b):new E.Audio(b),this.pool.add(f);for(h.setObject3D(this.attrName,this.pool),v=0;v<this.pool.children.length;v++)f=this.pool.children[v],f.onEnded=function(){this.isPlaying=!1,m.el.emit("sound-ended",m.evtDetail,!1)}},pauseSound:function(){var h,v;for(this.isPlaying=!1,h=0;h<this.pool.children.length;h++)v=this.pool.children[h],!(!v.source||!v.source.buffer||!v.isPlaying||v.isPaused)&&(v.isPaused=!0,v.pause())},playSound:function(h){var v,d,m;if(!this.loaded){w("Sound not loaded yet. It will be played once it finished loading"),this.mustPlay=!0;return}for(v=!1,this.isPlaying=!0,d=0;d<this.pool.children.length;d++)if(m=this.pool.children[d],!m.isPlaying&&m.buffer&&!v){h&&h(m),m.play(),m.isPaused=!1,v=!0;continue}if(!v){w("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.",this.el);return}this.mustPlay=!1},stopSound:function(){var h,v;for(this.isPlaying=!1,h=0;h<this.pool.children.length;h++){if(v=this.pool.children[h],!v.source||!v.source.buffer)return;v.stop()}}})},{"../core/component":131,"../lib/three":179,"../utils/debug":201}],113:[function(_,G,fe){var u=_("three-bmfont-text"),A=_("load-bmfont"),E=_("../core/component").registerComponent,w=_("../core/shader"),h=_("../lib/three"),v=_("../utils/"),d=v.debug("components:text:error"),m=w.shaders,f=v.debug("components:text:warn"),b=1,g=16,y="https://cdn.aframe.io/fonts/",x={aileronsemibold:y+"Aileron-Semibold.fnt",dejavu:y+"DejaVu-sdf.fnt",exo2bold:y+"Exo2Bold.fnt",exo2semibold:y+"Exo2SemiBold.fnt",kelsonsans:y+"KelsonSans.fnt",monoid:y+"Monoid.fnt",mozillavr:y+"mozillavr.fnt",roboto:y+"Roboto-msdf.json",sourcecodepro:y+"SourceCodePro.fnt"},L=["roboto"],M="roboto";G.exports.FONTS=x;var R=new ae,D={},N={},z=/^\w+:/;G.exports.Component=E("text",{multiple:!0,schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},alphaTest:{default:.5},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string",default:M},fontImage:{type:"string"},height:{type:"number"},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},negate:{type:"boolean",default:!0},opacity:{type:"number",default:1},shader:{default:"sdf",oneOf:m},side:{default:"front",oneOf:["front","back","double"]},tabSize:{default:4},transparent:{default:!0},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","pre","nowrap"]},width:{type:"number"},wrapCount:{type:"number",default:40},wrapPixels:{type:"number"},xOffset:{type:"number",default:0},yOffset:{type:"number",default:0},zOffset:{type:"number",default:.001}},init:function(){this.shaderData={},this.geometry=u(),this.createOrUpdateMaterial()},update:function(Z){var ye=this.data,Ne=this.currentFont;if(N[ye.font]?this.texture=N[ye.font]:(this.texture=N[ye.font]=new h.Texture,this.texture.anisotropy=g),this.createOrUpdateMaterial(),Z.font!==ye.font){this.updateFont();return}Ne&&(this.updateGeometry(this.geometry,Ne),this.updateLayout())},remove:function(){this.geometry.dispose(),this.geometry=null,this.el.removeObject3D(this.attrName),this.material.dispose(),this.material=null,this.texture.dispose(),this.texture=null,this.shaderObject&&delete this.shaderObject},createOrUpdateMaterial:function(){var Z=this.data,ye,Ne=this.material,We,ke=this.shaderData,it;if(it=Z.shader,L.indexOf(Z.font)!==-1||Z.font.indexOf("-msdf.")>=0?it="msdf":Z.font in x&&L.indexOf(Z.font)===-1&&(it="sdf"),ye=(this.shaderObject&&this.shaderObject.name)!==it,ke.alphaTest=Z.alphaTest,ke.color=Z.color,ke.map=this.texture,ke.opacity=Z.opacity,ke.side=re(Z.side),ke.transparent=Z.transparent,ke.negate=Z.negate,!ye){this.shaderObject.update(ke),Ne.transparent=ke.transparent,Ne.side=ke.side;return}We=J(this.el,it,ke),this.material=We.material,this.shaderObject=We.shader,this.material.side=ke.side,this.mesh&&(this.mesh.material=this.material)},updateFont:function(){var Z=this.data,ye=this.el,Ne,We=this.geometry,ke=this;Z.font||f("No font specified. Using the default font."),this.mesh&&(this.mesh.visible=!1),Ne=this.lookupFont(Z.font||M)||Z.font,R.get(Ne,function(){return Y(Ne,Z.yOffset)}).then(function(rt){var At;if(rt.pages.length!==1)throw new Error("Currently only single-page bitmap fonts are supported.");D[Ne]||(rt.widthFactor=D[rt]=j(rt)),ke.currentFont=rt,At=ke.getFontImageSrc(),R.get(At,function(){return te(At)}).then(function(St){var Gt=ke.texture;Gt.image=St,Gt.needsUpdate=!0,N[Z.font]=Gt,ke.texture=Gt,ke.initMesh(),ke.currentFont=rt,ke.updateGeometry(We,rt),ke.updateLayout(),ke.mesh.visible=!0,ye.emit("textfontset",{font:Z.font,fontObj:rt})}).catch(function(St){d(St.message),d(St.stack)})}).catch(function(it){d(it.message),d(it.stack)})},initMesh:function(){this.mesh||(this.mesh=new h.Mesh(this.geometry,this.material),this.el.setObject3D(this.attrName,this.mesh))},getFontImageSrc:function(){if(this.data.fontImage)return this.data.fontImage;var Z=this.lookupFont(this.data.font||M)||this.data.font,ye=this.currentFont.pages[0];return ye.match(z)&&ye.indexOf("http")!==0?Z.replace(/(\.fnt)|(\.json)/,".png"):h.LoaderUtils.extractUrlBase(Z)+ye},updateLayout:function(){var Z,ye,Ne=this.el,We=this.data,ke=this.geometry,it,rt,At,St=this.mesh,Gt,er,zt,wt,kr;if(!(!St||!ke.layout)){if(it=Ne.getAttribute("geometry"),zt=We.width||it&&it.width||b,Gt=le(We.wrapPixels,We.wrapCount,this.currentFont.widthFactor),er=zt/Gt,At=ke.layout,rt=er*(At.height+At.descender),it&&it.primitive==="plane"&&(it.width||Ne.setAttribute("geometry","width",zt),it.height||Ne.setAttribute("geometry","height",rt)),Z=We.anchor==="align"?We.align:We.anchor,Z==="left")wt=0;else if(Z==="right")wt=-1*At.width;else if(Z==="center")wt=-1*At.width/2;else throw new TypeError("Invalid text.anchor property value",Z);if(ye=We.baseline,ye==="bottom")kr=0;else if(ye==="top")kr=-1*At.height+At.ascender;else if(ye==="center")kr=-1*At.height/2;else throw new TypeError("Invalid text.baseline property value",ye);St.position.x=wt*er+We.xOffset,St.position.y=kr*er,St.position.z=We.zOffset,St.scale.set(er,-1*er,er)}},lookupFont:function(Z){return x[Z]},updateGeometry:function(){var Z={},ye={},Ne=/\\n/g,We=/\\t/g;return function(ke,it){var rt=this.data;ye.font=it,ye.lineHeight=rt.lineHeight&&isFinite(rt.lineHeight)?rt.lineHeight:it.common.lineHeight,ye.text=rt.value.toString().replace(Ne,`
`).replace(We,"	"),ye.width=le(rt.wrapPixels,rt.wrapCount,it.widthFactor),ke.update(v.extend(Z,rt,ye))}}()});function re(Z){switch(Z){case"back":return h.FrontSide;case"double":return h.DoubleSide;default:return h.BackSide}}function Y(Z,ye){return new Promise(function(Ne,We){A(Z,function(ke,it){if(ke){d("Error loading font",Z),We(ke);return}Z.indexOf("/Roboto-msdf.json")>=0&&(ye=30),ye&&it.chars.map(function(At){At.yoffset+=ye}),Ne(it)})})}function te(Z){return new Promise(function(ye,Ne){new h.ImageLoader().load(Z,function(We){ye(We)},void 0,function(){d("Error loading font image",Z),Ne(null)})})}function J(Z,ye,Ne){var We,ke;return ke=new m[ye].Shader,ke.el=Z,ke.init(Ne),ke.update(Ne),We=ke.material,We.transparent=Ne.transparent,{material:We,shader:ke}}function le(Z,ye,Ne){return Z||(.5+ye)*Ne}function j(Z){var ye=0,Ne=0,We=0;return Z.chars.map(function(ke){ye+=ke.xadvance,ke.id>=48&&ke.id<=57&&(We++,Ne+=ke.xadvance)}),We?Ne/We:ye/Z.chars.length}function ae(){var Z=this.cache={};this.get=function(ye,Ne){return ye in Z||(Z[ye]=Ne()),Z[ye]}}},{"../core/component":131,"../core/shader":141,"../lib/three":179,"../utils/":205,"load-bmfont":37,"three-bmfont-text":63}],114:[function(_,G,fe){var u=_("../core/component").registerComponent,A=_("../utils/tracked-controls"),E=_("../constants").DEFAULT_CAMERA_HEIGHT,w=_("../lib/three"),h=_("../constants").DEFAULT_HANDEDNESS,v={x:.175,y:-.3,z:-.03},d={x:0,y:0,z:-.175},m={touches:[]},f={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};G.exports.Component=u("tracked-controls-webvr",{schema:{autoHide:{default:!0},controller:{default:0},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"}},init:function(){this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.changedAxes=[],this.targetControllerNumber=this.data.controller,this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes},this.deltaControllerPosition=new w.Vector3,this.controllerQuaternion=new w.Quaternion,this.controllerEuler=new w.Euler,this.updateGamepad(),this.buttonEventDetails={}},tick:function(b,g){var y=this.el.getObject3D("mesh");y&&y.update&&y.update(g/1e3),this.updateGamepad(),this.updatePose(),this.updateButtons()},defaultUserHeight:function(){return E},getHeadElement:function(){return this.data.headElement||this.el.sceneEl.camera.el},updateGamepad:function(){var b=this.data,g=A.findMatchingControllerWebVR(this.system.controllers,b.id,b.idPrefix,b.hand,b.controller);this.controller=g,this.el.components["tracked-controls"].controller=g,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},applyArmModel:function(b){var g=this.controller,y=this.controllerEuler,x=this.controllerQuaternion,L=this.deltaControllerPosition,M,R,D,N,z;R=this.getHeadElement(),D=R.object3D,z=this.defaultUserHeight(),N=g.pose,M=(g?g.hand:void 0)||h,b.copy(D.position),L.set(v.x*(M==="left"?-1:M==="right"?1:0),v.y,v.z),L.multiplyScalar(z),L.applyAxisAngle(D.up,D.rotation.y),b.add(L),L.set(d.x,d.y,d.z),L.multiplyScalar(z),N.orientation?x.fromArray(N.orientation):x.copy(D.quaternion),y.setFromQuaternion(x),y.set(y.x,y.y,0),L.applyEuler(y),b.add(L)},updatePose:function(){var b=this.controller,g=this.data,y=this.el.object3D,x,L=this.system.vrDisplay,M;!b||(x=b.pose,x.position?y.position.fromArray(x.position):g.armModel&&this.applyArmModel(y.position),x.orientation&&y.quaternion.fromArray(x.orientation),L&&x.position&&(M=this.el.sceneEl.renderer.xr.getStandingMatrix(),y.matrix.compose(y.position,y.quaternion,y.scale),y.matrix.multiplyMatrices(M,y.matrix),y.matrix.decompose(y.position,y.quaternion,y.scale)),y.rotateX(this.data.orientationOffset.x*w.Math.DEG2RAD),y.rotateY(this.data.orientationOffset.y*w.Math.DEG2RAD),y.rotateZ(this.data.orientationOffset.z*w.Math.DEG2RAD))},updateButtons:function(){var b,g=this.controller,y;if(!!g){for(y=0;y<g.buttons.length;++y)this.buttonStates[y]||(this.buttonStates[y]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[y]||(this.buttonEventDetails[y]={id:y,state:this.buttonStates[y]}),b=g.buttons[y],this.handleButton(y,b);this.handleAxes()}},handleButton:function(b,g){var y;return y=this.handlePress(b,g)|this.handleTouch(b,g)|this.handleValue(b,g),y?(this.el.emit(f.BUTTONCHANGED,this.buttonEventDetails[b],!1),!0):!1},handleAxes:function(){var b=!1,g=this.controller.axes,y,x=this.axis,L=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),y=0;y<g.length;++y)L.push(x[y]!==g[y]),L[y]&&(b=!0);if(!b)return!1;for(this.axis.splice(0,this.axis.length),y=0;y<g.length;y++)this.axis.push(g[y]);return this.el.emit(f.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(b,g){var y,x=this.buttonStates[b];return g.pressed===x.pressed?!1:(y=g.pressed?f.BUTTONDOWN:f.BUTTONUP,this.el.emit(y,this.buttonEventDetails[b],!1),x.pressed=g.pressed,!0)},handleTouch:function(b,g){var y,x=this.buttonStates[b];return g.touched===x.touched?!1:(y=g.touched?f.TOUCHSTART:f.TOUCHEND,this.el.emit(y,this.buttonEventDetails[b],!1,m),x.touched=g.touched,!0)},handleValue:function(b,g){var y=this.buttonStates[b];return g.value===y.value?!1:(y.value=g.value,!0)}})},{"../constants":123,"../core/component":131,"../lib/three":179,"../utils/tracked-controls":214}],115:[function(_,G,fe){var u=_("../utils/tracked-controls"),A=_("../core/component").registerComponent,E={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};G.exports.Component=A("tracked-controls-webxr",{schema:{id:{type:"string",default:""},hand:{type:"string",default:""},handTrackingEnabled:{default:!1},index:{type:"int",default:-1},iterateControllerProfiles:{default:!1}},init:function(){this.updateController=this.updateController.bind(this),this.buttonEventDetails={},this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.changedAxes=[],this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes}},update:function(){this.updateController()},play:function(){var w=this.el.sceneEl;this.updateController(),w.addEventListener("controllersupdated",this.updateController)},pause:function(){var w=this.el.sceneEl;w.removeEventListener("controllersupdated",this.updateController)},isControllerPresent:function(w){return!(!this.controller||this.controller.gamepad||w.inputSource.handedness!=="none"&&w.inputSource.handedness!==this.data.hand)},updateController:function(){this.controller=u.findMatchingControllerWebXR(this.system.controllers,this.data.id,this.data.hand,this.data.index,this.data.iterateControllerProfiles,this.data.handTrackingEnabled),this.el.components["tracked-controls"].controller=this.controller,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},tick:function(){var w=this.el.sceneEl,h=this.controller,v=w.frame;!h||!w.frame||!this.system.referenceSpace||h.hand||(this.pose=v.getPose(h.targetRaySpace,this.system.referenceSpace),this.updatePose(),this.updateButtons())},updatePose:function(){var w=this.el.object3D,h=this.pose;!h||(w.matrix.elements=h.transform.matrix,w.matrix.decompose(w.position,w.rotation,w.scale))},updateButtons:function(){var w,h,v=this.controller,d;if(!(!v||!v.gamepad)){for(d=v.gamepad,h=0;h<d.buttons.length;++h)this.buttonStates[h]||(this.buttonStates[h]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[h]||(this.buttonEventDetails[h]={id:h,state:this.buttonStates[h]}),w=d.buttons[h],this.handleButton(h,w);this.handleAxes()}},handleButton:function(w,h){var v;return v=this.handlePress(w,h)|this.handleTouch(w,h)|this.handleValue(w,h),v?(this.el.emit(E.BUTTONCHANGED,this.buttonEventDetails[w],!1),!0):!1},handleAxes:function(){var w=!1,h=this.controller.gamepad.axes,v,d=this.axis,m=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),v=0;v<h.length;++v)m.push(d[v]!==h[v]),m[v]&&(w=!0);if(!w)return!1;for(this.axis.splice(0,this.axis.length),v=0;v<h.length;v++)this.axis.push(h[v]);return this.el.emit(E.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(w,h){var v,d=this.buttonStates[w];return h.pressed===d.pressed?!1:(v=h.pressed?E.BUTTONDOWN:E.BUTTONUP,this.el.emit(v,this.buttonEventDetails[w],!1),d.pressed=h.pressed,!0)},handleTouch:function(w,h){var v,d=this.buttonStates[w];return h.touched===d.touched?!1:(v=h.touched?E.TOUCHSTART:E.TOUCHEND,this.el.emit(v,this.buttonEventDetails[w],!1),d.touched=h.touched,!0)},handleValue:function(w,h){var v=this.buttonStates[w];return h.value===v.value?!1:(v.value=h.value,!0)}})},{"../core/component":131,"../utils/tracked-controls":214}],116:[function(_,G,fe){var u=_("../core/component").registerComponent;G.exports.Component=u("tracked-controls",{schema:{autoHide:{default:!0},controller:{default:-1},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},handTrackingEnabled:{default:!1},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"},iterateControllerProfiles:{default:!1}},update:function(){var A=this.data,E=this.el;E.sceneEl.hasWebXR?E.setAttribute("tracked-controls-webxr",{id:A.id,hand:A.hand,index:A.controller,iterateControllerProfiles:A.iterateControllerProfiles,handTrackingEnabled:A.handTrackingEnabled}):E.setAttribute("tracked-controls-webvr",A)}})},{"../core/component":131}],117:[function(_,G,fe){var u=_("../core/component").registerComponent,A=_("../utils/bind"),E=_("../lib/three"),w=_("../utils/tracked-controls"),h=w.checkControllerPresentAndSetup,v=w.emitIfAxesChanged,d=w.onButtonEvent,m="https://cdn.aframe.io/controllers/valve/index/valve-index-",f={left:m+"left.glb",right:m+"right.glb"},b="valve",g=_("../utils/").device.isWebXRAvailable,y={left:{x:-.00023692678902063457,y:.04724540367838371,z:-.061959880395271096},right:{x:.002471558599671131,y:.055765208987076195,z:-.061068168708348844}},x={left:{x:0,y:-.05,z:.06},right:{x:0,y:-.05,z:.06}},L={left:{_x:.692295102620542,_y:-.0627618864318427,_z:-.06265893149611756,_order:"XYZ"},right:{_x:.6484021229942998,_y:-.032563619881892894,_z:-.1327973171917482,_order:"XYZ"}},M={left:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"},right:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"}},R=g?M:L,D=g?x:y;G.exports.Component=u("valve-index-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:{axes:{trackpad:[0,1],thumbstick:[2,3]},buttons:["trigger","grip","trackpad","thumbstick","abutton"]},init:function(){var N=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=A(this.onButtonChanged,this),this.onButtonDown=function(z){d(z.detail.id,"down",N)},this.onButtonUp=function(z){d(z.detail.id,"up",N)},this.onButtonTouchEnd=function(z){d(z.detail.id,"touchend",N)},this.onButtonTouchStart=function(z){d(z.detail.id,"touchstart",N)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=A(this.onModelLoaded,this),this.onControllersUpdate=A(this.onControllersUpdate,this),this.checkIfControllerPresent=A(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=A(this.removeControllersUpdateListener,this),this.onAxisMoved=A(this.onAxisMoved,this)},addEventListeners:function(){var N=this.el;N.addEventListener("buttonchanged",this.onButtonChanged),N.addEventListener("buttondown",this.onButtonDown),N.addEventListener("buttonup",this.onButtonUp),N.addEventListener("touchend",this.onButtonTouchEnd),N.addEventListener("touchstart",this.onButtonTouchStart),N.addEventListener("model-loaded",this.onModelLoaded),N.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var N=this.el;N.removeEventListener("buttonchanged",this.onButtonChanged),N.removeEventListener("buttondown",this.onButtonDown),N.removeEventListener("buttonup",this.onButtonUp),N.removeEventListener("touchend",this.onButtonTouchEnd),N.removeEventListener("touchstart",this.onButtonTouchStart),N.removeEventListener("model-loaded",this.onModelLoaded),N.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var N=this.data,z=N.hand==="right"?0:N.hand==="left"?1:2;h(this,b,{index:z,iterateControllerProfiles:!0,hand:N.hand})},injectTrackedControls:function(){var N=this.el,z=this.data;N.setAttribute("tracked-controls",{idPrefix:b,controller:z.hand==="right"?1:z.hand==="left"?0:2,hand:z.hand,orientationOffset:z.orientationOffset}),this.loadModel()},loadModel:function(){var N=this.data;!N.model||this.el.setAttribute("gltf-model",""+f[N.hand]+"")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(N){var z=this.mapping.buttons[N.detail.id],re=this.buttonMeshes,Y;!z||(z==="trigger"&&(Y=N.detail.state.value,re&&re.trigger&&(re.trigger.rotation.x=this.triggerOriginalRotationX-Y*(Math.PI/40))),this.el.emit(z+"changed",N.detail.state))},onModelLoaded:function(N){var z,re=N.detail.model,Y=this;!this.data.model||(z=this.buttonMeshes={},z.grip={left:re.getObjectByName("leftgrip"),right:re.getObjectByName("rightgrip")},z.menu=re.getObjectByName("menubutton"),z.system=re.getObjectByName("systembutton"),z.trackpad=re.getObjectByName("touchpad"),z.trigger=re.getObjectByName("trigger"),this.triggerOriginalRotationX=z.trigger.rotation.x,Object.keys(z).forEach(function(te){Y.setButtonColor(te,Y.data.buttonColor)}),re.position.copy(D[this.data.hand]),re.rotation.copy(R[this.data.hand]),this.el.emit("controllermodelready",{name:"valve-index-controlls",model:this.data.model,rayOrigin:new E.Vector3(0,0,0)}))},onAxisMoved:function(N){v(this,this.mapping.axes,N)},updateModel:function(N,z){var re,Y;!this.data.model||(Y=z.indexOf("touch")!==-1,!Y&&(re=z==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(N,re)))},setButtonColor:function(N,z){}})},{"../core/component":131,"../lib/three":179,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],118:[function(_,G,fe){var u=_("../core/component").registerComponent;G.exports.Component=u("visible",{schema:{default:!0},update:function(){this.el.object3D.visible=this.data}})},{"../core/component":131}],119:[function(_,G,fe){var u=_("../core/component").registerComponent,A=_("../utils/bind"),E=_("../utils/tracked-controls"),w=E.checkControllerPresentAndSetup,h=E.emitIfAxesChanged,v=E.onButtonEvent,d="https://cdn.aframe.io/controllers/vive/vr_controller_vive.obj",m="https://cdn.aframe.io/controllers/vive/vr_controller_vive.mtl",f=_("../utils/").device.isWebXRAvailable,b="htc-vive-controller-mv",g="OpenVR ",y=f?b:g,x={axes:{trackpad:[0,1]},buttons:["trackpad","trigger","grip","menu","system"]},L={axes:{thumbstick:[0,1]},buttons:["trigger","grip","trackpad","none","menu"]},M=f?L:x;G.exports.Component=u("vive-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:M,init:function(){var R=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=A(this.onButtonChanged,this),this.onButtonDown=function(D){v(D.detail.id,"down",R)},this.onButtonUp=function(D){v(D.detail.id,"up",R)},this.onButtonTouchEnd=function(D){v(D.detail.id,"touchend",R)},this.onButtonTouchStart=function(D){v(D.detail.id,"touchstart",R)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},update:function(){var R=this.data;this.controllerIndex=R.hand==="right"?0:R.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=A(this.onModelLoaded,this),this.onControllersUpdate=A(this.onControllersUpdate,this),this.checkIfControllerPresent=A(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=A(this.removeControllersUpdateListener,this),this.onAxisMoved=A(this.onAxisMoved,this)},addEventListeners:function(){var R=this.el;R.addEventListener("buttonchanged",this.onButtonChanged),R.addEventListener("buttondown",this.onButtonDown),R.addEventListener("buttonup",this.onButtonUp),R.addEventListener("touchend",this.onButtonTouchEnd),R.addEventListener("touchstart",this.onButtonTouchStart),R.addEventListener("model-loaded",this.onModelLoaded),R.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var R=this.el;R.removeEventListener("buttonchanged",this.onButtonChanged),R.removeEventListener("buttondown",this.onButtonDown),R.removeEventListener("buttonup",this.onButtonUp),R.removeEventListener("touchend",this.onButtonTouchEnd),R.removeEventListener("touchstart",this.onButtonTouchStart),R.removeEventListener("model-loaded",this.onModelLoaded),R.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var R=this.data;w(this,y,{index:this.controllerIndex,hand:R.hand})},injectTrackedControls:function(){var R=this.el,D=this.data;R.setAttribute("tracked-controls",{idPrefix:y,hand:D.hand,controller:this.controllerIndex,orientationOffset:D.orientationOffset}),!!this.data.model&&this.el.setAttribute("obj-model",{obj:d,mtl:m})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(R){var D=this.mapping.buttons[R.detail.id],N=this.buttonMeshes,z;!D||(D==="trigger"&&(z=R.detail.state.value,N&&N.trigger&&(N.trigger.rotation.x=-z*(Math.PI/12))),this.el.emit(D+"changed",R.detail.state))},onModelLoaded:function(R){var D,N=R.detail.model,z=this;!this.data.model||(D=this.buttonMeshes={},D.grip={left:N.getObjectByName("leftgrip"),right:N.getObjectByName("rightgrip")},D.menu=N.getObjectByName("menubutton"),D.system=N.getObjectByName("systembutton"),D.trackpad=N.getObjectByName("touchpad"),D.trigger=N.getObjectByName("trigger"),Object.keys(D).forEach(function(re){z.setButtonColor(re,z.data.buttonColor)}),N.position.set(0,-.015,.04))},onAxisMoved:function(R){h(this,this.mapping.axes,R)},updateModel:function(R,D){var N,z;!this.data.model||(z=D.indexOf("touch")!==-1,!z&&(N=D==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(R,N)))},setButtonColor:function(R,D){var N=this.buttonMeshes,z=this.rendererSystem;if(!!N){if(R==="grip"){N.grip.left.material.color.set(D),N.grip.right.material.color.set(D),z.applyColorCorrection(N.grip.left.material.color),z.applyColorCorrection(N.grip.right.material.color);return}N[R].material.color.set(D),z.applyColorCorrection(N[R].material.color)}}})},{"../core/component":131,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],120:[function(_,G,fe){var u=_("../core/component").registerComponent,A=_("../utils/bind"),E=_("../utils/tracked-controls"),w=E.checkControllerPresentAndSetup,h=E.emitIfAxesChanged,v=E.onButtonEvent,d="HTC Vive Focus",m="https://cdn.aframe.io/controllers/vive/focus-controller/focus-controller.gltf";G.exports.Component=u("vive-focus-controls",{schema:{hand:{default:""},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:{axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},bindMethods:function(){this.onModelLoaded=A(this.onModelLoaded,this),this.onControllersUpdate=A(this.onControllersUpdate,this),this.checkIfControllerPresent=A(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=A(this.removeControllersUpdateListener,this),this.onAxisMoved=A(this.onAxisMoved,this)},init:function(){var f=this;this.onButtonChanged=A(this.onButtonChanged,this),this.onButtonDown=function(b){v(b.detail.id,"down",f)},this.onButtonUp=function(b){v(b.detail.id,"up",f)},this.onButtonTouchStart=function(b){v(b.detail.id,"touchstart",f)},this.onButtonTouchEnd=function(b){v(b.detail.id,"touchend",f)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var f=this.el;f.addEventListener("buttonchanged",this.onButtonChanged),f.addEventListener("buttondown",this.onButtonDown),f.addEventListener("buttonup",this.onButtonUp),f.addEventListener("touchstart",this.onButtonTouchStart),f.addEventListener("touchend",this.onButtonTouchEnd),f.addEventListener("model-loaded",this.onModelLoaded),f.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0,this.addControllersUpdateListener()},removeEventListeners:function(){var f=this.el;f.removeEventListener("buttonchanged",this.onButtonChanged),f.removeEventListener("buttondown",this.onButtonDown),f.removeEventListener("buttonup",this.onButtonUp),f.removeEventListener("touchstart",this.onButtonTouchStart),f.removeEventListener("touchend",this.onButtonTouchEnd),f.removeEventListener("model-loaded",this.onModelLoaded),f.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1,this.removeControllersUpdateListener()},checkIfControllerPresent:function(){w(this,d,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var f=this.el,b=this.data;f.setAttribute("tracked-controls",{armModel:b.armModel,idPrefix:d,orientationOffset:b.orientationOffset}),!!this.data.model&&this.el.setAttribute("gltf-model",m)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(f){var b=f.detail.model,g;!this.data.model||(g=this.buttonMeshes={},g.trigger=b.getObjectByName("BumperKey"),g.triggerPressed=b.getObjectByName("BumperKey_Press"),g.triggerPressed&&(g.triggerPressed.visible=!1),g.trackpad=b.getObjectByName("TouchPad"),g.trackpadPressed=b.getObjectByName("TouchPad_Press"),g.trackpadPressed&&(g.trackpadPressed.visible=!1))},onButtonChanged:function(f){var b=this.mapping.buttons[f.detail.id];!b||this.el.emit(b+"changed",f.detail.state)},onAxisMoved:function(f){h(this,this.mapping.axes,f)},updateModel:function(f,b){!this.data.model||this.updateButtonModel(f,b)},updateButtonModel:function(f,b){var g=this.buttonMeshes,y=f+"Pressed";if(!(!g||!g[f]||!g[y])){var x;switch(b){case"down":x=this.data.buttonHighlightColor;break;case"touchstart":x=this.data.buttonTouchedColor;break}x&&g[y].material.color.set(x),g[y].visible=!!x,g[f].visible=!x}}})},{"../core/component":131,"../utils/bind":199,"../utils/tracked-controls":214}],121:[function(_,G,fe){var u=_("../constants").keyboardevent.KEYCODE_TO_CODE,A=_("../core/component").registerComponent,E=_("../lib/three"),w=_("../utils/"),h=w.bind,v=w.shouldCaptureKeyEvent,d=1e-5,m=.2,f=["KeyW","KeyA","KeyS","KeyD","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"];G.exports.Component=A("wasd-controls",{schema:{acceleration:{default:65},adAxis:{default:"x",oneOf:["x","y","z"]},adEnabled:{default:!0},adInverted:{default:!1},enabled:{default:!0},fly:{default:!1},wsAxis:{default:"z",oneOf:["x","y","z"]},wsEnabled:{default:!0},wsInverted:{default:!1}},init:function(){this.keys={},this.easing=1.1,this.velocity=new E.Vector3,this.onBlur=h(this.onBlur,this),this.onContextMenu=h(this.onContextMenu,this),this.onFocus=h(this.onFocus,this),this.onKeyDown=h(this.onKeyDown,this),this.onKeyUp=h(this.onKeyUp,this),this.onVisibilityChange=h(this.onVisibilityChange,this),this.attachVisibilityEventListeners()},tick:function(g,y){var x=this.data,L=this.el,M=this.velocity;!M[x.adAxis]&&!M[x.wsAxis]&&b(this.keys)||(y=y/1e3,this.updateVelocity(y),!(!M[x.adAxis]&&!M[x.wsAxis])&&L.object3D.position.add(this.getMovementVector(y)))},remove:function(){this.removeKeyEventListeners(),this.removeVisibilityEventListeners()},play:function(){this.attachKeyEventListeners()},pause:function(){this.keys={},this.removeKeyEventListeners()},updateVelocity:function(g){var y,x,L,M=this.data,R=this.keys,D=this.velocity,N,z;if(x=M.adAxis,N=M.wsAxis,g>m){D[x]=0,D[N]=0;return}var re=Math.pow(1/this.easing,g*60);D[x]!==0&&(D[x]=D[x]*re),D[N]!==0&&(D[N]=D[N]*re),Math.abs(D[x])<d&&(D[x]=0),Math.abs(D[N])<d&&(D[N]=0),!!M.enabled&&(y=M.acceleration,M.adEnabled&&(L=M.adInverted?-1:1,(R.KeyA||R.ArrowLeft)&&(D[x]-=L*y*g),(R.KeyD||R.ArrowRight)&&(D[x]+=L*y*g)),M.wsEnabled&&(z=M.wsInverted?-1:1,(R.KeyW||R.ArrowUp)&&(D[N]-=z*y*g),(R.KeyS||R.ArrowDown)&&(D[N]+=z*y*g)))},getMovementVector:function(){var g=new E.Vector3(0,0,0),y=new E.Euler(0,0,0,"YXZ");return function(x){var L=this.el.getAttribute("rotation"),M=this.velocity,R;return g.copy(M),g.multiplyScalar(x),L&&(R=this.data.fly?L.x:0,y.set(E.Math.degToRad(R),E.Math.degToRad(L.y),0),g.applyEuler(y)),g}}(),attachVisibilityEventListeners:function(){window.oncontextmenu=this.onContextMenu,window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),document.addEventListener("visibilitychange",this.onVisibilityChange)},removeVisibilityEventListeners:function(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),document.removeEventListener("visibilitychange",this.onVisibilityChange)},attachKeyEventListeners:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)},removeKeyEventListeners:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)},onContextMenu:function(){for(var g=Object.keys(this.keys),y=0;y<g.length;y++)delete this.keys[g[y]]},onBlur:function(){this.pause()},onFocus:function(){this.play()},onVisibilityChange:function(){document.hidden?this.onBlur():this.onFocus()},onKeyDown:function(g){var y;!v(g)||(y=g.code||u[g.keyCode],f.indexOf(y)!==-1&&(this.keys[y]=!0))},onKeyUp:function(g){var y;y=g.code||u[g.keyCode],delete this.keys[y]}});function b(g){var y;for(y in g)return!1;return!0}},{"../constants":123,"../core/component":131,"../lib/three":179,"../utils/":205}],122:[function(_,G,fe){var u=_("../core/component").registerComponent,A=_("../utils/bind"),E=_("../utils/tracked-controls"),w=E.checkControllerPresentAndSetup,h=E.emitIfAxesChanged,v=E.onButtonEvent,d=_("../utils/"),m=d.debug("components:windows-motion-controls:debug"),f=d.debug("components:windows-motion-controls:warn"),b=_("../constants").DEFAULT_HANDEDNESS,g="https://cdn.aframe.io/controllers/microsoft/",y={left:"left.glb",right:"right.glb",default:"universal.glb"},x=_("../utils/").device.isWebXRAvailable,L="windows-mixed-reality",M="Spatial Controller (Spatial Interaction Source) ",R=/([0-9a-zA-Z]+-[0-9a-zA-Z]+)$/,D=x?L:M,N={axes:{thumbstick:[0,1],trackpad:[2,3]},buttons:["thumbstick","trigger","grip","menu","trackpad"],axisMeshNames:["THUMBSTICK_X","THUMBSTICK_Y","TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",grip:"GRASP",thumbstick:"THUMBSTICK_PRESS",trackpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},z={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick","menu"],axisMeshNames:["TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_X","THUMBSTICK_X","THUMBSTICK_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",squeeze:"GRASP",thumbstick:"THUMBSTICK_PRESS",touchpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},re=x?z:N;G.exports.Component=u("windows-motion-controls",{schema:{hand:{default:b},pair:{default:0},model:{default:!0},hideDisconnected:{default:!0}},mapping:re,bindMethods:function(){this.onModelError=A(this.onModelError,this),this.onModelLoaded=A(this.onModelLoaded,this),this.onControllersUpdate=A(this.onControllersUpdate,this),this.checkIfControllerPresent=A(this.checkIfControllerPresent,this),this.onAxisMoved=A(this.onAxisMoved,this)},init:function(){var Y=this,te=this.el;this.onButtonChanged=A(this.onButtonChanged,this),this.onButtonDown=function(J){v(J.detail.id,"down",Y)},this.onButtonUp=function(J){v(J.detail.id,"up",Y)},this.onButtonTouchStart=function(J){v(J.detail.id,"touchstart",Y)},this.onButtonTouchEnd=function(J){v(J.detail.id,"touchend",Y)},this.onControllerConnected=function(){Y.setModelVisibility(!0)},this.onControllerDisconnected=function(){Y.setModelVisibility(!1)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.loadedMeshInfo={buttonMeshes:null,axisMeshes:null},this.rayOrigin={origin:new THREE.Vector3,direction:new THREE.Vector3(0,0,-1),createdFromMesh:!1},te.addEventListener("controllerconnected",this.onControllerConnected),te.addEventListener("controllerdisconnected",this.onControllerDisconnected)},addEventListeners:function(){var Y=this.el;Y.addEventListener("buttonchanged",this.onButtonChanged),Y.addEventListener("buttondown",this.onButtonDown),Y.addEventListener("buttonup",this.onButtonUp),Y.addEventListener("touchstart",this.onButtonTouchStart),Y.addEventListener("touchend",this.onButtonTouchEnd),Y.addEventListener("axismove",this.onAxisMoved),Y.addEventListener("model-error",this.onModelError),Y.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var Y=this.el;Y.removeEventListener("buttonchanged",this.onButtonChanged),Y.removeEventListener("buttondown",this.onButtonDown),Y.removeEventListener("buttonup",this.onButtonUp),Y.removeEventListener("touchstart",this.onButtonTouchStart),Y.removeEventListener("touchend",this.onButtonTouchEnd),Y.removeEventListener("axismove",this.onAxisMoved),Y.removeEventListener("model-error",this.onModelError),Y.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){w(this,D,{hand:this.data.hand,index:this.data.pair,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},updateControllerModel:function(){if(!this.data.model||this.rayOrigin.createdFromMesh){this.modelReady();return}var Y=this.createControllerModelUrl();this.loadModel(Y)},createControllerModelUrl:function(Y){var te=this.el.components["tracked-controls"],J=te?te.controller:null,le="default",j=this.data.hand,ae;if(J&&!window.hasNativeWebXRImplementation&&(j=J.hand,!Y)){var Z=J.id.match(R);le=Z&&Z[0]||le}return ae=y[j]||y.default,g+le+"/"+ae},injectTrackedControls:function(){var Y=this.data;this.el.setAttribute("tracked-controls",{idPrefix:D,controller:Y.pair,hand:Y.hand,armModel:!1}),this.updateControllerModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelError:function(Y){var te=this.createControllerModelUrl(!0);Y.detail.src!==te?(f("Failed to load controller model for device, attempting to load default."),this.loadModel(te)):f("Failed to load default controller model.")},loadModel:function(Y){this.el.setAttribute("gltf-model","url("+Y+")")},onModelLoaded:function(Y){var te=this.controllerModel=Y.detail.model,J=this.loadedMeshInfo,le,j,ae,Z;if(m("Processing model"),J.buttonMeshes={},J.axisMeshes={},te){for(le=0;le<this.mapping.buttons.length;le++){if(j=this.mapping.buttonMeshNames[this.mapping.buttons[le]],!j){m("Skipping unknown button at index: "+le+" with mapped name: "+this.mapping.buttons[le]);continue}if(ae=te.getObjectByName(j),!ae){f("Missing button mesh with name: "+j);continue}Z={index:le,value:ye(ae,"VALUE"),pressed:ye(ae,"PRESSED"),unpressed:ye(ae,"UNPRESSED")},Z.value&&Z.pressed&&Z.unpressed?J.buttonMeshes[this.mapping.buttons[le]]=Z:f("Missing button submesh under mesh with name: "+j+"(VALUE: "+!!Z.value+", PRESSED: "+!!Z.pressed+", UNPRESSED:"+!!Z.unpressed+")")}for(le=0;le<this.mapping.axisMeshNames.length;le++){if(j=this.mapping.axisMeshNames[le],!j){m("Skipping unknown axis at index: "+le);continue}if(ae=te.getObjectByName(j),!ae){f("Missing axis mesh with name: "+j);continue}Z={index:le,value:ye(ae,"VALUE"),min:ye(ae,"MIN"),max:ye(ae,"MAX")},Z.value&&Z.min&&Z.max?J.axisMeshes[le]=Z:f("Missing axis submesh under mesh with name: "+j+"(VALUE: "+!!Z.value+", MIN: "+!!Z.min+", MAX:"+!!Z.max+")")}this.calculateRayOriginFromMesh(te),this.setModelVisibility()}m("Model load complete.");function ye(Ne,We){for(var ke=0,it=Ne.children.length;ke<it;ke++){var rt=Ne.children[ke];if(rt&&rt.name===We)return rt}}},calculateRayOriginFromMesh:function(){var Y=new THREE.Quaternion;return function(te){var J;if(this.rayOrigin.origin.set(0,0,0),this.rayOrigin.direction.set(0,0,-1),this.rayOrigin.createdFromMesh=!0,J=te.getObjectByName(this.mapping.pointingPoseMeshName),J){var le=te.parent;le&&(te.parent=null,te.updateMatrixWorld(!0),te.parent=le),J.getWorldPosition(this.rayOrigin.origin),J.getWorldQuaternion(Y),this.rayOrigin.direction.applyQuaternion(Y),le&&te.updateMatrixWorld(!0)}else m("Mesh does not contain pointing origin data, defaulting to none.");this.modelReady()}}(),lerpAxisTransform:function(){var Y=new THREE.Quaternion;return function(te,J){var le=this.loadedMeshInfo.axisMeshes[te];if(!!le){var j=le.min,ae=le.max,Z=le.value,ye=J*.5+.5;Z.setRotationFromQuaternion(Y.copy(j.quaternion).slerp(ae.quaternion,ye)),Z.position.lerpVectors(j.position,ae.position,ye)}}}(),lerpButtonTransform:function(){var Y=new THREE.Quaternion;return function(te,J){var le=this.loadedMeshInfo.buttonMeshes[te];if(!!le){var j=le.unpressed,ae=le.pressed,Z=le.value;Z.setRotationFromQuaternion(Y.copy(j.quaternion).slerp(ae.quaternion,J)),Z.position.lerpVectors(j.position,ae.position,J)}}}(),modelReady:function(){this.el.emit("controllermodelready",{name:"windows-motion-controls",model:this.data.model,rayOrigin:this.rayOrigin})},onButtonChanged:function(Y){var te=this.mapping.buttons[Y.detail.id];te&&(this.loadedMeshInfo&&this.loadedMeshInfo.buttonMeshes&&this.lerpButtonTransform(te,Y.detail.state.value),this.el.emit(te+"changed",Y.detail.state))},onAxisMoved:function(Y){var te=this.mapping.axisMeshNames.length;if(this.loadedMeshInfo&&this.loadedMeshInfo.axisMeshes)for(var J=0;J<te;J++)this.lerpAxisTransform(J,Y.detail.axis[J]||0);h(this,this.mapping.axes,Y)},setModelVisibility:function(Y){var te=this.el.getObject3D("mesh");Y=Y!==void 0?Y:this.modelVisible,this.modelVisible=Y,!!te&&(te.visible=Y)}})},{"../constants":123,"../core/component":131,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],123:[function(_,G,fe){G.exports={AFRAME_INJECTED:"aframe-injected",DEFAULT_CAMERA_HEIGHT:1.6,DEFAULT_HANDEDNESS:"right",keyboardevent:_("./keyboardevent")}},{"./keyboardevent":124}],124:[function(_,G,fe){G.exports={KEYCODE_TO_CODE:{"38":"ArrowUp","37":"ArrowLeft","40":"ArrowDown","39":"ArrowRight","87":"KeyW","65":"KeyA","83":"KeyS","68":"KeyD"}}},{}],125:[function(_,G,fe){var u=_("./a-node"),A=_("../utils/bind"),E=_("../utils/debug"),w=_("./a-register-element").registerElement,h=_("../lib/three"),v=new h.FileLoader,d=E("core:a-assets:warn");G.exports=w("a-assets",{prototype:Object.create(u.prototype,{createdCallback:{value:function(){this.isAssets=!0,this.fileLoader=v,this.timeout=null}},attachedCallback:{value:function(){var L=this,M,R=[],D,N,z,re,Y;if(!this.parentNode.isScene)throw new Error("<a-assets> must be a child of a <a-scene>.");for(re=this.querySelectorAll("img"),M=0;M<re.length;M++)z=f(re[M]),R.push(new Promise(function(te,J){h.Cache.files[re[M].getAttribute("src")]=z,z.onload=te,z.onerror=J}));for(N=this.querySelectorAll("audio, video"),M=0;M<N.length;M++)D=f(N[M]),!D.src&&!D.srcObject&&d("Audio/video asset has neither `src` nor `srcObject` attributes."),R.push(m(D));Promise.all(R).then(A(this.load,this)),Y=parseInt(this.getAttribute("timeout"),10)||3e3,this.timeout=setTimeout(function(){L.hasLoaded||(d("Asset loading timed out in ",Y,"ms"),L.emit("timeout"),L.load())},Y)}},detachedCallback:{value:function(){this.timeout&&clearTimeout(this.timeout)}},load:{value:function(){u.prototype.load.call(this,null,function(M){return M.isAssetItem&&M.hasAttribute("src")})}}})}),w("a-asset-item",{prototype:Object.create(u.prototype,{createdCallback:{value:function(){this.data=null,this.isAssetItem=!0}},attachedCallback:{value:function(){var L=this,M=this.getAttribute("src");v.setResponseType(this.getAttribute("response-type")||y(M)),v.load(M,function(D){L.data=D,setTimeout(function(){u.prototype.load.call(L)})},function(D){L.emit("progress",{loadedBytes:D.loaded,totalBytes:D.total,xhr:D})},function(D){L.emit("error",{xhr:D})})}}})});function m(L){if(!(!L.hasAttribute("autoplay")&&L.getAttribute("preload")!=="auto"))return new Promise(function(M,R){if(L.readyState===4)return M();if(L.error)return R();L.addEventListener("loadeddata",D,!1),L.addEventListener("progress",D,!1),L.addEventListener("error",R,!1);function D(){for(var N=0,z=0;z<L.buffered.length;z++)N+=L.buffered.end(z)-L.buffered.start(z);N>=L.duration&&(L.tagName==="VIDEO"&&(h.Cache.files[L.getAttribute("src")]=L),M())}})}function f(L){var M=b(L);return M.tagName&&M.tagName.toLowerCase()==="video"&&(M.setAttribute("playsinline",""),M.setAttribute("webkit-playsinline","")),M!==L&&(L.parentNode.appendChild(M),L.parentNode.removeChild(L)),M}function b(L){var M,R;return L.hasAttribute("crossorigin")||(R=L.getAttribute("src"),R!==null&&(R.indexOf("://")===-1||g(R)===window.location.host))?L:(d('Cross-origin element (e.g., <img>) was requested without `crossorigin` set. A-Frame will re-request the asset with `crossorigin` attribute set. Please set `crossorigin` on the element (e.g., <img crossorigin="anonymous">)',R),L.crossOrigin="anonymous",M=L.cloneNode(!0),M)}function g(L){var M=L.indexOf("://")>-1?L.split("/")[2]:L.split("/")[0];return M.substring(0,M.indexOf(":"))}function y(L){var M=x(L),R=M.lastIndexOf(".");if(R>=0){var D=M.slice(R,L.search(/\?|#|$/));if(D===".glb")return"arraybuffer"}return"text"}G.exports.inferResponseType=y;function x(L){var M=document.createElement("a");M.href=L;var R=M.search.replace(/^\?/,""),D=L.replace(R,"").replace("?","");return D.substring(D.lastIndexOf("/")+1)}G.exports.getFileNameFromURL=x},{"../lib/three":179,"../utils/bind":199,"../utils/debug":201,"./a-node":129,"./a-register-element":130}],126:[function(_,G,fe){var u=_("../utils/debug"),A=_("./a-register-element").registerElement,E=u("core:cubemap:warn");G.exports=A("a-cubemap",{prototype:Object.create(window.HTMLElement.prototype,{attachedCallback:{value:function(){this.srcs=this.validate()},writable:window.debug},validate:{value:function(){var w=this.querySelectorAll("[src]"),h,v=[];if(w.length===6){for(h=0;h<w.length;h++)v.push(w[h].getAttribute("src"));return v}E("<a-cubemap> did not contain exactly six elements each with a `src` attribute.")},writable:window.debug}})})},{"../utils/debug":201,"./a-register-element":130}],127:[function(_,G,fe){var u=_("./a-node"),A=_("./component").components,E=_("./a-register-element").registerElement,w=_("../lib/three"),h=_("../utils/"),v,d=h.debug("core:a-entity:debug"),m=h.debug("core:a-entity:warn"),f="__",b=["position","rotation","scale","visible"],g={once:!0},y=Object.create(u.prototype,{createdCallback:{value:function(){this.components={},this.initializingComponents={},this.componentsToUpdate={},this.isEntity=!0,this.isPlaying=!1,this.object3D=new w.Group,this.object3D.el=this,this.object3DMap={},this.parentEl=null,this.rotationObj={},this.states=[]}},attributeChangedCallback:{value:function(N,z,re){var Y=this.components[N];if(Y&&Y.justInitialized&&re===""){delete Y.justInitialized;return}!Y&&re===null||this.setEntityAttribute(N,z,re)}},attachedCallback:{value:function(){var N,z=this.sceneEl,re=this;if(this.addToParent(),!this.isScene){if(!z){this.load();return}if(N=z.querySelector("a-assets"),N&&!N.hasLoaded){N.addEventListener("loaded",function(){re.load()});return}this.load()}}},detachedCallback:{value:function(){var N;if(!!this.parentEl){for(N in this.components)this.removeComponent(N,!1);this.isScene||(this.removeFromParent(),u.prototype.detachedCallback.call(this),this.object3D.el=null)}}},getObject3D:{value:function(N){return this.object3DMap[N]}},setObject3D:{value:function(N,z){var re,Y=this;if(!(z instanceof w.Object3D))throw new Error("`Entity.setObject3D` was called with an object that was not an instance of THREE.Object3D.");re=this.getObject3D(N),re&&this.object3D.remove(re),z.el=this,z.children.length&&z.traverse(function(J){J.el=Y}),this.object3D.add(z),this.object3DMap[N]=z,this.emit("object3dset",{object:z,type:N})}},removeObject3D:{value:function(N){var z=this.getObject3D(N);if(!z){m("Tried to remove `Object3D` of type:",N,"which was not defined.");return}this.object3D.remove(z),delete this.object3DMap[N],this.emit("object3dremove",{type:N})}},getOrCreateObject3D:{value:function(N,z){var re=this.getObject3D(N);return!re&&z&&(re=new z,this.setObject3D(N,re)),m("`getOrCreateObject3D` has been deprecated. Use `setObject3D()` and `object3dset` event instead."),re}},add:{value:function(N){if(!N.object3D)throw new Error("Trying to add an element that doesn't have an `object3D`");this.object3D.add(N.object3D),this.emit("child-attached",{el:N})}},addToParent:{value:function(){var N=this.parentEl=this.parentNode;!N||!N.add||this.attachedToParent||(N.add(this),this.attachedToParent=!0)}},removeFromParent:{value:function(){var N=this.parentEl;this.parentEl.remove(this),this.attachedToParent=!1,this.parentEl=null,N.emit("child-detached",{el:this})}},load:{value:function(){var N=this;this.hasLoaded||!this.parentEl||u.prototype.load.call(this,function(){!N.parentEl||(N.updateComponents(),(N.isScene||N.parentEl.isPlaying)&&N.play())})},writable:window.debug},remove:{value:function(N){N?this.object3D.remove(N.object3D):this.parentNode.removeChild(this)}},getChildEntities:{value:function(){for(var N=this.children,z=[],re=0;re<N.length;re++){var Y=N[re];Y instanceof v&&z.push(Y)}return z}},initComponent:{value:function(N,z,re){var Y,te,J,le,j;if(J=h.split(N,f),le=J[0],te=J.length>2?J.slice(1).join("__"):J[1],!!A[le]&&(j=x(this,N)||z!==void 0,!(!j&&!re)&&!(N in this.components))){if(this.initComponentDependencies(le),te&&!A[le].multiple)throw new Error("Trying to initialize multiple components of type `"+le+"`. There can only be one component of this type per entity.");Y=new A[le].Component(this,z,te),this.isPlaying&&Y.play(),this.hasAttribute(N)||(Y.justInitialized=!0,window.HTMLElement.prototype.setAttribute.call(this,N,"")),d("Component initialized: %s",N)}},writable:window.debug},initComponentDependencies:{value:function(N){var z=this,re=A[N],Y,te;if(!!re&&(Y=A[N].dependencies,!!Y))for(te=0;te<Y.length;te++)z.initComponent(Y[te],window.HTMLElement.prototype.getAttribute.call(z,Y[te])||void 0,!0)}},removeComponent:{value:function(N,z){var re;if(re=this.components[N],!!re){if(!re.initialized){this.addEventListener("componentinitialized",function Y(te){te.detail.name===N&&(this.removeComponent(N,z),this.removeEventListener("componentinitialized",Y))});return}re.pause(),re.remove(),z&&(re.destroy(),delete this.components[N]),this.emit("componentremoved",re.evtDetail,!1)}},writable:window.debug},updateComponents:{value:function(){var N,z,re,Y,te=this.componentsToUpdate;if(!!this.hasLoaded){for(re=0;re<this.mixinEls.length;re++)for(Y in this.mixinEls[re].componentCache)R(Y)&&(te[Y]=!0);if(this.getExtraComponents){z=this.getExtraComponents();for(Y in z)R(Y)&&(te[Y]=!0)}for(re=0;re<this.attributes.length;++re)Y=this.attributes[re].name,b.indexOf(Y)===-1&&R(Y)&&(te[Y]=!0);for(re=0;re<b.length;re++)Y=b[re],!!this.hasAttribute(Y)&&this.updateComponent(Y,this.getDOMAttribute(Y));for(Y in te)N=M(this.getDOMAttribute(Y),z&&z[Y]),this.updateComponent(Y,N),delete te[Y]}},writable:window.debug},updateComponent:{value:function(N,z,re){var Y=this.components[N];if(Y){if(z===null&&!x(this,N)){this.removeComponent(N,!0);return}Y.updateProperties(z,re);return}this.initComponent(N,z,!1)}},removeAttribute:{value:function(N,z){var re=this.components[N];if(re&&z===void 0&&this.removeComponent(N,!0),re&&z!==void 0){re.resetProperty(z);return}N==="mixin"&&this.mixinUpdate(""),window.HTMLElement.prototype.removeAttribute.call(this,N)}},play:{value:function(){var N,z,re;if(!(this.isPlaying||!this.hasLoaded)){this.isPlaying=!0;for(re in this.components)this.components[re].play();for(N=this.getChildEntities(),z=0;z<N.length;z++)N[z].play();this.emit("play")}},writable:!0},pause:{value:function(){var N,z,re;if(!!this.isPlaying){this.isPlaying=!1;for(re in this.components)this.components[re].pause();for(N=this.getChildEntities(),z=0;z<N.length;z++)N[z].pause();this.emit("pause")}},writable:!0},setEntityAttribute:{value:function(N,z,re){if(A[N]||this.components[N]){this.updateComponent(N,re);return}if(N==="mixin"){if(re===this.computedMixinStr)return;this.mixinUpdate(re,z)}}},mixinUpdate:{value:function(){var N=[];return function(z,re){var Y,te,J,le,j=this;if(!this.hasLoaded){this.addEventListener("loaded",function(){j.mixinUpdate(z,re)},g);return}for(re=re||this.getAttribute("mixin"),J=this.updateMixins(z,re),N.length=0,le=0;le<this.mixinEls.length;le++)for(Y in this.mixinEls[le].componentCache)N.indexOf(Y)===-1&&(this.components[Y]?this.components[Y].handleMixinUpdate():this.initComponent(Y,null),N.push(Y));for(le=0;le<J.oldMixinIds.length;le++)if(te=document.getElementById(J.oldMixinIds[le]),!!te)for(Y in te.componentCache)N.indexOf(Y)===-1&&this.components[Y]&&(this.getDOMAttribute(Y)?this.components[Y].handleMixinUpdate():this.removeComponent(Y,!0))}}()},setAttribute:{value:function(){var N={};return function(z,re,Y){var te,J,le,j,ae,Z;if(j=z.indexOf(f),le=j>0?z.substring(0,j):z,!A[le]){z==="mixin"&&this.mixinUpdate(re),u.prototype.setAttribute.call(this,z,re);return}if(!this.components[z]&&this.hasAttribute(z)&&this.updateComponent(z,window.HTMLElement.prototype.getAttribute.call(this,z)),typeof Y!="undefined"&&typeof re=="string"&&re.length>0&&typeof h.styleParser.parse(re)=="string"){for(Z in N)delete N[Z];te=N,te[re]=Y,J=!1}else te=re,J=Y===!0;this.updateComponent(z,te,J),ae=this.sceneEl&&this.sceneEl.getAttribute("debug"),ae&&this.components[z].flushToDOM()}}(),writable:window.debug},flushToDOM:{value:function(N){var z=this.components,re,Y=this.children,te,J;for(J in z)z[J].flushToDOM();if(!!N)for(te=0;te<Y.length;++te)re=Y[te],!!re.flushToDOM&&re.flushToDOM(N)}},getAttribute:{value:function(N){var z;return N==="position"?this.object3D.position:N==="rotation"?D(this):N==="scale"?this.object3D.scale:N==="visible"?this.object3D.visible:(z=this.components[N],z?z.data:window.HTMLElement.prototype.getAttribute.call(this,N))},writable:window.debug},getDOMAttribute:{value:function(N){var z=this.components[N];return z?z.attrValue:window.HTMLElement.prototype.getAttribute.call(this,N)},writable:window.debug},addState:{value:function(N){this.is(N)||(this.states.push(N),this.emit("stateadded",N))}},removeState:{value:function(N){var z=this.states.indexOf(N);z!==-1&&(this.states.splice(z,1),this.emit("stateremoved",N))}},is:{value:function(N){return this.states.indexOf(N)!==-1}},inspect:{value:function(){this.sceneEl.components.inspector.openInspector(this)}},destroy:{value:function(){var N;if(this.parentNode){m("Entity can only be destroyed if detached from scenegraph.");return}for(N in this.components)this.components[N].destroy()}}});function x(N,z){return N.components[z]&&N.components[z].attrValue?!0:L(z,N.mixinEls)}function L(N,z){var re,Y=!1;for(re=0;re<z.length&&(Y=z[re].hasAttribute(N),!Y);++re);return Y}function M(N,z){return z?z.constructor===Object?h.extend(z,h.styleParser.parse(N||{})):N||z:N}function R(N){return N.indexOf(f)!==-1&&(N=h.split(N,f)[0]),!!A[N]}function D(N){var z=w.Math.radToDeg,re=N.object3D.rotation,Y=N.rotationObj;return Y.x=z(re.x),Y.y=z(re.y),Y.z=z(re.z),Y}v=E("a-entity",{prototype:y}),G.exports=v},{"../lib/three":179,"../utils/":205,"./a-node":129,"./a-register-element":130,"./component":131}],128:[function(_,G,fe){var u=_("./a-node"),A=_("./a-register-element").registerElement,E=_("./component").components,w=_("../utils"),h="__";G.exports=A("a-mixin",{prototype:Object.create(u.prototype,{createdCallback:{value:function(){this.componentCache={},this.id=this.getAttribute("id"),this.isMixin=!0}},attributeChangedCallback:{value:function(v,d,m){this.cacheAttribute(v,m),this.updateEntities()}},attachedCallback:{value:function(){this.sceneEl=this.closestScene(),this.cacheAttributes(),this.updateEntities(),this.load()}},setAttribute:{value:function(v,d){window.HTMLElement.prototype.setAttribute.call(this,v,d),this.cacheAttribute(v,d)}},cacheAttribute:{value:function(v,d){var m,f;f=w.split(v,h)[0],m=E[f],!!m&&(d===void 0&&(d=window.HTMLElement.prototype.getAttribute.call(this,v)),this.componentCache[v]=m.parseAttrValueForCache(d))}},getAttribute:{value:function(v){return this.componentCache[v]||window.HTMLElement.prototype.getAttribute.call(this,v)}},cacheAttributes:{value:function(){var v=this.attributes,d,m;for(m=0;m<v.length;m++)d=v[m].name,this.cacheAttribute(d)}},updateEntities:{value:function(){var v,d,m;if(!!this.sceneEl)for(d=this.sceneEl.querySelectorAll("[mixin~="+this.id+"]"),m=0;m<d.length;m++)v=d[m],!(!v.hasLoaded||v.isMixin)&&v.mixinUpdate(this.id)}}})})},{"../utils":205,"./a-node":129,"./a-register-element":130,"./component":131}],129:[function(_,G,fe){var u=_("./a-register-element").registerElement,A=_("./a-register-element").isNode,E=_("../utils/"),w=E.debug("core:a-node:warn"),h=E.debug("core:a-node:error");G.exports=u("a-node",{prototype:Object.create(window.HTMLElement.prototype,{createdCallback:{value:function(){this.computedMixinStr="",this.hasLoaded=!1,this.isNode=!0,this.mixinEls=[]},writable:window.debug},attachedCallback:{value:function(){var v;this.sceneEl=this.closestScene(),this.sceneEl||w("You are attempting to attach <"+this.tagName+"> outside of an A-Frame scene. Append this element to `<a-scene>` instead."),this.hasLoaded=!1,this.emit("nodeready",void 0,!1),this.isMixin||(v=this.getAttribute("mixin"),v&&this.updateMixins(v))},writable:window.debug},attributeChangedCallback:{value:function(v,d,m){m!==this.computedMixinStr&&v==="mixin"&&!this.isMixin&&this.updateMixins(m,d)}},closestScene:{value:function(){for(var d=this;d&&!d.isScene;)d=d.parentElement;return d}},closest:{value:function(d){for(var m=this.matches||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector,f=this;f&&!m.call(f,d);)f=f.parentElement;return f}},detachedCallback:{value:function(){this.hasLoaded=!1}},load:{value:function(v,d){var m,f,b=this;this.hasLoaded||(d=d||A,m=this.getChildren(),f=m.filter(d).map(function(g){return new Promise(function(x){if(g.hasLoaded)return x();g.addEventListener("loaded",x)})}),Promise.all(f).then(function(){b.hasLoaded=!0,v&&v(),b.emit("loaded",void 0,!1)}).catch(function(g){h("Failure loading node: ",g)}))},writable:!0},getChildren:{value:function(){return Array.prototype.slice.call(this.children,0)}},updateMixins:{value:function(){var v=[],d=[],m={};return function(f,b){var g,y,x;for(v.length=0,d.length=0,y=f?E.split(f.trim(),/\s+/):v,x=b?E.split(b.trim(),/\s+/):d,m.newMixinIds=y,m.oldMixinIds=x,g=0;g<x.length;g++)y.indexOf(x[g])===-1&&this.unregisterMixin(x[g]);for(this.computedMixinStr="",this.mixinEls.length=0,g=0;g<y.length;g++)this.registerMixin(document.getElementById(y[g]));return this.computedMixinStr&&(this.computedMixinStr=this.computedMixinStr.trim(),window.HTMLElement.prototype.setAttribute.call(this,"mixin",this.computedMixinStr)),m}}()},registerMixin:{value:function(v){var d,m,f;if(!!v){if(f=v.getAttribute("mixin"),f)for(d=E.split(f.trim(),/\s+/),m=0;m<d.length;m++)this.registerMixin(document.getElementById(d[m]));this.computedMixinStr=this.computedMixinStr+" "+v.id,this.mixinEls.push(v)}}},setAttribute:{value:function(v,d){v==="mixin"&&this.updateMixins(d),window.HTMLElement.prototype.setAttribute.call(this,v,d)}},unregisterMixin:{value:function(v){var d,m=this.mixinEls,f;for(d=0;d<m.length;++d)if(f=m[d],v===f.id){m.splice(d,1);break}}},emit:{value:function(){var v={};return function(d,m,f,b){f===void 0&&(f=!0),v.bubbles=!!f,v.detail=m,b&&(v=E.extend({},b,v)),this.dispatchEvent(new CustomEvent(d,v))}}(),writable:window.debug}})})},{"../utils/":205,"./a-register-element":130}],130:[function(_,G,fe){_("document-register-element");var u,A,E=G.exports.knownTags={};function w(b){E[b.toLowerCase()]=!0}G.exports.isNode=function(b){return b.tagName.toLowerCase()in E||b.isNode},G.exports.registerElement=function(b,g){var y=Object.getPrototypeOf(g.prototype),x=g,L=u&&y===u.prototype,M=A&&y===A.prototype;return(L||M)&&w(b),L&&(x=h(g.prototype),x={prototype:Object.create(y,x)}),M&&(x=v(g.prototype),x={prototype:Object.create(y,x)}),Object.getOwnPropertyNames(x.prototype).forEach(function(R){var D=x.prototype[R];typeof D=="function"&&(D.displayName=R)}),document.registerElement(b,x)};function h(b){var g={},y=["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"];return d(g,y,b,u.prototype),f(b,g),g}function v(b){var g={},y=["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"],x=["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"];return d(g,y,b,u.prototype),d(g,x,b,A.prototype),f(b,g),g}function d(b,g,y,x){g.forEach(function(L){m(b,L,y,x)})}G.exports.wrapMethods=d;function m(b,g,y,x){var L=y[g],M=x[g];!L||!M||L!==M&&(b[g]={value:function(){return M.apply(this,arguments),L.apply(this,arguments)},writable:window.debug})}function f(b,g){var y=Object.getOwnPropertyNames(b);y.forEach(function(x){var L;g[x]||(L=Object.getOwnPropertyDescriptor(b,x),g[x]={value:b[x],writable:L.writable})})}u=_("./a-node"),A=_("./a-entity")},{"./a-entity":127,"./a-node":129,"document-register-element":12}],131:[function(_,G,fe){var u=_("./schema"),A=_("./scene/scenes"),E=_("./system"),w=_("../utils/"),h=G.exports.components={},v=u.parseProperties,d=u.parseProperty,m=u.process,f=u.isSingleProperty,b=u.stringifyProperties,g=u.stringifyProperty,y=w.styleParser,x=w.debug("core:component:warn"),L=document.currentScript,M=new RegExp("[A-Z]+"),R={},D=G.exports.Component=function(Z,ye,Ne){var We=this;this.el=Z,this.id=Ne,this.attrName=this.name+(Ne?"__"+Ne:""),this.evtDetail={id:this.id,name:this.name},this.initialized=!1,this.isSingleProperty=f(this.schema),this.isSinglePropertyObject=this.isSingleProperty&&j(d(void 0,this.schema))&&!(this.schema.default instanceof window.HTMLElement),this.isObjectBased=!this.isSingleProperty||this.isSinglePropertyObject,this.el.components[this.attrName]=this,this.objectPool=R[this.name];const ke=this.events;this.events={},N(this,ke),this.attrValue=void 0,this.isObjectBased?(this.nextData=this.objectPool.use(),w.objectPool.removeUnusedKeys(this.nextData,this.schema),this.oldData=this.objectPool.use(),w.objectPool.removeUnusedKeys(this.oldData,this.schema),this.previousOldData=this.objectPool.use(),w.objectPool.removeUnusedKeys(this.previousOldData,this.schema),this.parsingAttrValue=this.objectPool.use(),w.objectPool.removeUnusedKeys(this.parsingAttrValue,this.schema)):(this.nextData=void 0,this.oldData=void 0,this.previousOldData=void 0,this.parsingAttrValue=void 0),this.throttledEmitComponentChanged=w.throttle(function(){Z.emit("componentchanged",We.evtDetail,!1)},200),this.updateProperties(ye)};D.prototype={schema:{},init:function(){},events:{},update:function(Z){},updateSchema:void 0,tick:void 0,tock:void 0,play:function(){},pause:function(){},remove:function(){},parse:function(Z,ye){var Ne=this.schema;return this.isSingleProperty?d(Z,Ne):v(y.parse(Z),Ne,!0,this.name,ye)},stringify:function(Z){var ye=this.schema;return typeof Z=="string"?Z:this.isSingleProperty?g(Z,ye):(Z=b(Z,ye),y.stringify(Z))},updateCachedAttrValue:function(Z,ye){var Ne,We,ke;if(Z!==void 0){if(Z===null){this.isObjectBased&&this.attrValue&&this.objectPool.recycle(this.attrValue),this.attrValue=void 0;return}if(Z instanceof Object&&!(Z instanceof window.HTMLElement)?(We=this.objectPool.use(),Ne=w.extend(We,Z)):Ne=this.parseAttrValueForCache(Z),this.isObjectBased&&!ye&&this.attrValue)for(ke in this.attrValue)Ne[ke]===void 0&&(Ne[ke]=this.attrValue[ke]);this.isObjectBased&&!this.attrValue&&(this.attrValue=this.objectPool.use()),w.objectPool.clearObject(this.attrValue),this.attrValue=Y(this.attrValue,Ne,this.isObjectBased),w.objectPool.clearObject(We)}},parseAttrValueForCache:function(Z){var ye;return typeof Z!="string"?Z:(this.isSingleProperty?(ye=this.schema.parse(Z),typeof ye=="string"&&(ye=Z)):(w.objectPool.clearObject(this.parsingAttrValue),ye=y.parse(Z,this.parsingAttrValue)),ye)},flushToDOM:function(Z){var ye=Z?this.data:this.attrValue;ye!=null&&window.HTMLElement.prototype.setAttribute.call(this.el,this.attrName,this.stringify(ye))},updateProperties:function(Z,ye){var Ne=this.el;if(!Ne.hasLoaded){this.updateCachedAttrValue(Z);return}Z!==null&&(Z=this.parseAttrValueForCache(Z)),this.updateCachedAttrValue(Z,ye),this.initialized?(this.updateComponent(Z,ye),this.callUpdateHandler()):this.initComponent()},initComponent:function(){var Z=this.el,ye;this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!1,!0)),this.data=this.buildData(this.attrValue),!Z.initializingComponents[this.name]&&(Z.initializingComponents[this.name]=!0,this.init(),this.initialized=!0,delete Z.initializingComponents[this.name],this.oldData=Y(this.oldData,this.data,this.isObjectBased),ye=this.isObjectBased?this.objectPool.use():void 0,this.update(ye),this.isObjectBased&&this.objectPool.recycle(ye),Z.isPlaying&&this.play(),Z.emit("componentinitialized",this.evtDetail,!1))},updateComponent:function(Z,ye){var Ne,We;if(ye){this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),this.data=this.buildData(this.attrValue,!0,!1);return}if(this.isSingleProperty){this.isObjectBased&&d(Z,this.schema),this.data=Z;return}if(v(Z,this.schema,!0,this.name),this.schemaChangeKeys.length){for(Ne in Z)if(this.schema[Ne].schemaChange){We=!0;break}}if(We){this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),this.data=this.buildData(this.attrValue,!0,!1);return}for(Ne in Z)Z[Ne]!==void 0&&(this.data[Ne]=Z[Ne])},callUpdateHandler:function(){var Z;this.previousOldData instanceof Object&&w.objectPool.clearObject(this.previousOldData),this.isObjectBased?re(this.previousOldData,this.oldData):this.previousOldData=this.oldData,Z=!w.deepEqual(this.oldData,this.data),!(!this.isPositionRotationScale&&!Z)&&(this.oldData instanceof Object&&w.objectPool.clearObject(this.oldData),this.oldData=Y(this.oldData,this.data,this.isObjectBased),this.update(this.previousOldData),this.throttledEmitComponentChanged())},handleMixinUpdate:function(){this.data=this.buildData(this.attrValue),this.callUpdateHandler()},resetProperty:function(Z){if(this.isObjectBased){if(!(Z in this.attrValue))return;delete this.attrValue[Z],this.data[Z]=this.schema[Z].default}else this.attrValue=this.schema.default,this.data=this.schema.default;this.updateProperties(this.attrValue)},extendSchema:function(Z){var ye;ye=w.extend({},h[this.name].schema),w.extend(ye,Z),this.schema=m(ye),this.el.emit("schemachanged",this.evtDetail)},buildData:function(Z,ye,Ne){var We,ke,it,rt,At,St=this.nextData,Gt=this.schema,er,zt=this.el.mixinEls,wt;if(We=Z&&Z.constructor===Array?Z.length:Z!=null,this.isObjectBased&&w.objectPool.clearObject(St),this.isSingleProperty)this.isObjectBased?ke=re(St,Gt.default):ke=ae(Gt.default)?w.clone(Gt.default):Gt.default;else{wt=!ye&&this.attrValue,ke=wt instanceof Object?re(St,wt):St;for(rt in Gt)it=Gt[rt].default,ke[rt]===void 0&&(ke[rt]=ae(it)?w.clone(it):it)}for(er=0;er<zt.length;er++)At=zt[er].getAttribute(this.attrName),!!At&&(ke=Y(ke,At,this.isObjectBased));if(We){if(this.isSingleProperty)return j(Z)?(re(this.parsingAttrValue,Z),d(this.parsingAttrValue,Gt)):d(Z,Gt);ke=Y(ke,Z,this.isObjectBased)}else if(this.isSingleProperty)return d(ke,Gt);return v(ke,Gt,void 0,this.name,Ne)},eventsAttach:function(){var Z;this.eventsDetach();for(Z in this.events)this.el.addEventListener(Z,this.events[Z])},eventsDetach:function(){var Z;for(Z in this.events)this.el.removeEventListener(Z,this.events[Z])},destroy:function(){this.objectPool.recycle(this.attrValue),this.objectPool.recycle(this.oldData),this.objectPool.recycle(this.parsingAttrValue),this.attrValue=this.oldData=this.parsingAttrValue=void 0}};function N(Z,ye){var Ne;for(Ne in ye)Z.events[Ne]=ye[Ne].bind(Z)}if(window.debug)var z=G.exports.registrationOrderWarnings={};G.exports.registerComponent=function(Z,ye){var Ne,We,ke={},it,rt;if(document.currentScript&&document.currentScript!==L&&A.forEach(function(St){St.hasLoaded||document.currentScript.compareDocumentPosition(St)!==Node.DOCUMENT_POSITION_FOLLOWING&&(x("The component `"+Z+"` was registered in a <script> tag after the scene. Component <script> tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization."),window.debug&&(z[Z]=!0))}),M.test(Z)===!0&&x("The component name `"+Z+"` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `"+Z.toLowerCase()+"`"),Z.indexOf("__")!==-1)throw new Error("The component name `"+Z+"` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type");if(Object.keys(ye).forEach(function(At){ke[At]={value:ye[At],writable:!0}}),h[Z])throw new Error("The component `"+Z+"` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name.");if(Ne=function(At,St,Gt){D.call(this,At,St,Gt)},Ne.prototype=Object.create(D.prototype,ke),Ne.prototype.name=Z,Ne.prototype.isPositionRotationScale=Z==="position"||Z==="rotation"||Z==="scale",Ne.prototype.constructor=Ne,Ne.prototype.system=E&&E.systems[Z],Ne.prototype.play=le(Ne.prototype.play),Ne.prototype.pause=J(Ne.prototype.pause),it=w.extend(m(Ne.prototype.schema,Ne.prototype.name)),rt=f(Ne.prototype.schema),!rt){Ne.prototype.schemaChangeKeys=[];for(We in it)it[We].schemaChange&&Ne.prototype.schemaChangeKeys.push(We)}return R[Z]=w.objectPool.createPool(),h[Z]={Component:Ne,dependencies:Ne.prototype.dependencies,isSingleProp:rt,multiple:Ne.prototype.multiple,name:Z,parse:Ne.prototype.parse,parseAttrValueForCache:Ne.prototype.parseAttrValueForCache,schema:it,stringify:Ne.prototype.stringify,type:Ne.prototype.type},Ne};function re(Z,ye){var Ne,We;for(We in ye)ye[We]!==void 0&&(Ne=ye[We],Z[We]=ae(Ne)?w.clone(Ne):Ne);return Z}function Y(Z,ye,Ne){var We;if(Ne&&ye.constructor===Object){for(We in ye)ye[We]!==void 0&&(ye[We]&&ye[We].constructor===Object?Z[We]=w.clone(ye[We]):Z[We]=ye[We]);return Z}return ye}function te(Z){return Z.tick||Z.tock}function J(Z){return function(){var Ne=this.el.sceneEl;!this.isPlaying||(Z.call(this),this.isPlaying=!1,this.eventsDetach(),!!te(this)&&Ne.removeBehavior(this))}}function le(Z){return function(){var Ne=this.el.sceneEl,We=this.el.isPlaying&&!this.isPlaying;!this.initialized||!We||(Z.call(this),this.isPlaying=!0,this.eventsAttach(),!!te(this)&&Ne.addBehavior(this))}}function j(Z){return Z&&Z.constructor===Object&&!(Z instanceof window.HTMLElement)}function ae(Z){return Z&&(Z.constructor===Object||Z.constructor===Array)&&!(Z instanceof window.HTMLElement)}},{"../utils/":205,"./scene/scenes":138,"./schema":140,"./system":142}],132:[function(_,G,fe){var u=_("./schema"),A=u.process,E=G.exports.geometries={},w=G.exports.geometryNames=[],h=_("../lib/three"),v=G.exports.Geometry=function(){};v.prototype={schema:{},init:function(d){return this.geometry=new h.BufferGeometry,this.geometry},update:function(d){}},G.exports.registerGeometry=function(d,m){var f,b={};if(Object.keys(m).forEach(function(y){b[y]={value:m[y],writable:!0}}),E[d])throw new Error("The geometry `"+d+"` has been already registered");return f=function(){v.call(this)},f.prototype=Object.create(v.prototype,b),f.prototype.name=d,f.prototype.constructor=f,E[d]={Geometry:f,schema:A(f.prototype.schema)},w.push(d),f}},{"../lib/three":179,"./schema":140}],133:[function(_,G,fe){var u=_("../utils/coordinates"),A=_("debug"),E=A("core:propertyTypes:warn"),w=A("core:propertyTypes:warn"),h=G.exports.propertyTypes={},v=/[,> .[\]:]/,d=/\url\((.+)\)/;m("audio","",g),m("array",[],f,b),m("asset","",g),m("boolean",!1,L),m("color","#FFF",y,x),m("int",0,M),m("number",0,R),m("map","",g),m("model","",g),m("selector",null,D,z),m("selectorAll",null,N,re),m("src","",Y),m("string","",y,x),m("time",0,M),m("vec2",{x:0,y:0},te,u.stringify),m("vec3",{x:0,y:0,z:0},te,u.stringify),m("vec4",{x:0,y:0,z:0,w:1},te,u.stringify);function m(j,ae,Z,ye){if("type"in h){E("Property type "+j+" is already registered.");return}h[j]={default:ae,parse:Z||y,stringify:ye||x}}G.exports.registerPropertyType=m;function f(j){if(Array.isArray(j))return j;if(!j||typeof j!="string")return[];return j.split(",").map(ae);function ae(Z){return Z.trim()}}function b(j){return j.join(", ")}function g(j){var ae,Z;if(typeof j!="string")return j;if(Z=j.match(d),Z)return Z[1];if(j.charAt(0)==="#"){if(ae=document.getElementById(j.substring(1)),ae)return ae.tagName==="CANVAS"||ae.tagName==="VIDEO"||ae.tagName==="IMG"?ae:ae.getAttribute("src");w('"'+j+'" asset not found.');return}return j}function y(j){return j}function x(j){return j===null?"null":j.toString()}function L(j){return j!=="false"&&j!==!1}function M(j){return parseInt(j,10)}function R(j){return parseFloat(j,10)}function D(j){return j?typeof j!="string"?j:j[0]==="#"&&!v.test(j)?document.getElementById(j.substring(1)):document.querySelector(j):null}function N(j){return j?typeof j!="string"?j:Array.prototype.slice.call(document.querySelectorAll(j),0):null}function z(j){return j.getAttribute?"#"+j.getAttribute("id"):x(j)}function re(j){return j instanceof Array?j.map(function(ae){return"#"+ae.getAttribute("id")}).join(", "):x(j)}function Y(j){return w("`src` property type is deprecated. Use `asset` instead."),g(j)}function te(j){return u.parse(j,this.default)}function J(j,ae){return j==="audio"&&typeof ae!="string"||j==="array"&&!Array.isArray(ae)||j==="asset"&&typeof ae!="string"||j==="boolean"&&typeof ae!="boolean"||j==="color"&&typeof ae!="string"||j==="int"&&typeof ae!="number"||j==="number"&&typeof ae!="number"||j==="map"&&typeof ae!="string"||j==="model"&&typeof ae!="string"||j==="selector"&&typeof ae!="string"&&ae!==null||j==="selectorAll"&&typeof ae!="string"&&ae!==null||j==="src"&&typeof ae!="string"||j==="string"&&typeof ae!="string"||j==="time"&&typeof ae!="number"?!1:j==="vec2"?le(ae,2):j==="vec3"?le(ae,3):j==="vec4"?le(ae,4):!0}G.exports.isValidDefaultValue=J;function le(j,ae){if(j===null)return!0;if(typeof j!="object"||Object.keys(j).length!==ae)return!1;var Z=j.x,ye=j.y,Ne=j.z,We=j.w;return!(typeof Z!="number"||typeof ye!="number"||ae>2&&typeof Ne!="number"||ae>3&&typeof We!="number")}G.exports.isValidDefaultCoordinate=le},{"../utils/coordinates":200,debug:8}],134:[function(_,G,fe){var u=_("./metaTags").inject,A=_("./wakelock"),E=_("./loadingScreen"),w=_("../a-register-element"),h=_("./scenes"),v=_("../system").systems,d=_("../../lib/three"),m=_("../../utils/"),f=_("../a-entity"),b=_("../a-node"),g=_("./postMessage"),y=m.bind,x=m.device.isIOS(),L=m.device.isMobile(),M=m.device.isWebXRAvailable,R=w.registerElement,D=m.debug("core:a-scene:warn");x&&_("../../utils/ios-orientationchange-blank-bug"),G.exports.AScene=R("a-scene",{prototype:Object.create(f.prototype,{createdCallback:{value:function(){this.clock=new d.Clock,this.isIOS=x,this.isMobile=L,this.hasWebXR=M,this.isAR=!1,this.isScene=!0,this.object3D=new d.Scene;var J=this;this.object3D.onAfterRender=function(le,j,ae){J.isPlaying&&J.tock(J.time,J.delta,ae)},this.resize=y(this.resize,this),this.render=y(this.render,this),this.systems={},this.systemNames=[],this.time=this.delta=0,this.behaviors={tick:[],tock:[]},this.hasLoaded=!1,this.isPlaying=!1,this.originalHTML=this.innerHTML,this.setAttribute("inspector",""),this.setAttribute("keyboard-shortcuts",""),this.setAttribute("screenshot",""),this.setAttribute("vr-mode-ui",""),this.setAttribute("device-orientation-permission-ui","")}},addFullScreenStyles:{value:function(){document.documentElement.classList.add("a-fullscreen")}},removeFullScreenStyles:{value:function(){document.documentElement.classList.remove("a-fullscreen")}},attachedCallback:{value:function(){var J=this,le=this.hasAttribute("embedded");te(this),this.setupRenderer(),E.setup(this,N),this.resize(),le||this.addFullScreenStyles(),g(this),u(this),A(this),this.onVRPresentChangeBound=y(this.onVRPresentChange,this),window.addEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),this.enterVRBound=function(){J.enterVR()},this.exitVRBound=function(){J.exitVR()},this.exitVRTrueBound=function(){J.exitVR(!0)},this.pointerRestrictedBound=function(){J.pointerRestricted()},this.pointerUnrestrictedBound=function(){J.pointerUnrestricted()},M||(window.addEventListener("vrdisplaydeactivate",this.exitVRBound),window.addEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.addEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.addEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)),window.addEventListener("sessionend",this.resize),this.addEventListener("cameraready",function(){J.attachedCallbackPostCamera()}),this.initSystems(),this.hasWebXR&&navigator.xr&&navigator.xr.addEventListener&&navigator.xr.addEventListener("sessiongranted",function(){J.enterVR()})}},attachedCallbackPostCamera:{value:function(){var J,le=this;window.addEventListener("load",J),window.addEventListener("resize",function(){le.isIOS?setTimeout(le.resize,100):le.resize()}),this.play(),h.push(this)},writable:window.debug},initSystems:{value:function(){var J;this.initSystem("camera");for(J in v)J!=="camera"&&this.initSystem(J)}},initSystem:{value:function(J){this.systems[J]||(this.systems[J]=new v[J](this),this.systemNames.push(J))}},detachedCallback:{value:function(){var J=h.indexOf(this);h.splice(J,1),window.removeEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),window.removeEventListener("vrdisplayactivate",this.enterVRBound),window.removeEventListener("vrdisplaydeactivate",this.exitVRBound),window.removeEventListener("vrdisplayconnect",this.enterVRBound),window.removeEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.removeEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.removeEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound),window.removeEventListener("sessionend",this.resize),this.renderer.xr.dispose()}},addBehavior:{value:function(J){var le,j=this.behaviors,ae;for(ae in j)!J[ae]||(le=this.behaviors[ae],le.indexOf(J)===-1&&le.push(J))}},getPointerLockElement:{value:function(){return document.pointerLockElement},writable:window.debug},checkHeadsetConnected:{value:m.device.checkHeadsetConnected,writable:window.debug},enterAR:{value:function(){var J;if(!this.hasWebXR)throw J="Failed to enter AR mode, WebXR not supported.",new Error(J);if(!m.device.checkARSupport())throw J="Failed to enter AR, WebXR immersive-ar mode not supported in your browser or device.",new Error(J);return this.enterVR(!0)}},enterVR:{value:function(J){var le=this,j,ae=le.renderer.xr,Z;if(this.is("vr-mode"))return Promise.resolve("Already in VR.");if(this.checkHeadsetConnected()||this.isMobile)if(ae.enabled=!0,this.hasWebXR){this.xrSession&&this.xrSession.removeEventListener("end",this.exitVRBound);var ye=this.sceneEl.systems.webxr.sessionReferenceSpaceType;ae.setReferenceSpaceType(ye);var Ne=J?"immersive-ar":"immersive-vr";return Z=this.sceneEl.systems.webxr.sessionConfiguration,new Promise(function(At,St){navigator.xr.requestSession(Ne,Z).then(function(er){le.xrSession=er,ae.layersEnabled=Z.requiredFeatures.indexOf("layers")!==-1,ae.setSession(er),er.addEventListener("end",le.exitVRBound),it(At)},function(er){var zt=Ne==="immersive-ar",wt=zt?"AR":"VR";throw new Error("Failed to enter "+wt+" mode (`requestSession`) "+er)})})}else{if(j=m.device.getVRDisplay(),ae.setDevice(j),j.isPresenting&&!window.hasNativeWebVRImplementation)return it(),Promise.resolve();var We=this.getAttribute("renderer"),ke={highRefreshRate:We.highRefreshRate,foveationLevel:We.foveationLevel};return j.requestPresent([{source:this.canvas,attributes:ke}]).then(it,rt)}return it(),Promise.resolve();function it(At){var St;window.hasNativeWebVRImplementation&&!window.hasNativeWebXRImplementation&&(St=new CustomEvent("vrdisplaypresentchange",{detail:{display:m.device.getVRDisplay()}}),window.dispatchEvent(St)),J?le.addState("ar-mode"):le.addState("vr-mode"),le.emit("enter-vr",{target:le}),!M&&le.isMobile&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape"),le.addFullScreenStyles(),!le.isMobile&&!le.checkHeadsetConnected()&&re(le.canvas),le.renderer.setAnimationLoop(le.render),le.resize(),At&&At()}function rt(At){throw le.removeState("vr-mode"),At&&At.message?new Error("Failed to enter VR mode (`requestPresent`): "+At.message):new Error("Failed to enter VR mode (`requestPresent`).")}},writable:!0},exitVR:{value:function(){var J=this,le,j=this.renderer.xr;if(!this.is("vr-mode")&&!this.is("ar-mode"))return Promise.resolve("Not in immersive mode.");if(this.checkHeadsetConnected()||this.isMobile){if(j.enabled=!1,le=m.device.getVRDisplay(),this.hasWebXR)this.xrSession.removeEventListener("end",this.exitVRBound),this.xrSession.end().then(function(){},function(){}),this.xrSession=void 0,j.setSession(null);else if(le.isPresenting)return le.exitPresent().then(ae,Z)}else Y();return ae(),Promise.resolve();function ae(){J.removeState("vr-mode"),J.removeState("ar-mode"),J.isMobile&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),J.hasAttribute("embedded")&&J.removeFullScreenStyles(),J.resize(),J.isIOS&&m.forceCanvasResizeSafariMobile(J.canvas),J.renderer.setPixelRatio(window.devicePixelRatio),J.emit("exit-vr",{target:J})}function Z(ye){throw ye&&ye.message?new Error("Failed to exit VR mode (`exitPresent`): "+ye.message):new Error("Failed to exit VR mode (`exitPresent`).")}},writable:!0},pointerRestricted:{value:function(){if(this.canvas){var J=this.getPointerLockElement();J&&J!==this.canvas&&document.exitPointerLock&&document.exitPointerLock(),this.canvas.requestPointerLock&&this.canvas.requestPointerLock()}}},pointerUnrestricted:{value:function(){var J=this.getPointerLockElement();J&&J===this.canvas&&document.exitPointerLock&&document.exitPointerLock()}},onVRPresentChange:{value:function(J){var le=J.display||J.detail.display;if(le&&le.isPresenting){this.enterVR();return}this.exitVR()}},getAttribute:{value:function(J){var le=this.systems[J];return le?le.data:f.prototype.getAttribute.call(this,J)}},getComputedAttribute:{value:function(J){D("`getComputedAttribute` is deprecated. Use `getAttribute` instead."),this.getAttribute(J)}},getDOMAttribute:{value:function(J){var le=this.systems[J];return le?le.data:f.prototype.getDOMAttribute.call(this,J)}},setAttribute:{value:function(J,le,j){var ae=this.systems[J];if(ae){b.prototype.setAttribute.call(this,J,le),ae.updateProperties(le);return}f.prototype.setAttribute.call(this,J,le,j)}},removeBehavior:{value:function(J){var le,j,ae=this.behaviors,Z;for(j in ae)!J[j]||(le=this.behaviors[j],Z=le.indexOf(J),Z!==-1&&le.splice(Z,1))}},resize:{value:function(){var J=this.camera,le=this.canvas,j,ae,Z,ye=this.renderer.xr.isPresenting;ae=this.renderer.xr.enabled&&ye,!(!J||!le||this.is("vr-mode")&&(this.isMobile||ae))&&(j=this.getAttribute("embedded")&&!this.is("vr-mode"),Z=N(le,j,this.maxCanvasSize,this.is("vr-mode")),J.aspect=Z.width/Z.height,J.updateProjectionMatrix(),this.renderer.setSize(Z.width,Z.height,!1),this.emit("rendererresize",null,!1))},writable:!0},setupRenderer:{value:function(){var J=this,le,j,ae,Z;Z={alpha:!0,antialias:!L,canvas:this.canvas,logarithmicDepthBuffer:!1,powerPreference:"high-performance"},this.maxCanvasSize={height:1920,width:1920},this.hasAttribute("renderer")&&(ae=this.getAttribute("renderer"),j=m.styleParser.parse(ae),j.precision&&(Z.precision=j.precision+"p"),j.antialias&&j.antialias!=="auto"&&(Z.antialias=j.antialias==="true"),j.logarithmicDepthBuffer&&j.logarithmicDepthBuffer!=="auto"&&(Z.logarithmicDepthBuffer=j.logarithmicDepthBuffer==="true"),j.alpha&&(Z.alpha=j.alpha==="true"),this.maxCanvasSize={width:j.maxCanvasWidth?parseInt(j.maxCanvasWidth):this.maxCanvasSize.width,height:j.maxCanvasHeight?parseInt(j.maxCanvasHeight):this.maxCanvasSize.height}),le=this.renderer=new d.WebGLRenderer(Z),le.setPixelRatio(window.devicePixelRatio),le.sortObjects=!1,this.camera&&le.xr.setPoseTarget(this.camera.el.object3D),this.addEventListener("camera-set-active",function(){le.xr.setPoseTarget(J.camera.el.object3D)})},writable:window.debug},play:{value:function(){var J=this,le=this;if(this.renderStarted){f.prototype.play.call(this);return}this.addEventListener("loaded",function(){var j=this.renderer,ae,Z=this.renderer.xr;f.prototype.play.call(this),!le.renderStarted&&(le.resize(),le.renderer&&(window.performance&&window.performance.mark("render-started"),E.remove(),ae=m.device.getVRDisplay(),ae&&ae.isPresenting&&(Z.setDevice(ae),Z.enabled=!0,le.enterVR()),j.setAnimationLoop(this.render),le.renderStarted=!0,le.emit("renderstart")))}),setTimeout(function(){f.prototype.load.call(J)})}},updateComponent:{value:function(J){J in v||f.prototype.updateComponent.apply(this,arguments)}},tick:{value:function(J,le){var j,ae=this.systems;for(j=0;j<this.behaviors.tick.length;j++)!this.behaviors.tick[j].el.isPlaying||this.behaviors.tick[j].tick(J,le);for(j=0;j<this.systemNames.length;j++)!ae[this.systemNames[j]].tick||ae[this.systemNames[j]].tick(J,le)}},tock:{value:function(J,le,j){var ae,Z=this.systems;for(ae=0;ae<this.behaviors.tock.length;ae++)!this.behaviors.tock[ae].el.isPlaying||this.behaviors.tock[ae].tock(J,le,j);for(ae=0;ae<this.systemNames.length;ae++)!Z[this.systemNames[ae]].tock||Z[this.systemNames[ae]].tock(J,le,j)}},render:{value:function(J,le){var j=this.renderer;this.frame=le,this.delta=this.clock.getDelta()*1e3,this.time=this.clock.elapsedTime*1e3,this.isPlaying&&this.tick(this.time,this.delta);var ae=null;this.is("ar-mode")&&(ae=this.object3D.background,this.object3D.background=null),j.render(this.object3D,this.camera),ae&&(this.object3D.background=ae)},writable:!0}})});function N(J,le,j,ae){return J.parentElement?le?{height:J.parentElement.offsetHeight,width:J.parentElement.offsetWidth}:z(j,ae):{height:0,width:0}}function z(J,le){var j,ae,Z=window.devicePixelRatio;return ae={height:document.body.offsetHeight,width:document.body.offsetWidth},!J||le||J.width===-1&&J.height===-1||ae.width*Z<J.width&&ae.height*Z<J.height||(j=ae.width/ae.height,ae.width*Z>J.width&&J.width!==-1&&(ae.width=Math.round(J.width/Z),ae.height=Math.round(J.width/j/Z)),ae.height*Z>J.height&&J.height!==-1&&(ae.height=Math.round(J.height/Z),ae.width=Math.round(J.height*j/Z))),ae}function re(J){var le=J.requestFullscreen||J.webkitRequestFullscreen||J.mozRequestFullScreen||J.msRequestFullscreen;le.apply(J,[{navigationUI:"hide"}])}function Y(){var J=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement;!J||(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}function te(J){var le;le=document.createElement("canvas"),le.classList.add("a-canvas"),le.dataset.aframeCanvas=!0,J.appendChild(le),document.addEventListener("fullscreenchange",j),document.addEventListener("mozfullscreenchange",j),document.addEventListener("webkitfullscreenchange",j),document.addEventListener("MSFullscreenChange",j),le.addEventListener("touchmove",function(ae){ae.preventDefault()}),J.canvas=le,J.emit("render-target-loaded",{target:le}),setTimeout(y(J.resize,J),0);function j(){var ae=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;ae||J.exitVR(),document.activeElement.blur(),document.body.focus()}}G.exports.setupCanvas=te},{"../../lib/three":179,"../../utils/":205,"../../utils/ios-orientationchange-blank-bug":206,"../a-entity":127,"../a-node":129,"../a-register-element":130,"../system":142,"./loadingScreen":135,"./metaTags":136,"./postMessage":137,"./scenes":138,"./wakelock":139}],135:[function(_,G,fe){var u=_("../../utils/"),A=u.styleParser,E,w,h,v="loading-screen",d="a-loader-title";G.exports.setup=function(g,y){E=g,h=y;var x=E.hasAttribute(v)?A.parse(E.getAttribute(v)):void 0,L=x&&x.dotsColor||"white",M=x&&x.backgroundColor||"#24CAFF",R=x===void 0||x.enabled==="true"||x.enabled===void 0,D,N,z,re,Y,te,J,le,j,ae;!R||(D=new THREE.Scene,N=new THREE.SphereGeometry(.2,36,18,0,2*Math.PI,0,Math.PI),z=new THREE.MeshBasicMaterial({color:L}),re=new THREE.Mesh(N,z),Y=re.clone(),te=re.clone(),J=new THREE.PerspectiveCamera(80,window.innerWidth/window.innerHeight,5e-4,1e4),le=new THREE.Clock,j=0,ae=function(){E.renderer.render(D,J),j=le.getElapsedTime()%4,re.visible=j>=1,Y.visible=j>=2,te.visible=j>=3},D.background=new THREE.Color(M),D.add(J),re.position.set(-1,0,-15),Y.position.set(0,0,-15),te.position.set(1,0,-15),J.add(re),J.add(Y),J.add(te),f(),setTimeout(function(){E.hasLoaded||(m(J),w.style.display="block",window.addEventListener("resize",function(){m(J)}),E.renderer.setAnimationLoop(ae))},200))},G.exports.remove=function(){window.removeEventListener("resize",m),!!w&&(w.style.display="none")};function m(b){var g=E.hasAttribute("embedded"),y=h(E.canvas,g,E.maxCanvasSize,E.is("vr-mode"));b.aspect=y.width/y.height,b.updateProjectionMatrix(),E.renderer.setSize(y.width,y.height,!1)}function f(){w=document.createElement("div"),w.className=d,w.innerHTML=document.title,w.style.display="none",E.appendChild(w)}},{"../../utils/":205}],136:[function(_,G,fe){var u=_("../../constants/"),A=_("../../utils").extend,E=G.exports.MOBILE_HEAD_TAGS=[h({name:"viewport",content:"width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui,viewport-fit=cover"}),h({name:"mobile-web-app-capable",content:"yes"}),h({name:"theme-color",content:"black"})],w=[h({name:"apple-mobile-web-app-capable",content:"yes"}),h({name:"apple-mobile-web-app-status-bar-style",content:"black"}),v({rel:"apple-touch-icon",href:"https://aframe.io/images/aframe-logo-152.png"})];function h(m){return{tagName:"meta",attributes:m,exists:function(){return document.querySelector('meta[name="'+m.name+'"]')}}}function v(m){return{tagName:"link",attributes:m,exists:function(){return document.querySelector('link[rel="'+m.rel+'"]')}}}G.exports.inject=function(f){var b=document.head,g=b.querySelector("script"),y,x=[];return E.forEach(L),f.isIOS&&w.forEach(L),x;function L(M){!M||M.exists()||(y=d(M),!!y&&(g?g.parentNode.insertBefore(y,g):b.appendChild(y),x.push(y)))}};function d(m){if(!(!m||!m.tagName)){var f=document.createElement(m.tagName);return f.setAttribute(u.AFRAME_INJECTED,""),A(f,m.attributes)}}},{"../../constants/":123,"../../utils":205}],137:[function(_,G,fe){var u=_("../../utils/bind"),A=_("../../utils/").isIframed;G.exports=function(h){!A()||window.addEventListener("message",u(E,h))};function E(w){var h=this;if(!!w.data)switch(w.data.type){case"vr":switch(w.data.data){case"enter":h.enterVR();break;case"exit":h.exitVR();break}}}},{"../../utils/":205,"../../utils/bind":199}],138:[function(_,G,fe){G.exports=[]},{}],139:[function(_,G,fe){var u=_("../../../vendor/wakelock/wakelock");G.exports=function(E){if(!!E.isMobile){var w=E.wakelock=new u;E.addEventListener("enter-vr",function(){w.request()}),E.addEventListener("exit-vr",function(){w.release()})}}},{"../../../vendor/wakelock/wakelock":220}],140:[function(_,G,fe){var u=_("../utils/"),A=_("./propertyTypes"),E=u.debug,w=A.isValidDefaultValue,h=A.propertyTypes,v=E("core:schema:warn");function d(g){return"type"in g?typeof g.type=="string":"default"in g}G.exports.isSingleProperty=d,G.exports.process=function(g,y){var x;if(d(g))return m(g,y);for(x in g)g[x]=m(g[x],y);return g};function m(g,y){var x=g.default,L,M,R=g.type;return g.type?g.type==="bool"?R="boolean":g.type==="float"&&(R="number"):x!==void 0&&(typeof x=="boolean"||typeof x=="number")?R=typeof x:Array.isArray(x)?R="array":R="string",M=h[R],M||v("Unknown property type for component `"+y+"`: "+R),L=!!g.parse,g.parse=g.parse||M.parse,g.stringify=g.stringify||M.stringify,g.type=R,"default"in g?!L&&!w(R,x)&&v("Default value `"+x+"` does not match type `"+R+"` in component `"+y+"`"):g.default=M.default,g}G.exports.processPropertyDefinition=m,G.exports.parseProperties=function(){var g=[];return function(y,x,L,M,R){var D,N,z,re;g.length=0;for(N in L?y:x)L&&y[N]===void 0||g.push(N);if(y===null||typeof y!="object")return y;for(N in y)y[N]!==void 0&&!x[N]&&!R&&v("Unknown property `"+N+"` for component/system `"+M+"`.");for(D=0;D<g.length;D++){if(N=g[D],z=x[N],re=y[N],!x[N])return;y[N]=f(re,z)}return y}}();function f(g,y){return(g==null||g==="")&&(g=y.default,Array.isArray(g)&&(g=g.slice())),y.parse(g,y.default)}G.exports.parseProperty=f,G.exports.stringifyProperties=function(g,y){var x,L,M,R={},D;for(x in g)L=y[x],M=g[x],D=M,typeof D=="object"&&(D=b(M,L),L||v("Unknown component property: "+x)),R[x]=D;return R};function b(g,y){return typeof g!="object"?g:!y||g===null?JSON.stringify(g):y.stringify(g)}G.exports.stringifyProperty=b},{"../utils/":205,"./propertyTypes":133}],141:[function(_,G,fe){var u=_("./schema"),A=u.process,E=G.exports.shaders={},w=G.exports.shaderNames=[],h=_("../lib/three"),v=_("../utils"),d={array:"v3",color:"v3",int:"i",number:"f",map:"t",time:"f",vec2:"v2",vec3:"v3",vec4:"v4"},m=G.exports.Shader=function(){};m.prototype={schema:{},vertexShader:"void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",fragmentShader:"void main() {gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);}",init:function(f){return this.attributes=this.initVariables(f,"attribute"),this.uniforms=this.initVariables(f,"uniform"),this.material=new(this.raw?h.RawShaderMaterial:h.ShaderMaterial)({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader}),this.material},initVariables:function(f,b){var g,y=this.schema,x={},L;for(g in y)y[g].is===b&&(L=d[y[g].type],x[g]={type:L,value:void 0});return x},update:function(f){this.updateVariables(f,"attribute"),this.updateVariables(f,"uniform")},updateVariables:function(f,b){var g,y,x=this.schema,L;L=b==="uniform"?this.uniforms:this.attributes;for(g in f)if(!(!x[g]||x[g].is!==b)){if(x[g].type==="map"){if(!L[g]||L[g].value===f[g])continue;y="_texture_"+g,this.setMapOnTextureLoad(L,g,y),v.material.updateMapMaterialFromData(y,g,this,f);continue}L[g].value=this.parseValue(x[g].type,f[g]),L[g].needsUpdate=!0}},parseValue:function(f,b){var g;switch(f){case"vec2":return new h.Vector2(b.x,b.y);case"vec3":return new h.Vector3(b.x,b.y,b.z);case"vec4":return new h.Vector4(b.x,b.y,b.z,b.w);case"color":return g=new h.Color(b),new h.Vector3(g.r,g.g,g.b);case"map":return h.ImageUtils.loadTexture(b);default:return b}},setMapOnTextureLoad:function(f,b,g){var y=this;this.el.addEventListener("materialtextureloaded",function(){f[b].value=y.material[g],f[b].needsUpdate=!0})}},G.exports.registerShader=function(f,b){var g,y={};if(Object.keys(b).forEach(function(x){y[x]={value:b[x],writable:!0}}),E[f])throw new Error("The shader "+f+" has been already registered");return g=function(){m.call(this)},g.prototype=Object.create(m.prototype,y),g.prototype.name=f,g.prototype.constructor=g,E[f]={Shader:g,schema:A(g.prototype.schema)},w.push(f),g}},{"../lib/three":179,"../utils":205,"./schema":140}],142:[function(_,G,fe){var u=_("./component"),A=_("./schema"),E=_("../utils/"),w=A.parseProperties,h=A.parseProperty,v=A.process,d=A.isSingleProperty,m=E.styleParser,f=G.exports.systems={},b=G.exports.System=function(g){var y=u&&u.components[this.name];this.el=g,this.sceneEl=g,y&&(y.Component.prototype.system=this),this.buildData(),this.init(),this.update({})};b.prototype={schema:{},init:function(){},update:function(g){},updateProperties:function(g){var y=this.data;!Object.keys(A).length||(this.buildData(g),this.update(y))},buildData:function(g){var y=this.schema;!Object.keys(y).length||(g=g||window.HTMLElement.prototype.getAttribute.call(this.sceneEl,this.name),d(y)?this.data=h(g,y):this.data=w(m.parse(g)||{},y))},tick:void 0,tock:void 0,play:function(){},pause:function(){}},G.exports.registerSystem=function(g,y){var x,L,M={},R=E.findAllScenes(document);if(Object.keys(y).forEach(function(D){M[D]={value:y[D],writable:!0}}),f[g])throw new Error("The system `"+g+"` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name.");for(L=function(D){b.call(this,D)},L.prototype=Object.create(b.prototype,M),L.prototype.name=g,L.prototype.constructor=L,L.prototype.schema=E.extend(v(L.prototype.schema)),f[g]=L,x=0;x<R.length;x++)R[x].initSystem(g)}},{"../utils/":205,"./component":131,"./schema":140}],143:[function(_,G,fe){_("./pivot")},{"./pivot":144}],144:[function(_,G,fe){var u=_("../../core/component").registerComponent,A=_("../../lib/three"),E=new A.Vector3,w=new A.Vector3;u("pivot",{dependencies:["position"],schema:{type:"vec3"},init:function(){var h=this.data,v=this.el,d=v.object3D.parent,m=v.object3D,f=new A.Group;E.copy(m.position),w.copy(m.rotation),d.remove(m),f.add(m),d.add(f),v.object3D=f,m.position.set(-1*h.x,-1*h.y,-1*h.z),f.position.set(h.x+E.x,h.y+E.y,h.z+E.z),f.rotation.copy(m.rotation),m.rotation.set(0,0,0)}})},{"../../core/component":131,"../../lib/three":179}],145:[function(_,G,fe){var u=_("../../core/component").components,A=_("../../core/shader").shaders,E=_("../../utils/"),w={};Object.keys(u.material.schema).forEach(h),Object.keys(A.standard.schema).forEach(h);function h(v){var d=v.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();v==="fog"&&(d="material-fog"),v==="visible"&&(d="material-visible"),w[d]="material."+v}G.exports=function(){return{defaultComponents:{material:{}},mappings:E.extend({},w)}}},{"../../core/component":131,"../../core/shader":141,"../../utils/":205}],146:[function(_,G,fe){_("./primitives/a-camera"),_("./primitives/a-cursor"),_("./primitives/a-curvedimage"),_("./primitives/a-gltf-model"),_("./primitives/a-image"),_("./primitives/a-light"),_("./primitives/a-link"),_("./primitives/a-obj-model"),_("./primitives/a-sky"),_("./primitives/a-sound"),_("./primitives/a-text"),_("./primitives/a-video"),_("./primitives/a-videosphere"),_("./primitives/meshPrimitives")},{"./primitives/a-camera":148,"./primitives/a-cursor":149,"./primitives/a-curvedimage":150,"./primitives/a-gltf-model":151,"./primitives/a-image":152,"./primitives/a-light":153,"./primitives/a-link":154,"./primitives/a-obj-model":155,"./primitives/a-sky":156,"./primitives/a-sound":157,"./primitives/a-text":158,"./primitives/a-video":159,"./primitives/a-videosphere":160,"./primitives/meshPrimitives":161}],147:[function(_,G,fe){var u=_("../../core/a-entity"),A=_("../../core/component").components,E=_("../../core/a-register-element").registerElement,w=_("../../utils/"),h=w.debug,v=w.entity.setComponentProperty,d=h("extras:primitives:debug"),m=h("extras:primitives:warn"),f=G.exports.primitives={};G.exports.registerPrimitive=function(x,L){x=x.toLowerCase(),d("Registering <%s>",x),L.defaultAttributes&&m("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.");var M=E(x,{prototype:Object.create(u.prototype,{defaultComponentsFromPrimitive:{value:L.defaultComponents||L.defaultAttributes||{}},deprecated:{value:L.deprecated||null},deprecatedMappings:{value:L.deprecatedMappings||{}},mappings:{value:L.mappings||{}},createdCallback:{value:function(){L.deprecated&&console.warn(L.deprecated),this.resolveMappingCollisions()}},resolveMappingCollisions:{value:function(){var R=this.mappings,D=this;Object.keys(R).forEach(function(z){var re;z!==z.toLowerCase()&&m("Mapping keys should be specified in lower case. The mapping key "+z+" may not be recognized"),A[z]&&(re=R[z].replace(".","-"),R[re]=R[z],delete R[z],console.warn("The primitive "+D.tagName.toLowerCase()+" has a mapping collision. The attribute "+z+" has the same name as a registered component and has been renamed to "+re))})}},getExtraComponents:{value:function(){var R,D,N,z,re,Y,te=this;for(D=w.clone(this.defaultComponentsFromPrimitive),re=this.getAttribute("mixin"),re&&(re=re.trim().split(" "),re.forEach(function(ye){var Ne=te.sceneEl.querySelector("#"+ye).componentCache;Object.keys(Ne).forEach(function(ke){D[ke]=J(D[ke],Ne[ke])})})),N=0;N<this.attributes.length;N++)if(R=this.attributes[N],z=this.mappings[R.name],z){Y=w.entity.getComponentPropertyPath(z),Y.constructor===Array?(D[Y[0]]=D[Y[0]]||{},D[Y[0]][Y[1]]=R.value.trim()):D[Y]=R.value.trim();continue}return D;function J(Z,ye){return le(Z)?j(ye):le(ye)?j(Z):ae(Z)&&ae(ye)?w.extendDeep(Z,ye):j(ye)}function le(Z){return typeof Z=="undefined"}function j(Z){return ae(Z)?w.extendDeep({},Z):Z}function ae(Z){return Z!==null&&Z.constructor===Object}}},attributeChangedCallback:{value:function(R,D,N){var z=this.mappings[R];R in this.deprecatedMappings&&console.warn(this.deprecatedMappings[R]),!(!R||!z)&&v(this,z,N)}}})});return f[x]=M,M};function b(y,x){var L=A[y].schema;Object.keys(L).map(function(M){var R=M.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();x[R]!==void 0&&(R=y+"-"+M),x[R]=y+"."+M})}function g(y,x,L){L=L||{},Object.keys(x).map(function(R){b(R,L)}),G.exports.registerPrimitive(y,w.extendDeep({},null,{defaultComponents:x,mappings:L}))}G.exports.definePrimitive=g},{"../../core/a-entity":127,"../../core/a-register-element":130,"../../core/component":131,"../../utils/":205}],148:[function(_,G,fe){var u=_("../primitives").registerPrimitive;u("a-camera",{defaultComponents:{camera:{},"look-controls":{},"wasd-controls":{},position:{x:0,y:1.6,z:0}},mappings:{active:"camera.active",far:"camera.far",fov:"camera.fov","look-controls-enabled":"look-controls.enabled",near:"camera.near","pointer-lock-enabled":"look-controls.pointerLockEnabled","wasd-controls-enabled":"wasd-controls.enabled","reverse-mouse-drag":"look-controls.reverseMouseDrag",zoom:"camera.zoom"}})},{"../primitives":147}],149:[function(_,G,fe){var u=_("../getMeshMixin"),A=_("../primitives").registerPrimitive,E=_("../../../utils/");A("a-cursor",E.extendDeep({},u(),{defaultComponents:{cursor:{},geometry:{primitive:"ring",radiusOuter:.016,radiusInner:.01,segmentsTheta:32},material:{color:"#000",shader:"flat",opacity:.8},position:{x:0,y:0,z:-1}},mappings:{far:"raycaster.far",fuse:"cursor.fuse","fuse-timeout":"cursor.fuseTimeout",interval:"raycaster.interval",objects:"raycaster.objects"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],150:[function(_,G,fe){var u=_("../getMeshMixin"),A=_("../primitives").registerPrimitive,E=_("../../../utils/");A("a-curvedimage",E.extendDeep({},u(),{defaultComponents:{geometry:{height:1,primitive:"cylinder",radius:2,segmentsRadial:48,thetaLength:270,openEnded:!0,thetaStart:0},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0,repeat:"-1 1"}},mappings:{height:"geometry.height","open-ended":"geometry.openEnded",radius:"geometry.radius",segments:"geometry.segmentsRadial",start:"geometry.thetaStart","theta-length":"geometry.thetaLength","theta-start":"geometry.thetaStart",width:"geometry.thetaLength"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],151:[function(_,G,fe){var u=_("../primitives").registerPrimitive;u("a-gltf-model",{mappings:{src:"gltf-model"}})},{"../primitives":147}],152:[function(_,G,fe){var u=_("../getMeshMixin"),A=_("../primitives").registerPrimitive,E=_("../../../utils/");A("a-image",E.extendDeep({},u(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],153:[function(_,G,fe){var u=_("../primitives").registerPrimitive;u("a-light",{defaultComponents:{light:{}},mappings:{angle:"light.angle",color:"light.color","ground-color":"light.groundColor",decay:"light.decay",distance:"light.distance",intensity:"light.intensity",penumbra:"light.penumbra",type:"light.type",target:"light.target"}})},{"../primitives":147}],154:[function(_,G,fe){var u=_("../primitives").registerPrimitive;u("a-link",{defaultComponents:{link:{visualAspectEnabled:!0}},mappings:{href:"link.href",image:"link.image",title:"link.title"}})},{"../primitives":147}],155:[function(_,G,fe){var u=_("../getMeshMixin")(),A=_("../primitives").registerPrimitive,E=_("../../../utils/");A("a-obj-model",E.extendDeep({},u,{defaultComponents:{"obj-model":{}},mappings:{src:"obj-model.obj",mtl:"obj-model.mtl"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],156:[function(_,G,fe){var u=_("../getMeshMixin"),A=_("../primitives").registerPrimitive,E=_("../../../utils/"),w=_("./meshPrimitives");A("a-sky",E.extendDeep({},u(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",side:"back",shader:"flat",npot:!0},scale:"-1 1 1"},mappings:E.extendDeep({},w["a-sphere"].prototype.mappings)}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147,"./meshPrimitives":161}],157:[function(_,G,fe){var u=_("../primitives").registerPrimitive;u("a-sound",{defaultComponents:{sound:{}},mappings:{src:"sound.src",on:"sound.on",autoplay:"sound.autoplay",loop:"sound.loop",volume:"sound.volume"}})},{"../primitives":147}],158:[function(_,G,fe){var u=_("../primitives").definePrimitive;u("a-text",{text:{anchor:"align",width:5}})},{"../primitives":147}],159:[function(_,G,fe){var u=_("../getMeshMixin"),A=_("../primitives").registerPrimitive,E=_("../../../utils/");A("a-video",E.extendDeep({},u(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],160:[function(_,G,fe){var u=_("../getMeshMixin"),A=_("../primitives").registerPrimitive,E=_("../../../utils/");A("a-videosphere",E.extendDeep({},u(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",side:"back",npot:!0},scale:"-1 1 1"},mappings:{radius:"geometry.radius","segments-height":"geometry.segmentsHeight","segments-width":"geometry.segmentsWidth"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],161:[function(_,G,fe){var u=_("../getMeshMixin"),A=_("../../../core/geometry").geometries,E=_("../../../core/geometry").geometryNames,w=_("../primitives").registerPrimitive,h=_("../../../utils/"),v=G.exports={};E.forEach(function(f){var b=A[f],g=d(f),y={};Object.keys(b.schema).forEach(function(R){y[d(R)]="geometry."+R});var x="a-"+g,L=w(x,h.extendDeep({},u(),{defaultComponents:{geometry:{primitive:f}},mappings:y}));v[x]=L});function d(m){return m.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},{"../../../core/geometry":132,"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],162:[function(_,G,fe){var u=_("../core/geometry").registerGeometry,A=_("../lib/three");u("box",{schema:{depth:{default:1,min:0},height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"},segmentsDepth:{default:1,min:1,max:20,type:"int"}},init:function(E){this.geometry=new A.BoxGeometry(E.width,E.height,E.depth,E.segmentsWidth,E.segmentsHeight,E.segmentsDepth)}})},{"../core/geometry":132,"../lib/three":179}],163:[function(_,G,fe){var u=_("../core/geometry").registerGeometry,A=_("../lib/three"),E=A.Math.degToRad;u("circle",{schema:{radius:{default:1,min:0},segments:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(w){this.geometry=new A.CircleGeometry(w.radius,w.segments,E(w.thetaStart),E(w.thetaLength))}})},{"../core/geometry":132,"../lib/three":179}],164:[function(_,G,fe){var u=_("../core/geometry").registerGeometry,A=_("../lib/three"),E=A.Math.degToRad;u("cone",{schema:{height:{default:1,min:0},openEnded:{default:!1},radiusBottom:{default:1,min:0},radiusTop:{default:.01,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(w){this.geometry=new A.CylinderGeometry(w.radiusTop,w.radiusBottom,w.height,w.segmentsRadial,w.segmentsHeight,w.openEnded,E(w.thetaStart),E(w.thetaLength))}})},{"../core/geometry":132,"../lib/three":179}],165:[function(_,G,fe){var u=_("../core/geometry").registerGeometry,A=_("../lib/three"),E=A.Math.degToRad;u("cylinder",{schema:{height:{default:1,min:0},openEnded:{default:!1},radius:{default:1,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(w){this.geometry=new A.CylinderGeometry(w.radius,w.radius,w.height,w.segmentsRadial,w.segmentsHeight,w.openEnded,E(w.thetaStart),E(w.thetaLength))}})},{"../core/geometry":132,"../lib/three":179}],166:[function(_,G,fe){var u=_("../core/geometry").registerGeometry,A=_("../lib/three");u("dodecahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(E){this.geometry=new A.DodecahedronGeometry(E.radius,E.detail)}})},{"../core/geometry":132,"../lib/three":179}],167:[function(_,G,fe){var u=_("../core/geometry").registerGeometry,A=_("../lib/three");u("icosahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(E){this.geometry=new A.IcosahedronGeometry(E.radius,E.detail)}})},{"../core/geometry":132,"../lib/three":179}],168:[function(_,G,fe){_("./box.js"),_("./circle.js"),_("./cone.js"),_("./cylinder.js"),_("./dodecahedron.js"),_("./icosahedron.js"),_("./octahedron.js"),_("./plane.js"),_("./ring.js"),_("./sphere.js"),_("./tetrahedron.js"),_("./torus.js"),_("./torusKnot.js"),_("./triangle.js")},{"./box.js":162,"./circle.js":163,"./cone.js":164,"./cylinder.js":165,"./dodecahedron.js":166,"./icosahedron.js":167,"./octahedron.js":169,"./plane.js":170,"./ring.js":171,"./sphere.js":172,"./tetrahedron.js":173,"./torus.js":174,"./torusKnot.js":175,"./triangle.js":176}],169:[function(_,G,fe){var u=_("../core/geometry").registerGeometry,A=_("../lib/three");u("octahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(E){this.geometry=new A.OctahedronGeometry(E.radius,E.detail)}})},{"../core/geometry":132,"../lib/three":179}],170:[function(_,G,fe){var u=_("../core/geometry").registerGeometry,A=_("../lib/three");u("plane",{schema:{height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"}},init:function(E){this.geometry=new A.PlaneGeometry(E.width,E.height,E.segmentsWidth,E.segmentsHeight)}})},{"../core/geometry":132,"../lib/three":179}],171:[function(_,G,fe){var u=_("../core/geometry").registerGeometry,A=_("../lib/three"),E=A.Math.degToRad;u("ring",{schema:{radiusInner:{default:.8,min:0},radiusOuter:{default:1.2,min:0},segmentsPhi:{default:10,min:1,type:"int"},segmentsTheta:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(w){this.geometry=new A.RingGeometry(w.radiusInner,w.radiusOuter,w.segmentsTheta,w.segmentsPhi,E(w.thetaStart),E(w.thetaLength))}})},{"../core/geometry":132,"../lib/three":179}],172:[function(_,G,fe){var u=_("../core/geometry").registerGeometry,A=_("../lib/three"),E=A.Math.degToRad;u("sphere",{schema:{radius:{default:1,min:0},phiLength:{default:360},phiStart:{default:0,min:0},thetaLength:{default:180,min:0},thetaStart:{default:0},segmentsHeight:{default:18,min:2,type:"int"},segmentsWidth:{default:36,min:3,type:"int"}},init:function(w){this.geometry=new A.SphereGeometry(w.radius,w.segmentsWidth,w.segmentsHeight,E(w.phiStart),E(w.phiLength),E(w.thetaStart),E(w.thetaLength))}})},{"../core/geometry":132,"../lib/three":179}],173:[function(_,G,fe){var u=_("../core/geometry").registerGeometry,A=_("../lib/three");u("tetrahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(E){this.geometry=new A.TetrahedronGeometry(E.radius,E.detail)}})},{"../core/geometry":132,"../lib/three":179}],174:[function(_,G,fe){var u=_("../core/geometry").registerGeometry,A=_("../lib/three"),E=A.Math.degToRad;u("torus",{schema:{arc:{default:360},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:36,min:2,type:"int"},segmentsTubular:{default:32,min:3,type:"int"}},init:function(w){this.geometry=new A.TorusGeometry(w.radius,w.radiusTubular*2,w.segmentsRadial,w.segmentsTubular,E(w.arc))}})},{"../core/geometry":132,"../lib/three":179}],175:[function(_,G,fe){var u=_("../core/geometry").registerGeometry,A=_("../lib/three");u("torusKnot",{schema:{p:{default:2,min:1},q:{default:3,min:1},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:8,min:3,type:"int"},segmentsTubular:{default:100,min:3,type:"int"}},init:function(E){this.geometry=new A.TorusKnotGeometry(E.radius,E.radiusTubular*2,E.segmentsTubular,E.segmentsRadial,E.p,E.q)}})},{"../core/geometry":132,"../lib/three":179}],176:[function(_,G,fe){var u=_("../core/geometry").registerGeometry,A=_("../lib/three"),E=new A.Quaternion,w=new A.Vector3(0,0,1),h=new A.Vector2,v=new A.Vector2,d=new A.Vector2;u("triangle",{schema:{vertexA:{type:"vec3",default:{x:0,y:.5,z:0}},vertexB:{type:"vec3",default:{x:-.5,y:-.5,z:0}},vertexC:{type:"vec3",default:{x:.5,y:-.5,z:0}}},init:function(m){var f,b,g,y,x,L,M,R,D;g=new A.Triangle,g.a.set(m.vertexA.x,m.vertexA.y,m.vertexA.z),g.b.set(m.vertexB.x,m.vertexB.y,m.vertexB.z),g.c.set(m.vertexC.x,m.vertexC.y,m.vertexC.z),b=g.getNormal(new A.Vector3),E.setFromUnitVectors(b,w),y=g.a.clone().applyQuaternion(E),x=g.b.clone().applyQuaternion(E),L=g.c.clone().applyQuaternion(E),h.set(Math.min(y.x,x.x,L.x),Math.min(y.y,x.y,L.y)),v.set(Math.max(y.x,x.x,L.x),Math.max(y.y,x.y,L.y)),d.set(0,0).subVectors(v,h),y=new A.Vector2().subVectors(y,h).divide(d),x=new A.Vector2().subVectors(x,h).divide(d),L=new A.Vector2().subVectors(L,h).divide(d),f=this.geometry=new A.BufferGeometry,M=[g.a.x,g.a.y,g.a.z,g.b.x,g.b.y,g.b.z,g.c.x,g.c.y,g.c.z],R=[b.x,b.y,b.z,b.x,b.y,b.z,b.x,b.y,b.z],D=[y.x,y.y,x.x,x.y,L.x,L.y],f.setAttribute("position",new A.Float32BufferAttribute(M,3)),f.setAttribute("normal",new A.Float32BufferAttribute(R,3)),f.setAttribute("uv",new A.Float32BufferAttribute(D,2))}})},{"../core/geometry":132,"../lib/three":179}],177:[function(_,G,fe){if(window.Promise=window.Promise||_("promise-polyfill"),window.hasNativeWebVRImplementation=!!window.navigator.getVRDisplays||!!window.navigator.getVRDevices,window.hasNativeWebXRImplementation=navigator.xr!==void 0,!window.hasNativeWebXRImplementation&&!window.hasNativeWebVRImplementation){var u=_("./utils/isIOSOlderThan10"),A=u(window.navigator.userAgent)?1/window.devicePixelRatio:1,E=_("webvr-polyfill"),w={BUFFER_SCALE:A,CARDBOARD_UI_DISABLED:!0,ROTATE_INSTRUCTIONS_DISABLED:!0,MOBILE_WAKE_LOCK:!!window.cordova};window.webvrpolyfill=new E(w)}var h=_("./utils/"),v=h.debug;h.isIE11&&(_("custom-event-polyfill"),_("../vendor/starts-with-polyfill"));var d=v("A-Frame:error"),m=v("A-Frame:warn");window.document.currentScript&&window.document.currentScript.parentNode!==window.document.head&&!window.debug&&m("Put the A-Frame <script> tag in the <head> of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML."),!window.cordova&&window.location.protocol==="file:"&&d("This HTML file is currently being served via the file:// protocol. Assets, textures, and models WILL NOT WORK due to cross-origin policy! Please use a local or hosted server: https://aframe.io/docs/0.5.0/introduction/getting-started.html#using-a-local-server."),_("present"),h.device.isBrowserEnvironment&&(_("./style/aframe.css"),_("./style/rStats.css"));var f=_("./core/scene/a-scene").AScene,b=_("./core/component").components,g=_("./core/component").registerComponent,y=_("./core/geometry").registerGeometry,x=_("./extras/primitives/primitives").registerPrimitive,L=_("./core/shader").registerShader,M=_("./core/system").registerSystem,R=_("./core/shader").shaders,D=_("./core/system").systems,N=window.THREE=_("./lib/three"),z=_("../package");_("./components/index"),_("./geometries/index"),_("./shaders/index"),_("./systems/index");var re=_("./core/a-node"),Y=_("./core/a-entity");_("./core/a-assets"),_("./core/a-cubemap"),_("./core/a-mixin"),_("./extras/components/"),_("./extras/primitives/"),console.log("A-Frame Version: 1.2.0 (Date 2021-02-05, Commit #b220fa00)"),console.log("THREE Version (https://github.com/supermedium/three.js):",z.dependencies["super-three"]),console.log("WebVR Polyfill Version:",z.dependencies["webvr-polyfill"]),G.exports=window.AFRAME={AComponent:_("./core/component").Component,AEntity:Y,ANode:re,ANIME:_("super-animejs"),AScene:f,components:b,coreComponents:Object.keys(b),geometries:_("./core/geometry").geometries,registerComponent:g,registerElement:_("./core/a-register-element").registerElement,registerGeometry:y,registerPrimitive:x,registerShader:L,registerSystem:M,primitives:{getMeshMixin:_("./extras/primitives/getMeshMixin"),primitives:_("./extras/primitives/primitives").primitives},scenes:_("./core/scene/scenes"),schema:_("./core/schema"),shaders:R,systems:D,THREE:N,utils:h,version:z.version}},{"../package":73,"../vendor/starts-with-polyfill":218,"./components/index":84,"./core/a-assets":125,"./core/a-cubemap":126,"./core/a-entity":127,"./core/a-mixin":128,"./core/a-node":129,"./core/a-register-element":130,"./core/component":131,"./core/geometry":132,"./core/scene/a-scene":134,"./core/scene/scenes":138,"./core/schema":140,"./core/shader":141,"./core/system":142,"./extras/components/":143,"./extras/primitives/":146,"./extras/primitives/getMeshMixin":145,"./extras/primitives/primitives":147,"./geometries/index":168,"./lib/three":179,"./shaders/index":181,"./style/aframe.css":186,"./style/rStats.css":187,"./systems/index":191,"./utils/":205,"./utils/isIOSOlderThan10":208,"custom-event-polyfill":7,present:48,"promise-polyfill":50,"super-animejs":56,"webvr-polyfill":68}],178:[function(_,G,fe){window.aframeStats=function(u){var A=null,E=u,w={te:{caption:"Entities"},lt:{caption:"Load Time"}},h=[{caption:"A-Frame",values:["te","lt"]}];function v(){A("te").set(d()),window.performance.getEntriesByName&&A("lt").set(window.performance.getEntriesByName("render-started")[0].startTime.toFixed(0))}function d(){var g=E.querySelectorAll("*");return Array.prototype.slice.call(g).filter(function(y){return y.isEntity}),g.length}function m(){}function f(){}function b(g){A=g}return{update:v,start:m,end:f,attach:b,values:w,groups:h,fractions:[]}},typeof G=="object"&&(G.exports={aframeStats:window.aframeStats})},{}],179:[function(_,G,fe){(function(u){var A=u.THREE=_("super-three");A.TextureLoader&&(A.TextureLoader.prototype.crossOrigin="anonymous"),A.ImageLoader&&(A.ImageLoader.prototype.crossOrigin="anonymous"),A.Cache&&(A.Cache.enabled=!0),_("../../vendor/DeviceOrientationControls"),_("super-three/examples/js/loaders/DRACOLoader"),_("super-three/examples/js/loaders/GLTFLoader"),_("super-three/examples/js/loaders/OBJLoader"),_("super-three/examples/js/loaders/MTLLoader"),_("super-three/examples/js/utils/BufferGeometryUtils"),A.DRACOLoader.prototype.crossOrigin="anonymous",A.GLTFLoader.prototype.crossOrigin="anonymous",A.MTLLoader.prototype.crossOrigin="anonymous",A.OBJLoader.prototype.crossOrigin="anonymous",G.exports=A}).call(this,typeof da!="undefined"?da:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"../../vendor/DeviceOrientationControls":215,"super-three":57,"super-three/examples/js/loaders/DRACOLoader":58,"super-three/examples/js/loaders/GLTFLoader":59,"super-three/examples/js/loaders/MTLLoader":60,"super-three/examples/js/loaders/OBJLoader":61,"super-three/examples/js/utils/BufferGeometryUtils":62}],180:[function(_,G,fe){var u=_("../core/shader").registerShader,A=_("../lib/three"),E=_("../utils/");G.exports.Shader=u("flat",{schema:{color:{type:"color"},fog:{default:!0},height:{default:256},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(h){this.rendererSystem=this.el.sceneEl.systems.renderer,this.materialData={color:new A.Color},this.textureSrc=null,w(h,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.material=new A.MeshBasicMaterial(this.materialData),E.material.updateMap(this,h)},update:function(h){this.updateMaterial(h),E.material.updateMap(this,h)},updateMaterial:function(h){var v;w(h,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color);for(v in this.materialData)this.material[v]=this.materialData[v]}});function w(h,v){return v.color.set(h.color),v.fog=h.fog,v.wireframe=h.wireframe,v.wireframeLinewidth=h.wireframeLinewidth,v}},{"../core/shader":141,"../lib/three":179,"../utils/":205}],181:[function(_,G,fe){_("./flat"),_("./standard"),_("./sdf"),_("./msdf"),_("./ios10hls")},{"./flat":180,"./ios10hls":182,"./msdf":183,"./sdf":184,"./standard":185}],182:[function(_,G,fe){var u=_("../core/shader").registerShader;G.exports.Shader=u("ios10hls",{schema:{src:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},vertexShader:["varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),fragmentShader:["uniform sampler2D src;","uniform float opacity;","varying vec2 vUV;","void main() {","  vec2 offset = vec2(0, 0);","  vec2 repeat = vec2(1, 1);","  vec4 color = texture2D(src, vec2(vUV.x / repeat.x + offset.x, (1.0 - vUV.y) / repeat.y + offset.y)).bgra;","  gl_FragColor = vec4(color.rgb, opacity);","}"].join(`
`)})},{"../core/shader":141}],183:[function(_,G,fe){var u=_("../core/shader").registerShader,A=!!document.createElement("canvas").getContext("webgl2"),E=["attribute vec2 uv;","attribute vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),w=["#version 300 es","in vec2 uv;","in vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","out vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),h=A?w:E,v=["#ifdef GL_OES_standard_derivatives","#extension GL_OES_standard_derivatives: enable","#endif","precision highp float;","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 sampleColor = texture2D(map, vUV).rgb;","  if (negate) { sampleColor = 1.0 - sampleColor; }","  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color.xyz, alpha * opacity);","}"].join(`
`),d=["#version 300 es","precision highp float;","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","out vec4 fragColor;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 sampleColor = texture(map, vUV).rgb;","  if (negate) { sampleColor = 1.0 - sampleColor; }","  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  fragColor = vec4(color.xyz, alpha * opacity);","}"].join(`
`),m=A?d:v;G.exports.Shader=u("msdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},negate:{type:"boolean",is:"uniform",default:!0},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:h,fragmentShader:m})},{"../core/shader":141}],184:[function(_,G,fe){var u=_("../core/shader").registerShader;G.exports.Shader=u("sdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:["#version 300 es","in vec2 uv;","in vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","out vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),fragmentShader:["#version 300 es","precision highp float;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","out vec4 fragColor;","#ifdef GL_OES_standard_derivatives","  float contour(float width, float value) {","    return smoothstep(0.5 - value, 0.5 + value, width);","  }","#else","  float aastep(float value, float afwidth) {","    return smoothstep(0.5 - afwidth, 0.5 + afwidth, value);","  }","#endif","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","#define ALL_SMOOTH 0.4","#define ALL_ROUGH 0.02","#define DISCARD_ALPHA (alphaTest / (2.2 - 1.2 * ratio))","void main() {","  #ifdef GL_OES_standard_derivatives","    vec2 uv = vUV;","    vec4 texColor = texture(map, uv);","    float dist = texColor.a;","    float width = fwidth(dist);","    float alpha = contour(dist, width);","    float dscale = 0.353505;","    vec2 duv = dscale * (dFdx(uv) + dFdy(uv));","    float isBigEnough = max(abs(duv.x), abs(duv.y));","    if (isBigEnough > BIG_ENOUGH) {","      float ratio = BIG_ENOUGH / isBigEnough;","      alpha = ratio * alpha + (1.0 - ratio) * dist;","    }","    if (isBigEnough <= BIG_ENOUGH) {","      vec4 box = vec4 (uv - duv, uv + duv);","      alpha = (alpha + 0.5 * (","        contour(texture(map, box.xy).a, width)","        + contour(texture(map, box.zw).a, width)","        + contour(texture(map, box.xw).a, width)","        + contour(texture(map, box.zy).a, width)","      )) / 3.0;","    }","    if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  #else","    vec4 texColor = texture(map, vUV);","    float value = texColor.a;","    float afwidth = (1.0 / 32.0) * (1.4142135623730951 / (2.0 * gl_FragCoord.w));","    float alpha = aastep(value, afwidth);","    float ratio = (gl_FragCoord.w >= ALL_SMOOTH) ? 1.0 : (gl_FragCoord.w < ALL_ROUGH) ? 0.0 : (gl_FragCoord.w - ALL_ROUGH) / (ALL_SMOOTH - ALL_ROUGH);","    if (alpha < alphaTest) { if (ratio >= 1.0) { discard; return; } alpha = 0.0; }","    alpha = alpha * ratio + (1.0 - ratio) * value;","    if (ratio < 1.0 && alpha <= DISCARD_ALPHA) { discard; return; }","  #endif","  fragColor = vec4(color, opacity * alpha);","}"].join(`
`)})},{"../core/shader":141}],185:[function(_,G,fe){var u=_("../core/shader").registerShader,A=_("../lib/three"),E=_("../utils/"),w=new A.CubeTextureLoader,h={};G.exports.Shader=u("standard",{schema:{ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},ambientOcclusionTextureOffset:{type:"vec2"},ambientOcclusionTextureRepeat:{type:"vec2",default:{x:1,y:1}},color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},emissive:{type:"color",default:"#000"},emissiveIntensity:{default:1},envMap:{default:""},fog:{default:!0},height:{default:256},metalness:{default:0,min:0,max:1},metalnessMap:{type:"map"},metalnessTextureOffset:{type:"vec2"},metalnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},roughness:{default:.5,min:0,max:1},roughnessMap:{type:"map"},roughnessTextureOffset:{type:"vec2"},roughnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},sphericalEnvMap:{type:"map"},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(d){this.rendererSystem=this.el.sceneEl.systems.renderer,this.materialData={color:new A.Color,emissive:new A.Color},v(d,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.rendererSystem.applyColorCorrection(this.materialData.emissive),this.material=new A.MeshStandardMaterial(this.materialData),E.material.updateMap(this,d),d.normalMap&&E.material.updateDistortionMap("normal",this,d),d.displacementMap&&E.material.updateDistortionMap("displacement",this,d),d.ambientOcclusionMap&&E.material.updateDistortionMap("ambientOcclusion",this,d),d.metalnessMap&&E.material.updateDistortionMap("metalness",this,d),d.roughnessMap&&E.material.updateDistortionMap("roughness",this,d),this.updateEnvMap(d)},update:function(d){this.updateMaterial(d),E.material.updateMap(this,d),d.normalMap&&E.material.updateDistortionMap("normal",this,d),d.displacementMap&&E.material.updateDistortionMap("displacement",this,d),d.ambientOcclusionMap&&E.material.updateDistortionMap("ambientOcclusion",this,d),d.metalnessMap&&E.material.updateDistortionMap("metalness",this,d),d.roughnessMap&&E.material.updateDistortionMap("roughness",this,d),this.updateEnvMap(d)},updateMaterial:function(d){var m,f=this.material;v(d,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.rendererSystem.applyColorCorrection(this.materialData.emissive);for(m in this.materialData)f[m]=this.materialData[m]},updateEnvMap:function(d){var m=this,f=this.material,b=d.envMap,g=d.sphericalEnvMap;if(!b&&!g||this.isLoadingEnvMap){f.envMap=null,f.needsUpdate=!0;return}if(this.isLoadingEnvMap=!0,g){this.el.sceneEl.systems.material.loadTexture(g,{src:g},function(x){m.isLoadingEnvMap=!1,x.mapping=A.SphericalReflectionMapping,f.envMap=x,E.material.handleTextureEvents(m.el,x),f.needsUpdate=!0});return}if(h[b]){h[b].then(function(y){m.isLoadingEnvMap=!1,f.envMap=y,E.material.handleTextureEvents(m.el,y),f.needsUpdate=!0});return}h[b]=new Promise(function(y){E.srcLoader.validateCubemapSrc(b,function(L){w.load(L,function(M){m.isLoadingEnvMap=!1,f.envMap=M,E.material.handleTextureEvents(m.el,M),y(M)})})})}});function v(d,m){return m.color.set(d.color),m.emissive.set(d.emissive),m.emissiveIntensity=d.emissiveIntensity,m.fog=d.fog,m.metalness=d.metalness,m.roughness=d.roughness,m.wireframe=d.wireframe,m.wireframeLinewidth=d.wireframeLinewidth,d.normalMap&&(m.normalScale=d.normalScale),d.ambientOcclusionMap&&(m.aoMapIntensity=d.ambientOcclusionMapIntensity),d.displacementMap&&(m.displacementScale=d.displacementScale,m.displacementBias=d.displacementBias),m}},{"../core/shader":141,"../lib/three":179,"../utils/":205}],186:[function(_,G,fe){var u=`html.a-fullscreen{bottom:0;left:0;position:fixed;right:0;top:0}html.a-fullscreen body{height:100%;margin:0;overflow:hidden;padding:0;width:100%}html.a-fullscreen .a-canvas{width:100%!important;height:100%!important;top:0!important;left:0!important;right:0!important;bottom:0!important;position:fixed!important}html:not(.a-fullscreen) .a-enter-ar,html:not(.a-fullscreen) .a-enter-vr{right:5px;bottom:5px}:-webkit-full-screen{background-color:transparent}.a-hidden{display:none!important}.a-canvas{height:100%;left:0;position:absolute;top:0;width:100%}.a-canvas.a-grab-cursor:hover{cursor:grab;cursor:-moz-grab;cursor:-webkit-grab}canvas.a-canvas.a-mouse-cursor-hover:hover{cursor:pointer}.a-inspector-loader{background-color:#ed3160;position:fixed;left:3px;top:3px;padding:6px 10px;color:#fff;text-decoration:none;font-size:12px;font-family:Roboto,sans-serif;text-align:center;z-index:99999;width:204px}@keyframes dots-1{from{opacity:0}25%{opacity:1}}@keyframes dots-2{from{opacity:0}50%{opacity:1}}@keyframes dots-3{from{opacity:0}75%{opacity:1}}@-webkit-keyframes dots-1{from{opacity:0}25%{opacity:1}}@-webkit-keyframes dots-2{from{opacity:0}50%{opacity:1}}@-webkit-keyframes dots-3{from{opacity:0}75%{opacity:1}}.a-inspector-loader .dots span{animation:dots-1 2s infinite steps(1);-webkit-animation:dots-1 2s infinite steps(1)}.a-inspector-loader .dots span:first-child+span{animation-name:dots-2;-webkit-animation-name:dots-2}.a-inspector-loader .dots span:first-child+span+span{animation-name:dots-3;-webkit-animation-name:dots-3}a-scene{display:block;position:relative;height:100%;width:100%}a-assets,a-scene audio,a-scene img,a-scene video{display:none}.a-enter-vr-modal,.a-orientation-modal{font-family:Consolas,Andale Mono,Courier New,monospace}.a-enter-vr-modal a{border-bottom:1px solid #fff;padding:2px 0;text-decoration:none;transition:.1s color ease-in}.a-enter-vr-modal a:hover{background-color:#fff;color:#111;padding:2px 4px;position:relative;left:-4px}.a-enter-ar,.a-enter-vr{font-family:sans-serif,monospace;font-size:13px;width:100%;font-weight:200;line-height:16px;position:absolute;right:20px;bottom:20px}.a-enter-ar{right:80px}.a-enter-vr-button,.a-enter-vr-modal,.a-enter-vr-modal a{color:#fff;user-select:none;outline:0}.a-enter-vr-button{background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z' fill='%23fff'/%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat rgba(0,0,0,.35)}.a-enter-ar-button{background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z' fill='%23fff'/%3E%3Cpath d='M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z' fill='%23fff'/%3E%3Cpath d='M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat rgba(0,0,0,.2)}.a-enter-ar-button,.a-enter-vr-button{background-size:90% 90%;border:0;bottom:0;cursor:pointer;min-width:58px;min-height:34px;padding-right:0;padding-top:0;position:absolute;right:0;transition:background-color .05s ease;-webkit-transition:background-color .05s ease;z-index:9999;border-radius:8px;touch-action:manipulation}.a-enter-ar-button{background-size:100% 90%;margin-right:10px;border-radius:7px}.a-enter-ar-button:active,.a-enter-ar-button:hover,.a-enter-vr-button:active,.a-enter-vr-button:hover{background-color:#ef2d5e}.a-enter-vr-button.resethover{background-color:rgba(0,0,0,.35)}[data-a-enter-vr-no-webvr] .a-enter-vr-button{border-color:#666;opacity:.65}[data-a-enter-vr-no-webvr] .a-enter-vr-button:active,[data-a-enter-vr-no-webvr] .a-enter-vr-button:hover{background-color:rgba(0,0,0,.35);cursor:not-allowed}.a-enter-vr-modal{background-color:#666;border-radius:0;display:none;min-height:32px;margin-right:70px;padding:9px;width:280px;right:2%;position:absolute}.a-enter-vr-modal:after{border-bottom:10px solid transparent;border-left:10px solid #666;border-top:10px solid transparent;display:inline-block;content:'';position:absolute;right:-5px;top:5px;width:0;height:0}.a-enter-vr-modal a,.a-enter-vr-modal p{display:inline}.a-enter-vr-modal p{margin:0}.a-enter-vr-modal p:after{content:' '}[data-a-enter-vr-no-headset].a-enter-vr:hover .a-enter-vr-modal,[data-a-enter-vr-no-webvr].a-enter-vr:hover .a-enter-vr-modal{display:block}.a-orientation-modal{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center/50% 50% no-repeat rgba(244,244,244,1);bottom:0;font-size:14px;font-weight:600;left:0;line-height:20px;right:0;position:fixed;top:0;z-index:9999999}.a-orientation-modal:after{color:#666;content:"Insert phone into Cardboard holder.";display:block;position:absolute;text-align:center;top:70%;transform:translateY(-70%);width:100%}.a-orientation-modal button{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;border:none;height:50px;text-indent:-9999px;width:50px}.a-loader-title{background-color:rgba(0,0,0,.6);font-family:sans-serif,monospace;text-align:center;font-size:20px;height:50px;font-weight:300;line-height:50px;position:absolute;right:0;left:0;top:0;color:#fff}.a-modal{background:0 0/50% 50% rgba(0,0,0,.6);bottom:0;font-size:14px;font-weight:600;left:0;line-height:20px;right:0;position:fixed;top:0;z-index:9999999}.a-dialog{position:relative;left:50%;top:50%;transform:translate(-50%,-50%);z-index:199995;width:300px;height:200px;background-size:contain;background-color:#fff;font-family:sans-serif,monospace;font-size:20px;border-radius:3px;padding:6px}.a-dialog-text-container{width:100%;height:70%;align-self:flex-start;display:flex;justify-content:center;align-content:center;flex-direction:column}.a-dialog-text{display:inline-block;font-weight:400;font-size:14pt;margin:8px}.a-dialog-buttons-container{display:inline-flex;align-self:flex-end;width:100%;height:30%}.a-dialog-button{cursor:pointer;align-self:center;opacity:.9;height:80%;width:50%;font-size:12pt;margin:4px;border-radius:2px;text-align:center;border:none;display:inline-block;-webkit-transition:all .25s ease-in-out;transition:all .25s ease-in-out;box-shadow:0 1px 3px rgba(0,0,0,.1),0 1px 2px rgba(0,0,0,.2);user-select:none}.a-dialog-permission-button:hover{box-shadow:0 7px 14px rgba(0,0,0,.2),0 2px 2px rgba(0,0,0,.2)}.a-dialog-allow-button{background-color:#00ceff}.a-dialog-deny-button{background-color:#ff005b}.a-dialog-ok-button{background-color:#00ceff;width:100%}`;_("browserify-css").createStyle(u,{href:"src/style/aframe.css"}),G.exports=u},{"browserify-css":4}],187:[function(_,G,fe){var u=".rs-base{background-color:#333;color:#fafafa;border-radius:0;font:10px monospace;left:5px;line-height:1em;opacity:.85;overflow:hidden;padding:10px;position:fixed;top:5px;width:300px;z-index:10000}.rs-base div.hidden{display:none}.rs-base h1{color:#fff;cursor:pointer;font-size:1.4em;font-weight:300;margin:0 0 5px;padding:0}.rs-group{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-direction:column-reverse;flex-direction:column-reverse;margin-bottom:5px}.rs-group:last-child{margin-bottom:0}.rs-counter-base{align-items:center;display:-webkit-box;display:-webkit-flex;display:flex;height:10px;-webkit-justify-content:space-between;justify-content:space-between;margin:2px 0}.rs-counter-base.alarm{color:#b70000;text-shadow:0 0 0 #b70000,0 0 1px #fff,0 0 1px #fff,0 0 2px #fff,0 0 2px #fff,0 0 3px #fff,0 0 3px #fff,0 0 4px #fff,0 0 4px #fff}.rs-counter-id{font-weight:300;-webkit-box-ordinal-group:0;-webkit-order:0;order:0;width:54px}.rs-counter-value{font-weight:300;-webkit-box-ordinal-group:1;-webkit-order:1;order:1;text-align:right;width:35px}.rs-canvas{-webkit-box-ordinal-group:2;-webkit-order:2;order:2}@media (min-width:480px){.rs-base{left:20px;top:20px}}";_("browserify-css").createStyle(u,{href:"src/style/rStats.css"}),G.exports=u},{"browserify-css":4}],188:[function(_,G,fe){var u=_("../constants/"),A=_("../core/system").registerSystem,E="data-aframe-default-camera";G.exports.System=A("camera",{init:function(){this.activeCameraEl=null,this.render=this.render.bind(this),this.unwrapRender=this.unwrapRender.bind(this),this.wrapRender=this.wrapRender.bind(this),this.initialCameraFound=!1,this.numUserCameras=0,this.numUserCamerasChecked=0,this.setupInitialCamera()},setupInitialCamera:function(){var h,v,d=this.sceneEl,m=this;if(d.camera&&!d.camera.el.getAttribute("camera").spectator){d.emit("cameraready",{cameraEl:d.camera.el});return}if(h=d.querySelectorAll("a-camera, [camera]"),!h.length){this.createDefaultCamera();return}for(this.numUserCameras=h.length,v=0;v<h.length;v++)h[v].addEventListener("object3dset",function(f){f.detail.type==="camera"&&m.checkUserCamera(this)}),h[v].isNode?h[v].load():h[v].addEventListener("nodeready",function(){this.load()})},checkUserCamera:function(h){var v,d=this.el.sceneEl;if(this.numUserCamerasChecked++,!this.initialCameraFound){if(v=h.getAttribute("camera"),!v.active||v.spectator){this.numUserCamerasChecked===this.numUserCameras&&this.createDefaultCamera();return}this.initialCameraFound=!0,d.camera=h.getObject3D("camera"),d.emit("cameraready",{cameraEl:h})}},createDefaultCamera:function(){var h,v=this.sceneEl;h=document.createElement("a-entity"),h.setAttribute("camera",{active:!0}),h.setAttribute("position",{x:0,y:u.DEFAULT_CAMERA_HEIGHT,z:0}),h.setAttribute("wasd-controls",""),h.setAttribute("look-controls",""),h.setAttribute(u.AFRAME_INJECTED,""),h.addEventListener("object3dset",function(d){d.detail.type==="camera"&&(v.camera=d.detail.object,v.emit("cameraready",{cameraEl:h}))}),v.appendChild(h)},disableActiveCamera:function(){var h,v;h=this.sceneEl.querySelectorAll("[camera]"),v=h[h.length-1],v.setAttribute("camera","active",!0)},setActiveCamera:function(h){var v,d,m,f,b=this.activeCameraEl,g=this.sceneEl;if(f=h.getObject3D("camera"),!(!f||h===this.activeCameraEl)){var y=g.querySelector("["+E+"]"),x=y&&y.querySelector("[camera]");for(h!==x&&w(g),this.activeCameraEl=h,this.activeCameraEl.play(),g.camera=f,b&&b.setAttribute("camera","active",!1),d=g.querySelectorAll("[camera]"),m=0;m<d.length;m++)v=d[m],!(!v.isEntity||h===v)&&(v.setAttribute("camera","active",!1),v.pause());g.emit("camera-set-active",{cameraEl:h})}},setSpectatorCamera:function(h){var v,d=this.spectatorCameraEl,m=this.sceneEl,f;v=h.getObject3D("camera"),!(!v||h===this.spectatorCameraEl)&&(d&&d.setAttribute("camera","spectator",!1),f=this.spectatorCameraEl=h,m.addEventListener("enter-vr",this.wrapRender),m.addEventListener("exit-vr",this.unwrapRender),f.setAttribute("camera","active",!1),f.play(),m.emit("camera-set-spectator",{cameraEl:h}))},disableSpectatorCamera:function(){this.spectatorCameraEl=void 0},wrapRender:function(){!this.spectatorCameraEl||this.originalRender||(this.originalRender=this.sceneEl.renderer.render,this.sceneEl.renderer.render=this.render)},unwrapRender:function(){!this.originalRender||(this.sceneEl.renderer.render=this.originalRender,this.originalRender=void 0)},render:function(h,v){var d,m=this.sceneEl,f;d=m.renderer.xr.enabled,this.originalRender.call(m.renderer,h,v),!(!this.spectatorCameraEl||m.isMobile||!d)&&(f=this.spectatorCameraEl.components.camera.camera,m.renderer.xr.enabled=!1,this.originalRender.call(m.renderer,h,f),m.renderer.xr.enabled=d)}});function w(h){var v,d=h.camera;!d||(v=h.querySelector("["+E+"]"),!!v&&h.removeChild(v))}},{"../constants/":123,"../core/system":142}],189:[function(_,G,fe){var u=_("../core/geometry").geometries,A=_("../core/system").registerSystem;G.exports.System=A("geometry",{init:function(){this.cache={},this.cacheCount={}},clearCache:function(){this.cache={},this.cacheCount={}},getOrCreateGeometry:function(v){var d=this.cache,m,f;return v.skipCache?E(v):(f=this.hash(v),m=d[f],h(this.cacheCount,f),m||(m=E(v),d[f]=m,m))},unuseGeometry:function(v){var d=this.cache,m=this.cacheCount,f,b;v.skipCache||(b=this.hash(v),!!d[b]&&(w(m,b),!(m[b]>0)&&(f=d[b],f.dispose(),delete d[b],delete m[b])))},hash:function(v){return JSON.stringify(v)}});function E(v){var d=v.primitive,m=u[d]&&u[d].Geometry,f=new m;if(!m)throw new Error("Unknown geometry `"+d+"`");return f.init(v),f.geometry}function w(v,d){v[d]--}function h(v,d){v[d]=v[d]===void 0?1:v[d]+1}},{"../core/geometry":132,"../core/system":142}],190:[function(_,G,fe){var u=_("../core/system").registerSystem,A=_("../lib/three");G.exports.System=u("gltf-model",{schema:{dracoDecoderPath:{default:""}},init:function(){var E=this.data.dracoDecoderPath;this.dracoLoader=new A.DRACOLoader,this.dracoLoader.setDecoderPath(E)},update:function(){var E;this.dracoLoader||(E=this.data.dracoDecoderPath,this.dracoLoader=new A.DRACOLoader,this.dracoLoader.setDecoderPath(E))},getDRACOLoader:function(){return this.dracoLoader}})},{"../core/system":142,"../lib/three":179}],191:[function(_,G,fe){_("./camera"),_("./geometry"),_("./gltf-model"),_("./light"),_("./material"),_("./renderer"),_("./shadow"),_("./tracked-controls-webvr"),_("./tracked-controls-webxr"),_("./webxr")},{"./camera":188,"./geometry":189,"./gltf-model":190,"./light":192,"./material":193,"./renderer":194,"./shadow":195,"./tracked-controls-webvr":196,"./tracked-controls-webxr":197,"./webxr":198}],192:[function(_,G,fe){var u=_("../core/system").registerSystem,A=_("../utils/bind"),E=_("../constants/"),w="data-aframe-default-light";G.exports.System=u("light",{schema:{defaultLightsEnabled:{default:!0}},init:function(){this.defaultLights=!1,this.userDefinedLights=!1,this.sceneEl.addEventListener("loaded",A(this.setupDefaultLights,this))},registerLight:function(h){h.hasAttribute(w)||(this.removeDefaultLights(),this.userDefinedLights=!0)},removeDefaultLights:function(){var h,v=this.sceneEl;if(!!this.defaultLights){h=document.querySelectorAll("["+w+"]");for(var d=0;d<h.length;d++)v.removeChild(h[d]);this.defaultLights=!1}},setupDefaultLights:function(){var h=this.sceneEl,v,d;this.userDefinedLights||this.defaultLights||!this.data.defaultLightsEnabled||(v=document.createElement("a-entity"),v.setAttribute("light",{color:"#BBB",type:"ambient"}),v.setAttribute(w,""),v.setAttribute(E.AFRAME_INJECTED,""),h.appendChild(v),d=document.createElement("a-entity"),d.setAttribute("light",{color:"#FFF",intensity:.6,castShadow:!0}),d.setAttribute("position",{x:-.5,y:1,z:1}),d.setAttribute(w,""),d.setAttribute(E.AFRAME_INJECTED,""),h.appendChild(d),this.defaultLights=!0)}})},{"../constants/":123,"../core/system":142,"../utils/bind":199}],193:[function(_,G,fe){var u=_("../core/system").registerSystem,A=_("../lib/three"),E=_("../utils/"),w=_("../utils/material").isHLS,h=E.bind,v=E.debug,d=v("components:texture:error"),m=new A.TextureLoader,f=v("components:texture:warn");m.setCrossOrigin("anonymous"),G.exports.System=u("material",{init:function(){this.materials={},this.textureCounts={},this.textureCache={},this.sceneEl.addEventListener("materialtextureloaded",h(this.onMaterialTextureLoaded,this))},clearTextureCache:function(){this.textureCache={}},loadTexture:function(M,R,D){var N=this;if(M.tagName==="CANVAS"){this.loadCanvas(M,R,D);return}if(M.tagName==="VIDEO"){!M.src&&!M.srcObject&&!M.childElementCount&&f("Video element was defined with neither `source` elements nor `src` / `srcObject` attributes."),this.loadVideo(M,R,D);return}E.srcLoader.validateSrc(M,z,re);function z(Y){N.loadImage(Y,R,D)}function re(Y){N.loadVideo(Y,R,D)}},loadImage:function(M,R,D){var N=this.hash(R),z=this.textureCache;if(z[N]){z[N].then(D);return}z[N]=g(M,R),z[N].then(D)},loadCanvas:function(M,R,D){var N;N=new A.CanvasTexture(M),y(N,R),D(N)},loadVideo:function(M,R,D){var N,z,re=this.textureCache,Y,te;function J(le){le.texture.needsUpdate=!0,D(le.texture,le.videoEl)}if(typeof M!="string"){if(Y=M,N=this.hashVideo(R,Y),re[N]){re[N].then(J);return}L(Y)}if(Y=Y||x(M,R.width,R.height),N=this.hashVideo(R,Y),re[N]){re[N].then(J);return}z=new A.VideoTexture(Y),z.minFilter=A.LinearFilter,y(z,R),this.sceneEl.isIOS&&w(Y.src||Y.getAttribute("src"),Y.type||Y.getAttribute("type"))&&(z.format=A.RGBAFormat,z.needsCorrectionBGRA=!0,z.flipY=!1,z.needsCorrectionFlipY=!0),te={texture:z,videoEl:Y},re[N]=Promise.resolve(te),J(te)},hash:function(M){return M.src.tagName&&(M=E.extendDeep({},M),M.src=M.src.src),JSON.stringify(M)},hashVideo:function(M,R){return b(M,R)},registerMaterial:function(M){this.materials[M.uuid]=M},unregisterMaterial:function(M){delete this.materials[M.uuid];var R=this.textureCounts;Object.keys(M).filter(function(D){return M[D]&&M[D].isTexture}).forEach(function(D){R[M[D].uuid]--,R[M[D].uuid]<=0&&M[D].dispose()})},updateMaterials:function(M){var R=this.materials;Object.keys(R).forEach(function(D){R[D].needsUpdate=!0})},onMaterialTextureLoaded:function(M){this.textureCounts[M.detail.texture.uuid]||(this.textureCounts[M.detail.texture.uuid]=0),this.textureCounts[M.detail.texture.uuid]++}});function b(M,R){var D,N=R.getAttribute("id"),z,re;if(N)return N;for(z="",re=M||{},D=0;D<R.attributes.length;D++)re[R.attributes[D].name]=R.attributes[D].value;return Object.keys(re).sort().forEach(function(Y){z+=Y+":"+re[Y]+";"}),z}function g(M,R){return new Promise(D);function D(N,z){var re=typeof M!="string";function Y(te){y(te,R),te.needsUpdate=!0,N(te)}if(re){Y(new A.Texture(M));return}m.load(M,Y,function(){},function(te){d("`$s` could not be fetched (Error code: %s; Response: %s)",te.status,te.statusText)})}}function y(M,R){var D=R.offset||{x:0,y:0},N=R.repeat||{x:1,y:1},z=R.npot||!1;z&&(M.wrapS=A.ClampToEdgeWrapping,M.wrapT=A.ClampToEdgeWrapping,M.magFilter=A.LinearFilter,M.minFilter=A.LinearFilter),(N.x!==1||N.y!==1)&&(M.wrapS=A.RepeatWrapping,M.wrapT=A.RepeatWrapping,M.repeat.set(N.x,N.y)),(D.x!==0||D.y!==0)&&M.offset.set(D.x,D.y)}function x(M,R,D){var N=document.createElement("video");return N.width=R,N.height=D,N.setAttribute("playsinline",""),N.setAttribute("webkit-playsinline",""),N.autoplay=!0,N.loop=!0,N.crossOrigin="anonymous",N.addEventListener("error",function(){f("`$s` is not a valid video",M)},!0),N.src=M,N}function L(M){return M.autoplay=M.hasAttribute("autoplay")&&M.getAttribute("autoplay")!=="false",M.controls=M.hasAttribute("controls")&&M.getAttribute("controls")!=="false",M.getAttribute("loop")==="false"&&M.removeAttribute("loop"),M.getAttribute("preload")==="false"&&(M.preload="none"),M.crossOrigin=M.crossOrigin||"anonymous",M.setAttribute("playsinline",""),M.setAttribute("webkit-playsinline",""),M}},{"../core/system":142,"../lib/three":179,"../utils/":205,"../utils/material":209}],194:[function(_,G,fe){var u=_("../core/system").registerSystem,A=_("../utils/"),E=_("../lib/three"),w=A.debug,h=w("components:renderer:warn");G.exports.System=u("renderer",{schema:{antialias:{default:"auto",oneOf:["true","false","auto"]},highRefreshRate:{default:A.device.isOculusBrowser()},logarithmicDepthBuffer:{default:"auto",oneOf:["true","false","auto"]},maxCanvasWidth:{default:1920},maxCanvasHeight:{default:1920},physicallyCorrectLights:{default:!1},precision:{default:"high",oneOf:["high","medium","low"]},sortObjects:{default:!1},colorManagement:{default:!1},gammaOutput:{default:!1},alpha:{default:!0},foveationLevel:{default:0}},init:function(){var v=this.data,d=this.el,m=d.renderer;m.sortObjects=v.sortObjects,m.physicallyCorrectLights=v.physicallyCorrectLights,(v.colorManagement||v.gammaOutput)&&(m.outputEncoding=E.sRGBEncoding,v.gammaOutput&&h('Property `gammaOutput` is deprecated. Use `renderer="colorManagement: true;"` instead.')),d.hasAttribute("antialias")&&h('Component `antialias` is deprecated. Use `renderer="antialias: true"` instead.'),d.hasAttribute("logarithmicDepthBuffer")&&h('Component `logarithmicDepthBuffer` is deprecated. Use `renderer="logarithmicDepthBuffer: true"` instead.')},applyColorCorrection:function(v){!this.data.colorManagement||!v||(v.isColor?v.convertSRGBToLinear():v.isTexture&&(v.encoding=E.sRGBEncoding))}})},{"../core/system":142,"../lib/three":179,"../utils/":205}],195:[function(_,G,fe){var u=_("../core/system").registerSystem,A=_("../lib/three"),E={basic:A.BasicShadowMap,pcf:A.PCFShadowMap,pcfsoft:A.PCFSoftShadowMap};G.exports.System=u("shadow",{schema:{enabled:{default:!0},autoUpdate:{default:!0},type:{default:"pcf",oneOf:["basic","pcf","pcfsoft"]}},init:function(){var w=this.sceneEl,h=this.data;this.shadowMapEnabled=!1,!!w.renderer&&(w.renderer.shadowMap.type=E[h.type],w.renderer.shadowMap.autoUpdate=h.autoUpdate,this.setShadowMapEnabled(this.shadowMapEnabled))},update:function(w){w.enabled!==this.data.enabled&&this.setShadowMapEnabled(this.data.enabled)},setShadowMapEnabled:function(w){var h=this.sceneEl.renderer;this.shadowMapEnabled=this.data.enabled&&w,h&&(h.shadowMap.enabled=this.shadowMapEnabled)}})},{"../core/system":142,"../lib/three":179}],196:[function(_,G,fe){var u=_("../core/system").registerSystem,A=_("../utils"),E=A.device.isWebXRAvailable;G.exports.System=u("tracked-controls-webvr",{init:function(){var w=this;this.controllers=[],this.isChrome=navigator.userAgent.indexOf("Chrome")!==-1,this.updateControllerList(),this.throttledUpdateControllerList=A.throttle(this.updateControllerList,500,this),!E&&(!navigator.getVRDisplays||this.sceneEl.addEventListener("enter-vr",function(){navigator.getVRDisplays().then(function(h){h.length&&(w.vrDisplay=h[0])})}))},tick:function(){this.isChrome?this.updateControllerList():this.throttledUpdateControllerList()},updateControllerList:function(){var w=this.controllers,h,v,d,m;if(v=navigator.getGamepads&&navigator.getGamepads(),!!v){for(m=w.length,w.length=0,d=0;d<v.length;++d)h=v[d],h&&h.pose&&w.push(h);w.length!==m&&this.el.emit("controllersupdated",void 0,!1)}}})},{"../core/system":142,"../utils":205}],197:[function(_,G,fe){var u=_("../core/system").registerSystem,A=_("../utils");G.exports.System=u("tracked-controls-webxr",{init:function(){this.controllers=[],this.oldControllers=[],this.oldControllersLength=0,this.throttledUpdateControllerList=A.throttle(this.updateControllerList,500,this),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.addEventListener("enter-vr",this.updateReferenceSpace),this.el.addEventListener("exit-vr",this.updateReferenceSpace)},tick:function(){this.throttledUpdateControllerList()},updateReferenceSpace:function(){var E=this,w=this.el.xrSession;if(!w){this.referenceSpace=void 0,this.controllers=[],this.oldControllersLength>0&&(this.oldControllersLength=0,this.el.emit("controllersupdated",void 0,!1));return}var h=E.el.sceneEl.systems.webxr.sessionReferenceSpaceType;w.requestReferenceSpace(h).then(function(v){E.referenceSpace=v}).catch(function(v){throw E.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(h,'tracked-controls-webxr uses reference space "'+h+'".'),v})},updateControllerList:function(){var E=this.el.xrSession,w=this.oldControllers,h;if(!E){if(this.oldControllersLength===0)return;this.oldControllersLength=0,this.controllers=[],this.el.emit("controllersupdated",void 0,!1);return}if(!!E.inputSources){if(this.controllers=E.inputSources,this.oldControllersLength===this.controllers.length){var v=!0;for(h=0;h<this.controllers.length;++h)if(!(this.controllers[h]===w[h]&&this.controllers[h].gamepad===w[h].gamepad)){v=!1;break}if(v)return}for(w.length=0,h=0;h<this.controllers.length;h++)w.push(this.controllers[h]);this.oldControllersLength=this.controllers.length,this.el.emit("controllersupdated",void 0,!1)}}})},{"../core/system":142,"../utils":205}],198:[function(_,G,fe){var u=_("../core/system").registerSystem,A=_("../utils/"),E=A.debug("systems:webxr:warn");G.exports.System=u("webxr",{schema:{referenceSpaceType:{type:"string",default:"local-floor"},requiredFeatures:{type:"array",default:["local-floor"]},optionalFeatures:{type:"array",default:["bounded-floor"]},overlayElement:{type:"selector"}},update:function(){var w=this.data;this.sessionConfiguration={requiredFeatures:w.requiredFeatures,optionalFeatures:w.optionalFeatures},this.sessionReferenceSpaceType=w.referenceSpaceType,w.overlayElement&&(this.warnIfFeatureNotRequested("dom-overlay"),this.sessionConfiguration.domOverlay={root:w.overlayElement})},wasFeatureRequested:function(w){return!!(w==="viewer"||w==="local"||this.sessionConfiguration.requiredFeatures.includes(w)||this.sessionConfiguration.optionalFeatures.includes(w))},warnIfFeatureNotRequested:function(w,h){if(!this.wasFeatureRequested(w)){var v='Please add the feature "'+w+`" to a-scene's webxr system options in requiredFeatures/optionalFeatures.`;E((h?h+" ":"")+v)}}})},{"../core/system":142,"../utils/":205}],199:[function(_,G,fe){G.exports=function(A,E){return function(w){return function(){var v=w.concat(Array.prototype.slice.call(arguments,0));return A.apply(E,v)}}(Array.prototype.slice.call(arguments,2))}},{}],200:[function(_,G,fe){var u=_("./debug"),A=_("object-assign"),E=u("utils:coordinates:warn"),w=["x","y","z","w"],h=/^\s*((-?\d*\.{0,1}\d+(e-?\d+)?)\s+){2,3}(-?\d*\.{0,1}\d+(e-?\d+)?)\s*$/;G.exports.regex=h;var v="object",d=/\s+/g;function m(y,x){var L,M,R,D,N,z,re,Y,te;if(y&&y instanceof Object)return z=y.x===void 0?x&&x.x:y.x,re=y.y===void 0?x&&x.y:y.y,Y=y.z===void 0?x&&x.z:y.z,te=y.w===void 0?x&&x.w:y.w,z!=null&&(y.x=g(z)),re!=null&&(y.y=g(re)),Y!=null&&(y.z=g(Y)),te!=null&&(y.w=g(te)),y;if(y==null)return typeof x===v?A({},x):x;for(L=y.trim().split(d),N={},D=0;D<w.length;D++)if(R=w[D],L[D])N[R]=parseFloat(L[D],10);else{if(M=x&&x[R],M===void 0)continue;N[R]=g(M)}return N}G.exports.parse=m;function f(y){var x;return typeof y!==v?y:(x=y.x+" "+y.y,y.z!=null&&(x+=" "+y.z),y.w!=null&&(x+=" "+y.w),x)}G.exports.stringify=f;function b(y){return h.test(y)}G.exports.isCoordinates=b,G.exports.isCoordinate=function(y){return E("`AFRAME.utils.isCoordinate` has been renamed to `AFRAME.utils.isCoordinates`"),b(y)};function g(y){return y!=null&&y.constructor===String?parseFloat(y,10):y}G.exports.toVector3=function(y){return new THREE.Vector3(y.x,y.y,y.z)}},{"./debug":201,"object-assign":39}],201:[function(_,G,fe){(function(u){var A=_("debug"),E=_("object-assign"),w={colors:{debug:"gray",error:"red",info:"gray",warn:"orange"}},h=function(b){var g=A(b);return g.color=d(b),g};E(h,A);function v(b){var g=b.split(":");return g[g.length-1]}function d(b){var g=v(b),y=w.colors&&w.colors[g];return y||null}function m(){try{return window.localStorage}catch{}}var f=m();f&&(parseInt(f.logs,10)||f.logs==="true")?h.enable("*"):h.enable("*:error,*:info,*:warn"),u.browser&&(window.logs=h),G.exports=h}).call(this,_("_process"))},{_process:49,debug:8,"object-assign":39}],202:[function(_,G,fe){(function(u){var A=_("debug")("device:error"),E,w=!1,h=!1,v=G.exports.isWebXRAvailable=!window.debug&&navigator.xr!==void 0;if(window.addEventListener("vrdisplayactivate",function(re){var Y;v||(Y=document.createElement("canvas"),E=re.display,Y.getContext("webgl",{}),E.requestPresent([{source:Y}]).then(function(){},function(){}))}),v){var d=function(){var re=document.querySelector("a-scene");if(!re){window.addEventListener("DOMContentLoaded",d);return}re.hasLoaded?re.components["vr-mode-ui"].updateEnterInterfaces():re.addEventListener("loaded",d)},m=function(re){A("WebXR session support error: "+re.message)};navigator.xr.isSessionSupported?(navigator.xr.isSessionSupported("immersive-vr").then(function(re){w=re,d()}).catch(m),navigator.xr.isSessionSupported("immersive-ar").then(function(re){h=re,d()}).catch(function(){})):navigator.xr.supportsSession?(navigator.xr.supportsSession("immersive-vr").then(function(){w=!0,d()}).catch(m),navigator.xr.supportsSession("immersive-ar").then(function(){h=!0,d()}).catch(function(){})):A("WebXR has neither isSessionSupported or supportsSession?!")}else navigator.getVRDisplays&&navigator.getVRDisplays().then(function(re){var Y=document.querySelector("a-scene");E=re.length&&re[0],Y&&Y.emit("displayconnected",{vrDisplay:E})});function f(){return E}G.exports.getVRDisplay=f;function b(){return w||h||!!f()}G.exports.checkHeadsetConnected=b;function g(){return h}G.exports.checkARSupport=g;var y=function(){var re=!1;return function(Y){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(Y)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(Y.substr(0,4)))&&(re=!0),(L()||x()||z())&&(re=!0),N()&&(re=!1)}(window.navigator.userAgent||window.navigator.vendor||window.opera),function(){return re}}();G.exports.isMobile=y;function x(re){var Y=re||window.navigator.userAgent;return/ipad|Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(Y)}G.exports.isTablet=x;function L(){return/iPad|iPhone|iPod/.test(window.navigator.platform)}G.exports.isIOS=L;function M(){return!y()&&!N()&&window.orientation!==void 0}G.exports.isMobileDeviceRequestingDesktopSite=M;function R(){return/(OculusBrowser)/i.test(window.navigator.userAgent)}G.exports.isOculusBrowser=R;function D(){return/(Mobile VR)/i.test(window.navigator.userAgent)}G.exports.isFirefoxReality=D;function N(){return R()||D()}G.exports.isMobileVR=N;function z(){return/R7 Build/.test(window.navigator.userAgent)}G.exports.isR7=z,G.exports.isLandscape=function(){var re=window.orientation;return z()&&(re+=90),re===90||re===-90},G.exports.isBrowserEnvironment=!!(!u||u.browser),G.exports.isNodeEnvironment=!G.exports.isBrowserEnvironment}).call(this,_("_process"))},{_process:49,debug:8}],203:[function(_,G,fe){var u={};function A(E,w){return w=w||".",u[w]||(u[w]={}),E.indexOf(w)!==-1?u[w][E]=E.split(w):u[w][E]=E,u[w][E]}G.exports.getComponentPropertyPath=A,G.exports.propertyPathCache=u,G.exports.getComponentProperty=function(E,w,h){var v;return h=h||".",w.indexOf(h)!==-1?(v=A(w,h),v.constructor===String?E.getAttribute(v):E.getAttribute(v[0])[v[1]]):E.getAttribute(w)},G.exports.setComponentProperty=function(E,w,h,v){var d;if(v=v||".",w.indexOf(v)!==-1){d=A(w,v),d.constructor===String?E.setAttribute(d,h):E.setAttribute(d[0],d[1],h);return}E.setAttribute(w,h)}},{}],204:[function(_,G,fe){G.exports=function(A){var E=A.style.width,w=A.style.height;A.style.width=parseInt(E,10)+1+"px",A.style.height=parseInt(w,10)+1+"px",setTimeout(function(){A.style.width=E,A.style.height=w},200)}},{}],205:[function(_,G,fe){var u=_("./debug"),A=_("deep-assign"),E=_("./device"),w=_("object-assign"),h=_("./object-pool"),v=u("utils:warn");G.exports.bind=_("./bind"),G.exports.coordinates=_("./coordinates"),G.exports.debug=u,G.exports.device=E,G.exports.entity=_("./entity"),G.exports.forceCanvasResizeSafariMobile=_("./forceCanvasResizeSafariMobile"),G.exports.isIE11=_("./is-ie11"),G.exports.material=_("./material"),G.exports.objectPool=h,G.exports.split=_("./split").split,G.exports.styleParser=_("./styleParser"),G.exports.trackedControls=_("./tracked-controls"),G.exports.checkHeadsetConnected=function(){return v("`utils.checkHeadsetConnected` has moved to `utils.device.checkHeadsetConnected`"),E.checkHeadsetConnected(arguments)},G.exports.isGearVR=G.exports.device.isGearVR=function(){v("`utils.isGearVR` has been deprecated, use `utils.device.isMobileVR`")},G.exports.isIOS=function(){return v("`utils.isIOS` has moved to `utils.device.isIOS`"),E.isIOS(arguments)},G.exports.isOculusGo=G.exports.device.isOculusGo=function(){v("`utils.isOculusGo` has been deprecated, use `utils.device.isMobileVR`")},G.exports.isMobile=function(){return v("`utils.isMobile has moved to `utils.device.isMobile`"),E.isMobile(arguments)},G.exports.throttle=function(m,f,b){var g;return b&&(m=G.exports.bind(m,b)),function(){var y=Date.now(),x=typeof g=="undefined"?f:y-g;(typeof g=="undefined"||x>=f)&&(g=y,m.apply(null,arguments))}},G.exports.throttleTick=function(m,f,b){var g;return b&&(m=G.exports.bind(m,b)),function(y,x){var L=typeof g=="undefined"?x:y-g;(typeof g=="undefined"||L>=f)&&(g=y,m(y,L))}},G.exports.debounce=function(m,f,b){var g;return function(){var y=this,x=arguments,L=function(){g=null,b||m.apply(y,x)},M=b&&!g;clearTimeout(g),g=setTimeout(L,f),M&&m.apply(y,x)}},G.exports.extend=w,G.exports.extendDeep=A,G.exports.clone=function(m){return JSON.parse(JSON.stringify(m))};var d=function(){var m=h.createPool(function(){return[]});return function(f,b){var g,y,x,L,M,R;if(f===void 0||b===void 0||f===null||b===null||!(f&&b&&f.constructor===Object&&b.constructor===Object||f.constructor===Array&&b.constructor===Array))return f===b;y=m.use(),x=m.use(),y.length=0,x.length=0;for(g in f)y.push(g);for(g in b)x.push(g);if(y.length!==x.length)return m.recycle(y),m.recycle(x),!1;for(L=0;L<y.length;++L)if(M=f[y[L]],R=b[y[L]],typeof M=="object"||typeof R=="object"||Array.isArray(M)&&Array.isArray(R)){if(M===R)continue;if(!d(M,R))return m.recycle(y),m.recycle(x),!1}else if(M!==R)return m.recycle(y),m.recycle(x),!1;return m.recycle(y),m.recycle(x),!0}}();G.exports.deepEqual=d,G.exports.diff=function(){var m=[];return function(f,b,g){var y,x,L,M,R,D,N;M=g||{},m.length=0;for(R in f)m.push(R);if(!b)return M;for(L in b)m.indexOf(L)===-1&&m.push(L);for(D=0;D<m.length;D++)R=m[D],y=f[R],x=b[R],N=y&&x&&y.constructor===Object&&x.constructor===Object,(N&&!d(y,x)||!N&&y!==x)&&(M[R]=x);return M}}(),G.exports.shouldCaptureKeyEvent=function(m){return m.metaKey?!1:document.activeElement===document.body},G.exports.splitString=function(m,f){typeof f=="undefined"&&(f=" ");var b=new RegExp(f,"g");return m=(m||"").replace(b,f),m.split(f)},G.exports.getElData=function(m,f){f=f||{};var b={};Object.keys(f).forEach(g);function g(y){m.hasAttribute(y)&&(b[y]=m.getAttribute(y))}return b},G.exports.getUrlParameter=function(m){m=m.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var f=new RegExp("[\\?&]"+m+"=([^&#]*)"),b=f.exec(location.search);return b===null?"":decodeURIComponent(b[1].replace(/\+/g," "))},G.exports.isIframed=function(){return window.top!==window.self},G.exports.findAllScenes=function(m){for(var f=[],b=m.getElementsByTagName("*"),g=0,y=b.length;g<y;g++)b[g].isScene&&f.push(b[g]);return f},G.exports.srcLoader=_("./src-loader")},{"./bind":199,"./coordinates":200,"./debug":201,"./device":202,"./entity":203,"./forceCanvasResizeSafariMobile":204,"./is-ie11":207,"./material":209,"./object-pool":210,"./split":211,"./src-loader":212,"./styleParser":213,"./tracked-controls":214,"deep-assign":10,"object-assign":39}],206:[function(_,G,fe){window.addEventListener("orientationchange",function(){document.documentElement.style.height="initial",setTimeout(function(){document.documentElement.style.height="100%",setTimeout(function(){window.scrollTo(0,1)},500)},500)})},{}],207:[function(_,G,fe){function u(){var A=-1,E=navigator.userAgent,w;return navigator.appName==="Microsoft Internet Explorer"?(w=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})"),w.exec(E)!=null&&(A=parseFloat(RegExp.$1))):navigator.appName==="Netscape"&&(w=new RegExp("Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})"),w.exec(E)!=null&&(A=parseFloat(RegExp.$1))),A}G.exports=u()===11},{}],208:[function(_,G,fe){G.exports=function(A){return/(iphone|ipod|ipad).*os.(7_|8_|9_)/i.test(A)}},{}],209:[function(_,G,fe){var u=_("../lib/three"),A=["application/x-mpegurl","application/vnd.apple.mpegurl"],E=new Set(["emissiveMap","envMap","map","specularMap"]);G.exports.updateMapMaterialFromData=function(h,v,d,m){var f=d.el,b=d.material,g=f.sceneEl.systems.renderer,y=m[v];if(d.materialSrcs||(d.materialSrcs={}),!y){delete d.materialSrcs[h],L(null);return}if(y===d.materialSrcs[h])return;d.materialSrcs[h]=y,y instanceof u.Texture?L(y):f.sceneEl.systems.material.loadTexture(y,{src:y,repeat:m.repeat,offset:m.offset,npot:m.npot},x);function x(M){d.materialSrcs[h]===y&&L(M)}function L(M){b[h]=M,M&&E.has(h)&&g.applyColorCorrection(M),b.needsUpdate=!0,w(f,M)}},G.exports.updateMap=function(h,v){return G.exports.updateMapMaterialFromData("map","src",h,v)},G.exports.updateDistortionMap=function(h,v,d){var m=h;h==="ambientOcclusion"&&(m="ao");var f=v.el,b=v.material,g=f.sceneEl.systems.renderer,y=d[h+"Map"],x={};if(x.src=y,x.offset=d[h+"TextureOffset"],x.repeat=d[h+"TextureRepeat"],x.wrap=d[h+"TextureWrap"],y){if(y===v[h+"TextureSrc"])return;v[h+"TextureSrc"]=y,f.sceneEl.systems.material.loadTexture(y,x,L);return}if(!b.map)return;L(null);function L(M){var R=m+"Map";b[R]=M,M&&E.has(R)&&g.applyColorCorrection(M),b.needsUpdate=!0,w(f,M)}};function w(h,v){!v||(h.emit("materialtextureloaded",{src:v.image,texture:v}),!(!v.image||v.image.tagName!=="VIDEO")&&(v.image.addEventListener("loadeddata",function(){!h.components||!h.components.material||(v.needsCorrectionBGRA&&v.needsCorrectionFlipY&&["standard","flat"].indexOf(h.components.material.data.shader)!==-1&&h.setAttribute("material","shader","ios10hls"),h.emit("materialvideoloadeddata",{src:v.image,texture:v}))}),v.image.addEventListener("ended",function(){h.emit("materialvideoended",{src:v.image,texture:v})})))}G.exports.handleTextureEvents=w,G.exports.isHLS=function(h,v){return!!(v&&A.includes(v.toLowerCase())||h&&h.toLowerCase().indexOf(".m3u8")>0)}},{"../lib/three":179}],210:[function(_,G,fe){var u=Object.freeze(Object.create(null));function A(){return{}}G.exports.createPool=function(v){var d=[],m=null;v=v||A;function f(){var x;return(m===null||m===d.length)&&g(d.length||5),x=d[m],d[m++]=u,E(x),x}function b(x){if(x instanceof Object){if(m===null||m===-1){d[d.length]=x;return}d[--m]=x}}function g(x){var L,M;if(x=x===void 0?d.length:x,x>0&&m==null&&(m=0),x>0)for(L=d.length,d.length+=Number(x),M=L;M<d.length;M++)d[M]=v();return d.length}function y(){return d.length}return{grow:g,pool:d,recycle:b,size:y,use:f}};function E(h){var v;if(!(!h||h.constructor!==Object))for(v in h)h[v]=void 0}G.exports.clearObject=E;function w(h,v){var d;if(!(!h||h.constructor!==Object))for(d in h)d in v||delete h[d]}G.exports.removeUnusedKeys=w},{}],211:[function(_,G,fe){G.exports.split=function(){var u={};return function(A,E){return E in u||(u[E]={}),A in u[E]||(u[E][A]=A.split(E)),u[E][A]}}()},{}],212:[function(_,G,fe){var u=_("./debug"),A=u("utils:src-loader:warn");function E(f,b,g){v(f,function(x){if(x){b(f);return}g(f)})}function w(f,b){var g,y="",x,L,M=[];for(x=0;x<5;x++)y+="(url\\((?:[^\\)]+)\\),\\s*)";y+="(url\\((?:[^\\)]+)\\)\\s*)",L=f.match(new RegExp(y));function R(D){M.push(D),M.length===6&&b(M)}if(L){for(x=1;x<7;x++)E(h(L[x]),R);return}if(g=m(f),!!g){if(g.tagName==="A-CUBEMAP"&&g.srcs)return b(g.srcs);A('Selector "%s" does not point to <a-cubemap>',f)}}function h(f){var b=f.match(/\url\((.+)\)/);if(!!b)return b[1]}function v(f,b){var g;if(f.tagName){b(f.tagName==="IMG");return}g=new XMLHttpRequest,g.open("HEAD",f),g.addEventListener("load",function(y){var x;g.status>=200&&g.status<300?(x=g.getResponseHeader("Content-Type"),x==null?d(f,b):x.startsWith("image")?b(!0):b(!1)):d(f,b),g.abort()}),g.send()}function d(f,b){var g=new Image;g.addEventListener("load",y);function y(){b(!0)}g.addEventListener("error",x);function x(){b(!1)}g.src=f}function m(f){try{var b=document.querySelector(f);return b||A('No element was found matching the selector: "%s"',f),b}catch{A('"%s" is not a valid selector',f);return}}G.exports={parseUrl:h,validateSrc:E,validateCubemapSrc:w}},{"./debug":201}],213:[function(_,G,fe){var u=/-([a-z])/g;G.exports.parse=function(m,f){var b;return typeof m!="string"||(b=h(m,f),b[""])?m:E(b)},G.exports.stringify=function(m){return typeof m=="string"?m:v(m)};function A(m){return m.replace(u,d)}G.exports.toCamelCase=A;function E(m){var f,b;for(b in m)f=A(b),b!==f&&(m[f]=m[b],delete m[b]);return m}G.exports.transformKeysToCamelCase=E;var w=function(){var m=[],f=/url\([^)]+$/;return function(g){var y="",x,L=0,M=";";for(m.length=0;L<g.length;){if(x=g.indexOf(M,L),x===-1&&(x=g.length),y+=g.substring(L,x),f.test(y)){y+=";",L=x+1;continue}m.push(y.trim()),y="",L=x+1}return m}}();function h(m,f){var b,g,y,x,L,M;for(f=f||{},b=w(m),g=0;g<b.length;g++)y=b[g],!!y&&(x=y.indexOf(":"),L=y.substr(0,x).trim(),M=y.substr(x+1).trim(),f[L]=M);return f}function v(m){var f,b=0,g=0,y="";for(f in m)b++;for(f in m)y+=f+": "+m[f],g<b-1&&(y+="; "),g++;return y}function d(m){return m[1].toUpperCase()}},{}],214:[function(_,G,fe){var u=_("../constants").DEFAULT_HANDEDNESS,A=["x","y","z","w"],E=2;G.exports.checkControllerPresentAndSetup=function(m,f,b){var g=m.el,y,x=g.sceneEl.hasWebXR,L=x?h:w,M;if(y=L(m,f,b),M=!!y,m.controllerPresent&&!m.controllerEventsActive&&!x&&m.addEventListeners(),M===m.controllerPresent)return M;m.controllerPresent=M,M?(m.addEventListeners(),m.injectTrackedControls(y),g.emit("controllerconnected",{name:m.name,component:m})):(m.removeEventListeners(),g.emit("controllerdisconnected",{name:m.name,component:m}))};function w(m,f,b){var g,y=m.el.sceneEl,x,L=b.index||0;return!f||(x=y&&y.systems["tracked-controls-webvr"],!x)||(g=x.controllers,!g.length)?!1:!!v(g,null,f,b.hand,L)}function h(m,f,b){var g,y=m.el.sceneEl,x=y&&y.systems["tracked-controls-webxr"];return!x||(g=x.controllers,!g||!g.length)?!1:d(g,f,b.hand,b.index,b.iterateControllerProfiles,b.handTracking)}G.exports.isControllerPresentWebVR=w,G.exports.isControllerPresentWebXR=h;function v(m,f,b,g,y){var x,L,M=0,R=y>=0?y:0;for(L=0;L<m.length;L++)if(x=m[L],!(b&&!x.id.startsWith(b))&&!(!b&&x.id!==f)&&!(g&&x.hand&&g!==x.hand)){if(g&&!x.hand)R=E*y+(g===u?0:1);else return x;if(M===R)return x;++M}}function d(m,f,b,g,y,x){var L,M,R,D=!1,N,z;for(L=0;L<m.length;L++){if(R=m[L],z=R.profiles,x)D=R.hand;else if(y)for(M=0;M<z.length&&(D=z[M].startsWith(f),!D);M++);else D=z.length>0&&z[0].startsWith(f);if(!!D){if(N=R.handedness==="right"||R.handedness==="left",N){if(R.handedness===b)return m[L]}else if(L===g)return m[L]}}}G.exports.findMatchingControllerWebVR=v,G.exports.findMatchingControllerWebXR=d,G.exports.emitIfAxesChanged=function(m,f,b){var g,y,x,L,M;for(y in f){for(g=f[y],x=!1,M=0;M<g.length;M++)b.detail.changed[g[M]]&&(x=!0);if(!!x){for(L={},M=0;M<g.length;M++)L[A[M]]=b.detail.axis[g[M]];m.el.emit(y+"moved",L)}}},G.exports.onButtonEvent=function(m,f,b,g){var y=g?b.mapping[g]:b.mapping,x=y.buttons[m];b.el.emit(x+f),b.updateModel&&b.updateModel(x,f)}},{"../constants":123}],215:[function(_,G,fe){THREE.DeviceOrientationControls=function(u){var A=this;this.object=u,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var E=function(v){A.deviceOrientation=v},w=function(){A.screenOrientation=window.orientation||0},h=function(){var v=new THREE.Vector3(0,0,1),d=new THREE.Euler,m=new THREE.Quaternion,f=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(b,g,y,x,L){d.set(y,g,-x,"YXZ"),b.setFromEuler(d),b.multiply(f),b.multiply(m.setFromAxisAngle(v,-L))}}();this.connect=function(){w(),window.addEventListener("orientationchange",w,!1),window.addEventListener("deviceorientation",E,!1),A.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",w,!1),window.removeEventListener("deviceorientation",E,!1),A.enabled=!1},this.update=function(){if(A.enabled!==!1){var v=A.deviceOrientation;if(v){var d=v.alpha?THREE.Math.degToRad(v.alpha)+A.alphaOffset:0,m=v.beta?THREE.Math.degToRad(v.beta):0,f=v.gamma?THREE.Math.degToRad(v.gamma):0,b=A.screenOrientation?THREE.Math.degToRad(A.screenOrientation):0;h(A.object.quaternion,d,m,f,b)}}},this.dispose=function(){A.disconnect()},this.connect()}},{}],216:[function(_,G,fe){window.glStats=function(){var u=null,A=0,E=0,w=0,h=0,v=0,d=0,m=0;function f(D,N){return function(){N.apply(this,arguments),D.apply(this,arguments)}}WebGLRenderingContext.prototype.drawArrays=f(WebGLRenderingContext.prototype.drawArrays,function(){A++,arguments[0]==this.POINTS?d+=arguments[2]:v+=arguments[2]}),WebGLRenderingContext.prototype.drawElements=f(WebGLRenderingContext.prototype.drawElements,function(){E++,h+=arguments[1]/3,v+=arguments[1]}),WebGLRenderingContext.prototype.useProgram=f(WebGLRenderingContext.prototype.useProgram,function(){w++}),WebGLRenderingContext.prototype.bindTexture=f(WebGLRenderingContext.prototype.bindTexture,function(){m++});var b={allcalls:{over:3e3,caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}},g=[{caption:"WebGL",values:["allcalls","drawelements","drawarrays","useprogram","bindtexture","glfaces","glvertices","glpoints"]}],y=[{base:"allcalls",steps:["drawelements","drawarrays"]}];function x(){u("allcalls").set(A+E),u("drawElements").set(E),u("drawArrays").set(A),u("bindTexture").set(m),u("useProgram").set(w),u("glfaces").set(h),u("glvertices").set(v),u("glpoints").set(d)}function L(){A=0,E=0,w=0,h=0,v=0,d=0,m=0}function M(){}function R(D){u=D}return{update:x,start:L,end:M,attach:R,values:b,groups:g,fractions:y}},window.threeStats=function(u){var A=null,E={"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.triangles":{caption:"Triangles",over:1e3},"renderer.info.render.points":{caption:"Points"}},w=[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.triangles","renderer.info.render.points"]}],h=[];function v(){A("renderer.info.memory.geometries").set(u.info.memory.geometries),A("renderer.info.programs").set(u.info.programs.length),A("renderer.info.memory.textures").set(u.info.memory.textures),A("renderer.info.render.calls").set(u.info.render.calls),A("renderer.info.render.triangles").set(u.info.render.triangles),A("renderer.info.render.points").set(u.info.render.points)}function d(){}function m(){}function f(b){A=b}return{update:v,start:d,end:m,attach:f,values:E,groups:w,fractions:h}},window.BrowserStats=function(){var u=null,A=0,E=0;window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0,totalJSHeapSize:0}),performance.memory.totalJSHeapSize===0&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var w={memory:{caption:"Used Memory",average:!0,avgMs:1e3,over:22},total:{caption:"Total Memory"}},h=[{caption:"Browser",values:["memory","total"]}],v=[{base:"total",steps:["memory"]}],d=Math.log(1024);function m(x){var L=100,M=Math.floor(Math.log(x)/d);return Math.round(x*L/Math.pow(1024,M))/L}function f(){A=m(performance.memory.usedJSHeapSize),E=m(performance.memory.totalJSHeapSize),u("memory").set(A),u("total").set(E)}function b(){A=0}function g(){}function y(x){u=x}return{update:f,start:b,end:g,attach:y,values:w,groups:h,fractions:v}},typeof G=="object"&&(G.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats})},{}],217:[function(_,G,fe){(function(){"performance"in window||(window.performance={});var u=window.performance;if(!("now"in u)){var A=Date.now();u.timing&&u.timing.navigationStart&&(A=u.timing.navigationStart),u.now=function(){return Date.now()-A}}u.mark||(u.mark=function(){}),u.measure||(u.measure=function(){})})(),window.rStats=function(A){function E(Y,te){for(var J=Object.keys(Y),le=0,j=J.length;le<j;le++)te(J[le])}function w(Y){var te=document.createElement("link");te.href=Y,te.rel="stylesheet",te.type="text/css",document.getElementsByTagName("head")[0].appendChild(te)}var h=A||{},v=h.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"],d="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300",m=(h.CSSPath?h.CSSPath:"")+"rStats.css",f=h.css||[d,m];f.forEach(function(Y){w(Y)}),h.values||(h.values={});var b,g,y=10,x=200,L={};function M(Y,te,J){var le=J||{},j=document.createElement("canvas"),ae=j.getContext("2d"),Z=0,ye=0,Ne=le.color?le.color:"#666666",We=document.createElement("canvas"),ke=We.getContext("2d");We.width=1,We.height=2*y,ke.fillStyle="#444444",ke.fillRect(0,0,1,2*y),ke.fillStyle=Ne,ke.fillRect(0,y,1,y),ke.fillStyle="#ffffff",ke.globalAlpha=.5,ke.fillRect(0,y,1,1),ke.globalAlpha=1;var it=document.createElement("canvas"),rt=it.getContext("2d");it.width=1,it.height=2*y,rt.fillStyle="#444444",rt.fillRect(0,0,1,2*y),rt.fillStyle="#b70000",rt.fillRect(0,y,1,y),rt.globalAlpha=.5,rt.fillStyle="#ffffff",rt.fillRect(0,y,1,1),rt.globalAlpha=1;function At(){j.width=x,j.height=y,j.style.width=j.width+"px",j.style.height=j.height+"px",j.className="rs-canvas",Y.appendChild(j),ae.fillStyle="#444444",ae.fillRect(0,0,j.width,j.height)}function St(Gt,er){ye+=(Gt-ye)*.1,Z*=.99,ye>Z&&(Z=ye),ae.drawImage(j,1,0,j.width-1,j.height,0,0,j.width-1,j.height),er?ae.drawImage(it,j.width-1,j.height-ye*j.height/Z-y):ae.drawImage(We,j.width-1,j.height-ye*j.height/Z-y)}return At(),{draw:St}}function R(Y,te){var J=document.createElement("canvas"),le=J.getContext("2d");function j(){J.width=x,J.height=y*te,J.style.width=J.width+"px",J.style.height=J.height+"px",J.className="rs-canvas",Y.appendChild(J),le.fillStyle="#444444",le.fillRect(0,0,J.width,J.height)}function ae(Z){le.drawImage(J,1,0,J.width-1,J.height,0,0,J.width-1,J.height);var ye=0;E(Z,function(Ne){var We=Z[Ne]*J.height;le.fillStyle=v[Ne],le.fillRect(J.width-1,ye,1,We),ye+=We})}return j(),{draw:ae}}function D(Y,te){var J=Y,le,j=0,ae=0,Z=0,ye=0,Ne=performance.now(),We=0,ke=document.createElement("div"),it=document.createElement("span"),rt=document.createElement("div"),At=document.createTextNode(""),St=h?h.values[J.toLowerCase()]:null,Gt=new M(ke,J,St),er=!1;it.className="rs-counter-id",it.textContent=St&&St.caption?St.caption:J,rt.className="rs-counter-value",rt.appendChild(At),ke.appendChild(it),ke.appendChild(rt),te?te.div.appendChild(ke):g.appendChild(ke),le=performance.now();function zt(ge){if(St&&St.average){ye+=ge,We++;var ve=performance.now();ve-Ne>=(St.avgMs||1e3)&&(Z=ye/We,ye=0,Ne=ve,We=0)}}function wt(){le=performance.now(),h.userTimingAPI&&performance.mark(J+"-start"),er=!0}function kr(){j=performance.now()-le,h.userTimingAPI&&(performance.mark(J+"-end"),er&&performance.measure(J,J+"-start",J+"-end")),zt(j)}function en(){kr(),wt()}function Nt(){var ge=St&&St.average?Z:j;At.nodeValue=Math.round(ge*100)/100;var ve=St&&(St.below&&j<St.below||St.over&&j>St.over);Gt.draw(j,ve),ke.className=ve?"rs-counter-base alarm":"rs-counter-base"}function ne(){var ge=performance.now(),ve=ge-le;ae++,ve>1e3&&(St&&St.interpolate===!1?j=ae:j=ae*1e3/ve,ae=0,le=ge,zt(j))}function ie(ge){j=ge,zt(j)}return{set:ie,start:wt,tick:en,end:kr,frame:ne,value:function(){return j},draw:Nt}}function N(Y){var te=Y.toLowerCase();if(te===void 0&&(te="default"),L[te])return L[te];var J=null;h&&h.groups&&E(h.groups,function(j){var ae=h.groups[parseInt(j,10)];!J&&ae.values.indexOf(te.toLowerCase())!==-1&&(J=ae)});var le=new D(te,J);return L[te]=le,le}function z(){if(h.plugins){h.values||(h.values={}),h.groups||(h.groups=[]),h.fractions||(h.fractions=[]);for(var Y=0;Y<h.plugins.length;Y++)h.plugins[Y].attach(N),E(h.plugins[Y].values,function(te){h.values[te]=h.plugins[Y].values[te]}),h.groups=h.groups.concat(h.plugins[Y].groups),h.fractions=h.fractions.concat(h.plugins[Y].fractions)}else h.plugins={};b=document.createElement("div"),b.className="rs-base",g=document.createElement("div"),g.className="rs-container",g.style.height="auto",b.appendChild(g),document.body.appendChild(b),!!h&&(h.groups&&E(h.groups,function(te){var J=h.groups[parseInt(te,10)],le=document.createElement("div");le.className="rs-group",J.div=le;var j=document.createElement("h1");j.textContent=J.caption,j.addEventListener("click",function(ae){this.classList.toggle("hidden"),ae.preventDefault()}.bind(le)),g.appendChild(j),g.appendChild(le)}),h.fractions&&E(h.fractions,function(te){var J=h.fractions[parseInt(te,10)],le=document.createElement("div");le.className="rs-fraction";var j=document.createElement("div");j.className="rs-legend";var ae=0;E(h.fractions[te].steps,function(ye){var Ne=document.createElement("p");Ne.textContent=h.fractions[te].steps[ye],Ne.style.color=v[ae],j.appendChild(Ne),ae++}),le.appendChild(j),le.style.height=ae*y+"px",J.div=le;var Z=new R(le,ae);J.graph=Z,g.appendChild(le)}))}function re(){E(h.plugins,function(Y){h.plugins[Y].update()}),E(L,function(Y){L[Y].draw()}),h&&h.fractions&&E(h.fractions,function(Y){var te=h.fractions[parseInt(Y,10)],J=[],le=L[te.base.toLowerCase()];le&&(le=le.value(),E(h.fractions[Y].steps,function(j){var ae=h.fractions[Y].steps[parseInt(j,10)].toLowerCase(),Z=L[ae];Z&&J.push(Z.value()/le)})),te.graph.draw(J)})}return z(),function(Y){return Y?N(Y):{element:b,update:re}}},typeof G=="object"&&(G.exports=window.rStats)},{}],218:[function(_,G,fe){String.prototype.startsWith||(String.prototype.startsWith=function(u,A){return A=A||0,this.substr(A,u.length)===u})},{}],219:[function(_,G,fe){var u={};u.base64=function(A,E){return"data:"+A+";base64,"+E},u.isMobile=function(){var A=!1;return function(E){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(E)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(E.substr(0,4)))&&(A=!0)}(navigator.userAgent||navigator.vendor||window.opera),A},u.isIOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},u.isIFrame=function(){try{return window.self!==window.top}catch{return!0}},u.appendQueryParameter=function(A,E,w){var h=A.indexOf("?")<0?"?":"&";return A+=h+E+"="+w,A},u.getQueryParameter=function(A){A=A.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var E=new RegExp("[\\?&]"+A+"=([^&#]*)"),w=E.exec(location.search);return w===null?"":decodeURIComponent(w[1].replace(/\+/g," "))},u.isLandscapeMode=function(){return window.orientation==90||window.orientation==-90},G.exports=u},{}],220:[function(_,G,fe){var u=_("./util.js");function A(){var h=document.createElement("video");h.addEventListener("ended",function(){h.play()}),this.request=function(){h.paused&&(h.src=u.base64("video/webm","GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw=="),h.play())},this.release=function(){h.pause(),h.src=""}}function E(){var h=null;this.request=function(){h||(h=setInterval(function(){window.location.href="/",setTimeout(window.stop,0)},15e3))},this.release=function(){h&&(clearInterval(h),h=null)}}function w(){var h=navigator.userAgent||navigator.vendor||window.opera;return h.match(/iPhone/i)||h.match(/iPod/i)?E:A}G.exports=w()},{"./util.js":219}]},{},[177])(177)})})(nh);var uA=lA(nh.exports),cA=Object.freeze(sA({__proto__:null,[Symbol.toStringTag]:"Module",default:uA},[nh.exports]));export{cA as a};
